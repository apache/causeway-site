<!doctype html>

<html class="no-js" lang="en">

<head>

    <meta charset="utf-8"/>

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>



    <title>User Guide</title>



    <!--

        Licensed to the Apache Software Foundation (ASF) under one

        or more contributor license agreements.  See the NOTICE file

        distributed with this work for additional information

        regarding copyright ownership.  The ASF licenses this file

        to you under the Apache License, Version 2.0 (the

        "License"); you may not use this file except in compliance

        with the License.  You may obtain a copy of the License at



        http://www.apache.org/licenses/LICENSE-2.0



        Unless required by applicable law or agreed to in writing,

        software distributed under the License is distributed on an

        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY

        KIND, either express or implied.  See the License for the

        specific language governing permissions and limitations

        under the License.

    -->



    <!-- No caching headers -->

    <meta http-equiv="cache-control" content="no-cache" />

    <meta http-equiv="pragma" content="no-cache" />

    <meta http-equiv="expires" content="-1" />



    <link href="../css/foundation/5.5.1/foundation.css" rel="stylesheet" />

    <script src="../js/foundation/5.5.1/vendor/modernizr.js"></script>

    <link href="../css/asciidoctor/colony.css" rel="stylesheet">

    <link href="../css/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">



    <link href="../css/github-fork-ribbon-css/0.1.1/gh-fork-ribbon.css" rel="stylesheet" />

    <!--[if lt IE 9]>

      <link href="../css/github-fork-ribbon-css/0.1.1/gh-fork-ribbon.ie.css" rel="stylesheet" />

    <![endif]-->



    <style type="text/css">

        /* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{font-weight: normal}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#00}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}



        pre.CodeRay code {

            background-color: inherit;

            border-style: none;

        }



        .literalblock pre,

        .listingblock pre:not(.highlight),

        .listingblock pre[class="highlight"],

        .listingblock pre[class^="highlight "],

        .listingblock pre.CodeRay,

        .listingblock pre.prettyprint {

            background: rgb(253, 250, 246);

         }

        .sidebarblock .literalblock pre,

        .sidebarblock .listingblock pre:not(.highlight),

        .sidebarblock .listingblock pre[class="highlight"],

        .sidebarblock .listingblock pre[class^="highlight "],

        .sidebarblock .listingblock pre.CodeRay,

        .sidebarblock .listingblock pre.prettyprint {

            background: rgb(253, 250, 246);

         }



    <style>



    <style>

    .github-fork-ribbon-wrapper.right {

        position: fixed;

    }

    .github-fork-ribbon {

        background: #090;

    }

    .github-fork-ribbon a:hover {

        background:#0D0;

        color:#fff;

        font-size: 1.1em;

    }

    </style>



    <style>

        .extended-quote,

        .extended-quote-first {

            margin-left: 40px;

            margin-right: 40px;

            font-style: italic;

        }

        .extended-quote-attribution {

            text-align: right;

            margin-right: 100px;

            color: #10B061;

        }



        .extended-quote-first:before {

            content: "\201c";

            float: left;

            font-size: 2.75em;

            font-weight: bold;

            line-height: 0.6em;

            margin-left: -0.6em;

            color: #003b6b;

            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);

        }

    </style>



    <style>

        body {

          position: relative;

        }



        *:not(pre) > code {

            background-color: inherit;

            border: none;

        }



        body div#toc li,

        body div#toc2 li {

            list-style-type: none;

        }



        div#doc-content {

            margin-top: 30px;

        }



        body div#toc li.active-region:before,

        body div#toc2 li.active-region:before {

            content: "\00BB \0020";

            margin-left: -12px;

        }



        body div#toc li a.active,

        body div#toc2 li a.active {

            color: red;

        }



        body div#toc.toc,

        body div#toc.toc2 {

            position: fixed;

            left: auto;

            padding-top: 80px;

            z-index: auto;

            background-color: white;

            border-left-color: #eee;

            border-left-style: solid;

            border-right: none;

            min-height: 2000px;

        }

    </style>



    <style>

        footer {

            margin-top: 1000px;

        }

    </style>



    <style>

        /* overriding colony.css stylesheet */

        .literalblock pre, .literalblock pre[class], .listingblock pre, .listingblock pre[class] {

           /*padding: 1.25em 1.5625em 1.125em 1.5625em;*/

           padding: 0.3em 0.6em 0.25em 0.6em;

        }

        @media only screen and (min-width: 1280px)

        #toc.toc2 {

          /*width: 20em;*/

          width: 25em;

        }



        #doc-content a {

          color: #210DDC;

        }



        h2 {

          margin-top: 100px;

        }

        h3 {

          margin-top: 50px;

        }

        h4,h5 {

          margin-top: 30px;

        }



        .admonitionblock.tip > table td.content {

            color: #10B061;

        }

        .admonitionblock.note > table td.content {

            color: #B509AB;

        }

        .admonitionblock.important > table td.content {

            color: #D5810A;

        }



        .imageblock img {

            margin-bottom: 10px;

        }

    </style>



    <style>

        /* from http://ben.balter.com/2014/03/13/pages-anchor-links/ */

        .header-link {

          position: absolute;

          left: -0.5em;

          opacity: 0;



          /*

          -webkit-transition: opacity 0.2s ease-in-out 0.1s;

          -moz-transition: opacity 0.2s ease-in-out 0.1s;

          -ms-transition: opacity 0.2s ease-in-out 0.1s;

          */

        }



        h2:hover .header-link,

        h3:hover .header-link,

        h4:hover .header-link,

        h5:hover .header-link,

        h6:hover .header-link {

          opacity: 1;

        }

    </style>



</script>



</head>

<body>



<div class="github-fork-ribbon-wrapper right" style="position: fixed;">

    <div class="github-fork-ribbon">

        <a href="https://github.com/apache/isis/fork">Fork me on GitHub</a>

    </div>

</div>



<div class="row">



    <div class="fixed contain-to-grid">

        <nav class="top-bar" data-topbar role="navigation">

            <ul class="title-area">

                <li class="name">

                    <h1>

                        <a href="/index.html">Apache Isis&trade;</a>

                    </h1>

                </li>

                <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone -->

                <li class="toggle-topbar menu-icon"><a href="#"><span>Menu</span></a></li>

            </ul>



            <section class="top-bar-section">

                <ul class="right">



                    <li class="has-form">

                       <FORM class="searchbox navbar-form navbar-right" id="searchbox_012614087480249044419:dn-q5gtwxya" action="http://www.google.com/cse">

                        <div class="row collapse">

                            <input type="hidden" name="cx" value="012614087480249044419:dn-q5gtwxya">

                            <INPUT type="hidden" name="cof" value="FORID:0">

                            <INPUT class="form-control" name="q" type="text" placeholder="Search">

                        </div>

                    </FORM>

                     </li>



                </ul>



                <!-- Left Nav Section -->

                <ul class="left">



                    <li class="has-dropdown">

                      <a href="#" >Demos</b></a>

                      <ul class="dropdown">

                        <li><a href="/intro/elevator-pitch/isis-in-pictures.html">Screenshots</a></li>

                        <li><a href="/intro/tutorials/screencasts.html">Screencasts&nbsp;<img src="/images/tv_show-25.png"></a></li>

                        <li><a href="/intro/powered-by/powered-by.html">Powered by</a></li>

                        <li><a href="http://isisdemo.mmyco.co.uk/" target="_blank">Online Demo</a></li>

                      </ul>

                    </li>



                    <li><a href="/documentation">Documentation</a></li>



                    <li class="has-dropdown">

                      <a href="#">Downloads</a>

                      <ul class="dropdown">

                        <li><a href="/intro/getting-started/simpleapp-archetype.html">Isis (Maven archetype)</a></li>

                        <li><a href="/download.html">Isis (downloads)</a></li>

                        <li><a href="http://www.isisaddons.org" target="_blank">Isis Add-ons (not ASF)</a></li>

                      </ul>

                    </li>



                    <li class="has-dropdown">

                      <a href="#">Help</a>

                      <ul class="dropdown">

                        <li><a href="/support.html">Mailing Lists</a></li>

                        <li><a href="http://isis.markmail.org/search/?q=" target="_blank">Mailing List Archives</a></li>

                        <li><a href="https://issues.apache.org/jira/browse/ISIS" target="_blank">JIRA</a></li>

                        <li><a href="http://github.com/apache/isis" target="_blank">Github mirror</a></li>

                        <li><a href="http://stackoverflow.com/questions/tagged/isis" target="_blank">Stack Overflow</a></li>

                        <li><a href="/contributors/contributing.html">How to contribute</a></li>

                      </ul>

                    </li>



                    <li class="has-dropdown">

                      <a href="#" >@ASF</a>

                      <ul class="dropdown">

                        <li>

                          <a href="http://www.apache.org/" target="_blank">Apache Homepage <i class="icon-share-alt"></i></a>

                        </li>

                        <li>

                          <a href="http://www.apache.org/licenses/" target="_blank">Licenses <i class="icon-share-alt"></i></a>

                        </li>

                        <li>

                          <a href="http://www.apache.org/security/" target="_blank">Security <i class="icon-share-alt"></i></a>

                        </li>

                        <li>

                          <a href="http://www.apache.org/foundation/sponsorship.html" target="_blank">Sponsorship <i class="icon-share-alt"></i></a>

                        </li>

                        <li>

                          <a href="http://www.apache.org/foundation/thanks.html">Thanks <i class="icon-share-alt"></i></a>

                        </li>

                        <li>

                          <a href="{{base}}more-thanks.html">More thanks <i class="icon-share-alt"></i></a>

                        </li>

                      </ul>

                    </li>



                </ul>



            </section>

        </nav>

    </div>

</div>



<div class="row">

    <div class="large-12 medium-12 columns">



        <div id="doc-content">

          <div class="sect1">
<h2 id="_core_concepts">1. Core Concepts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This introductory chapter should give you a good about what Apache Isis actually <strong>is</strong>: the fundamental ideas and principles that it builds upon, how it compares with other frameworks, what the fundamental building blocks are for actually writing an Isis application, and what services and features the framework provides for you to leverage in your own apps.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Parts of this chapter have been adapted from Dan Haywood&#8217;s 2009 book, 'Domain Driven Design using Naked Objects'.  We&#8217;ve also added some new insights and made sure the material we&#8217;ve used is relevant to Apache Isis.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_philosophy_and_architecture">1.1. Philosophy and Architecture</h3>
<div class="paragraph">
<p>This section describes some of the core ideas and architectural patterns upon which Apache Isis builds.</p>
</div>
<div class="sect3">
<h4 id="_domain_driven_design">1.1.1. Domain-Driven Design</h4>
<div class="paragraph">
<p>This section describes some of the core ideas and architectural patterns upon which Apache Isis builds.</p>
</div>
<div class="paragraph">
<p>There&#8217;s no doubt that we developers love the challenge of understanding and deploying complex technologies. But understanding the nuances and subtleties of the business domain itself is just as great a challenge, perhaps more so. If we devoted our efforts to understanding and addressing those subtleties, we could build better, cleaner, and more maintainable software that did a better job for our stakeholders. And there&#8217;s no doubt that our stakeholders would thank us for it.</p>
</div>
<div class="paragraph">
<p>A couple of years back Eric Evans wrote his book <a href="http://www.amazon.co.uk/Domain-driven-Design-Tackling-Complexity-Software/dp/0321125215">Domain-Driven Design</a>, which is well on its way to becoming a seminal work. In fact, most if not all of the ideas in Evans' book have been expressed before, but what he did was pull those ideas together to show how predominantly object-oriented techniques can be used to develop rich, deep, insightful, and ultimately useful business applications.</p>
</div>
<div class="paragraph">
<p>There are two central ideas at the heart of domain-driven design.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <strong><em>ubiquitous language</em></strong> is about getting the whole team (both domain experts and developers) to communicate more transparently using a domain model.</p>
</li>
<li>
<p>Meanwhile, <strong><em>model-driven design</em></strong> is about capturing that model in a very straightforward manner in code.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Let&#8217;s look at each in turn.</p>
</div>
<div class="sect4">
<h5 id="_ubiquitous_language">Ubiquitous Language</h5>
<div class="paragraph">
<p>It&#8217;s no secret that the IT industry is plagued by project failures. Too often systems take longer than intended to implement, and when finally implemented, they don&#8217;t address the real requirements anyway.</p>
</div>
<div class="paragraph">
<p>Over the years we in IT have tried various approaches to address this failing. Using waterfall methodologies, we&#8217;ve asked for requirements to be fully and precisely written down before starting on anything else. Or, using agile methodologies, we&#8217;ve realized that requirements are likely to change anyway and have sought to deliver systems incrementally using feedback loops to refine the implementation.</p>
</div>
<div class="paragraph">
<p>But let&#8217;s not get distracted talking about methodologies. At the end of the day what really matters is communication between the domain experts (that is, the business) who need the system and the techies actually implementing it. If the two don&#8217;t have and cannot evolve a shared understanding of what is required, then the chance of delivering a useful system will be next to nothing.</p>
</div>
<div class="paragraph">
<p>Bridging this gap is traditionally what business analysts are for; they act as interpreters between the domain experts and the developers. However, this still means there are two (or more) languages in use, making it difficult to verify that the system being built is correct. If the analyst mistranslates a requirement, then neither the domain expert nor the application developer will discover this until (at best) the application is first demonstrated or (much worse) an end user sounds the alarm once the application has been deployed into production.</p>
</div>
<div class="paragraph">
<p>Rather than trying to translate between a business language and a technical language, with  <em>DDD</em> we aim to have the business and developers using the same terms for the same concepts in order to create a single <strong><em>domain model</em></strong>. This domain model identifies the relevant concepts of the domain, how they relate, and ultimately where the responsibilities are. This single domain model provides the vocabulary for the  ubiquitous language for our system.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Ubiquitous Language</div>
<div class="paragraph">
<p>Build a common language between the domain experts and developers by using the concepts of the domain model as the primary means of communication. Use the terms in speech, in diagrams, in writing, and when presenting.</p>
</div>
<div class="paragraph">
<p>If an idea cannot be expressed using this set of concepts, then go back and extend the model. Look for and remove ambiguities and inconsistencies.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Creating a  ubiquitous language calls upon everyone involved in the system&#8217;s development to express what they are doing through the vocabulary provided by the model. If this can&#8217;t be done, then our model is incomplete. Finding the missing words deepens our understanding of the domain being modeled.</p>
</div>
<div class="paragraph">
<p>This might sound like nothing more than me insisting that the developers shouldn&#8217;t use jargon when talking to the business. Well, that&#8217;s true enough, but it&#8217;s not a one-way street. A  <strong>ubiquitous language</strong> demands that the developers work hard to understand the problem domain, but it also demands that the business works hard in being  <strong>precise</strong> in its naming and descriptions of those concepts. After all, ultimately the developers will have to express those concepts in a computer programming language.</p>
</div>
<div class="paragraph">
<p>Also, although here I&#8217;m talking about the "domain experts" as being a homogeneous group of people, often they may come from different branches of the business. Even if we weren&#8217;t building a computer system, there&#8217;s a lot of value in helping the domain experts standardize their own terminology. Is the marketing department&#8217;s "prospect" the same as sales' "customer," and is that the same as an after-sales "contract"?</p>
</div>
<div class="paragraph">
<p>The need for precision within the  ubiquitous language also helps us scope the system. Most business processes evolve piecemeal and are often quite ill-defined. If the domain experts have a very good idea of what the business process should be, then that&#8217;s a good candidate for automation, that is, including it in the scope of the system. But if the domain experts find it hard to agree, then it&#8217;s probably best to leave it out. After all, human beings are rather more capable of dealing with fuzzy situations than computers.</p>
</div>
<div class="paragraph">
<p>So, if the development team (business and developers together) continually searches to build their  ubiquitous language, then the domain model naturally becomes richer as the nuances of the domain are uncovered. At the same time, the knowledge of the business domain experts also deepens as edge conditions and contradictions that have previously been overlooked are explored.</p>
</div>
<div class="paragraph">
<p>We use the  ubiquitous language to build up a domain model. But what do we do  <strong>with</strong> that model? The answer to that is the second of our central ideas.</p>
</div>
</div>
<div class="sect4">
<h5 id="_model_driven_design">Model-Driven Design</h5>
<div class="paragraph">
<p>Of the various methodologies that the IT industry has tried, many advocate the production of separate analysis models and implementation models. One example (from the mid 2000s) was that of the  <em>OMG</em>'s Model-Driven Architecture ( <em>MDA</em>) initiative, with its platform-independent model (the  <em>PIM</em>) and a platform-specific model (the  <em>PSM</em>).</p>
</div>
<div class="paragraph">
<p>Bah and humbug! If we use our  ubiquitous language just to build up a high-level analysis model, then we will re-create the communication divide. The domain experts and business analysts will look only to the analysis model, and the developers will look only to the implementation model. Unless the mapping between the two is completely mechanical, inevitably the two will diverge.</p>
</div>
<div class="paragraph">
<p>What do we mean by  <strong>model</strong> anyway? For some, the term will bring to mind  <em>UML</em> class or sequence diagrams and the like. But this isn&#8217;t a model; it&#8217;s a visual  <strong>representation</strong> of some aspect of a model. No, a domain model is a group of related concepts, identifying them, naming them, and defining how they relate. What is in the model depends on what our objective is. We&#8217;re not looking to simply model everything that&#8217;s out there in the real world. Instead, we want to take a relevant abstraction or simplification of it and then make it do something useful for us.  A model is neither right nor wrong, just more or less useful.</p>
</div>
<div class="paragraph">
<p>For our  ubiquitous language to have value, the domain model that encodes it must have a straightforward, literal representation to the design of the software, specifically to the implementation. Our software&#8217;s design should be driven by this model; we should have a model-driven design.</p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Model-Driven Design</div>
<div class="paragraph">
<p>There must be a straightforward and very literal way to represent the domain model in terms of software. The model should balance these two requirements: form the  ubiquitous language of the development team and be representable in code.</p>
</div>
<div class="paragraph">
<p>Changing the code means changing the model; refining the model requires a change to the code.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Here also the word  <strong>design</strong> might mislead; some might again be thinking of design documents and design diagrams. But by  <strong>design</strong> we mean a way of organizing the domain concepts, which in turn leads to the way in which we organize their representation in code.</p>
</div>
<div class="paragraph">
<p>Luckily, using <strong><em>object-oriented</em></strong> ( <em>OO</em>) languages such as Java, this is relatively easy to do;  <em>OO</em> is based on a modeling paradigm anyway. We can express domain concepts using classes and interfaces, and we can express the relationships between those concepts using associations.</p>
</div>
<div class="paragraph">
<p>So far so good. Or maybe, so far so much motherhood and apple pie. Understanding the  <em>DDD</em> concepts isn&#8217;t the same as being able to apply them, and some of the  <em>DDD</em> ideas can be difficult to put into practice. Time to discuss the naked objects pattern and how it eases that path by applying these central ideas of <em>DDD</em> in a very concrete way.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_naked_objects_pattern">1.1.2. Naked Objects Pattern</h4>
<div class="paragraph">
<p>Apache Isis implements the naked objects pattern, originally formulated by Richard Pawson.  So who better than Richard to explain the origination of the idea?</p>
</div>
<div class="paragraph">
<p><div class="extended-quote-first"><p>The Naked Objects pattern arose, at least in part, from my own frustration at the lack of success of the domain-driven approach. Good examples were hard to find&#8212;&#8203;as they are still.
</p></div></p>
</div>
<div class="paragraph">
<p><div class="extended-quote"><p>A common complaint from <em>DDD</em> practitioners was that it was hard to gain enough commitment from business stakeholders, or even to engage them at all. My own experience suggested that it was nearly impossible to engage business managers with <em>UML</em> diagrams.  It was much easier to engage them in rapid prototyping&#8201;&#8212;&#8201;where they could see and interact with the results&#8201;&#8212;&#8201;but most forms of rapid prototyping concentrate on the presentation layer, often at the expense of the underlying model and certainly at the expense of abstract thinking.
</p></div></p>
</div>
<div class="paragraph">
<p><div class="extended-quote"><p>Even if you could engage the business sponsors sufficiently to design a domain model, by the time you&#8217;d finished developing the system on top of the domain model, most of its benefits had disappeared. It&#8217;s all very well creating an agile domain object model, but if any change to that model also dictates the modification of one or more layers underneath it (dealing with persistence) and multiple layers on top (dealing with presentation), then that agility is practically worthless.
</p></div></p>
</div>
<div class="paragraph">
<p><div class="extended-quote"><p>The other concern that gave rise to the birth of Naked Objects was how to make user interfaces of mainstream business systems more "expressive"&#8201;&#8212;&#8201;how to make them feel more like using a drawing program or <em>CAD</em> system. Most business systems are not at all expressive; they treat the user merely as a dumb <strong>process-follower</strong>, rather than as an empowered <strong>problem-solver</strong>.  Even the so-called usability experts had little to say on the subject: try finding the word "empowerment" or any synonym thereof in the index of any book on usability. Research had demonstrated that the best way to achieve expressiveness was to create an object-oriented user interface (<em>OOUI</em>). In practice, though, <em>OOUI</em>s were notoriously hard to develop.
</p></div></p>
</div>
<div class="paragraph">
<p><div class="extended-quote"><p>Sometime in the late 1990s, it dawned on me that if the domain model really did represent the "ubiquitous language" of the business and those domain objects were behaviorally rich (that is, business logic is encapsulated as methods on the domain objects rather than in procedural scripts on top of them), then the <em>UI</em> could be nothing more than a reflection of the user interface. This would solve both of my concerns. It would make it easier to do domain-driven design, because one could instantly translate evolving domain modeling ideas into a working prototype. And it would deliver an expressive, object-oriented user interface for free. Thus was born the idea of Naked Objects.
</p></div></p>
</div>
<div class="paragraph">
<p><div class="extended-quote-attribution"><p>-- Richard Pawson
</p></div></p>
</div>
<div class="paragraph">
<p>You can learn much more about the pattern in the book, <a href="http://www.amazon.com/exec/obidos/ISBN=0470844205/">Naked Objects</a>, also freely available to <a href="http://www.nakedobjects.org/book/">read online</a>.  Richard co-wrote the book with one of Isis' committers, Robert Matthews, who was in turn the author of the Naked Objects Framework for Java (the original codebase of of Apache Isis).</p>
</div>
<div class="paragraph">
<p>You might also want to read Richard&#8217;s <a href="core-concepts/Pawson-Naked-Objects-thesis.pdf">PhD on the subject</a>.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>One of the external examiners for Richard&#8217;s PhD was <a href="http://en.wikipedia.org/wiki/Trygve_Reenskaug">Trygve Reenskaug</a>, who originally formulated the MVC pattern at Xeroc PARC.  In his paper, <a href="http://heim.ifi.uio.no/~trygver/2007/2007.02.13-babyUML.pdf">Baby UML</a>, Reenskaug describes that when implemented the first MVC, "the conventional wisdom in the group was that objects should be visible and tangible, thus bridging the gap between the human brain and the abstract data within the computer."  Sound familiar?  It&#8217;s interesting to speculate what might have been if this idea had been implemented back then in the late 70s.</p>
</div>
<div class="paragraph">
<p>Reenskaug then goes on to say that "this simple and powerful idea failed because &#8230;&#8203; users were used to seeing [objects] from different perspectives. The visible and tangible object would get very complex if it should be able to show itself and be manipulated in many different ways."</p>
</div>
<div class="paragraph">
<p>In Apache Isis the responsibility of rendering an object is not the object itself, it is the framework.  Rather, the object inspects the object and uses that to decide how to render the object.  This is also extensible.  In the <a href="http://isisaddons.org">Isis Addons</a> (non-ASF) the <a href="http://github.com/isisaddons/isis-wicket-gmap3}">Isis addons' gmap3 modue</a> renders any object with latitude/longitude on a map, while <a href="http://github.com/isisaddons/isis-wicket-fullcalendar2}">Isis addons' fullcalendar2 wicket extension</a> renders any object with date(s) on a calendar.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect5">
<h6 id="_object_interface_mapping">Object Interface Mapping</h6>
<div class="paragraph">
<p>Another&#8201;&#8212;&#8201;more technical&#8201;&#8212;&#8201;way to think about the naked objects pattern is as an <em>object interface mapper</em>, or <code>OIM</code>.  We sometimes use this idea to explain naked objects to a bunch of developers.</p>
</div>
<div class="paragraph">
<p>Just as an ORM (such as <a href="http://datanucleus.org">DataNucleus</a> or <a href="http:hibernate.org">Hibernate</a>) maps domain entities to a database, you can think of the naked objects pattern as representing the concept of mapping domain objects to a user interface.</p>
</div>
<div class="paragraph">
<p>This is the way that the <a href="http://metawidget.org/">MetaWidget</a> team, in particular Richard Kennard, the primary contributor, likes to describe their tool.  MetaWidget has a number of ideas in common with Apache Isis, specifically the runtime generation of a UI for domain objects.  You can hear more from Kennard and others on this <a href="http://devchat.tv/js-jabber/150-jsj-oims">Javascript Jabber podcast</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>We compare Apache Isis' with MetaWidget <a href="#_vs_metawidget">here</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_hexagonal_architecture">1.1.3. Hexagonal Architecture</h4>
<div class="paragraph">
<p>One of the patterns that Evans discusses in his book is that of a <strong>layered architecture</strong>.  In it he describes why the domain model lives in its own layer within the architecture. The other layers of the application (usually presentation, application, and persistence) have their own responsibilities, and are completely separate.  Each layer is cohesive and depending only on the layers below.  In particular, we have a layer dedicated to the domain model. The code in this layer is unencumbered with the (mostly technical) responsibilities of the other layers and so can evolve to tackle complex domains as well as simple ones.</p>
</div>
<div class="paragraph">
<p>This is a well-established pattern, almost a de-facto; there&#8217;s very little debate that these responsibilities should be kept separate from each other.  With Apache Isis the responsibility for presentation is a framework concern, the responsibility for the domain logic is implemented by the (your) application code.</p>
</div>
<div class="paragraph">
<p>A few years ago Alistair Cockburn reworked the traditional layered architecture diagram and came up with the <strong><em>hexagonal architecture</em></strong>:.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The hexagonal architecture is also known as the <a href="http://c2.com/cgi/wiki?PortsAndAdaptersArchitecture:">Ports and Adapters</a> architecture or (less frequently) as the <a href="http://jeffreypalermo.com/blog/the-onion-architecture-part-1/">Onion</a> architecture.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/core-concepts/philosophy/hexagonal-architecture.png" alt="hexagonal architecture" width="700px">
</div>
<div class="title">Figure 1. The hexagonal architecture emphasizes multiple implementations of the different layers.</div>
</div>
<div class="paragraph">
<p>What Cockburn is emphasizing is that there&#8217;s usually more than one way <strong>into</strong> an application (what he called the <strong><em>user-side' ports</em></strong>) and more than one way  <strong>out of</strong> an application too (the <strong><em>data-side ports</em></strong>). This is very similar to the concept of primary and secondary actors in use cases: a primary actor (often a human user but not always) is active and initiates an interaction, while a secondary actor (almost always an external system) is passive and waits to be interacted with.</p>
</div>
<div class="paragraph">
<p>Associated with each port can be an <strong><em>adapter</em></strong> (in fact, Cockburn&#8217;s alternative name for this architecture is <strong><em>ports and adapters</em></strong>). An adapter is a device (piece of software) that talks in the protocol (or  <em>API</em>) of the port. Each port could have several adapters.</p>
</div>
<div class="paragraph">
<p>Apache Isis maps very nicely onto the  <strong>hexagonal architecture</strong>.  Isis' viewers act as user-side adapters and use the Isis metamodel API as a port into the domain objects.   For the data side, we are mostly concerned with persisting domain objects to some sort of object store.  Here Apache Isis delegates most of the heavy lifting to ORM implementing the JDO API.  Most of the time this will be DataNucleus configured to persist to an RDBMS, but DataNucleus can also support other object stores, for example Neo4J.  Alternatively Isis can be configured to persist using some other JDO implementation, for example Google App Engine.</p>
</div>
</div>
<div class="sect3">
<h4 id="_aspect_oriented">1.1.4. Aspect Oriented</h4>
<div class="paragraph">
<p>Although not a book about object modelling, Evans' "Domain Driven Design" does use object orientation as its primary modelling tool; and many tend to think of <a href="#_domain_driven_design">DDD</a> as an updated treatise on good object modelling, in the same vein as Rebecca Wirf Brock&#8217;s Responsibility Driven Design, say.  Meanwhile the <a href="#_naked_objects_pattern">naked objects pattern</a> very much comes from an OO background (it even has 'object' in its name); and Richard Pawson lists Alan Kay as one of his idols.</p>
</div>
<div class="paragraph">
<p>It&#8217;s certainly true that to develop an Apache Isis application you will need to have good object oriented modelling skills.  Given that all the mainstream languages for developing business systems are object oriented (Java, C#, Ruby), that&#8217;s not such a stretch.</p>
</div>
<div class="paragraph">
<p>However, what you&#8217;ll also find as you write your applications is that in some ways an Isis application is more aspect-oriented than it is object oriented.  Given that aspect-orientation&#8201;&#8212;&#8201;as a programming paradigm at least&#8201;&#8212;&#8201;hasn&#8217;t caught on, that statement probably needs unpacking a little.</p>
</div>
<div class="paragraph">
<p>Aspect-orientation, then, is a different way of decomposing your application, by treating <em>cross-cutting concerns</em> as a first-class citizen.  The canonical (also rather boring) example of a cross-cutting concern is that of logging (or tracing) all method calls.  An aspect can be written that will weave in some code (a logging statement) at specified points in the code).</p>
</div>
<div class="paragraph">
<p>This idea sounds rather abstract, but what it really amounts to is the idea of interceptors.  When one method calls another the AOP code is called in first.  This is actually then one bit of AOP that is quite mainstream; DI containers such as Spring provide aspect orientation in supporting annotations such as <code>@Transactional</code> or <code>@Secured</code> to java beans.</p>
</div>
<div class="paragraph">
<p>Another aspect (ahem!) of aspect-oriented programming has found its way into other programming languages, that of a mix-in or trait.  In languages such as Scala these mix-ins are specified statically as part of the inheritance hierarchy, whereas with AOP the binding of a trait to some other class/type is done without the class "knowing" that additional behaviour is being mixed-in to it.</p>
</div>
<div class="paragraph">
<p>What has all this to do with Apache Isis, then?</p>
</div>
<div class="paragraph">
<p>Well, a different way to think of the naked objects pattern is that the visualization of a domain object within a UI is a cross-cutting concern.  By following certain very standard programming conventions that represent the <em>Apache Isis Programming Model</em> (POJOs plus annotations), the framework is able to build a metamodel and from this can render your domain objects in a standard generic fashion.  That&#8217;s a rather more interesting cross-cutting concern than boring old logging!</p>
</div>
<div class="paragraph">
<p>Isis also draws heavily on the AOP concept of interceptors.  Whenever an object is rendered in the UI, it is filtered with respect to the user&#8217;s permissions.  That is, if a user is not authorized to either view or perhaps modify an object, then this is applied transparently by the framework.  The <a href="http://github.com/isisaddons/isis-module-security}">Isis addons' security</a> module, mentioned previously, provides a rich user/role/permissions subdomain to use out of the box; but you can integrate with a different security mechanism if you have one already.</p>
</div>
<div class="paragraph">
<p>Another example of interceptors are the <a href="http://github.com/isisaddons/isis-module-command}">Isis addons' command</a> and <a href="http://github.com/isisaddons/isis-module-audit}">Isis addons' audit</a> modules.  The command module captures every user interaction that modifies the state of the system (the "cause" of a change) while the audit module captures every change to every object (the "effect" of a change).  Again, this is all transparent to the user.</p>
</div>
<div class="paragraph">
<p>Apache Isis also has an internal event bus (you can switch between an underlying implementation of Gauva or Axon).  A domain event is fired whenever an object is interacted with, and this allows any subscribers to influence the operation (or even veto it).  This is a key mechanism in ensuring that Isis applications are maintainable, and we discuss it in depth in the <a href="#_decoupling">Decoupling</a> chapter.  But fundamentally its relying on this AOP concept of interceptors.</p>
</div>
<div class="paragraph">
<p>Finally, Isis also a feature that is akin to AOP mix-ins.  A "contributed action" is one that is implemented on a domain service but that appears to be a behaviour of rendered domain object.  In other words, we can dissociate behaviour from data.  That&#8217;s not always the right thing to do of course; in Richard&#8217;s description of the <a href="#_naked_objects_pattern">naked objects pattern</a> he talks about "behaviourally rich" objects, in other words where the business functionality encapsulated the data: OO as your mother taught you!  But equally sometimes the behaviour and data structures change at different rates; the single responsibility pattern says we should only lump code together that changes at the same rate.  Isis' support for contributions (not only contributed actions, but also contributed properties and contributed collections) enables this.  And again, to loop back to the topic of this section, it&#8217;s an AOP concept that being implemented by the framework.</p>
</div>
<div class="paragraph">
<p>The nice thing about aspect orientation is that for the most part you can ignore these cross-cutting concerns and - at least initially at least - just focus on implementing your domain object.  Later when your app starts to grow and you start to break it out into smaller modules, you can leverage Isis' AOP support for mixins (contributions) see interceptors (the event bus) to ensure that your codebase remains maintainable.</p>
</div>
</div>
<div class="sect3">
<h4 id="_how_apache_isis_eases_ddd">1.1.5. How Apache Isis eases DDD</h4>
<div class="paragraph">
<p>The case for  <em>DDD</em> might be compelling, but that doesn&#8217;t necessarily make it easy to do. Let&#8217;s take a look at some of the
challenges that  <em>DDD</em> throws up and see how Apache Isis (and its implementation of the naked objects pattern) helps address them.</p>
</div>
<div class="sect4">
<h5 id="_ddd_takes_a_conscious_effort">DDD takes a conscious effort</h5>
<div class="paragraph">
<p>Here&#8217;s what Eric Evans says about ubiquitous language:</p>
</div>
<div class="paragraph">
<p><div class="extended-quote-first"><p>With a conscious effort by the [development] team the domain model can provide the backbone for [the] common [ubiquitous] language&#8230;&#8203;connecting team communication to the software implementation."
</p></div></p>
</div>
<div class="paragraph">
<p><div class="extended-quote-attribution"><p>-- Eric Evans
</p></div></p>
</div>
<div class="paragraph">
<p>The word to pick up on here is <strong>conscious</strong>.  It takes a conscious effort by the entire team to develop the ubiquitous language. Everyone in the team must challenge the use of new or unfamiliar terms, must clarify concepts when used in a new context, and in general must be on the lookout for sloppy thinking. This takes willingness on the part of all involved, not to mention some practice.</p>
</div>
<div class="paragraph">
<p>With Apache Isis, though, the  ubiquitous language evolves with scarcely any effort at all. For the business experts, the Isis viewers show the domain concepts they identify and the relationships between those concepts in a straightforward fashion. Meanwhile, the developers can devote themselves to encoding those domain concepts directly as domain classes. There&#8217;s no technology to get distracted by; there is literally nothing else for the developers to work on.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ddd_must_be_grounded">DDD must be grounded</h5>
<div class="paragraph">
<p>Employing a  model-driven design isn&#8217;t necessarily straightforward, and the development processes used by some organizations positively hinder it. It&#8217;s not sufficient for the business analysts or architects to come up with some idealized representation of the business domain and then chuck it over the wall for the programmers to do their best with.</p>
</div>
<div class="paragraph">
<p>Instead, the concepts in the model must have a very literal representation in code. If we fail to do this, then we open up the communication divide, and our  ubiquitous language is lost. There is literally no point having a domain model that cannot be represented in code. We cannot invent our ubiquitous language in a vacuum, and the developers must ensure that the model remains grounded in the doable.</p>
</div>
<div class="paragraph">
<p>In Apache Isis, we have a very pure one-to-one correspondence between the domain concepts and its implementation. Domain concepts are represented as classes and interfaces, easily demonstrated back to the business. If the model is clumsy, then the application will be clumsy too, and so the team can work together to find a better implementable model.</p>
</div>
</div>
<div class="sect4">
<h5 id="_abstract_models_are_difficult_to_represent">Abstract models are difficult to represent</h5>
<div class="paragraph">
<p>If we are using code as the primary means of expressing the model, then we need to find a way to make this model understandable to the business.</p>
</div>
<div class="paragraph">
<p>We could generate  <em>UML</em> diagrams and the like from code. That will work for some members of the business community, but not for everyone. Or we could generate a  <em>PDF</em> document from Javadoc comments, but comments aren&#8217;t code and so the document may be inaccurate.  Anyway, even if we do create such a document, not everyone will read it.</p>
</div>
<div class="paragraph">
<p>A better way to represent the model is to show it in action as a working prototype. As we show in the <a href="#_getting_started">Getting Started</a> section, Apache Isis enables this with ease. Such prototypes bring the domain model to life, engaging the audience in a way that a piece of paper never can.</p>
</div>
<div class="paragraph">
<p>Moreover, with Apache Isis prototypes, the domain model will come shining through. If there are mistakes or misunderstandings in the domain model (inevitable when building any complex system), they will be obvious to all.</p>
</div>
</div>
<div class="sect4">
<h5 id="_layered_architectures_are_easily_compromised">Layered architectures are easily compromised</h5>
<div class="paragraph">
<p><em>DDD</em> rightly requires that the domain model lives in its own layer within the architecture. The other layers of the application (usually presentation, application, and persistence) have their own responsibilities, and are completely separate.</p>
</div>
<div class="paragraph">
<p>However, there are two immediate issues. The first is rather obvious: custom coding each of those other layers is an expensive proposition. Picking up on the previous point, this in itself can put the kibosh on using prototyping to represent the model, even if we wanted to do so.</p>
</div>
<div class="paragraph">
<p>The second issue is more subtle. It takes real skill to ensure the correct separation of concerns between these layers, if indeed you can get an agreement as to what those concerns actually are. Even with the best intentions, it&#8217;s all too easy for custom-written layers to blur the boundaries and put (for example) validation in the user interface layer when it should belong to the domain layer. At the other extreme, it&#8217;s quite possible for custom layers to distort or completely subvert the underlying domain model.</p>
</div>
<div class="paragraph">
<p>Because of Apache Isis' generic  <em>OOUI</em>s, there&#8217;s no need to write the other layers of the architecture.  Of course, this reduces the development cost. But more than that, there will be no leakage of concerns outside the domain model. All the validation logic <strong>must</strong> be in the domain model because there is nowhere else to put it.</p>
</div>
<div class="paragraph">
<p>Moreover, although Apache Isis does provide a complete runtime framework, there is no direct coupling of your domain model to the framework. That means it is very possible to take your domain model prototyped in Naked Objects and then deploy it on some other  <em>J(2)EE</em> architecture, with a custom <em>UI</em> if you want.  Isis guarantees that your domain model is complete.</p>
</div>
</div>
<div class="sect4">
<h5 id="_extending_the_reach_of_ddd">Extending the reach of DDD</h5>
<div class="paragraph">
<p>Domain-driven design is often positioned as  being applicable only to complex domains; indeed, the subtitle of Evans book is  "Tackling Complexity in the Heart of Software". The corollary is that DDD is overkill for simpler domains. The trouble is that we immediately have to make a choice: is the domain complex enough to warrant a domain-driven approach?</p>
</div>
<div class="paragraph">
<p>This goes back to the previous point, building and maintaining a layered architecture. It doesn&#8217;t seem cost effective to go to all the effort of a DDD approach if the underlying domain is simple.</p>
</div>
<div class="paragraph">
<p>However, with Apache Isis, we don&#8217;t write these other layers, so we don&#8217;t have to make a call on how complex our domain is. We can start working solely on our domain, even if we suspect it will be simple. If it is indeed a simple domain, then there&#8217;s no hardship, but if unexpected subtleties arise, then we&#8217;re in a good position to handle them.</p>
</div>
<div class="paragraph">
<p>If you&#8217;re just starting out writing domain-driven applications, then Apache Isis should significantly ease your journey into applying <em>DDD</em>. On the other hand, if you&#8217;ve used <em>DDD</em> for a while, then you should find Isis a very useful new tool in your arsenal.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_principles_and_values">1.2. Principles and Values</h3>
<div class="paragraph">
<p>This section describes some of the core principles and values that the framework aims to honour and support.</p>
</div>
<div class="paragraph">
<p>The first of these relate to how we believe your domain application should be written: it should be decoupled, testable and so on).  Others relate to the implementation of the framework itself.</p>
</div>
<div class="paragraph">
<p>The section concludes by contrasting the framework with some other open source frameworks commonly used.</p>
</div>
<div class="sect3">
<h4 id="_your_applications">1.2.1. Your Applications</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_decoupled">Decoupled</h5>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO &#8230;&#8203;
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Long-term Cost of ownership</p>
</div>
<div class="paragraph">
<p>Using:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>dependency injection of services</p>
</li>
<li>
<p>OO design techniques, eg dependency inversion principle</p>
</li>
<li>
<p>an in-memory event bus</p>
</li>
<li>
<p>applib</p>
</li>
<li>
<p>(no "Big Ball of Mud")</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_honouring_the_single_responsibility_principle">Honouring the Single Responsibility Principle</h5>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p>behaviourally Complete vs Contributions</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="_testable">Testable</h5>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>While Apache Isis can be used (very effectively) for simple CRUD-style applications, it is also intended to be used for complex business domains.  Ensuring that the business logic in such applications is correct means that the framework must (and does) provide robust testing support, both for developer-level unit testing and business-level (end-to-end) integration testing.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_isis_itself">1.2.2. Isis itself</h4>
<div class="paragraph">
<p>This section discusses some of the principles and values we apply to the development of the Apache Isis framework itself.</p>
</div>
<div class="sect4">
<h5 id="_full_stack_but_extensible">Full-stack but Extensible</h5>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_focuses_on_its_usp">Focuses on its USP</h5>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>add-ons</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Isis is at heart a metamodel with runtime, and coordinates interations using an AOP set of principles</p>
</li>
<li>
<p>Apache Isis vs Isis Addons</p>
</li>
<li>
<p>Apache Isis vs Shiro vs DataNucleus</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>all code has legacy in it&#8230;&#8203;. parts of the Isis codebase are well over a decade old; and back then a lot of the JEE technologies that we&#8217;d like to be using just didn&#8217;t exist, so we had to invent the features we required ourselves.</p>
</li>
<li>
<p>also, Apache Isis today is more pragmatic than previously</p>
</li>
</ol>
</div>
</li>
<li>
<p>a client/server solution, with AWT-based client</p>
</li>
<li>
<p>a HTML browser, Scimpi (JSF-like, but not using JSF), &#8230;&#8203;</p>
</li>
<li>
<p>security</p>
</li>
<li>
<p>objectstores</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We&#8217;re working hard to remove duplication, reuse existing open source/JEE, and simplify.</p>
</div>
<div class="paragraph">
<p>The areas of Isis we consider mature are those that have been developed in support of real-world applications implemented by the committers.  Foremost among these is Estatio.</p>
</div>
<div class="paragraph">
<p>Focus on enterprise / line-of-business applications, for use by internal staff.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>problem solvers, not process followers</p>
</li>
<li>
<p>view models</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_apache_isis_vs">1.2.3. Apache Isis vs &#8230;&#8203;</h4>
<div class="paragraph">
<p>Many other frameworks promise rapid application development and provide automatically generated user interfaces, so how
do they compare to Apache Isis?</p>
</div>
<div class="sect4">
<h5 id="_vs_mvc_server_side_frameworks">vs MVC server-side frameworks</h5>
<div class="paragraph">
<p>Some of most commonly used frameworks today are <a href="http://www.springframework.org/">Spring MVC</a>, <a href="http://rubyonrails.org/">Ruby on Rails</a> and <a href="http://www.grails.org">Grails</a>, all of which implement one flavour or another of the server-side MVC pattern.  The MVC 1.0 specification (scheduled for JavaEE 8) is also similar.</p>
</div>
<div class="paragraph">
<p>These frameworks all use the classic  <strong>model-view-controller</strong> ( <em>MVC</em>) pattern for web applications, with scaffolding, code-generation, and/or metaprogramming tools for the controllers and views, as well as convention over configuration to define how these components interact.  The views provided out of the box by these frameworks tend to be simple  <em>CRUD</em>-style interfaces. More sophisticated behavior is accomplished by customizing the generated controllers.</p>
</div>
<div class="paragraph">
<p>The most obvious difference when developing an Apache Isis application is its deliberate lack of an explicit controller layer; non- <em>CRUD</em> behavior is automatically made available in its generic object-oriented  _UI_s.  More sophisticated UIs can be built either by <a href="#_extending_the_viewer">extending Isis' Wicket viewer</a> or by writing a bespoke UI leveraging the REST (hypermedia) API automatically exposed by <a href="#_restful_objects_viewer">Isis' Restful Objects viewer</a>.  Other frameworks can also be used to implement REST APIs, of course, but generally they require a significant amount of development to get anywhere near the level of sophistication provided automatically by Isis' REST API.</p>
</div>
<div class="paragraph">
<p>Although these frameworks all provide their own ecosystems of extensions, Isis' equivalent <a href="http://isisaddons.org">Isis Addons</a> (non-ASF) tend to work at a higher-level of abstraction.  For example, each of these frameworks will integrate with various security mechanism, but the <a href="http://github.com/isisaddons/isis-module-security}">Isis addons' security module</a> provides a full subdomain of users, roles, features and permissions that can be plugged into any Isis application.  Similarly, the <a href="http://github.com/isisaddons/isis-module-command}">Isis addons' command</a> and <a href="http://github.com/isisaddons/isis-module-audit}">Isis addons' audit</a> modules in combination provide a support for auditing and traceability that can also be used for out of the box profiling.  Again, these addons can be plugged into any Isis app.</p>
</div>
<div class="paragraph">
<p>In terms of testing support, each of these other frameworks provide mechanisms to allow the webapp to be tested from within a JUnit test harness. Isis' support is similar.  Where Isis differs though is that it enables end-to-end testing without the need for slow and fragile Selenium tests. Instead, Isis provides a "<a href="#_using_the_wrapper_factory">WrapperFactory</a>" domain service that allows the generic UI provided to in essence be simulated. On a more pragmatic level, the <a href="http://github.com/isisaddons/isis-module-fakedata}">Isis addons' fakedata</a> module does "what it says on the tin", allowing both unit- and integration-tests to focus on the salient data and fake out the rest.</p>
</div>
</div>
<div class="sect4">
<h5 id="_vs_angular">vs Angular</h5>

</div>
<div class="sect4">
<h5 id="_vs_metawidget">vs MetaWidget</h5>
<div class="paragraph">
<p>MetaWidget (mentioned <a href="#_object_interface_mapping">earlier</a> has a number of ideas in common with Apache Isis, specifically the runtime generation of a UI for domain objects.  And like Apache Isis, MetaWidget builds its own metamodel of the domain objects and uses this to render the object.</p>
</div>
<div class="paragraph">
<p>However, there is a difference in philosophy in that MW is not a full-stack framework and does not (in their words) try to "own the UI".  Rather they support a huge variety of UI technologies and allow the domain object to be rendered in any of them.</p>
</div>
<div class="paragraph">
<p>In contrast, Apache Isis is full-stack and does generate a complete UI; we then allow you to customize or extend this UI (as per the various <a href="http://isisaddons.org">Isis Addons</a> (non-ASF), and we also provide a full <a href="#_restful_objects_viewer">Restful API</a></p>
</div>
<div class="paragraph">
<p>Also, it&#8217;s worth noting that MetaWidget does have an elegant pipeline architecture, with APIs to allow even its metamodel to be replaced.  It would be feasible and probably quite straightforward to use Isis' own metamodel as an implementation of the MetaWidget API.  This would allow MetaWidget to be able to render an Isis domain application.</p>
</div>
</div>
<div class="sect4">
<h5 id="_vs_openxava">vs OpenXava</h5>

</div>
</div>
</div>
<div class="sect2">
<h3 id="_building_blocks">1.3. Building Blocks</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_a_metamodel_with_explicit_and_inferred_semantics">1.3.1. A MetaModel with Explicit and Inferred Semantics</h4>
<div class="ulist">
<ul>
<li>
<p>use of annotations</p>
<div class="ulist">
<ul>
<li>
<p>reuse JEE annotations where possible</p>
</li>
</ul>
</div>
</li>
<li>
<p>layout hints are overridable, to avoid restarting the app/speed up feedback</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_domain_objects_and_domain_services">1.3.2. Domain Objects and Domain Services</h4>
<div class="ulist">
<ul>
<li>
<p>domain model</p>
<div class="ulist">
<ul>
<li>
<p>domain objects</p>
<div class="ulist">
<ul>
<li>
<p>domain entity</p>
</li>
<li>
<p>view model</p>
</li>
</ul>
</div>
</li>
<li>
<p>domain service</p>
</li>
<li>
<p>value type</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Anything else can be (should be) ignored by annotating with <code>@Programmatic</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_properties_collections_and_actions">1.3.3. Properties, Collections and Actions</h4>

</div>
<div class="sect3">
<h4 id="_domain_entities_vs_view_models">1.3.4. Domain Entities vs View Models</h4>
<div class="paragraph">
<p><code>@DomainObject(nature=&#8230;&#8203;)</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_domain_services">1.3.5. Domain Services</h4>
<div class="paragraph">
<p>Domain services consist of a set of logically grouped actions, and as such follow the same conventions as for entities. However, a service cannot have (persisted) properties, nor can it have (persisted) collections.</p>
</div>
<div class="paragraph">
<p>Domain services are instantiated once and once only by the framework, and are used to centralize any domain logic that does not logically belong in a domain entity or value. Isis will automatically inject services into every domain entity that requests them, and into each other.</p>
</div>
<div class="paragraph">
<p>For convenience you can inherit from AbstractService or one of its subclasses, but this is not mandatory.</p>
</div>
<div class="sect4">
<h5 id="_domain_services_vs_view_services">Domain Services vs View Services</h5>
<div class="paragraph">
<p><code>@DomainService(nature=&#8230;&#8203;)</code></p>
</div>
<div class="sidebarblock">
<div class="content">
<div class="title">Factories, Repositories and Services</div>
<div class="paragraph">
<p>A distinction is sometimes made between a factory (that creates object) and a repository (that is used to find existing objects).  You will find them discussed separately in Evans' link:Domain Driven Design[<a href="http://books.google.com/books/about/Domain_Driven_Design.html?id=hHBf4YxMnWMC" class="bare">http://books.google.com/books/about/Domain_Driven_Design.html?id=hHBf4YxMnWMC</a>], for example.</p>
</div>
<div class="paragraph">
<p>In Apache Isis these are all implemented as domain services.  Indeed, it is quite common to have a domain service that acts as both a factory and a repository.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_value_objects_primitives">1.3.6. Value Objects (Primitives)</h4>

</div>
<div class="sect3">
<h4 id="_contributions">1.3.7. Contributions</h4>

</div>
<div class="sect3">
<h4 id="_event_bus">1.3.8. Event Bus</h4>
<div class="sect4">
<h5 id="_registering_domain_services">Registering domain services</h5>
<div class="paragraph">
<p>As noted <a href="../../how-tos/how-to-09-010-How-to-register-domain-services,-repositories-and-factories.html">elsewhere</a>, domain services (which includes repositories and factories) should be registered in the <code>isis.properties</code> configuration file, under <code>isis.services</code> key (a comma-separated list):</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>isis.services = com.mycompany.myapp.employee.Employees\,
                com.mycompany.myapp.claim.Claims\,
                ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will then result in the framework instantiating a single instance of each of the services listed.</p>
</div>
<div class="paragraph">
<p>If all services reside under a common package, then the <code>isis.services.prefix</code> can specify this prefix:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>isis.services.prefix = com.mycompany.myapp
isis.services = employee.Employees,\
                claim.Claims,\
                ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is quite rare, however; you will often want to use default implementations of domain services that are provided by the framework and so will not reside under this prefix.</p>
</div>
<div class="paragraph">
<p>Examples of framework-provided services (as defined in the applib) can be found referenced from the main <a href="../../documentation.html">documentation</a> page. They include clock, auditing, publishing, exception handling, view model support, snapshots/mementos, and user/application settings management.</p>
</div>
</div>
<div class="sect4">
<h5 id="_service_scopes">Service scopes</h5>
<div class="paragraph">
<p>By default all domain services are considered to be singletons, and thread-safe.</p>
</div>
<div class="paragraph">
<p>Sometimes though a service&#8217;s lifetime is applicable only to a single request; in other words it is request-scoped.</p>
</div>
<div class="paragraph">
<p>The CDI annotation <code>@javax.enterprise.context.RequestScoped</code> is used to indicate this fact:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code> @javax.enterprise.context.RequestScoped
 public class MyService extends AbstractService {
     ...
 }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The framework provides a number of request-scoped services; these can be found referenced from the main <a href="../../documentation.html">documentation</a> page. They include scratchpad service, query results caching, and support for co-ordinating bulk actions.</p>
</div>
</div>
<div class="sect4">
<h5 id="__suppressing_contributed_actions">(Suppressing) contributed actions</h5>
<div class="paragraph">
<p>Any n-parameter action provided by a service will automatically be contributed to the list of actions for each of its (entity) parameters. From the viewpoint of the entity the action is called a contributed action.</p>
</div>
<div class="paragraph">
<p>For example, given a service:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>public interface Library {
    public Loan borrow(Loanable l, Borrower b);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>and the entities:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>public class Book implements Loanable { ... }y</code></pre>
</div>
</div>
<div class="paragraph">
<p>and</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>public class LibraryMember implements Borrower { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>then the <code>borrow(&#8230;&#8203;)</code> action will be contributed to both <code>Book</code> and to <code>LibraryMember</code>.</p>
</div>
<div class="paragraph">
<p>This is an important capability because it helps to decouple the concrete classes from the services.</p>
</div>
<div class="paragraph">
<p>If necessary, though, this behaviour can be suppressed by annotating the service action with <code>@org.apache.isis.applib.annotations.NotContributed</code>.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>public interface Library {
    @NotContributed
    public Loan borrow(Loanable l, Borrower b);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If annotated at the interface level, then the annotation will be inherited by every concrete class. Alternatively the annotation can be applied at the implementation class level and only apply to that particular implementation.</p>
</div>
<div class="paragraph">
<p>Note that an action annotated as being <code>@NotContributed</code> will still appear in the service menu for the service. If an action should neither be contributed nor appear in service menu items, then simply annotate it as <code>@Hidden</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="__suppressing_service_menu_items">(Suppressing) service menu items</h5>
<div class="paragraph">
<p>By default every action of a service (by which we also mean repositories and factories) will be rendered in the viewer, eg as a menu item for that service menu. This behaviour can be suppressed by annotating the action using <code>@org.apache.isis.applib.annotations.NotInServiceMenu</code>.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>public interface Library {
    @NotInServiceMenu
    public Loan borrow(Loanable l, Borrower b);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that an action annotated as being <code>@NotInServiceMenu</code> will still be contributed. If an action should neither be contributed nor appear in service menu items, then simply annotate it as <code>@Hidden</code>.</p>
</div>
<div class="paragraph">
<p>Alternatively, this can be performed using a supporting method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>public class LibraryImpl implements Library {
    public Loan borrow(Loanable l, Borrower b) { ... }
    public boolean notInServiceMenuBorrow() { ... }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="__suppressing_service_menus">(Suppressing) service menus</h5>
<div class="paragraph">
<p>If none of the service menu items should appear, then the service itself should be annotated as <code>@Hidden</code>.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>@Hidden
public interface EmailService {
    public void sendEmail(String to, String from, String subject, String body);
    public void forwardEmail(String to, String from, String subject, String body);
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_initializing_services">Initializing Services</h5>
<div class="paragraph">
<p>Services can optionally declare lifecycle callbacks to initialize them (when the app is deployed) and to shut them down (when the app is undeployed).</p>
</div>
<div class="paragraph">
<p>An Isis session <em>is</em> available when initialization occurs (so services can interact with the object store, for example).</p>
</div>
<div class="sect5">
<h6 id="_initialization">Initialization</h6>
<div class="paragraph">
<p>The framework will call any <code>public</code> method annotated with <code>@javax.annotation.PostConstruct</code> and with either no arguments of an argument of type <code>Map&lt;String,String&gt;</code>:</p>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="paragraph">
<p>In the latter case, the framework passes in the configuration (<code>isis.properties</code> and any other component-specific configuration files).</p>
</div>
</div>
<div class="sect5">
<h6 id="_shutdown">Shutdown</h6>
<div class="paragraph">
<p>Shutdown is similar; the framework will call any method annotated with <code>@javax.annotation.PreDestroy</code>:</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_the_getid_method">The getId() method</h5>
<div class="paragraph">
<p>Optionally, a service may provide a <code>getId()</code> method:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>public String getId()</code></pre>
</div>
</div>
<div class="paragraph">
<p>This method returns a logical identifier for a service, independent of its implementation. Currently it used only by perspectives, providing a label by which to record the services that are available for a current user&#8217;s profile. &lt;!--See ? for more about profiles and perspectives.-&#8594;</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_framework_provided_services">1.4. Framework-provided Services</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_api_vs_spi">1.4.1. API vs SPI</h4>
<div class="paragraph">
<p>Most framework domain services are API: they exist to provide support functionality to the application&#8217;s domain objects and services.  In this case an implementation of the service will be available, either by Apache Isis itself or by Isis Addons (non ASF).</p>
</div>
<div class="paragraph">
<p>Some framework domain services are SPI: they exist primarily so that the application can influence the framework&#8217;s behaviour.  In these cases there is (usually) no default implementation; it is up to the application to provide an implementation.</p>
</div>
</div>
<div class="sect3">
<h4 id="_autoregistration_of_domain_services">1.4.2. Autoregistration of Domain services</h4>
<div class="paragraph">
<p>Where a domain service has an implementation, it is (almost always) automatically registered just by virtue of being on the <code>CLASSPATH</code>.</p>
</div>
<div class="paragraph">
<p>The one exception is <a href="#ExceptionRecognizer">[ExceptionRecognizer]</a>.</p>
</div>
<div class="paragraph">
<p>It is possible to replacing automatically-registered domain services.</p>
</div>
</div>
<div class="sect3">
<h4 id="_overview_of_domain_services">1.4.3. Overview of Domain Services</h4>
<div class="paragraph">
<p>Unless indicated as SPI, each of the following has an implementation in Isis core.</p>
</div>
<div class="paragraph">
<p>A full list of services (including those with implementations in <a href="http://isisaddons.org">Isis Addons</a> (non-ASF)) can be found in the <a href="#_domain_services_2">Domain Services</a> section.</p>
</div>
<div class="sect4">
<h5 id="__code_domainobjectcontainer_code"><code>DomainObjectContainer</code></h5>

</div>
<div class="sect4">
<h5 id="__code_clockservice_code"><code>ClockService</code></h5>

</div>
<div class="sect4">
<h5 id="__code_isissupportjdo_code"><code>IsisSupportJdo</code></h5>

</div>
<div class="sect4">
<h5 id="__code_exceptionrecognizer_code"><code>ExceptionRecognizer</code></h5>

</div>
<div class="sect4">
<h5 id="__code_wrapperfactory_code"><code>WrapperFactory</code></h5>

</div>
<div class="sect4">
<h5 id="__code_eventbusservice_code"><code>EventBusService</code></h5>

</div>
<div class="sect4">
<h5 id="_commands_background">Commands/Background</h5>
<div class="sect5">
<h6 id="__code_commandcontext_code"><code>CommandContext</code></h6>

</div>
<div class="sect5">
<h6 id="__code_backgroundservice_code"><code>BackgroundService</code></h6>

</div>
</div>
<div class="sect4">
<h5 id="_information_sharing">Information Sharing</h5>
<div class="sect5">
<h6 id="__code_scratchpad_code"><code>ScratchPad</code></h6>

</div>
<div class="sect5">
<h6 id="__code_actioninvocationcontext_code"><code>ActionInvocationContext</code></h6>

</div>
<div class="sect5">
<h6 id="__code_queryresultscache_code"><code>QueryResultsCache</code></h6>

</div>
</div>
<div class="sect4">
<h5 id="__code_emailservice_code"><code>EmailService</code></h5>

</div>
<div class="sect4">
<h5 id="_usermanagement">UserManagement</h5>
<div class="sect5">
<h6 id="__code_userprofileservice_code_spi"><code>UserProfileService</code> (SPI)</h6>

</div>
<div class="sect5">
<h6 id="__code_userregistrationservice_code_spi"><code>UserRegistrationService</code> (SPI)</h6>

</div>
<div class="sect5">
<h6 id="__code_emailnotificationservice_code"><code>EmailNotificationService</code></h6>

</div>
</div>
<div class="sect4">
<h5 id="_bookmarks_and_mementos">Bookmarks and Mementos</h5>
<div class="sect5">
<h6 id="__code_bookmarkservice_code"><code>BookmarkService</code></h6>

</div>
<div class="sect5">
<h6 id="__code_mementoservice_code"><code>MementoService</code></h6>

</div>
<div class="sect5">
<h6 id="__code_deeplinkservice_code"><code>DeepLinkService</code></h6>

</div>
<div class="sect5">
<h6 id="__code_xmlsnapshotservice_code"><code>XmlSnapshotService</code></h6>

</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_add_ons">1.5. Add-ons</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started">2. Getting Started</h2>
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_simpleapp_archetype">2.1. SimpleApp Archetype</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_datanucleus_enhancer">2.2. Datanucleus Enhancer</h3>
<div class="paragraph">
<p>By leveraging the JDO/Datanucleus ORM, Isis' JDO objectstore is very powerful. However, with such power comes a little bit of complexity to the development environment: all domain objects must be enhanced through the <a href="http://db.apache.org/jdo/enhancement.html">JDO enhancer</a>.  So the enhancer must, in one way or another, be integrated into your development environment.</p>
</div>
<div class="paragraph">
<p>If working from the Maven command line, JDO enhancement is done using the <code>maven-datanucleus-plugin</code>.  As of 1.9.0-SNAPSHOT, we put all the configuration into an (always active) profile:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;profile&gt;</span>
    <span class="tag">&lt;id&gt;</span>enhance<span class="tag">&lt;/id&gt;</span>
    <span class="tag">&lt;activation&gt;</span>
        <span class="tag">&lt;activeByDefault&gt;</span>true<span class="tag">&lt;/activeByDefault&gt;</span>
    <span class="tag">&lt;/activation&gt;</span>
    <span class="tag">&lt;properties&gt;</span>
        <span class="tag">&lt;datanucleus-maven-plugin.version&gt;</span>4.0.0-release<span class="tag">&lt;/datanucleus-maven-plugin.version&gt;</span>
    <span class="tag">&lt;/properties&gt;</span>
    <span class="tag">&lt;build&gt;</span>
        <span class="tag">&lt;plugins&gt;</span>
            <span class="tag">&lt;plugin&gt;</span>
                <span class="tag">&lt;groupId&gt;</span>org.datanucleus<span class="tag">&lt;/groupId&gt;</span>
                <span class="tag">&lt;artifactId&gt;</span>datanucleus-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
                <span class="tag">&lt;version&gt;</span>${datanucleus-maven-plugin.version}<span class="tag">&lt;/version&gt;</span>
                <span class="tag">&lt;configuration&gt;</span>
                    <span class="tag">&lt;fork&gt;</span>false<span class="tag">&lt;/fork&gt;</span>
                    <span class="tag">&lt;log4jConfiguration&gt;</span>${basedir}/log4j.properties<span class="tag">&lt;/log4jConfiguration&gt;</span>
                    <span class="tag">&lt;verbose&gt;</span>true<span class="tag">&lt;/verbose&gt;</span>
                    <span class="tag">&lt;props&gt;</span>${basedir}/datanucleus.properties<span class="tag">&lt;/props&gt;</span>
                <span class="tag">&lt;/configuration&gt;</span>
                <span class="tag">&lt;executions&gt;</span>
                    <span class="tag">&lt;execution&gt;</span>
                        <span class="tag">&lt;phase&gt;</span>process-classes<span class="tag">&lt;/phase&gt;</span>
                        <span class="tag">&lt;goals&gt;</span>
                            <span class="tag">&lt;goal&gt;</span>enhance<span class="tag">&lt;/goal&gt;</span>
                        <span class="tag">&lt;/goals&gt;</span>
                    <span class="tag">&lt;/execution&gt;</span>
                <span class="tag">&lt;/executions&gt;</span>
            <span class="tag">&lt;/plugin&gt;</span>
        <span class="tag">&lt;/plugins&gt;</span>
    <span class="tag">&lt;/build&gt;</span>
    <span class="tag">&lt;dependencies&gt;</span>
        <span class="tag">&lt;dependency&gt;</span>
            <span class="tag">&lt;groupId&gt;</span>org.datanucleus<span class="tag">&lt;/groupId&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>datanucleus-core<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;/dependency&gt;</span>
        <span class="tag">&lt;dependency&gt;</span>
            <span class="tag">&lt;groupId&gt;</span>org.datanucleus<span class="tag">&lt;/groupId&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>datanucleus-jodatime<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;/dependency&gt;</span>
        <span class="tag">&lt;dependency&gt;</span>
            <span class="tag">&lt;groupId&gt;</span>org.datanucleus<span class="tag">&lt;/groupId&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>datanucleus-api-jdo<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;/dependency&gt;</span>
    <span class="tag">&lt;/dependencies&gt;</span>
<span class="tag">&lt;/profile&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="#_simpleapp_archetype">SimpleApp Archetype</a> sets up the plugin correctly in the <code>dom</code> (domain object model) module.  (It&#8217;s actually a little bit more complext to cater for users of the Eclipse IDE using Eclipse&#8217;s m2e plugin).</p>
</div>
<div class="sect3">
<h4 id="__code_meta_inf_persistence_xml_code">2.2.1. <code>META-INF/persistence.xml</code></h4>
<div class="paragraph">
<p>It&#8217;s also a good idea to ensure that the <code>dom</code> module has a JDO <code>META-INF/persistence.xml</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="tag">&lt;persistence</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://java.sun.com/xml/ns/persistence</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">&quot;</span></span>
    <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1.0</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>

    <span class="tag">&lt;persistence-unit</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">simple</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tag">&lt;/persistence-unit&gt;</span>
<span class="tag">&lt;/persistence&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>change as required; typically is the name of the app.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Again, the <a href="#_simpleapp_archetype">SimpleApp Archetype</a> does this.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If running on Windows, then there&#8217;s a good chance you&#8217;ll hit the <a href="http://msdn.microsoft.com/en-us/library/aa365247%28VS.85%29.aspx#maxpath">maximum path length limit</a>.   In this case the <code>persistence.xml</code> file is mandatory rather than optional.</p>
</div>
<div class="paragraph">
<p>This file is also required if you are using developing in Eclipse and relying on the DataNucleus plugin for Eclipse rather than the DataNucleus plugin for Maven.  More information can be found <a href="#_setting_up_eclipse">here</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_tos">3. How-tos</h2>
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_class_structure">3.1. Class Structure</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_class_definition">3.1.1. Class Definition</h4>
<div class="paragraph">
<p>Classes are defined both to Isis and (if any entity) also to JDO/DataNucleus.</p>
</div>
<div class="paragraph">
<p>We use Java packages as a way to group related domain objects together; the package name forms a namespace. We can then reason about all the classes in that package/namespace as a single unit.</p>
</div>
<div class="paragraph">
<p>In the same way that Java packages act as a namespace for domain objects, it&#8217;s good practice to map domain entities to their own (database) schemas.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>For more on this topic, see <a href="#_using_modules">Using Modules</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_property">3.1.2. Property</h4>
<div class="sect4">
<h5 id="_value_vs_reference_types">Value vs Reference Types</h5>
<div class="paragraph">
<p>The annotations for mapping value types tend to be different for properties vs action parameters, because JDO annotations are only valid on properties.  The table in <a href="#Mapping Value Types">[Mapping Value Types]</a> provides a handy reference for the each.</p>
</div>
</div>
<div class="sect4">
<h5 id="_optional_properties">Optional Properties</h5>

</div>
<div class="sect4">
<h5 id="_mapping_string_length">Mapping String (Length)</h5>

</div>
<div class="sect4">
<h5 id="_mapping_joda_dates">Mapping JODA Dates</h5>

</div>
<div class="sect4">
<h5 id="_mapping_bigdecimals">Mapping BigDecimals</h5>

</div>
<div class="sect4">
<h5 id="_mapping_blobs">Mapping Blobs</h5>

</div>
<div class="sect4">
<h5 id="_mapping_passwords">Mapping Passwords</h5>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Lazy Loading</div>

</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_collection">3.1.3. Collection</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>While Isis support collections of references, the framework (currently) does not support collections of values. That is, it isn&#8217;t possible to define a collection of type <code>Set&lt;String&gt;</code>.</p>
</div>
<div class="paragraph">
<p>Or, actually, you can, because that is a valid mapping supported by JDO/DataNucleus .  However, Isis has no default visualization.</p>
</div>
<div class="paragraph">
<p>The workaround is to mark the collection as <code>@Programmatic</code>, as described in <a href="#_ignoring_methods">Ignoring Methods</a>.  This ensures that the collection is ignored by Isis.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_actions">3.1.4. Actions</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>While Isis support actions whose parameters' types are scalar (values such as <code>String</code>, <code>int</code>, or references such as <code>Customer</code>), the framework (currently) does not support parameter types that are collections or maps.</p>
</div>
<div class="paragraph">
<p>The workaround is to mark the collection as <code>@Programmatic</code>, as described in <a href="#_ignoring_methods">Ignoring Methods</a>.  This ensures that the collection is ignored by Isis.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_action_parameters">3.1.5. Action Parameters</h4>
<div class="sect4">
<h5 id="_string_length_of_action_parameter">String Length Of Action Parameter</h5>

</div>
<div class="sect4">
<h5 id="_bigdecimal_precision_of_action_parameter">BigDecimal Precision Of Action Parameter</h5>

</div>
<div class="sect4">
<h5 id="_optional_action_argument">Optional Action Argument</h5>

</div>
</div>
<div class="sect3">
<h4 id="_properties_vs_parameters">3.1.6. Properties vs Parameters</h4>
<div class="paragraph">
<p>In many cases the value types of properties and of action parameters align. For example, a <code>Customer</code> entity might have a <code>surname</code> property, and there might also be corresponding <code>changeSurname</code>.  Ideally we want the surname property and surname action parameter to use the same value type.</p>
</div>
<div class="paragraph">
<p>Having first-class support for this is a goal of Isis, and it is already possible (by writing some plumbing and glue code using Isis and DataNucleus APIs) to get some way towards this ideal.  However, in the vast majority of cases it is much easier and more practical to simply use standard value types such as <code>java.lang.String</code>.</p>
</div>
<div class="paragraph">
<p>However, the JDO/DataNucleus annotations for specifying semantics such as optionality or maximum length are restricted to only apply to fields and to methods; they cannot be applied to action parameters.  It is therefore necessary to use Isis' equivalent annotations for action parameters.</p>
</div>
<div class="paragraph">
<p>The table below summarises the equivalence of some of the most common cases.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Comparing annotations of Properties vs Action Parameters</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 37%;">
<col style="width: 37%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">value type/semantic</th>
<th class="tableblock halign-left valign-top">property</th>
<th class="tableblock halign-left valign-top">action parameter</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">string (length)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">big decimal (precision)</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Isis blob</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Column(allowsNull="true")</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ParameterLayout(optionality=Optionality.OPTIONAL</code>) or <code>@Optional</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_ignoring_methods">3.1.7. Ignoring Methods</h4>
<div class="paragraph">
<p>Sometimes you want to define a <code>public</code> method on a domain object that is not intended to be rendered in Isis' UI.</p>
</div>
<div class="paragraph">
<p>To exclude such methods, use the <code>@Programmatic</code> annotation.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ui_hints">3.2. UI Hints</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_object_titles_and_icons">3.2.1. Object Titles and Icons</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_object_title">Object Title</h5>
<div class="sect5">
<h6 id="_titles_in_tables">Titles in Tables</h6>

</div>
<div class="sect5">
<h6 id="_hide_part_of_a_title">Hide part of a title</h6>

</div>
</div>
<div class="sect4">
<h5 id="_object_icon">Object Icon</h5>

</div>
<div class="sect4">
<h5 id="_object_css_styling">Object CSS Styling</h5>

</div>
</div>
<div class="sect3">
<h4 id="_names_and_descriptions">3.2.2. Names and Descriptions</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
see also <a href="#_i18n">Internationalization</a>
</td>
</tr>
</table>
</div>
<div class="sect5">
<h6 id="_class_object">Class (object)</h6>

</div>
<div class="sect5">
<h6 id="_property_2">Property</h6>

</div>
<div class="sect5">
<h6 id="_collections">Collections</h6>

</div>
<div class="sect5">
<h6 id="_actions_2">Actions</h6>

</div>
<div class="sect5">
<h6 id="_action_parameters_2">Action Parameters</h6>
<div class="paragraph">
<p>Use <code>@ParameterLayout(named=&#8230;&#8203;)</code> or <code>@Named(&#8230;&#8203;)</code></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If you&#8217;re running on Java 8, then note that it&#8217;s possible to write Isis applications without using <code>@ParameterLayout(named=&#8230;&#8203;)</code> annotation.  Support for this can be found in the <a href="http://github.com/isisaddons/isis-metamodel-paraname8}">Isis addons' paraname8</a> metamodel extension (non-ASF).  (In the future we&#8217;ll fold this into core).  See also our guidance on <a href="#_upgrading_to_java_8_1_9_0_snapshot_and_later">upgrading to Java 8</a>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_layout">3.2.3. Layout</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_layout_using_annotations">Layout using annotations</h5>

</div>
<div class="sect4">
<h5 id="_dynamic_layouts">Dynamic layouts</h5>

</div>
<div class="sect4">
<h5 id="_application_menu_layout">Application menu layout</h5>

</div>
</div>
<div class="sect3">
<h4 id="_eager_rendering">3.2.4. Eager rendering</h4>
<div class="paragraph">
<p>By default, collections all rendered lazily, in other words in a "collapsed" table view:</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO - screenshot here
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For the more commonly used collections we want to show the table expanded:</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO - screenshot here
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For this we annotate the collection using the <code>@CollectionLayout(render=RenderType.EAGERLY</code>; for example</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@javax</span>.jdo.annotations.Persistent(table=<span class="string"><span class="delimiter">&quot;</span><span class="content">ToDoItemDependencies</span><span class="delimiter">&quot;</span></span>)
<span class="directive">private</span> <span class="predefined-type">Set</span>&lt;ToDoItem&gt; dependencies = <span class="keyword">new</span> <span class="predefined-type">TreeSet</span>&lt;&gt;();
<span class="annotation">@Collection</span>
<span class="annotation">@CollectionLayout</span>(
    render = RenderType.EAGERLY
)
<span class="directive">public</span> <span class="predefined-type">Set</span>&lt;ToDoItem&gt; getDependencies() {
    <span class="keyword">return</span> dependencies;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Alternatively, it can be specified the <code>Xxx.layout.json</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="string"><span class="delimiter">&quot;</span><span class="content">dependencies</span><span class="delimiter">&quot;</span></span>: {
    <span class="key"><span class="delimiter">&quot;</span><span class="content">collectionLayout</span><span class="delimiter">&quot;</span></span>: {
        <span class="key"><span class="delimiter">&quot;</span><span class="content">render</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">EAGERLY</span><span class="delimiter">&quot;</span></span>
    },
}</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It might be thought that collections that are eagerly rendered should also be eagerly loaded from the database by enabling the <code>defaultFetchGroup</code> attribute:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@javax</span>.jdo.annotations.Persistent(table=<span class="string"><span class="delimiter">&quot;</span><span class="content">ToDoItemDependencies</span><span class="delimiter">&quot;</span></span>, defaultFetchGroup=<span class="string"><span class="delimiter">&quot;</span><span class="content">true</span><span class="delimiter">&quot;</span></span>)
<span class="directive">private</span> <span class="predefined-type">Set</span>&lt;ToDoItem&gt; dependencies = <span class="keyword">new</span> <span class="predefined-type">TreeSet</span>&lt;&gt;();
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>While this can be done, it&#8217;s likely to be a bad idea, because doing so will cause DataNucleus to query for more data than required even if the object is being rendered within some referencing object&#8217;s table.</p>
</div>
<div class="paragraph">
<p>Of course, your mileage may vary, so don&#8217;t think you can&#8217;t experiment.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_action_icons_and_css">3.2.5. Action Icons and CSS</h4>
<div class="paragraph">
<p>Apache Isis allows <a href="fortawesome.github.io/Font-Awesome/icons/">font awesome</a> icons to be associated with each action, and for <a href="http://getbootstrap.com/css/#buttons">Bootstrap CSS</a> to be applied to action rendered as buttons.</p>
</div>
<div class="paragraph">
<p>These UI hint can be applied either to individual actions, or can be applied en-masse using pattern matching.</p>
</div>
<div class="sect4">
<h5 id="_per_action">Per action</h5>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO - more words here&#8230;&#8203;
</td>
</tr>
</table>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@CssClassFa</code></p>
</li>
<li>
<p><code>@CssClass</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Alternatively, you can specify these hints in the <code>Xxx.layout.json</code> for the entity:</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_per_pattern_matching">Per pattern matching</h5>
<div class="paragraph">
<p>Rather than annotating every action with <code>@CssClassFa</code> and <code>@CssClass</code>, you can instead specify the UI hint globally using regular expressions.</p>
</div>
<div class="paragraph">
<p>The <code>isis.reflector.facet.cssClassFa.patterns</code> is a comma separated list of key:value pairs, eg:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ini">isis.reflector.facet.cssClassFa.patterns=\
                        new.*:fa-plus,\
                        add.*:fa-plus-square,\
                        create.*:fa-plus,\
                        list.*:fa-list, \
                        all.*:fa-list, \
                        download.*:fa-download, \
                        upload.*:fa-upload, \
                        execute.*:fa-bolt, \
                        run.*:fa-bolt</code></pre>
</div>
</div>
<div class="paragraph">
<p>where the key is a regex matching action names (eg <code>create.*</code>) and the value is a <a href="fortawesome.github.io/Font-Awesome/icons/">font-awesome</a> icon name (eg <code>fa-plus</code>) to be applied (as per <code>@CssClassFa()</code>) to all action members matching the regex.</p>
</div>
<div class="paragraph">
<p>Similarly, the <code>isis.reflector.facet.cssClass.patterns</code> is a comma separated list of key:value pairs, eg:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ini">isis.reflector.facet.cssClass.patterns=\
                        delete.*:btn-warning</code></pre>
</div>
</div>
<div class="paragraph">
<p>where (again)the key is a regex matching action names (eg <code>delete.*</code>) and the value is a <a href="http://getbootstrap.com/css/">Bootstrap</a> CSS button class (eg <code>btn-warning) to be applied (as per `@CssClass()</code>) to all action members matching the regex.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>We strongly recommend that you use this technique rather than annotating each action with <code>@CssClassFa</code> or <code>@CssClass</code>.  Not only is the code more maintainable, you&#8217;ll also find that it forces you to be consistent in your action names.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_domain_services_2">3.3. Domain Services</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_singleton_request_scoped_services">3.3.1. Singleton &amp; request-scoped services</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It&#8217;s worth extending the &lt;&lt;_hexagonal_architecture, Hexagonal Architecture&gt; to show where domain services&#8201;&#8212;&#8201;and in particular the domain services provided by <a href="http://isisaddons.org">Isis Addons</a> (non-ASF)&#8201;&#8212;&#8201;fit in:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/how-tos/domain-services/hexagonal-architecture-addons.png" alt="hexagonal architecture addons" width="700px">
</div>
<div class="title">Figure 2. The hexagonal architecture with Isis addons</div>
</div>
<div class="paragraph">
<p>Here, we can see that the addons provide services both to the Isis framework (for example security, command and auditing) and also - by way of dependency injection - to the domain objects (eg tags, excel, settings). Of course, you can also write your own domain services as well, for example to interface with some external CMS system, say.</p>
</div>
<div class="paragraph">
<p>The Apache Isis framework also provides a number of in-built domain services.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_object_management_crud">3.4. Object Management (CRUD)</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_injecting_services">3.4.1. Injecting Services</h4>

</div>
<div class="sect3">
<h4 id="_instantiating_and_persisting_objects">3.4.2. Instantiating and Persisting Objects</h4>

</div>
<div class="sect3">
<h4 id="_finding_objects">3.4.3. Finding Objects</h4>
<div class="sect4">
<h5 id="_using_datanucleus_type_safe_queries">Using DataNucleus type-safe queries</h5>
<div class="paragraph">
<p>as per <a href="http://github.com/isisaddons/isis-app-todoapp}">Isis addons' todoapp</a> (non-ASF)</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_deleting_objects">3.4.4. Deleting Objects</h4>

</div>
</div>
<div class="sect2">
<h3 id="_entity_relationships">3.5. Entity Relationships</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_mapping_mandatory_and_optional_properties">3.5.1. Mapping Mandatory and Optional Properties</h4>

</div>
<div class="sect3">
<h4 id="_managed_1_m_bidirectional_relationships">3.5.2. Managed 1-m bidirectional relationships</h4>

</div>
</div>
<div class="sect2">
<h3 id="_contributed_members">3.6. Contributed Members</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_contributed_action">3.6.1. Contributed Action</h4>

</div>
<div class="sect3">
<h4 id="_contributed_property">3.6.2. Contributed Property</h4>

</div>
<div class="sect3">
<h4 id="_contributed_collection">3.6.3. Contributed Collection</h4>

</div>
</div>
<div class="sect2">
<h3 id="_business_rules">3.7. Business Rules</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_visibility_see_it">3.7.1. Visibility ("see it")</h4>
<div class="sect4">
<h5 id="_hide_a_property">Hide a Property</h5>

</div>
<div class="sect4">
<h5 id="_hide_a_collection">Hide a Collection</h5>

</div>
<div class="sect4">
<h5 id="_hide_an_action">Hide an Action</h5>

</div>
<div class="sect4">
<h5 id="_hide_a_contributed_property_collection_or_action">Hide a Contributed Property, Collection or Action</h5>

</div>
<div class="sect4">
<h5 id="_all_members_hidden">All Members Hidden</h5>

</div>
</div>
<div class="sect3">
<h4 id="_usability_use_it">3.7.2. Usability ("use it")</h4>
<div class="sect4">
<h5 id="_disable_a_property">Disable a Property</h5>

</div>
<div class="sect4">
<h5 id="_disable_a_collection">Disable a Collection</h5>

</div>
<div class="sect4">
<h5 id="_disable_an_action">Disable an Action</h5>

</div>
<div class="sect4">
<h5 id="_disable_a_contributed_property_collection_or_action">Disable a Contributed Property, Collection or Action</h5>

</div>
<div class="sect4">
<h5 id="_all_members_unmodifiable_disabling_the_edit_button">All Members Unmodifiable (Disabling the Edit Button)</h5>
<div class="paragraph">
<p>Sometimes an object is unmodifiable.</p>
</div>
<div class="paragraph">
<p>In the Wicket viewer this means disabling the edit button.</p>
</div>
<div class="sect5">
<h6 id="_declarative">Declarative</h6>
<div class="paragraph">
<p><code>@DomainObject(editing=&#8230;&#8203;)</code></p>
</div>
</div>
<div class="sect5">
<h6 id="_imperative">Imperative</h6>

</div>
</div>
</div>
<div class="sect3">
<h4 id="_validity_do_it">3.7.3. Validity ("do it")</h4>
<div class="sect4">
<h5 id="_validate_change_to_a_property">Validate (change to) a Property</h5>

</div>
<div class="sect4">
<h5 id="_validate_adding_or_removing_from_a_collection">Validate (adding or removing from) a Collection</h5>

</div>
<div class="sect4">
<h5 id="_validate_arguments_to_invoke_an_action">Validate (arguments to invoke) an Action</h5>

</div>
<div class="sect4">
<h5 id="_validating_a_contributed_property_collection_or_action">Validating a Contributed Property, Collection or Action</h5>

</div>
<div class="sect4">
<h5 id="_declarative_validation_using_code_mustsatisfy_code">Declarative validation using <code>@MustSatisfy</code></h5>

</div>
</div>
</div>
<div class="sect2">
<h3 id="_derived_members">3.8. Derived Members</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_derived_property">3.8.1. Derived Property</h4>

</div>
<div class="sect3">
<h4 id="_derived_collection">3.8.2. Derived Collection</h4>
<div class="sidebarblock">
<div class="content">
<div class="title">Inlining query-only repository action</div>
<div class="paragraph">
<p>While derived properties and derived collections typically "walk the graph" to associated objects, there is nothing to prevent the returned value being the result of invoking a repository (domain service) action.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> {
    ...
    public <span class="predefined-type">List</span>&lt;Order&gt; getMostRecentOrders() {
        <span class="keyword">return</span> orderRepo.findMostRecentOrders(<span class="local-variable">this</span>, <span class="integer">5</span>);
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_trigger_on_property_change">3.8.3. Trigger on property change</h4>

</div>
<div class="sect3">
<h4 id="_trigger_on_collection_change">3.8.4. Trigger on collection change</h4>

</div>
</div>
<div class="sect2">
<h3 id="_drop_downs_and_defaults">3.9. Drop Downs and Defaults</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_for_properties">3.9.1. For Properties</h4>
<div class="sect4">
<h5 id="_choices_for_property">Choices for Property</h5>

</div>
<div class="sect4">
<h5 id="_auto_complete_for_property">Auto-complete for property</h5>

</div>
<div class="sect4">
<h5 id="_default_for_property">Default for property</h5>

</div>
</div>
<div class="sect3">
<h4 id="_for_action_parameters">3.9.2. For Action Parameters</h4>
<div class="sect4">
<h5 id="_choices_for_action_parameter">Choices for action parameter</h5>

</div>
<div class="sect4">
<h5 id="_dependent_choices_for_action_params">Dependent choices for action params</h5>

</div>
<div class="sect4">
<h5 id="_auto_complete_for_action_param">Auto-complete for action param</h5>

</div>
<div class="sect4">
<h5 id="_default_for_action_param">Default for action param</h5>

</div>
</div>
<div class="sect3">
<h4 id="_for_both_properties_and_action_parameters">3.9.3. For both Properties and Action Parameters</h4>
<div class="sect4">
<h5 id="_drop_down_for_limited_number_of_instances">Drop-down for limited number of instances</h5>

</div>
<div class="sect4">
<h5 id="_auto_complete_repository_based">Auto-complete (repository-based)</h5>

</div>
</div>
</div>
<div class="sect2">
<h3 id="_bulk_actions">3.10. Bulk Actions</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>ie <code>@Action(invokeOn=&#8230;&#8203;)</code></p>
</div>
</div>
<div class="sect2">
<h3 id="_triggering_events">3.11. Triggering Events</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_publishing_and_subscribing_to_events_pulling_changes">3.11.1. Publishing and Subscribing to Events (Pulling Changes)</h4>

</div>
<div class="sect3">
<h4 id="_pushing_changes">3.11.2. Pushing Changes</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
this technique is much less powerful than the event bus described in <a href="#_publishing_and_subscribing_to_events_pulling_changes">Publishing and Subscribing to Events (Pulling Changes)</a>).  We present it mostly for completeness.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_when_a_property_is_changed">When a property is changed</h5>
<div class="paragraph">
<p>If you want to invoke functionality whenever a property is changed by the user, then you should create a supporting <code>modifyXxx()</code> method and include the functionality within that. The syntax is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> modifyPropertyName(PropertyType param) { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Why not just put this functionality in the setter? Well, the setter is used by the object store to recreate the state of an already persisted object. Putting additional behaviour in the setter would cause it to be triggered incorrectly.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Order</span>() {
    <span class="directive">public</span> <span class="predefined-type">Integer</span> getAmount() { ... }
    <span class="directive">public</span> <span class="type">void</span> setAmount(<span class="predefined-type">Integer</span> amount) { ... }
    <span class="directive">public</span> <span class="type">void</span> modifyAmount(<span class="predefined-type">Integer</span> amount) { <i class="conum" data-value="1"></i><b>(1)</b>
        setAmount(amount);  <i class="conum" data-value="3"></i><b>(3)</b>
        addToTotal(amount); <i class="conum" data-value="2"></i><b>(2)</b>
    }
    ...
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>modifyAmount()</code> method calls &#8230;&#8203;</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>&#8230;&#8203; the <code>addToTotal()</code> (not shown) to maintain some running total.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We don&#8217;t want this <code>addToCall()</code> method to be called when pulling the object back from the object store, so we put it into the modify, not the setter.</p>
</div>
<div class="paragraph">
<p>You may optionally also specify a <code>clearXxx()</code> which works the same way as modify <code>modify Xxx()</code> but is called when the property is cleared by the user (i.e. the current value replaced by nothing). The syntax is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> clearPropertyName() { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>To extend the above example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Order</span>() {
    <span class="directive">public</span> <span class="predefined-type">Integer</span> getAmount() { ... }
    <span class="directive">public</span> <span class="type">void</span> setAmount(<span class="predefined-type">Integer</span> amount) { ... }
    <span class="directive">public</span> <span class="type">void</span> modifyAmount(<span class="predefined-type">Integer</span> amount) { ... }
    <span class="directive">public</span> <span class="type">void</span> clearAmount() {
        removeFromTotal(<span class="local-variable">this</span>.amount);
        setAmount(<span class="predefined-constant">null</span>);
    }
    ...
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_when_a_collection_is_added_to_or_removed_from">When a collection is added to or removed from</h5>
<div class="paragraph">
<p>A collection may have a corresponding <code>addToXxx()</code> and/or
<code>removeFromXxx()</code> method. If present, and direct manipulation of the
contents of the connection has not been disabled (see ?), then they will
be called (instead of adding/removing an object directly to the
collection returned by the accessor).</p>
</div>
<div class="paragraph">
<p>The reason for this behaviour is to allow other behaviour to be
triggered when the contents of the collection is altered. That is, it is
directly equivalent to the supporting <code>modifyXxx()</code> and <code>clearXxx()</code>
methods for properties (see ?).</p>
</div>
<div class="paragraph">
<p>The syntax is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> addTo&lt;CollectionName&gt;(EntityType param) { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>and</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> removeFromCollectionName(EntityType param) { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>EntityType</code> is the same type as the generic collection type.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> { ... }

<span class="directive">public</span> <span class="type">class</span> <span class="class">Department</span> {

    <span class="directive">private</span> <span class="type">int</span> numMaleEmployees;  <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="directive">private</span> <span class="type">int</span> numFemaleEmployees; <i class="conum" data-value="1"></i><b>(1)</b>

    <span class="directive">private</span> <span class="predefined-type">Set</span>&lt;Employee&gt; employees = <span class="keyword">new</span> <span class="predefined-type">TreeSet</span>&lt;Employee&gt;();
    <span class="directive">public</span> <span class="predefined-type">Set</span>&lt;Employee&gt; getEmployees() {
        <span class="keyword">return</span> employees;
    }
    <span class="directive">private</span> <span class="type">void</span> setEmployees(<span class="predefined-type">Set</span>&lt;Employee&gt; employees) {
        <span class="local-variable">this</span>.employees = employees;
    }
    <span class="directive">public</span> <span class="type">void</span> addToEmployees(Employee employee) {
        numMaleEmployees += countOneMale(employee);     <i class="conum" data-value="2"></i><b>(2)</b>
        numFemaleEmployees += countOneFemale(employee); <i class="conum" data-value="2"></i><b>(2)</b>
        employees.add(employee);
    }
    <span class="directive">public</span> <span class="type">void</span> removeFromEmployees(Employee employee) {
        numMaleEmployees -= countOneMale(employee);     <i class="conum" data-value="3"></i><b>(3)</b>
        numFemaleEmployees -= countOneFemale(employee); <i class="conum" data-value="3"></i><b>(3)</b>
        employees.remove(employee);
    }
    <span class="directive">private</span> <span class="type">int</span> countOneMale(Employee employee) { <span class="keyword">return</span> employee.isMale()?<span class="integer">1</span>:<span class="integer">0</span>; }
    <span class="directive">private</span> <span class="type">int</span> countOneFemale(Employee employee) { <span class="keyword">return</span> employee.isFemale()?<span class="integer">1</span>:<span class="integer">0</span>; }

    ...
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>maintain a count of the number of male and female employees (getters and setters omitted)</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>the <code>addTo&#8230;&#8203;()</code> method increments the derived properties</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>the <code>removeTo&#8230;&#8203;()</code> method similarly decrements the derived properties</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_using_modules">3.12. Using Modules</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
1.9.0-SNAPSHOT onwards.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We use Java packages as a way to group related domain objects together; the package name forms a namespace. We can then
reason about all the classes in that package/namespace as a single unit. Good examples are the various
<a href="http://github.com/isisaddons">Isis Addons</a> (not ASF): security, commands, auditing and so on.</p>
</div>
<div class="paragraph">
<p>In the same way that Java packages act as a namespace for domain objects, it&#8217;s good practice to map domain entities to
their own (database) schemas. As of 1.9.0-SNAPSHOT, all the IsisAddons modules do this, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@javax</span>.jdo.annotations.PersistenceCapable( ...
        schema = <span class="string"><span class="delimiter">&quot;</span><span class="content">isissecurity</span><span class="delimiter">&quot;</span></span>,
        table = <span class="string"><span class="delimiter">&quot;</span><span class="content">ApplicationUser</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ApplicationUser</span> ... { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>results in a <code>CREATE TABLE</code> statement of:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">CREATE</span> <span class="type">TABLE</span> isissecurity.<span class="string"><span class="delimiter">&quot;</span><span class="content">ApplicationUser</span><span class="delimiter">&quot;</span></span> (
    ...
)</code></pre>
</div>
</div>
<div class="paragraph">
<p>while:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@javax</span>.jdo.annotations.PersistenceCapable( ...
        schema = <span class="string"><span class="delimiter">&quot;</span><span class="content">isisaudit</span><span class="delimiter">&quot;</span></span>,
        table=<span class="string"><span class="delimiter">&quot;</span><span class="content">AuditEntry</span><span class="delimiter">&quot;</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">AuditEntry</span> ... { ... }</code></pre>
</div>
</div>
<div class="paragraph">
<p>similarly results in:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="sql"><span class="class">CREATE</span> <span class="type">TABLE</span> isisaudit.<span class="string"><span class="delimiter">&quot;</span><span class="content">AuditEntry</span><span class="delimiter">&quot;</span></span> (
    ...
)</code></pre>
</div>
</div>
<div class="paragraph">
<p>If for some reason you don&#8217;t want to use schemas (though we strongly recommend that you do), then then note that you can override the <code>@PersistenceCapable</code> annotation by providing XML metadata (the <code>mappings.jdo</code> file).  See <a href="#Overriding Annotations">[Overriding Annotations]</a> for a write-up of how to do this.</p>
</div>
<div class="sect3">
<h4 id="_listener_to_create_db_schema_objects">3.12.1. Listener to create DB schema objects</h4>
<div class="paragraph">
<p>JDO/DataNucleus does not automatically create these schema objects, but it <em>does</em> provide a listener callback API
on the initialization of each class into the JDO metamodel.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Actually, the above statement isn&#8217;t quite true.  In DN 3.2.x (as used by Isis up to v1.8.0) there was no support for schemas.  As of Isis 1.9.0-SNAPSHOT and DN 4.0 there is now support.  But we implemented this feature initially against DN 3.2.x, and it still works, so we&#8217;ve decided to leave it in.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Therefore Apache Isis attaches a listener, <code>CreateSchemaObjectFromClassMetadata</code>, that checks for the schema&#8217;s existence, and creates the schema if required.</p>
</div>
<div class="paragraph">
<p>The guts of its implementation is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">package</span> <span class="namespace">org.apache.isis.objectstore.jdo.datanucleus</span>;

<span class="directive">public</span> <span class="type">class</span> <span class="class">CreateSchemaObjectFromClassMetadata</span>
        <span class="directive">implements</span> MetaDataListener,
                   PersistenceManagerFactoryAware,
                   DataNucleusPropertiesAware {

    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> loaded(<span class="directive">final</span> AbstractClassMetaData cmd) { ... }

    <span class="directive">protected</span> <span class="predefined-type">String</span> buildSqlToCheck(<span class="directive">final</span> AbstractClassMetaData cmd) {
        <span class="directive">final</span> <span class="predefined-type">String</span> schemaName = schemaNameFor(cmd);
        <span class="keyword">return</span> <span class="predefined-type">String</span>.format(
            <span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT count(*) FROM INFORMATION_SCHEMA.SCHEMATA where SCHEMA_NAME = '%s'</span><span class="delimiter">&quot;</span></span>, schemaName);
    }

    <span class="directive">protected</span> <span class="predefined-type">String</span> buildSqlToExec(<span class="directive">final</span> AbstractClassMetaData cmd) {
        <span class="directive">final</span> <span class="predefined-type">String</span> schemaName = schemaNameFor(cmd);
        <span class="keyword">return</span> <span class="predefined-type">String</span>.format(<span class="string"><span class="delimiter">&quot;</span><span class="content">CREATE SCHEMA </span><span class="char">\&quot;</span><span class="content">%s</span><span class="char">\&quot;</span><span class="delimiter">&quot;</span></span>, schemaName);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>where <code>MetaDataListener</code> is the DataNucleus listener API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">MetaDataListener</span> {
    <span class="type">void</span> loaded(AbstractClassMetaData cmd);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Although not formal API, the default <code>CreateSchemaObjectFromClassMetadata</code> has been designed to be easily overrideable if you
need to tweak it to support other RDBMS'.  Any implementation must implement <code>org.datanucleus.metadata.MetaDataListener</code>:</p>
</div>
<div class="paragraph">
<p>The implementation provided has has been tested for HSQLDB, PostgreSQL and MS SQL Server, and is used automatically unless an alternative implementation is specified (as described in the section below).</p>
</div>
</div>
<div class="sect3">
<h4 id="_registering_an_alternative_implementation">3.12.2. Registering an Alternative Implementation</h4>
<div class="paragraph">
<p>An alternative implementation can be registered and used through the following configuration property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ini">#
# hook to perform additional initialization when JDO class metadata is loaded
# default implementation will attempt to run 'create schema' for the specified schema.
#
isis.persistor.datanucleus.classMetadataLoadedListener=\
        org.apache.isis.objectstore.jdo.datanucleus.CreateSchemaObjectFromClassMetadata</code></pre>
</div>
</div>
<div class="paragraph">
<p>Because this pertains to the JDO Objectstore we suggest you put this configuration property in <code>WEB-INF/persistor_datanucleus.properties</code>; but putting it in <code>isis.properties</code> will also work.</p>
</div>
<div class="paragraph">
<p>Any implementation must implement <code>org.datanucleus.metadata.MetaDataListener</code>.  In many cases simply subclassing from <code>CreateSchemaObjectFromClassMetadata</code> and overriding <code>buildSqlToCheck(&#8230;&#8203;)</code> and <code>buildSqlToExec(&#8230;&#8203;)</code> should suffice.</p>
</div>
<div class="paragraph">
<p>If you <em>do</em> need more control, your implementation can also optionally implement <code>org.apache.isis.objectstore.jdo.datanucleus.PersistenceManagerFactoryAware</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">PersistenceManagerFactoryAware</span> {
    <span class="directive">public</span> <span class="type">void</span> setPersistenceManagerFactory(<span class="directive">final</span> PersistenceManagerFactory persistenceManagerFactory);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>and also <code>org.apache.isis.objectstore.jdo.datanucleus.DataNucleusPropertiesAware</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">DataNucleusPropertiesAware</span> {
    <span class="directive">public</span> <span class="type">void</span> setDataNucleusProperties(<span class="directive">final</span> <span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">String</span>&gt; properties);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This latter interface provides access to the properties passed through to JDO/DataNucleus.</p>
</div>
</div>
<div class="sect3">
<h4 id="_please_contribute_back">3.12.3. Please contribute back</h4>
<div class="paragraph">
<p>If you do extend Isis' <code>CreateSchemaObjectFromClassMetadata</code> class for some other database, please <a href="https://issues.apache.org/jira/browse/ISIS">contribute back</a> your improvements.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_view_models">3.13. View Models</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="__code_viewmodel_code">3.13.1. <code>@ViewModel</code></h4>

</div>
<div class="sect3">
<h4 id="__code_viewmodel_code_interface">3.13.2. <code>ViewModel</code> interface</h4>

</div>
</div>
<div class="sect2">
<h3 id="_tips_n_tricks">3.14. Tips n Tricks</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="__are_you_sure_idiom">3.14.1. 'Are you sure?' idiom</h4>
<div class="paragraph">
<p>If providing an action that will perform irreversible changes, include a
mandatory boolean parameter that must be explicitly checked by the end-user
in order for the action to proceed.</p>
</div>
<div class="sect4">
<h5 id="_screenshots">Screenshots</h5>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images//how-tos/tips-n-tricks/are-you-sure.png" alt="are you sure">
</div>
</div>
<div class="paragraph">
<p>If the user checks the box:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images//how-tos/tips-n-tricks/are-you-sure-happy-case.png" alt="are you sure happy case">
</div>
</div>
<div class="paragraph">
<p>then the action will complete.</p>
</div>
<div class="paragraph">
<p>However, if the user fails to check the box, then a validation message is shown:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images//how-tos/tips-n-tricks/are-you-sure-sad-case.png" alt="are you sure sad case">
</div>
</div>
</div>
<div class="sect4">
<h5 id="_code_example">Code example</h5>
<div class="paragraph">
<p>The code for this is pretty simple:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="predefined-type">List</span>&lt;ToDoItem&gt; delete(<span class="annotation">@Named</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Are you sure?</span><span class="delimiter">&quot;</span></span>) <span class="type">boolean</span> areYouSure) {

    container.removeIfNotAlready(<span class="local-variable">this</span>);

    container.informUser(<span class="string"><span class="delimiter">&quot;</span><span class="content">Deleted </span><span class="delimiter">&quot;</span></span> + container.titleOf(<span class="local-variable">this</span>));

    <span class="comment">// invalid to return 'this' (cannot render a deleted object)</span>
    <span class="keyword">return</span> toDoItems.notYetComplete();
}
<span class="directive">public</span> <span class="predefined-type">String</span> validateDelete(<span class="type">boolean</span> areYouSure) {
    <span class="keyword">return</span> areYouSure? <span class="predefined-constant">null</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Please confirm you are sure</span><span class="delimiter">&quot;</span></span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that the action itself does not use the boolean parameter, it is only
used by the supporting <code>validateXxx()</code> method.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_overriding_jdo_annotations">3.14.2. Overriding JDO Annotations</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_render_all_properties_in_tables">3.14.3. Render all Properties in Tables</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>solution: use abstract properties in the supertype</p>
</div>
<div class="paragraph">
<p>example: audit, command and published event (from isis addons).</p>
</div>
</div>
<div class="sect3">
<h4 id="_per_user_themes">3.14.4. Per-user Themes</h4>
<div class="sect4">
<h5 id="_question">Question:</h5>
<div class="paragraph">
<p>Is it possible to have each of our resellers (using our Isis application) use there own theme/branding with their own logo and colors? Would this also be possible for the login page, possibly depending on the used host name?</p>
</div>
</div>
<div class="sect4">
<h5 id="_answer">Answer:</h5>
<div class="paragraph">
<p>Yes, you can do this, by installing a custom implementation of the Wicket Bootstrap&#8217;s <code>ActiveThemeProvider</code>.</p>
</div>
<div class="paragraph">
<p>The <a href="http://github.com/isisaddons/isis-app-todoapp}">Isis addons' todoapp</a> (non-ASF) actually <a href="https://github.com/isisaddons/isis-app-todoapp/blob/61b8114a8e01dbb3c380b31cf09eaed456407570">does this</a>, storing the info via the <a href="http://github.com/isisaddons/isis-module-settings}">Isis addons' settings module</a> settings modules:</p>
</div>
<div class="listingblock">
<div class="title">IActiveThemeProvider implementation</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">UserSettingsThemeProvider</span> <span class="directive">implements</span> ActiveThemeProvider {
    ...
    <span class="annotation">@Override</span>
    <span class="directive">public</span> ITheme getActiveTheme() {
        <span class="keyword">if</span>(IsisContext.getSpecificationLoader().isInitialized()) {
            <span class="directive">final</span> <span class="predefined-type">String</span> themeName = IsisContext.doInSession(<span class="keyword">new</span> <span class="predefined-type">Callable</span>&lt;<span class="predefined-type">String</span>&gt;() {
                <span class="annotation">@Override</span>
                <span class="directive">public</span> <span class="predefined-type">String</span> call() <span class="directive">throws</span> <span class="exception">Exception</span> {
                    <span class="directive">final</span> <span class="predefined-type">Class</span>&lt;UserSettingsService&gt; serviceClass = UserSettingsService.class;
                    <span class="directive">final</span> UserSettingsService userSettingsService = lookupService(serviceClass);
                    <span class="directive">final</span> UserSetting activeTheme = userSettingsService.find(
                            IsisContext.getAuthenticationSession().getUserName(), ACTIVE_THEME);
                    <span class="keyword">return</span> activeTheme != <span class="predefined-constant">null</span> ? activeTheme.valueAsString() : <span class="predefined-constant">null</span>;
                }
            });
            <span class="keyword">return</span> themeFor(themeName);
        }
        <span class="keyword">return</span> <span class="keyword">new</span> SessionThemeProvider().getActiveTheme();
    }
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> setActiveTheme(<span class="directive">final</span> <span class="predefined-type">String</span> themeName) {
        IsisContext.doInSession(<span class="keyword">new</span> <span class="predefined-type">Runnable</span>() {
            <span class="annotation">@Override</span>
            <span class="directive">public</span> <span class="type">void</span> run() {
                <span class="directive">final</span> <span class="predefined-type">String</span> currentUsrName = IsisContext.getAuthenticationSession().getUserName();
                <span class="directive">final</span> UserSettingsServiceRW userSettingsService =
                        lookupService(UserSettingsServiceRW.class);
                <span class="directive">final</span> UserSettingJdo activeTheme =
                        (UserSettingJdo) userSettingsService.find(currentUsrName, ACTIVE_THEME);
                <span class="keyword">if</span>(activeTheme != <span class="predefined-constant">null</span>) {
                    activeTheme.updateAsString(themeName);
                } <span class="keyword">else</span> {
                    userSettingsService.newString(
                        currentUsrName, ACTIVE_THEME, <span class="string"><span class="delimiter">&quot;</span><span class="content">Active Bootstrap theme for user</span><span class="delimiter">&quot;</span></span>, themeName);
                }
            }
        });
    }
    <span class="directive">private</span> ITheme themeFor(<span class="directive">final</span> <span class="predefined-type">String</span> themeName) {
        <span class="directive">final</span> ThemeProvider themeProvider = settings.getThemeProvider();
        <span class="keyword">if</span>(themeName != <span class="predefined-constant">null</span>) {
            <span class="keyword">for</span> (<span class="directive">final</span> ITheme theme : themeProvider.available()) {
                <span class="keyword">if</span> (themeName.equals(theme.name()))
                    <span class="keyword">return</span> theme;
            }
        }
        <span class="keyword">return</span> themeProvider.defaultTheme();
    }
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>and</p>
</div>
<div class="listingblock">
<div class="title">Using the ActiveThemeProvider</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Override</span>
<span class="directive">protected</span> <span class="type">void</span> init() {
    <span class="local-variable">super</span>.init();

    <span class="directive">final</span> IBootstrapSettings settings = Bootstrap.getSettings();
    settings.setThemeProvider(<span class="keyword">new</span> BootswatchThemeProvider(BootswatchTheme.Flatly));

    settings.setActiveThemeProvider(<span class="keyword">new</span> UserSettingsThemeProvider(settings));
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_suppressing_actions_from_the_ui">3.14.5. Suppressing actions from the UI</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>eg if included an addon such as auditing or security.</p>
</div>
<div class="paragraph">
<p>solution is to write a domain event subscriber that vetoes the visibility</p>
</div>
<div class="paragraph">
<p>All the addons actions inherit from common base classes so this can be as broad-brush or fine-grained as required</p>
</div>
</div>
<div class="sect3">
<h4 id="_enhance_only_intellij">3.14.6. Enhance only (IntelliJ)</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_question_2">Question:</h5>
<div class="paragraph">
<p>Is there a simple way to make a run configuration in IntelliJ for running the datanucleus enhancer before running integration test?</p>
</div>
</div>
<div class="sect4">
<h5 id="_answer_2">Answer:</h5>
<div class="ulist">
<ul>
<li>
<p>Duplicate your run configuration for running the webapp</p>
<div class="ulist">
<ul>
<li>
<p>the one where the main class is <code>org.apache.isis.WebServer</code></p>
</li>
<li>
<p>there&#8217;s a button for this on the run configurations dialog.</p>
</li>
</ul>
</div>
</li>
<li>
<p>then, on your copy change the main class to <code>org.apache.isis.Dummy</code></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_error_handling">3.15. Error Handling</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_raise_message_errors_to_users">3.15.1. Raise message/errors to users</h4>

</div>
<div class="sect3">
<h4 id="_exception_recognizers">3.15.2. Exception Recognizers</h4>

</div>
</div>
<div class="sect2">
<h3 id="_i18n">3.16. i18n</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_multi_tenancy">3.17. Multi-tenancy</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_persistence_lifecycle">3.18. Persistence Lifecycle</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reference">4. Reference</h2>
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_recognized_methods">4.1. Recognized Methods</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_annotations">4.2. Annotations</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_configuration_properties">4.3. Configuration Properties</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
WIP&#8230;&#8203;
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This section lists the configuration properties recognized by Apache Isis.</p>
</div>
<div class="sect3">
<h4 id="_core">4.3.1. Core</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
WIP&#8230;&#8203;
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. Core Configuration Properties</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 16%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Value<br>
(<em>default value</em>)</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.services</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FQCN</code>,<code>FQCN2</code>,&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Fully qualified class names of classes to be instantiated as domain services.  Each entry can be optionally prefixed by "n:" specifying the relative order on the menu (corresponds to <code>@DomainServiceLayout#menuOrder()</code>).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.services.</code><br>
<code>container.disableAutoFlush</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code>,<code><em>false</em></code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Whether the <code>DomainObjectContainer</code> should automatically flush pending changes prior to querying (via <code>allMatches()</code>, <code>firstMatch()</code> and so on).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.persistor.</code><br>
<code>disableConcurrencyChecking</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code>,<code><em>false</em></code></p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Disables concurrency checking globally.  Only intended for "emergency use" as a workaround while pending fix/patch to Isis itself.  (Note that there is no "datanucleus" in the property).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.reflector.facet.</code><br>
<code>cssClassFa.patterns</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">regex:fa-icon,regex2:fa-icon2,&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Comma separated list of key:value pairs, where the key is a regex matching action names (eg <code>create.*</code>) and the value is a <a href="fortawesome.github.io/Font-Awesome/icons/">font-awesome</a> icon name (eg <code>fa-plus</code>) to be applied (as per <code>@CssClassFa()</code>) to all action members matching the regex.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.reflector.facet.</code><br>
<code>cssClass.patterns</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">regex:css1,regex2:css2,&#8230;&#8203;</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Comma separated list of key:value pairs, where the key is a regex matching action names (eg <code>delete.*</code>) and the value is a <a href="http://getbootstrap.com/css/">Bootstrap</a> CSS button class (eg <code>btn-warning) to be applied (as per `@CssClass()</code>) to all action members matching the regex.</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_wicket_viewer">4.3.2. Wicket Viewer</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
WIP&#8230;&#8203;
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These configuration properties are typically stored in <code>WEB-INF/viewer_wicket.properties</code>.  However, you can place all configuration properties into <code>WEB-INF/isis.properties</code> if you wish (the configuration properties from all config files are merged together).</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 3. Wicket Viewer Configuration Properties</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 16%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Value<br>
(<em>default value</em>)</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.viewer.wicket.</code><br>
<code>suppressRememberMe</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code>,<code><em>false</em></code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.viewer.wicket.</code><br>
<code>disableModalDialogs</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code>,<code><em>false</em></code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.viewer.wicket.</code><br>
<code>stripWicketTags</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code>,<code>false</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Whether to force Wicket tags to be stripped. <br>
The default is for them to be stripped in production (Isis' SERVER mode == Wicket DEPLOYMENT mode), but not stripped otherwise (Isis' PROTOTYPE mode == Wicket DEVELOPMENT mode)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.viewer.wicket.</code><br>
<code>bookmarkedPages</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">+ve int (<code><em>15</em></code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">number of pages to bookmark</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.viewer.wicket.</code><br>
<code>regularCase</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code>,<code><em>false</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Ignored for 1.8.0+; in earlier versions forced regular case rather than title case in the UI</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.viewer.wicket.</code> <code>disableDependentChoiceAutoSelection</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>true</code>,<code><em>false</em></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For dependent choices, whether to automatically select the first dependent (eg subcategory) when the parameter on which it depends (category) changes.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_restfulobjects_viewer">4.3.3. RestfulObjects Viewer</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
WIP&#8230;&#8203;
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These configuration properties are typically stored in <code>WEB-INF/viewer_restfulobjects.properties</code>.  However, you can place all configuration properties into <code>WEB-INF/isis.properties</code> if you wish (the configuration properties from all config files are merged together).</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 4. RestfulObjects Viewer Configuration Properties</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 16%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Value<br>
(<em>default value</em>)</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
</table>
</div>
<div class="sect3">
<h4 id="_jdo_datanucleus_objectstore">4.3.4. JDO/Datanucleus Objectstore</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
WIP&#8230;&#8203;
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>These configuration properties are typically stored in <code>WEB-INF/persistor_datanucleus.properties</code>.  However, you can place all configuration properties into <code>WEB-INF/isis.properties</code> if you wish (the configuration properties from all config files are merged together).</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 5. JDO/DataNucleus Objectstore Configuration Properties</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 16%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Value<br>
(<em>default value</em>)</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.persistor.datanucleus.</code><br>
<code>impl.*</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Passed through directly to Datanucleus (with <code>isis.persistor.datanucleus.impl</code> prefix stripped)</p>
</div>
<div class="literalblock">
<div class="content">
<pre>// run-in memory
addDataNucleusProperty("javax.jdo.option.ConnectionURL", "jdbc:hsqldb:mem:test");
addDataNucleusProperty("javax.jdo.option.ConnectionDriverName", "org.hsqldb.jdbcDriver");
addDataNucleusProperty("javax.jdo.option.ConnectionUserName", "sa");
addDataNucleusProperty("javax.jdo.option.ConnectionPassword", "");</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>// Don't do validations that consume setup time.
addDataNucleusProperty(PropertyNames.PROPERTY_SCHEMA_AUTOCREATE_ALL, "true");
addDataNucleusProperty(PropertyNames.PROPERTY_SCHEMA_VALIDATE_ALL, "false");</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>// other properties as per WEB-INF/persistor_datanucleus.properties
addDataNucleusProperty("datanucleus.persistenceByReachabilityAtCommit", "false");
addDataNucleusProperty("datanucleus.identifier.case", "MixedCase");
addDataNucleusProperty("datanucleus.cache.level2.type","none");
addDataNucleusProperty("datanucleus.cache.level2.mode","ENABLE_SELECTIVE");</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>// automatically install any fixtures that might have been registered
add(DataNucleusObjectStore.INSTALL_FIXTURES_KEY , "true");</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>add(PersistenceConstants.ENFORCE_SAFE_SEMANTICS, ""+PersistenceConstants.ENFORCE_SAFE_SEMANTICS_DEFAULT);</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>add("isis.deploymentType", "server_prototype");</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.persistor.datanucleus.impl</code><br>
`.datanucleus.persistenceByReachabilityAtCommit</p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>We recommend this setting is disabled. <br>
Further <a href="#_disabling_persistence_by_reachability">discussion below</a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.persistor.datanucleus.</code><br>
<code>RegisterEntities.packagePrefix</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fully qualified package names (CSV)</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>of class names; specifies the entities early rather than allow DataNucleus to find the entities lazily.  Strongly recommended (subtle issues can sometimes arise if lazy discovery is used).
Further <a href="#_registering_entity_types">discussion below</a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.persistor.datanucleus.</code><br>
<code>PublishingService.serializedForm</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">zipped</p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
</tbody>
</table>
<div class="sect4">
<h5 id="_disabling_persistence_by_reachability">Disabling Persistence by Reachability</h5>
<div class="paragraph">
<p>By default, JDO/DataNucleus supports the concept of <a href="http://www.datanucleus.org/products/datanucleus/jdo/orm/cascading.html">persistence-by-reachability</a>. That is, if
a non-persistent entity is associated with an already-persistent entity, then DataNucleus will detect this and will automatically persist the associated object. Put another way: there is no need to call Isis' <code>DomainObjectContainer#persist(.)</code> or <code>DomainObjectContainer#persistIfNotAlready(.)</code> methods.</p>
</div>
<div class="paragraph">
<p>However, convenient though this feature is, you may find that it causes performance issues.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>DataNucleus' persistence-by-reachability may cause performance issues.  We strongly recommend that you disable it.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>One scenario in particular where this performance issues can arise is if your entities implement the <code>java.lang.Comparable</code> interface, and you have used Isis' <a href="../../../reference/Utility.html">ObjectContracts</a> utility. The issue here is that <code>ObjectContracts</code> implementation can cause DataNucleus to recursively rehydrate a larger number of associated entities. (More detail below).</p>
</div>
<div class="paragraph">
<p>We therefore recommend that you disable persistence-by-reachability by adding the following to <code>persistor_datanucleus.properties</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ini">isis.persistor.datanucleus.impl.datanucleus.persistenceByReachabilityAtCommit=false</code></pre>
</div>
</div>
<div class="paragraph">
<p>This change has been made to the <a href="#_simpleapp_archetype">SimpleApp Archetype</a></p>
</div>
<div class="paragraph">
<p>If you do disable this feature, then you will (of course) need to ensure that you explicitly persist all entities using the <code>DomainObjectContainer#persist(.)</code> or <code>DomainObjectContainer#persistIfNotAlready(.)</code> methods.</p>
</div>
<div class="sect5">
<h6 id="_explanation_of_the_issue_in_more_detail">Explanation of the issue in more detail</h6>
<div class="paragraph">
<p>Consider the entities:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/reference/configuration-properties/datanucleus-objectstore/party-agreementrole-agreement.png" alt="party agreementrole agreement" width="750px">
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="listingblock">
<div class="title">DSL (<a href="http://yuml.me/edit/b8681268">yuml.me/b8681268</a>)</div>
<div class="content">
<pre class="CodeRay highlight"><code>[Party|reference]&lt;---&gt;*[AgreementRole|startDate]
[AgreementRole]*&lt;--&gt;[Agreement|reference]</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In the course of a transaction, the <code>Agreement</code> entity is loaded into memory (not necessarily modified), and then new <code>AgreementRole</code>s are associated to it.</p>
</div>
<div class="paragraph">
<p>All these entities implement <code>Comparable</code> using <code>ObjectContracts</code>, and the implementation of <code>AgreementRole</code>'s (simplified) is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">AgreementRole</span> {
    ...
    public <span class="type">int</span> compareTo(AgreementRole other) {
        <span class="keyword">return</span> ObjectContracts.compareTo(<span class="local-variable">this</span>, other, <span class="string"><span class="delimiter">&quot;</span><span class="content">agreement</span><span class="delimiter">&quot;</span></span>,<span class="string"><span class="delimiter">&quot;</span><span class="content">startDate</span><span class="delimiter">&quot;</span></span>,<span class="string"><span class="delimiter">&quot;</span><span class="content">party</span><span class="delimiter">&quot;</span></span>);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>while <code>Agreement</code>'s is implemented as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Agreement</span> {
    ...
    public <span class="type">int</span> compareTo(Agreement other) {
        <span class="keyword">return</span> ObjectContracts.compareTo(<span class="local-variable">this</span>, other, <span class="string"><span class="delimiter">&quot;</span><span class="content">reference</span><span class="delimiter">&quot;</span></span>);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>and <code>Party</code>'s is similarly implemented as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Party</span> {
    ...
    public <span class="type">int</span> compareTo(Party other) {
        <span class="keyword">return</span> ObjectContracts.compareTo(<span class="local-variable">this</span>, other, <span class="string"><span class="delimiter">&quot;</span><span class="content">reference</span><span class="delimiter">&quot;</span></span>);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>DataNucleus&#8217;s persistence-by-reachability algorithm adds the <code>AgreementRole</code> instances into a <code>SortedSet</code>, which causes <code>AgreementRole#compareTo()</code> to fire:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the evaluation of the "agreement" property delegates back to the <code>Agreement</code>, whose own <code>Agreement#compareTo()</code> uses the scalar <code>reference</code> property. As the <code>Agreement</code> is already in-memory, this does not trigger any further database queries</p>
</li>
<li>
<p>the evaluation of the "startDate" property is just a scalar property of the <code>AgreementRole</code>, so will already in-memory</p>
</li>
<li>
<p>the evaluation of the "party" property delegates back to the <code>Party</code>, whose own <code>Party#compareTo()</code> requires the uses the scalar <code>reference</code> property. However, since the <code>Party</code> is not yet in-memory, using the <code>reference</code> property triggers a database query to "rehydrate" the <code>Party</code> instance.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In other words, in figuring out whether <code>AgreementRole</code> requires the persistence-by-reachability algorithm to run, it causes the adjacent associated entity <code>Party</code> to also be retrieved.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_eagerly_registering_entity_types">Eagerly Registering Entity Types</h5>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>From 1.6.0+ this feature may be (partly?) broken; see <a href="https://issues.apache.org/jira/browse/ISIS-847">ISIS-847</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Both Apache Isis and DataNucleus have their own metamodels of the domain entities. Isis builds its metamodel by walking the graph of types from the services registered using <code>@DomainService</code> or explicitly registered in <code>isis.properties</code>. The JDO objectstore then takes these types and registers them with DataNucleus.</p>
</div>
<div class="paragraph">
<p>In some cases, though, not every entity type is discoverable from the API of the service actions. This is especially the case if you have lots of subtypes (where the action method specifies only the supertype). In such cases the Isis and JDO metamodels is built lazily, when an instance of that (sub)type is first encountered.</p>
</div>
<div class="paragraph">
<p>Isis is quite happy for the metamodel to be lazily created, and - to be fair - DataNucleus also works well in most cases. In some cases, though, we have found that the JDBC driver (eg HSQLDB) will deadlock if DataNucleus tries to submit some DDL (for a lazily discovered type) intermingled with DML (for updating).</p>
</div>
<div class="paragraph">
<p>In any case, it&#8217;s probably not good practice to have DataNucleus work this way. The <code>RegisterEntities</code> service can therefore be registered in order to do the eager registration. It searches for all <code>@PersistenceCapable</code> entities under specified package(s), and registers them all.</p>
</div>
<div class="sect5">
<h6 id="_specify_the_package_prefix_es">Specify the Package Prefix(es)</h6>
<div class="paragraph">
<p>In the <code>persistor_datanucleus.properties</code>, specify the package prefix(es) of your application, to provide a hint for finding the <code>@PersistenceCapable</code> classes.</p>
</div>
<div class="paragraph">
<p>The value of this property can be a comma-separated list (if there is more than one package or Maven module that holds persistable entities).</p>
</div>
</div>
<div class="sect5">
<h6 id="_integration_testing">Integration Testing</h6>
<div class="paragraph">
<p>The <code>IsisConfigurationForJdoIntegTests</code>, recommended for use in <a href="#_integration_testing">Integration Testing</a> provides the <code>#addRegisterEntitiesPackagePrefix()</code> method to set up this configuration property:</p>
</div>
<div class="listingblock">
<div class="title">Integration test bootstrapping</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">private</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">SimpleAppSystemBuilder</span> <span class="directive">extends</span> IsisSystemForTest.Builder {
    ...
    private <span class="directive">static</span> IsisConfiguration testConfiguration() {
        <span class="directive">final</span> IsisConfigurationForJdoIntegTests testConfiguration = <span class="keyword">new</span> IsisConfigurationForJdoIntegTests();
        testConfiguration.addRegisterEntitiesPackagePrefix(<span class="string"><span class="delimiter">&quot;</span><span class="content">domainapp.dom.modules</span><span class="delimiter">&quot;</span></span>); <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="keyword">return</span> testConfiguration;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>specify the package prefix(es) for integration testing.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_domain_services_3">4.4. Domain Services</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_action_invocation_context">4.4.1. Action Invocation Context</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_auditing_service">4.4.2. Auditing Service</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_isis_addons_implementation">Isis Addons Implementation</h5>
<div class="paragraph">
<p>For 1.7.0+, see the <a href="http://github.com/isisaddons/isis-module-audit">Isis addons' Audit module</a> (non-ASF).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_background_command_1service">4.4.3. Background Command 1Service</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_isis_addons_implementation_2">Isis Addons Implementation</h5>
<div class="paragraph">
<p>For 1.7.0+, see the <a href="http://github.com/isisaddons/isis-module-command">Isis addons' Command module</a> (non-ASF).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_background_service">4.4.4. Background Service</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_bookmark_service">4.4.5. Bookmark Service</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_clock_service">4.4.6. Clock Service</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_command_context">4.4.7. Command Context</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_command_service">4.4.8. Command Service</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_isis_addons_implementation_3">Isis Addons Implementation</h5>
<div class="paragraph">
<p>For 1.7.0+, see the <a href="http://github.com/isisaddons/isis-module-command">Isis addons' Command module</a> (non-ASF).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_deep_link_service">4.4.9. Deep Link Service</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_domain_object_container">4.4.10. Domain Object Container</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_email_notification_service">4.4.11. Email Notification Service</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_email_service">4.4.12. Email Service</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_event_bus_service">4.4.13. Event Bus Service</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_implementation">Implementation</h5>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_registration">Registration</h5>
<div class="paragraph">
<p>The <code>EventBusServiceJdo</code> class provides the default implementation and (as of 1.6.0+) is automatically registered using <code>@DomainService</code>.  No further configuration is necessary.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_exception_recognizer">4.4.14. Exception Recognizer</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_isis_jdo_support">4.4.15. Isis JDO Support</h4>
<div class="paragraph">
<p>The <code>IsisJdoSupport</code> service provides a number of general purpose methods for working with the JDO/DataNucleus objectstore.</p>
</div>
<div class="sect4">
<h5 id="_api">API</h5>
<div class="paragraph">
<p>The API provided by <code>IsisJdoSupport</code> is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">IsisJdoSupport</span> {
    <span class="predefined-type">List</span>&lt;<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt;&gt; executeSql(<span class="predefined-type">String</span> sql);
    <span class="predefined-type">Integer</span> executeUpdate(<span class="predefined-type">String</span> sql);
    <span class="type">void</span> deleteAll(<span class="predefined-type">Class</span>&lt;?&gt;... pcClasses);
    &lt;T&gt; T refresh(T domainObject);
    <span class="type">void</span> ensureLoaded(<span class="predefined-type">Collection</span>&lt;?&gt; collectionOfDomainObjects);
    PersistenceManager getJdoPersistenceManager();
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Each of these methods are discussed in more details below.</p>
</div>
</div>
<div class="sect4">
<h5 id="_executing_arbitrary_sql">Executing arbitrary SQL</h5>
<div class="paragraph">
<p>The <code>executeSql(&#8230;&#8203;)</code> method allows arbitrary queries to be submitted:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="predefined-type">List</span>&lt;<span class="predefined-type">Map</span>&lt;<span class="predefined-type">String</span>, <span class="predefined-type">Object</span>&gt;&gt; results = isisJdoSupport.executeSql(<span class="string"><span class="delimiter">&quot;</span><span class="content">select * from custMgmt.customers</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result set is automatically converted into a list of maps, where the map key is the column name.</p>
</div>
<div class="paragraph">
<p>In a similar manner, the <code>executeUpdate(&#8230;&#8203;)</code> allows arbitrary updates to be performed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="type">int</span> count = isisJdoSupport.executeUpdate(<span class="string"><span class="delimiter">&quot;</span><span class="content">select count(*) from custMgmt.customers);</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The returned value is the number of rows updated.</p>
</div>
</div>
<div class="sect4">
<h5 id="_fixture_support">Fixture support</h5>
<div class="paragraph">
<p>The <code>deleteAll(&#8230;&#8203;)</code> method is provided pretty much exclusively for tearing down fixture data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">deleteAll(Order.class);
deleteAll(CustomerAddress.class);
deleteAll(Customer.class);</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It can occasionally be the case that Isis' internal adapter for the domain object is
still in memory.  JDO/DataNucleus seems to bump up the version of the object prior to its deletion,
which under normal circumstances would cause Isis to throw a concurrency exception.  Therefore
to prevent this from happening (ie to &lt;i&gt;force&lt;/i&gt; the deletion of all instances), concurrency checking
is temporarily disabled while this method is performed.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_reloading_entities">Reloading entities</h5>
<div class="paragraph">
<p>A <a href="http://www.datanucleus.org/products/datanucleus/jdo/orm/relationships.html">known limitation</a> of DataNucleus' implementation of JDO is that persisting a child entity (in a 1:n bidirectional relationship) does not cause the parent&#8217;s collection to be updated.</p>
</div>
<div class="paragraph">
<p>The <code>refresh(T domainObject)</code> method can be used to reload the parent object (or indeed any object).</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> Order newOrder(<span class="directive">final</span> Customer customer) {
    Order order = newTransientInstance(Order.class);
    order.setCustomer(customer);
    persist(customer);
    getContainer().flush(); <i class="conum" data-value="1"></i><b>(1)</b>
    isisJdoSupport.refresh(customer); <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="keyword">return</span> order;
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>flush to database</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>reload parent from database</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The particular example that led to this method being added was a 1:m bidirectional relationship,
analogous to <code>Customer &lt;&#8594; * Order</code>.  Persisting the child <code>Order</code> object did not cause
the parent <code>Customer</code>'s collection of orders to be updated.  In fact, JDO does not make any
such guarantee to do so.  Options are therefore either to maintain the collection in code, or to
refresh the parent.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="_using_jdo_code_persistencemanager_code_directly">Using JDO <code>PersistenceManager</code> directly</h5>
<div class="paragraph">
<p>Apache Isis provides a simplified API on top of only supports JDO, and so does not support all of JDO&#8217;s features.  For example, Isis (currently) only supports named queries.  If you require more flexibility than this, eg for dynamically constructed queries, then the service provides access to the underlying JDO <code>PersistenceManager</code> API:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="predefined-type">List</span>&lt;Order&gt; findOrders(...) {
    javax.jdo.PersistenceManager pm = isisJdoSupport.getPersistenceManager();

    <span class="comment">// knock yourself out...</span>

    <span class="keyword">return</span> someListOfOrders;
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_registering_the_service">Registering the Service</h5>
<div class="paragraph">
<p>The <code>IsisJdoSupportImpl</code> class provides the default implementation and (as of 1.6.0+) is automatically registered using <code>@DomainService</code>.  No further configuration is necessary.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_memento_service">4.4.16. Memento Service</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_publishing_service">4.4.17. Publishing Service</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_isis_addons_implementation_4">Isis Addons Implementation</h5>
<div class="paragraph">
<p>For 1.7.0+, see the <a href="http://github.com/isisaddons/isis-module-publishing">Isis addons' Publishing module</a> (non-ASF).</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_query_results_cache">4.4.18. Query Results Cache</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_scratch_pad">4.4.19. Scratch Pad</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_settings_service">4.4.20. Settings Service</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>This service (both its API and implementation) are entirely independent of Apache Isis, being part of the <a href="http://github.com/isisaddons/isis-module-settings}">Isis addons' Settings module</a> (non-ASF).  The service is documented here for your convenience.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_application_settings">Application Settings</h5>
<div class="sect5">
<h6 id="_api_2">API</h6>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="_implementation_2">Implementation</h6>
<div class="paragraph">
<p>In the case of <code>ApplicationSettingsService</code>, the service is implemented by <code>ApplicationSettingsServiceJdo</code>, with the <code>ApplicationSetting</code> interface implemented by a <code>ApplicationSettingsJdo</code> entity.</p>
</div>
<div class="paragraph">
<p>The service also provides the ability to create list all existing settings, create new settings (of whichever datatype), update settings, and to delete settings.</p>
</div>
<div class="paragraph">
<p>These actions can be hidden using security if need be.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_user_settings">User Settings</h5>
<div class="sect5">
<h6 id="_api_3">API</h6>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="_implementation_3">Implementation</h6>
<div class="paragraph">
<p>In the case of <code>UserSettingsService</code>, the service is implemented by <code>UserSettingsServiceJdo</code>, with the <code>UserSetting</code> interface implemented by a <code>UserSettingsJdo</code> entity.</p>
</div>
<div class="paragraph">
<p>As for application settings, the user settings service also provides the ability to create list all existing settings, create new settings (of whichever datatype), update settings, and to delete settings.</p>
</div>
<div class="paragraph">
<p>These actions can be hidden using security if need be.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_registration_and_configuration">Registration and Configuration</h5>
<div class="paragraph">
<p>The <code>ApplicationSettingsServiceJdo</code> class and <code>UserSettingsServiceJdo</code> are annotated with <code>@DomainService</code> and so are automatically registered with the framework, with actions appearing on the secondary menu bar.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO - screenshot of settings menu
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>All actions from the services emit domain events.  If you wish to hide/disable these default actions in your application, we recommend using up a subscriber on the actions' domain events to veto their visibility/usability.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_user_profile_service_spi">4.4.21. User Profile Service (SPI)</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_user_registration_service_spi">4.4.22. User Registration Service (SPI)</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_wrapper_factory">4.4.23. Wrapper Factory</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_xml_snapshot_service">4.4.24. XML Snapshot Service</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_value_types">4.5. Value Types</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_jdk">4.5.1. JDK</h4>

</div>
<div class="sect3">
<h4 id="_jodatime">4.5.2. JodaTime</h4>

</div>
<div class="sect3">
<h4 id="_isis_applib">4.5.3. Isis Applib</h4>

</div>
</div>
<div class="sect2">
<h3 id="_applib_utility_classes">4.6. Applib Utility Classes</h3>
<div class="paragraph">
<p>The <code>org.apache.isis.applib.util</code> package has a number of simple utility
classes designed to simplify the coding of some common tasks.</p>
</div>
<div class="sect3">
<h4 id="_title_creation">4.6.1. Title creation</h4>
<div class="paragraph">
<p>The <code>TitleBuffer</code> utility class is intended to make it easy to construct
title strings (returned from the <code>title()</code> method). For example, it has
overloaded versions of methods called <code>append()</code> and <code>concat()</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_reason_text_creation_for_disable_and_validate_methods">4.6.2. Reason text creation (for disable and validate methods)</h4>
<div class="paragraph">
<p>There are two different classes provided to help build reasons returned
by <code>disableXxX()</code> and <code>validateXxx()</code> methods:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the <code>org.apache.isis.applib.util.ReasonBuffer</code> helper class</p>
</li>
<li>
<p>the <code>org.apache.isis.applib.util.Reasons</code> helper class</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> {
    ...
    public <span class="predefined-type">String</span> validatePlaceOrder(Product p, <span class="type">int</span> quantity) {
        <span class="keyword">return</span> Reasons.coalesce(
            whetherCustomerBlacklisted(<span class="local-variable">this</span>),
            whetherProductOutOfStock(p)
        );
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Which you use (if any) is up to you.</p>
</div>
</div>
<div class="sect3">
<h4 id="_objectcontracts">4.6.3. ObjectContracts</h4>
<div class="paragraph">
<p>The <code>ObjectContracts</code> test provides a series of methods to make it easy for your domain objects to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>implement <code>Comparable</code> (eg so can be stored in <code>java.util.SortedSet</code>s)</p>
</li>
<li>
<p>implement <code>toString()</code></p>
</li>
<li>
<p>implement <code>equals()</code></p>
</li>
<li>
<p>implement <code>hashCode()</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">ToDoItem</span> <span class="directive">implements</span> <span class="predefined-type">Comparable</span>&lt;ToDoItem&gt; {

    <span class="directive">public</span> <span class="type">boolean</span> isComplete() { ... }
    <span class="directive">public</span> LocalDate getDueBy() { ... }
    <span class="directive">public</span> <span class="predefined-type">String</span> getDescription() { ... }
    <span class="directive">public</span> <span class="predefined-type">String</span> getOwnedBy() { ... }

    <span class="directive">public</span> <span class="type">int</span> compareTo(<span class="directive">final</span> ToDoItem other) {
        <span class="keyword">return</span> ObjectContracts.compare(<span class="local-variable">this</span>, other, <span class="string"><span class="delimiter">&quot;</span><span class="content">complete</span><span class="delimiter">&quot;</span></span>,<span class="string"><span class="delimiter">&quot;</span><span class="content">dueBy</span><span class="delimiter">&quot;</span></span>,<span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span>);
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> toString() {
        <span class="keyword">return</span> ObjectContracts.toString(<span class="local-variable">this</span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">description</span><span class="delimiter">&quot;</span></span>,<span class="string"><span class="delimiter">&quot;</span><span class="content">complete</span><span class="delimiter">&quot;</span></span>,<span class="string"><span class="delimiter">&quot;</span><span class="content">dueBy</span><span class="delimiter">&quot;</span></span>,<span class="string"><span class="delimiter">&quot;</span><span class="content">ownedBy</span><span class="delimiter">&quot;</span></span>);
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Note that <code>ObjectContracts</code> makes heavy use of Java Reflection.  While it&#8217;s great to get going quickly in prototyping, we recommend you use your IDE to code generate implementations of these methods for production code.</p>
</div>
<div class="paragraph">
<p>Moreover (and perhaps even more importantly) <code>ObjectContracts</code> implementation can cause DataNucleus to recursively rehydrate a larger number of associated entities (More detail below).</p>
</div>
<div class="paragraph">
<p>We therefore recommend that you disable persistence-by-reachability by adding:</p>
</div>
<div class="listingblock">
<div class="title">persistor_datanucleus.properties</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ini">#
# Require explicit persistence (since entities are Comparable and using ObjectContracts#compareTo).
#
isis.persistor.datanucleus.impl.datanucleus.persistenceByReachabilityAtCommit=false</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_explanation_of_the_issue_in_more_detail_2">Explanation of the issue in more detail</h5>
<div class="paragraph">
<p>Consider the entities:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Party &lt;-&gt;* AgreementRole &lt;*-&gt; Agreement</pre>
</div>
</div>
<div class="paragraph">
<p>In the course of a transaction, the <code>Agreement</code> entity is loaded into memory (not necessarily modified), and then new <code>AgreementRole</code>s are associated to it.</p>
</div>
<div class="paragraph">
<p>All these entities implement <code>Comparable</code> using <code>ObjectContracts</code>, so that the implementation of <code>AgreementRole</code>'s (simplified) is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">AgreementRole</span> {
    ...
    public <span class="type">int</span> compareTo(AgreementRole other) {
        <span class="keyword">return</span> ObjectContracts.compareTo(<span class="local-variable">this</span>, other, <span class="string"><span class="delimiter">&quot;</span><span class="content">agreement</span><span class="delimiter">&quot;</span></span>,<span class="string"><span class="delimiter">&quot;</span><span class="content">startDate</span><span class="delimiter">&quot;</span></span>,<span class="string"><span class="delimiter">&quot;</span><span class="content">party</span><span class="delimiter">&quot;</span></span>);
    }
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>while <code>Agreement</code>'s is implemented as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">    <span class="directive">public</span> <span class="type">class</span> <span class="class">Agreement</span> {
        ...
        public <span class="type">int</span> compareTo(Agreement other) {
            <span class="keyword">return</span> ObjectContracts.compareTo(<span class="local-variable">this</span>, other, <span class="string"><span class="delimiter">&quot;</span><span class="content">reference</span><span class="delimiter">&quot;</span></span>);
        }
        ...
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>and <code>Party</code>'s is similarly implemented as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Party</span> {
    ...
    public <span class="type">int</span> compareTo(Party other) {
        <span class="keyword">return</span> ObjectContracts.compareTo(<span class="local-variable">this</span>, other, <span class="string"><span class="delimiter">&quot;</span><span class="content">reference</span><span class="delimiter">&quot;</span></span>);
    }
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>DataNucleus&#8217;s persistence-by-reachability algorithm adds the <code>AgreementRole</code>s into a <code>SortedSet</code>, which causes <code>AgreementRole#compareTo()</code> to fire:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the evaluation of the "agreement" property delegates back to the <code>Agreement</code>, whose own <code>Agreement#compareTo()</code> uses the scalar <code>reference</code> property.  As the <code>Agreement</code> is already in-memory, this does not trigger any further database queries</p>
</li>
<li>
<p>the evaluation of the "startDate" property is just a scalar property of the <code>AgreementRole</code>, so will already in-memory</p>
</li>
<li>
<p>the evaluation of the "party" property delegates back to the <code>Party</code>, whose own <code>Party#compareTo()</code> requires the uses the scalar <code>reference</code> property.  However, since the <code>Party</code> is not yet in-memory, using the <code>reference</code> property triggers a database query to "rehydrate" the <code>Party</code> instance.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In other words, figuring out whether <code>AgreementRole</code> is comparable requires the persistence-by-reachability algorithm to run, causing the adjacent associated entity <code>Party</code> to also be retrieved.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_convenience_superclasses">4.7. Convenience Superclasses</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_command_line_arguments">4.8. Command Line Arguments</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="__code_org_apache_isis_webserver_code">4.8.1. <code>org.apache.isis.WebServer</code></h4>
<div class="paragraph">
<p>For example:
* <code>--fixture</code>
* <code>--services</code></p>
</div>
<div class="paragraph">
<p>etc&#8230;&#8203;</p>
</div>
</div>
<div class="sect3">
<h4 id="_recommended_jvm_flags">4.8.2. Recommended JVM Flags</h4>
<div class="paragraph">
<p>for the <code>WrapperFactory</code> (uses <a href="http://www.csg.ci.i.u-tokyo.ac.jp/~chiba/javassist/">Javassist</a>)</p>
</div>
<div class="paragraph">
<p>using:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code>-XX:+CMSClassUnloadingEnabled -XX:+UseConcMarkSweepGC</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can hint the JVM to unload dynamically created classes which ClassLoaders are still around.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_web_xml_configuration">4.9. web.xml Configuration</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_decoupling">5. Decoupling</h2>
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This chapter describes how to use Isis' features to ensure that your domain application remains decoupled.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>event bus</p>
</li>
<li>
<p>contributed actions/properties/collections</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing">6. Testing</h2>
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_unit_test_support">6.1. Unit Test Support</h3>
<div class="paragraph">
<p>Isis Core provides a number of unit test helpers for you to use (if you wish) to test your domain objects.  To use, update the <code>pom.xml</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.apache.isis.core<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>isis-core-unittestsupport<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
<span class="tag">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Normally <code>test</code>; usual Maven scoping rules apply.</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="__code_sortedset_code_s_contract_test">6.1.1. <code>SortedSet</code>s Contract Test</h4>
<div class="paragraph">
<p>This contract test automatically checks that all fields of type <code>java.util.Collection</code> are declared as <code>java.util.SortedSet</code>. In other words, it precludes either <code>java.util.List</code> or <code>java.util.Set</code> from being used as a collection.</p>
</div>
<div class="paragraph">
<p>For example, the following passes the contract test:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Department</span> {
    <span class="directive">private</span> <span class="predefined-type">SortedSet</span>&lt;Employee&gt; employees = <span class="keyword">new</span> <span class="predefined-type">TreeSet</span>&lt;Employee&gt;();
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>whereas this would not:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">SomeDomainObject</span> {
    <span class="directive">private</span> <span class="predefined-type">List</span>&lt;Employee&gt; employees = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;Employee&gt;();
    ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If using the JDO/DataNucleus Objectstore then we strongly recommend that you implement this test, for several reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>First, <code>Set</code>s align more closely to the relational model than do <code>List`s. A `List</code> must have an additional index to specify order.</p>
</li>
<li>
<p>Second, <code>SortedSet</code> is preferable to <code>Set</code> because then the order is well-defined and predictable (to an end user, to the programmer).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The <a href="#_objectcontracts">ObjectContracts</a> utility class substantially simplifies the task of implementing <code>Comparable</code> in your domain classes.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Third, if the relationship is bidirectional then JDO/Objectstore will automatically maintain the relationship. See <a href="../components/objectstores/jdo/managed-1-to-m-relationships.html">here</a> for further discussion.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To use the contract test, subclass <code>SortedSetsContractTestAbstract</code>, specifying the root package to search for domain classes.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">SortedSetsContractTestAll</span> <span class="directive">extends</span> SortedSetsContractTestAbstract {

    <span class="directive">public</span> SortedSetsContractTestAll() {
        <span class="local-variable">super</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.estatio.dom</span><span class="delimiter">&quot;</span></span>);
        withLoggingTo(<span class="predefined-type">System</span>.out);
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_injected_services_method_contract_test">6.1.2. Injected Services Method Contract Test</h4>
<div class="paragraph">
<p>It is quite common for some basic services to be injected in a project-specific domain object superclass; for example a <code>ClockService</code> might generally be injected everywhere:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">abstract</span> <span class="type">class</span> <span class="class">EstatioDomainObject</span> {
    <span class="directive">protected</span> ClockService clockService;
    <span class="directive">public</span> <span class="type">void</span> injectClockService(ClockService clockService) {
        <span class="local-variable">this</span>.clockService = clockService;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>If a subclass inadvertantly overrides this method and provides its own <code>ClockService</code> field, then the field in the superclass will never initialized. As you might imagine, <code>NullPointerException</code>s could then arise.</p>
</div>
<div class="paragraph">
<p>This contract test automatically checks that the <code>injectXxx(&#8230;&#8203;)</code> method, to allow for injected services, is not overridable, ie <code>final</code>.</p>
</div>
<div class="paragraph">
<p>To use the contract test, , subclass <code>SortedSetsContractTestAbstract</code>, specifying the root package to search for domain classes.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">InjectServiceMethodMustBeFinalContractTestAll</span> <span class="directive">extends</span> InjectServiceMethodMustBeFinalContractTestAbstract {

    <span class="directive">public</span> InjectServiceMethodMustBeFinalContractTestAll() {
        <span class="local-variable">super</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.estatio.dom</span><span class="delimiter">&quot;</span></span>);
        withLoggingTo(<span class="predefined-type">System</span>.out);
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_bidirectional_contract_test">6.1.3. Bidirectional Contract Test</h4>
<div class="paragraph">
<p>This contract test automatically checks that bidirectional 1:m or 1:1 associations are being maintained correctly (assuming that they follow the <a href="../more-advanced-topics/how-to-04-060-How-to-set-up-and-maintain-bidirectional-relationships.html">mutual registration pattern</a></p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
If using the <a href="../components/objectstores/jdo/about.html">JDO Object Store</a>, then there is generally no need to programmatically maintain 1:m relationships (indeed it may introduce subtle errors). For more details, see <a href="../components/objectstores/jdo/managed-1-to-m-relationships.html">here</a>. Check out the <a href="../intro/resources/editor-templates.html">Eclipse templates</a> for further guidance.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, suppose that <code>ParentDomainObject</code> and <code>ChildDomainObject</code> have a 1:m relationship (<code>ParentDomainObject#children</code> / <code>ChildDomainObject#parent</code>), and also <code>PeerDomainObject</code> has a 1:1 relationship with itself (<code>PeerDomainObject#next</code> / <code>PeerDomainObject#previous</code>).</p>
</div>
<div class="paragraph">
<p>The following will exercise these relationships:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">BidirectionalRelationshipContractTestAll</span>
        <span class="directive">extends</span> BidirectionalRelationshipContractTestAbstract {

    <span class="directive">public</span> BidirectionalRelationshipContractTestAll() {
        <span class="local-variable">super</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">org.apache.isis.core.unittestsupport.bidir</span><span class="delimiter">&quot;</span></span>,
                ImmutableMap.&lt;<span class="predefined-type">Class</span>&lt;?&gt;,Instantiator&gt;of(
                    ChildDomainObject.class, <span class="keyword">new</span> InstantiatorForChildDomainObject(),
                    PeerDomainObject.class, <span class="keyword">new</span> InstantiatorSimple(PeerDomainObjectForTesting.class)
                ));
        withLoggingTo(<span class="predefined-type">System</span>.out);
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The first argument to the constructor scopes the search for domain objects; usually this would be something like <code>&quot;com.mycompany.dom&quot;</code>.</p>
</div>
<div class="paragraph">
<p>The second argument provides a map of <code>Instantiator</code> for certain of the domain object types. This has two main purposes. First, for abstract classes, it nominates an alternative concrete class to be instantiated. Second, for classes (such as <code>ChildDomainObject</code>) that are <code>Comparable</code> and are held in a <code>SortedSet</code>), it provides the ability to ensure that different instances are unique when compared against each other. If no <code>Instantiator</code> is provided, then the contract test simply attempts to instantiates the class.</p>
</div>
<div class="paragraph">
<p>If any of the supporting methods (<code>addToXxx()</code>, <code>removeFromXxx()</code>, <code>modifyXxx()</code> or <code>clearXxx()</code>) are missing, the relationship is skipped.</p>
</div>
<div class="paragraph">
<p>To see what&#8217;s going on (and to identify any skipped relationships), use the <code>withLoggingTo()</code> method call. If any assertion fails then the error should be descriptive enough to figure out the problem (without enabling logging).</p>
</div>
<div class="paragraph">
<p>The example tests can be found <a href="https://github.com/apache/isis/tree/master/core/unittestsupport/src/test/java/org/apache/isis/core/unittestsupport/bidir">here</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_jmock_extensions">6.1.4. JMock Extensions</h4>
<div class="paragraph">
<p><code>JUnitRuleMockery2</code> is an extension to the JMock&#8217;s <code>JunitRuleMockery</code>, providing a simpler API and also providing support for autowiring.</p>
</div>
<div class="paragraph">
<p>For example, here we see that the class under test, an instance of <code>CollaboratingUsingSetterInjection</code>, is automatically wired up with its <code>Collaborator</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">JUnitRuleMockery2Test_autoWiring_setterInjection_happyCase</span> {

    <span class="annotation">@Rule</span>
    <span class="directive">public</span> JUnitRuleMockery2 context = JUnitRuleMockery2.createFor(Mode.INTERFACES_AND_CLASSES);

    <span class="annotation">@Mock</span>
    <span class="directive">private</span> Collaborator collaborator;

    <span class="annotation">@ClassUnderTest</span>
    <span class="directive">private</span> CollaboratingUsingSetterInjection collaborating;

    <span class="annotation">@Test</span>
    <span class="directive">public</span> <span class="type">void</span> wiring() {
        assertThat(collaborating.collaborator, is(not(nullValue())));
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The example tests can be found <a href="https://github.com/apache/isis/tree/master/core/unittestsupport/src/test/java/org/apache/isis/core/unittestsupport/jmocking">here</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_value_objects_contract_test">6.1.5. Value Objects Contract Test</h4>
<div class="paragraph">
<p>The <code>ValueTypeContractTestAbstract</code> automatically tests that a custom value type implements <code>equals()</code> and <code>hashCode()</code> correctly.</p>
</div>
<div class="paragraph">
<p>For example, testing JDK&#8217;s own <code>java.math.BigInteger</code> can be done as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">ValueTypeContractTestAbstract_BigIntegerTest</span> <span class="directive">extends</span> ValueTypeContractTestAbstract&lt;<span class="predefined-type">BigInteger</span>&gt; {

    <span class="annotation">@Override</span>
    <span class="directive">protected</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">BigInteger</span>&gt; getObjectsWithSameValue() {
        <span class="keyword">return</span> <span class="predefined-type">Arrays</span>.asList(<span class="keyword">new</span> <span class="predefined-type">BigInteger</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">1</span><span class="delimiter">&quot;</span></span>), <span class="keyword">new</span> <span class="predefined-type">BigInteger</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">1</span><span class="delimiter">&quot;</span></span>));
    }

    <span class="annotation">@Override</span>
    <span class="directive">protected</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">BigInteger</span>&gt; getObjectsWithDifferentValue() {
        <span class="keyword">return</span> <span class="predefined-type">Arrays</span>.asList(<span class="keyword">new</span> <span class="predefined-type">BigInteger</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">2</span><span class="delimiter">&quot;</span></span>));
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The example unit tests can be found <a href="https://github.com/apache/isis/tree/master/core/unittestsupport/src/test/java/org/apache/isis/core/unittestsupport/value">here</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_integration_test_support">6.2. Integration Test Support</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_bootstrapping">6.2.1. Bootstrapping</h4>
<div class="listingblock">
<div class="title">Integration test bootstrapping</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">private</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">SimpleAppSystemBuilder</span> <span class="directive">extends</span> IsisSystemForTest.Builder {

    <span class="directive">public</span> SimpleAppSystemBuilder() {
        withLoggingAt(org.apache.log4j.Level.INFO);
        with(testConfiguration());
        with(<span class="keyword">new</span> DataNucleusPersistenceMechanismInstaller());

        <span class="comment">// services annotated with @DomainService</span>
        withServicesIn( <span class="string"><span class="delimiter">&quot;</span><span class="content">domainapp</span><span class="delimiter">&quot;</span></span> );
    }

    <span class="directive">private</span> <span class="directive">static</span> IsisConfiguration testConfiguration() {
        <span class="directive">final</span> IsisConfigurationForJdoIntegTests testConfiguration = <span class="keyword">new</span> IsisConfigurationForJdoIntegTests(); <i class="conum" data-value="1"></i><b>(1)</b>

        testConfiguration.addRegisterEntitiesPackagePrefix(<span class="string"><span class="delimiter">&quot;</span><span class="content">domainapp.dom.modules</span><span class="delimiter">&quot;</span></span>);
        <span class="keyword">return</span> testConfiguration;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>uses <code>IsisConfigurationForJdoIntegTests</code> for in-memory HSQLDB and other standard settings, see <a href="#_isisconfigurationforjdointegtests">below</a>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <a href="#_simpleapp_archetype">SimpleApp archetype</a> is already set up to do this.</p>
</div>
</div>
<div class="sect3">
<h4 id="_isisconfigurationforjdointegtests">6.2.2. IsisConfigurationForJdoIntegTests</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
WIP&#8230;&#8203;
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When running integration tests with the JDO/DataNucleus Objectstore, there are certain standard configuration properties that are usually set. For example, integration tests are usually run against an in-memory HSQLDB database.</p>
</div>
<div class="paragraph">
<p>To remove a little bit of boilerplate, the <code>IsisConfigurationForJdoIntegTests</code> class (in the <code>org.apache.isis.objectstore.jdo.datanucleus</code> package) can be used to bootstrap the application.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 6. Default Configuration Properties for Integration Tests</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 16%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.persistor.datanucleus.impl.</code><br>
<code>javax.jdo.option.ConnectionURL</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">jdbc:hsqldb:mem:test</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>JDBC URL</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.persistor.datanucleus.impl.</code><br>
<code>javax.jdo.option.ConnectionDriverName</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.hsqldb.jdbcDriver</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>JDBC Driver</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.persistor.datanucleus.impl.</code><br>
<code>javax.jdo.option.ConnectionUserName</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sa</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Username</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.persistor.datanucleus.impl.</code><br>
<code>javax.jdo.option.ConnectionPassword</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;empty string&gt;</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Password</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.persistor.datanucleus.impl.</code><br>
<code>datanucleus.schema.autoCreateAll</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Recreate DB for each test run (an in-memory database)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.persistor.datanucleus.impl.</code><br>
<code>datanucleus.schema.validateAll</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Disable validations (minimize bootstrap time)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.persistor.datanucleus.impl.</code><br>
<code>datanucleus.persistenceByReachabilityAtCommit</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>As per WEB-INF/persistor_datanucleus.properties</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.persistor.datanucleus.impl.</code><br>
<code>datanucleus.identifier.case</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MixedCase</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>As per WEB-INF/persistor_datanucleus.properties</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.persistor.datanucleus.impl.</code><br>
<code>datanucleus.cache.level2.type</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">none</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>As per WEB-INF/persistor_datanucleus.properties</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.persistor.datanucleus.impl.</code><br>
<code>datanucleus.cache.level2.mode</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ENABLE_SELECTIVE</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>As per WEB-INF/persistor_datanucleus.properties</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.persistor.datanucleus.</code><br>
<code>install-fixtures</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">true</p></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Automatically install any fixtures that might have been registered</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.persistor.</code><br>
<code>enforceSafeSemantics</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p><code>isis.deploymentType</code></p>
</div></div></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">server_prototype</p></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="_wrapperfactory">6.2.3. WrapperFactory</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_bdd_integ_test_support">6.3. BDD/Integ Test Support</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_fixture_scripts">6.4. Fixture Scripts</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_api_and_usage">6.4.1. API and Usage</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_sudoservice_1_9_0_snapshot">6.4.2. SudoService (1.9.0-SNAPSHOT)</h4>
<div class="paragraph">
<p>Sometimes in our fixture scripts we want to perform a business action runnin as a particular user.  This might be for the usual reason - so that our fixtures accurately reflect the reality of the system with all business constraints enforced using the <code>WrapperFactory</code> - or more straightforwardly it might be simply that the action depends on the identity of the user invoking the action.</p>
</div>
<div class="paragraph">
<p>An example of the latter case is in the link:[todoapp]'s <code>ToDoItem</code> class:</p>
</div>
<div class="listingblock">
<div class="title">Production code that depends on current user</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> ToDoItem newToDo(
        <span class="annotation">@Parameter</span>(regexPattern = <span class="string"><span class="delimiter">&quot;</span><span class="char">\\</span><span class="content">w[@&amp;:</span><span class="char">\\</span><span class="content">-</span><span class="char">\\</span><span class="content">,</span><span class="char">\\</span><span class="content">.</span><span class="char">\\</span><span class="content">+ </span><span class="char">\\</span><span class="content">w]*</span><span class="delimiter">&quot;</span></span>) <span class="annotation">@ParameterLayout</span>(named=<span class="string"><span class="delimiter">&quot;</span><span class="content">Description</span><span class="delimiter">&quot;</span></span>)
        <span class="directive">final</span> <span class="predefined-type">String</span> description,
        <span class="annotation">@ParameterLayout</span>(named=<span class="string"><span class="delimiter">&quot;</span><span class="content">Category</span><span class="delimiter">&quot;</span></span>)
        <span class="directive">final</span> Category category,
        <span class="annotation">@Parameter</span>(optionality = Optionality.OPTIONAL) <span class="annotation">@ParameterLayout</span>(named=<span class="string"><span class="delimiter">&quot;</span><span class="content">Subcategory</span><span class="delimiter">&quot;</span></span>)
        <span class="directive">final</span> Subcategory subcategory,
        <span class="annotation">@Parameter</span>(optionality = Optionality.OPTIONAL) <span class="annotation">@ParameterLayout</span>(named=<span class="string"><span class="delimiter">&quot;</span><span class="content">Due by</span><span class="delimiter">&quot;</span></span>)
        <span class="directive">final</span> LocalDate dueBy,
        <span class="annotation">@Parameter</span>(optionality = Optionality.OPTIONAL) <span class="annotation">@ParameterLayout</span>(named=<span class="string"><span class="delimiter">&quot;</span><span class="content">Cost</span><span class="delimiter">&quot;</span></span>)
        <span class="directive">final</span> <span class="predefined-type">BigDecimal</span> cost) {
    <span class="keyword">return</span> newToDo(description, category, subcategory, currentUserName(), dueBy, cost);
}
<span class="directive">private</span> <span class="predefined-type">String</span> currentUserName() {
    <span class="keyword">return</span> container.getUser().getName(); <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>is the current user.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The fixture for this can use the <code>SudoService</code> to run a block of code as a specified user:</p>
</div>
<div class="listingblock">
<div class="title">Fixture Script</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">final</span> <span class="predefined-type">String</span> description = ...
final Category category = ...
final Subcategory subcategory = ...
final LocalDate dueBy = ...
final <span class="predefined-type">BigDecimal</span> cost = ...
final Location location = ...

toDoItem = sudoService.sudo(username,
        <span class="keyword">new</span> <span class="predefined-type">Callable</span>&lt;ToDoItem&gt;() {
            <span class="annotation">@Override</span>
            <span class="directive">public</span> ToDoItem call() {
                <span class="directive">final</span> ToDoItem toDoItem = wrap(toDoItems).newToDo(
                        description, category, subcategory, dueBy, cost);
                wrap(toDoItem).setLocation(location);
                <span class="keyword">return</span> toDoItem;
            }
        });</code></pre>
</div>
</div>
<div class="paragraph">
<p>Behind the scenes the <code>SudoService</code> simply talks to the <code>DomainObjectContainer</code> to override the user returned by the <code>getUser()</code> API.  It is possible to override both users and roles.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_fake_data">6.5. Fake Data</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>WARN: Isis Addons, not ASF.</p>
</div>
<div class="paragraph">
<p>link:https://github.com/isisaddons/isis-module-fakedata</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_wicket_viewer_2">7. Wicket Viewer</h2>
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_features_end_user_usage">7.1. Features/end-user usage</h3>
<div class="sect3">
<h4 id="_file_upload_download">7.1.1. File upload/download</h4>

</div>
<div class="sect3">
<h4 id="_bookmarked_pages_sliding_panel">7.1.2. Bookmarked pages (sliding panel)</h4>

</div>
<div class="sect3">
<h4 id="_recent_pages_drop_down">7.1.3. Recent pages (drop down)</h4>

</div>
<div class="sect3">
<h4 id="_hints_and_copy_url">7.1.4. Hints and copy URL</h4>

</div>
<div class="sect3">
<h4 id="_user_registration">7.1.5. User Registration</h4>

</div>
</div>
<div class="sect2">
<h3 id="_configuration">7.2. Configuration</h3>
<div class="sect3">
<h4 id="_brand_logo">7.2.1. Brand logo</h4>

</div>
<div class="sect3">
<h4 id="_suppressing_sign_up">7.2.2. Suppressing 'sign up'</h4>

</div>
<div class="sect3">
<h4 id="_suppressing_password_reset">7.2.3. Suppressing 'password reset'</h4>

</div>
<div class="sect3">
<h4 id="_suppressing_remember_me">7.2.4. Suppressing 'remember me'</h4>

</div>
<div class="sect3">
<h4 id="_number_of_bookmarked_pages">7.2.5. Number of bookmarked pages</h4>

</div>
<div class="sect3">
<h4 id="_stripped_wicket_tags">7.2.6. Stripped Wicket tags</h4>

</div>
<div class="sect3">
<h4 id="_disabling_modal_dialogs">7.2.7. Disabling modal dialogs</h4>

</div>
<div class="sect3">
<h4 id="_showing_a_theme_chooser">7.2.8. Showing a theme chooser</h4>

</div>
<div class="sect3">
<h4 id="_suppressing_header_and_footer_embedded_view">7.2.9. Suppressing header and footer (embedded view)</h4>

</div>
</div>
<div class="sect2">
<h3 id="_application_specific_customisation">7.3. Application-specific Customisation</h3>
<div class="sect3">
<h4 id="_customising_the_welcome_page">7.3.1. Customising the Welcome page</h4>

</div>
<div class="sect3">
<h4 id="_customising_the_about_page">7.3.2. Customising the About page</h4>

</div>
<div class="sect3">
<h4 id="_specifying_a_default_theme">7.3.3. Specifying a default theme</h4>

</div>
<div class="sect3">
<h4 id="_tweaking_css_classes">7.3.4. Tweaking CSS classes</h4>

</div>
<div class="sect3">
<h4 id="_custom_javascript">7.3.5. Custom Javascript</h4>

</div>
<div class="sect3">
<h4 id="_auto_refresh_page">7.3.6. Auto-refresh page</h4>

</div>
</div>
<div class="sect2">
<h3 id="_extending_the_viewer">7.4. Extending the viewer</h3>
<div class="paragraph">
<p>Discussed in <a href="#_extending_the_wicket_viewer">Extending the Wicket viewer</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_isis_add_ons_not_asf">7.5. Isis Add-ons (not ASF)</h3>
<div class="sect3">
<h4 id="_excel_download">7.5.1. Excel download</h4>

</div>
<div class="sect3">
<h4 id="_fullcalendar2">7.5.2. Fullcalendar2</h4>

</div>
<div class="sect3">
<h4 id="_gmap3">7.5.3. Gmap3</h4>

</div>
<div class="sect3">
<h4 id="_wicked_charts">7.5.4. Wicked charts</h4>

</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_restful_objects_viewer">8. Restful Objects Viewer</h2>
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_features">8.1. Features</h3>
<div class="sect3">
<h4 id="_restful_objects_specification">8.1.1. Restful Objects Specification</h4>

</div>
<div class="sect3">
<h4 id="_pretty_printing">8.1.2. Pretty printing</h4>

</div>
</div>
<div class="sect2">
<h3 id="_configuration_2">8.2. Configuration</h3>
<div class="sect3">
<h4 id="_honor_ui_hints">8.2.1. Honor UI hints</h4>

</div>
<div class="sect3">
<h4 id="_suppressing_elements_of_the_representations">8.2.2. Suppressing elements of the representations</h4>

</div>
<div class="sect3">
<h4 id="_simplified_object_representation">8.2.3. Simplified object representation</h4>

</div>
</div>
<div class="sect2">
<h3 id="_extending_the_viewer_2">8.3. Extending the viewer</h3>
<div class="paragraph">
<p>Discussed in <a href="#_extending_the_restful_viewer">Extending the Restful viewer</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_hints_and_tips">8.4. Hints and Tips</h3>
<div class="sect3">
<h4 id="_using_chrome_tools">8.4.1. Using Chrome Tools</h4>

</div>
<div class="sect3">
<h4 id="_angularjs_tips">8.4.2. AngularJS Tips</h4>

</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_background_execution">9. Background Execution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As well as supporting the Wicket viewer and Restful viewer for "online" access, Apache Isis also supports programmatic access.  The API provided is low-level and allows code to interact very directly with the Isis metamodel and runtime.  Howwever the <a href="#_wrapperfactory">WrapperFactory</a> service could be used to enforce business rules if required.</p>
</div>
<div class="paragraph">
<p>Typical use cases are to support batch execution or background scheduler execution (eg using <a href="http://quartz-scheduler.org">Quartz</a>) . It could also be used to run Isis as a service, or to integrate within a JMS/ESB messaging solutions.</p>
</div>
<div class="sect2">
<h3 id="_abstractisissessiontemplate">9.1. AbstractIsisSessionTemplate</h3>
<div class="paragraph">
<p>The <code>AbstractIsisSessionTemplate</code> class (whose name is inspired by the Spring framework&#8217;s naming convention for similar classes that query <a href="http://docs.spring.io/spring/docs/2.5.x/reference/jdbc.html#jdbc-JdbcTemplate">JDBC</a>, <a href="http://docs.spring.io/spring/docs/2.5.x/reference/jms.html#jms-jmstemplate">JMS</a>, <a href="http://docs.spring.io/spring/docs/2.5.x/reference/orm.html#orm-jpa-template">JPA</a> etc.) provides the mechanism to open up a 'session' within the Isis framework, in order to resolve and interact with entities.</p>
</div>
<div class="paragraph">
<p>The class itself is intended to be subclassed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">abstract</span> <span class="type">class</span> <span class="class">AbstractIsisSessionTemplate</span> {

    <span class="directive">public</span> <span class="type">void</span> execute(<span class="directive">final</span> AuthenticationSession authSession, <span class="directive">final</span> <span class="predefined-type">Object</span> context) { ... } <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="directive">protected</span> <span class="directive">abstract</span> <span class="type">void</span> doExecute(<span class="predefined-type">Object</span> context); <i class="conum" data-value="2"></i><b>(2)</b>

    <span class="directive">protected</span> ObjectAdapter adapterFor(<span class="directive">final</span> <span class="predefined-type">Object</span> targetObject) { ... }
    <span class="directive">protected</span> ObjectAdapter adapterFor(<span class="directive">final</span> RootOid rootOid) { ... }

    <span class="directive">protected</span> PersistenceSession getPersistenceSession() { ... }
    <span class="directive">protected</span> IsisTransactionManager getTransactionManager() { ... }
    <span class="directive">protected</span> AdapterManager getAdapterManager() { ... }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>execute(&#8230;&#8203;)</code> sets up the <code>IsisSession</code> and delegates to &#8230;&#8203;</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>doExecute(&#8230;&#8203;)</code>, the mandatory hook method for subclasses to implement.
The passed object represents passes a context from the caller (eg the scheduler, cron job, JMS etc) that instantiated and executed the class.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>protected</code> methods expose key internal APIs within Isis, for the subclass to use as necessary.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
One notable feature of <code>AbstractIsisSessionTemplate</code> is that it will automatically inject any domain services into itself. Thus, it is relatively easy for the subclass to "reach into" the domain, through injected repository services.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_backgroundcommandexecution">9.2. BackgroundCommandExecution</h3>
<div class="paragraph">
<p>The <code>BackgroundCommandExecution</code> class (a subclass of <a href="#_abstractisissessiontemplate">AbstractIsisSessionTemplate</a>) is intended to simplify the execution of background <code>Command</code>s persisted by way of the <a href="#CommandService">[CommandService]</a> and the <a href="#BackgroundCommandService">[BackgroundCommandService]</a>.</p>
</div>
<div class="paragraph">
<p>Its signature is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">abstract</span> <span class="type">class</span> <span class="class">BackgroundCommandExecution</span> <span class="directive">extends</span> AbstractIsisSessionTemplate {
    <span class="directive">protected</span> <span class="type">void</span> doExecute(<span class="predefined-type">Object</span> context) { ... }
    <span class="directive">protected</span> <span class="directive">abstract</span> <span class="predefined-type">List</span>&lt;? <span class="directive">extends</span> Command&gt; findBackgroundCommandsToExecute(); <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>findBackgroundCommandsToExecute()</code> is a mandatory hook method for subclasses to implement.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This allows for different implementations of the <code>CommandService</code> and <code>BackgroundCommandService</code> to persist to wherever.</p>
</div>
<div class="paragraph">
<p>The diagram below shows the dependencies between these various classes:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/background-execution/BackgroundCommandExecution.png" alt="BackgroundCommandExecution" width="400px">
</div>
<div class="title">Figure 3. Inheritance Hierarchy for <code>BackgroundCommandExecution</code></div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="listingblock">
<div class="title">DSL (<a href="http://yuml.me/edit/363b335f">yuml.me/363b335f</a>)</div>
<div class="content">
<pre class="CodeRay highlight"><code>[AbstractIsisSessionTemplate|#doExecute()]^-[BackgroundCommandExecution|#findBackgroundCommandsToExecute()]
[BackgroundCommandExecution]^-[BackgroundCommandExecutionFromBackgroundCommandServiceJdo]
[BackgroundCommandExecutionFromBackgroundCommandServiceJdo]-&gt;injected[BackgroundCommandServiceJdoRepository|findBackgroundCommandsNotYetStarted()]</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_isis_addons_command_module">9.2.1. Isis Addons Command Module</h4>
<div class="paragraph">
<p>The <code>BackgroundCommandExecutionFromBackgroundCommandServiceJdo</code> is a concrete subclass of <a href="#_backgroundcommandexecution">BackgroundCommandExecution</a>, the intended use being for the class to be instantiated regularly (eg every 10 seconds) by a scheduler such as <a href="http://quartz-scheduler.org">Quartz</a>) to poll for <code>Command</code>s to be executed, and then execute them.</p>
</div>
<div class="paragraph">
<p>This implementation queries for <code>Command</code>s persisted by the <a href="http://isisaddons.org/isis-module-command">Isis addons Command Module</a>'s  implementations of <a href="#CommandService">[CommandService]</a> and <a href="#BackgroundCommandService">[BackgroundCommandService]</a> using the <code>BackgroundCommandServiceJdoRepository</code>.</p>
</div>
<div class="paragraph">
<p>The diagram below shows the inheritance hierarchy for this class:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/background-execution/BackgroundCommandExecutionFromBackgroundCommandServiceJdo.png" alt="BackgroundCommandExecutionFromBackgroundCommandServiceJdo" width="500px">
</div>
<div class="title">Figure 4. Inheritance Hierarchy for <code>BackgroundCommandExecutionFromBackgroundCommandServiceJdo</code></div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="listingblock">
<div class="title">DSL (<a href="http://yuml.me/edit/25343da1">yuml.me/25343da1</a>):</div>
<div class="content">
<pre class="CodeRay highlight"><code>[AbstractIsisSessionTemplate|#doExecute()]^-[BackgroundCommandExecution|#findBackgroundCommandsToExecute()]
[BackgroundCommandExecution]-&gt;injected[BookmarkService|lookup()]
[BackgroundCommandExecution]-&gt;injected[CommandContext|setCommand()]</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration_3">10. Configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes how to configure an Apache Isis application.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Details on adjusting these configuration properties between development and production can be found in the <a href="#_deployment">Deployment</a> chapter.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_properties_and_files">10.1. Properties and Files</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Isis' own configuration properties are simple key-value pairs, typically held in the <code>WEBINF/isis.properties</code> file.  This section explains which other config files are read, and identifies the most important configuration properties.</p>
</div>
<div class="paragraph">
<p>A full list of all configuration properties can be found in the <a href="#_configuration_properties">reference</a> section of this manual.</p>
</div>
<div class="sect3">
<h4 id="_configuration_properties_2">10.1.1. Configuration Properties</h4>

</div>
<div class="sect3">
<h4 id="_files">10.1.2. Files</h4>
<div class="paragraph">
<p>When running an Isis webapp, configuration properties are read from configuration files held in the <code>WEB-INF</code> directory.</p>
</div>
<div class="paragraph">
<p>The <code>WEBINF/isis.properties</code> file is always read and must exist.</p>
</div>
<div class="paragraph">
<p>In addition, the following other properties are searched for and if present also read:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>viewer_wicket.properties</code> - if the Wicket UI (viewer) is in use</p>
</li>
<li>
<p><code>viewer_restfulobjects.properties</code> - if the Restful Objects REST API (viewer) is in use</p>
</li>
<li>
<p><code>viewer.properties</code> - for any shared UI configuration</p>
</li>
<li>
<p><code>persistor_datanucleus.properties</code> - assuming the JDO/DataNucleus objectstore is in use</p>
</li>
<li>
<p><code>persistor.properties</code> - for any shared objectstore configuration.  This typically is used to hold <code>JDBC</code> <code>URL</code>s</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can if you wish simply store all properties in the <code>isis.properties</code> file; but we think that breaking properties out into sections is preferable.</p>
</div>
</div>
<div class="sect3">
<h4 id="_deployment_types">10.1.3. Deployment Types</h4>
<div class="sect4">
<h5 id="_configuring_isis_to_use_shiro">Configuring Isis to use Shiro</h5>
<div class="paragraph">
<p>For more on some specific use cases, see <a href="#Configuring Shiro">[Configuring Shiro]</a></p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_configuring_the_integration_tests">10.1.4. Configuring the Integration Tests</h4>
<div class="paragraph">
<p>Integration tests are configured programmatically, with a default set of properties to bootstrap the JDO/DataNucleus objectstore using an HSQLDB in-memory database.</p>
</div>
<div class="paragraph">
<p>These can be overridden by subclassing <code>IsisConfigurationForJdoIntegTests</code>.</p>
</div>
<div class="paragraph">
<p>Unresolved directive in _user-guide_configuration.adoc - include::_user-guide_configuration_configuring_shiro.adoc[leveloffset=+1]</p>
</div>
<div class="paragraph">
<p>Unresolved directive in _user-guide_configuration.adoc - include::_user-guide_configuration_configuring_datanucleus.adoc[leveloffset=+1]</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_the_webapp">10.2. Configuring the Webapp</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><code>web.xml</code></p>
</div>
<div class="sect3">
<h4 id="_init_params">10.2.1. Init Params</h4>
<div class="paragraph">
<p><code>&lt;isis.viewers&gt;</code></p>
</div>
</div>
<div class="sect3">
<h4 id="_filters">10.2.2. Filters</h4>

</div>
<div class="sect3">
<h4 id="_servlets">10.2.3. Servlets</h4>

</div>
<div class="sect3">
<h4 id="_running_restful_objects_viewer_only">10.2.4. Running Restful Objects Viewer only</h4>

</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_deployment">11. Deployment</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter provides guidance on some common deployment scenarios.</p>
</div>
<div class="sect2">
<h3 id="_deploying_to_tomcat">11.1. Deploying to Tomcat</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>eg Tomcat</p>
</div>
<div class="sect3">
<h4 id="_externalized_configuration">11.1.1. Externalized Configuration</h4>

</div>
<div class="sect3">
<h4 id="_jvm_args">11.1.2. JVM Args</h4>

</div>
<div class="sect3">
<h4 id="_using_a_jndi_datasource">11.1.3. Using a JNDI Datasource</h4>

</div>
</div>
<div class="sect2">
<h3 id="_deploying_to_google_app_engine">11.2. Deploying to Google App Engine</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Google App Engine (GAE) provides a JDO API, meaning that you can deploy Isis onto GAE using the JDO objectstore.</p>
</div>
<div class="paragraph">
<p>However, GAE is not an RDBMS, and so there are some limitations that it imposes. This page gathers together various hints, tips and workarounds.</p>
</div>
<div class="sect3">
<h4 id="_primary_keys_and_owned_unowned_relationships">11.2.1. Primary Keys and Owned/Unowned Relationships</h4>
<div class="paragraph">
<p>All entities must have a <code>@PrimaryKey</code>. Within GAE, the type of this key matters.</p>
</div>
<div class="paragraph">
<p>For an entity to be an aggregate root, (ie a root of an GAE entity group), its key must be a <code>Long</code>, eg:</p>
</div>
<div class="paragraph">
<p>Any collection that holds this entity type (eg <code>ToDoItem#dependencies</code> holding a collection of <code>ToDoItem`s) should then be annotated with `@Unowned</code> (a GAE annotation).</p>
</div>
<div class="paragraph">
<p>If on the other hand you want the object to be owned (through a 1:m relationship somewhere) by some other root, then use a String:</p>
</div>
<div class="paragraph">
<p>Note: if you store a relationship with a String key it means that the parent object <em>owns</em> the child, any attempt to change the relationship raise and exception.</p>
</div>
</div>
<div class="sect3">
<h4 id="_custom_types">11.2.2. Custom Types</h4>
<div class="paragraph">
<p>Currently Isis' <code>Blob</code> and <code>Clob</code> types and the JODA types (<code>LocalDate</code> et al) are <em>not</em> supported in GAE.</p>
</div>
<div class="paragraph">
<p>Instead, GAE defines a <a href="https://developers.google.com/appengine/docs/java/datastore/entities#Properties_and_Value_Types">fixed set of value types</a>, including <code>BlobKey</code>. Members of the Isis community have this working, though I haven&#8217;t seen the code.</p>
</div>
<div class="paragraph">
<p>The above notwithstanding, Andy Jefferson at DataNucleus tells us:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>GAE JDO/JPA does support <em>some</em> type conversion, because looking at <a href="http://code.google.com/p/datanucleus-appengine/source/browse/trunk/src/com/google/appengine/datanucleus/StoreFieldManager.java#349">StoreFieldManager.java</a> for any field that is Object-based and not a relation nor Serialized it will call <a href="http://code.google.com/p/datanucleus-appengine/source/browse/trunk/src/com/google/appengine/datanucleus/TypeConversionUtils.java#736">TypeConverstionUtils.java</a> and that looks for a <code>TypeConverter</code> (specify <code>@Extension</code> with key of "type-converter-name" against a field and value as the <code>TypeConverter</code> class) and it should convert it. Similarly when getting the value from the datastore.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>On further investigation, it seems that the GAE implementation performs a type check on a <code>SUPPORTED_TYPES</code> Java set, in <code>com.google.appengine.api.datastore.DataTypeUtils</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">if</span> (!supportedTypes.contains(value.getClass())) {
     <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">IllegalArgumentException</span>(prefix + value.getClass().getName() + <span class="string"><span class="delimiter">&quot;</span><span class="content"> is not a supported property type.</span><span class="delimiter">&quot;</span></span>);
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>We still need to try out Andy&#8217;s recipe, above.</p>
</div>
<div class="sect4">
<h5 id="_a_gae_compatible_version_of_code_todoitem_java_code">A GAE compatible version of <code>ToDoItem.java</code></h5>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>as per the <a href="http://github.com/isisaddons/isis-app-todoapp}">Isis addons' todoapp</a> (non-ASF), is as follows:</p>
</li>
</ol>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@javax</span>.jdo.annotations.Queries( {
    <span class="annotation">@javax</span>.jdo.annotations.Query(
            name=<span class="string"><span class="delimiter">&quot;</span><span class="content">todo_all</span><span class="delimiter">&quot;</span></span>, language=<span class="string"><span class="delimiter">&quot;</span><span class="content">JDOQL</span><span class="delimiter">&quot;</span></span>,
            value=<span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT FROM dom.todo.ToDoItem WHERE ownedBy == :ownedBy</span><span class="delimiter">&quot;</span></span>),
    <span class="annotation">@javax</span>.jdo.annotations.Query(
        name=<span class="string"><span class="delimiter">&quot;</span><span class="content">todo_notYetComplete</span><span class="delimiter">&quot;</span></span>, language=<span class="string"><span class="delimiter">&quot;</span><span class="content">JDOQL</span><span class="delimiter">&quot;</span></span>,
        value=<span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT FROM dom.todo.ToDoItem WHERE ownedBy == :ownedBy &amp;&amp; complete == false</span><span class="delimiter">&quot;</span></span>),
    <span class="annotation">@javax</span>.jdo.annotations.Query(
            name=<span class="string"><span class="delimiter">&quot;</span><span class="content">todo_complete</span><span class="delimiter">&quot;</span></span>, language=<span class="string"><span class="delimiter">&quot;</span><span class="content">JDOQL</span><span class="delimiter">&quot;</span></span>,
            value=<span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT FROM dom.todo.ToDoItem WHERE ownedBy == :ownedBy &amp;&amp; complete == true</span><span class="delimiter">&quot;</span></span>),
    <span class="annotation">@javax</span>.jdo.annotations.Query(
        name=<span class="string"><span class="delimiter">&quot;</span><span class="content">todo_similarTo</span><span class="delimiter">&quot;</span></span>, language=<span class="string"><span class="delimiter">&quot;</span><span class="content">JDOQL</span><span class="delimiter">&quot;</span></span>,
        value=<span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT FROM dom.todo.ToDoItem WHERE ownedBy == :ownedBy &amp;&amp; category == :category</span><span class="delimiter">&quot;</span></span>),
    <span class="annotation">@javax</span>.jdo.annotations.Query(
            name=<span class="string"><span class="delimiter">&quot;</span><span class="content">todo_autoComplete</span><span class="delimiter">&quot;</span></span>, language=<span class="string"><span class="delimiter">&quot;</span><span class="content">JDOQL</span><span class="delimiter">&quot;</span></span>,
            value=<span class="string"><span class="delimiter">&quot;</span><span class="content">SELECT FROM dom.todo.ToDoItem WHERE ownedBy == :ownedBy &amp;&amp; description.startsWith(:description)</span><span class="delimiter">&quot;</span></span>)
})
<span class="annotation">@javax</span>.jdo.annotations.Version(strategy= VersionStrategy.VERSION_NUMBER, column=<span class="string"><span class="delimiter">&quot;</span><span class="content">VERSION</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@ObjectType</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">TODO</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@Auditable</span>
<span class="annotation">@AutoComplete</span>(repository=ToDoItems.class, action=<span class="string"><span class="delimiter">&quot;</span><span class="content">autoComplete</span><span class="delimiter">&quot;</span></span>)
<span class="annotation">@MemberGroups</span>({<span class="string"><span class="delimiter">&quot;</span><span class="content">General</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">Detail</span><span class="delimiter">&quot;</span></span>})
<span class="annotation">@javax</span>.jdo.annotations.PersistenceCapable
<span class="directive">public</span> <span class="type">class</span> <span class="class">ToDoItem</span> <span class="directive">implements</span> <span class="predefined-type">Comparable</span>&lt;ToDoItem&gt; {
<span class="comment">//    @PrimaryKey</span>
<span class="comment">//    @Persistent(valueStrategy = javax.jdo.annotations.IdGeneratorStrategy.IDENTITY)</span>
<span class="comment">//    @Extension(vendorName=&quot;datanucleus&quot;, key=&quot;gae.encoded-pk&quot;, value=&quot;true&quot;)</span>
<span class="comment">//  private String key;</span>
    <span class="annotation">@Persistent</span>(valueStrategy=IdGeneratorStrategy.IDENTITY)
    <span class="annotation">@PrimaryKey</span>
    <span class="directive">private</span> <span class="predefined-type">Long</span> id;

    <span class="directive">private</span> <span class="directive">static</span> <span class="directive">final</span> <span class="type">long</span> ONE_WEEK_IN_MILLIS = <span class="integer">7</span> * <span class="integer">24</span> * <span class="integer">60</span> * <span class="integer">60</span> * <span class="integer">1000L</span>;

    <span class="directive">public</span> <span class="directive">static</span> <span class="type">enum</span> Category {
        Professional, Domestic, Other;
    }

    <span class="comment">// {{ Identification on the UI</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> title() {
        <span class="directive">final</span> TitleBuffer buf = <span class="keyword">new</span> TitleBuffer();
        buf.append(getDescription());
        <span class="keyword">if</span> (isComplete()) {
            buf.append(<span class="string"><span class="delimiter">&quot;</span><span class="content"> - Completed!</span><span class="delimiter">&quot;</span></span>);
        } <span class="keyword">else</span> {
            <span class="keyword">if</span> (getDueBy() != <span class="predefined-constant">null</span>) {
                <span class="predefined-type">SimpleDateFormat</span> sdf = <span class="keyword">new</span> <span class="predefined-type">SimpleDateFormat</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">dd-MM-yyyy</span><span class="delimiter">&quot;</span></span>);
                buf.append(<span class="string"><span class="delimiter">&quot;</span><span class="content"> due by </span><span class="delimiter">&quot;</span></span>, sdf.format(getDueBy()));
            }
        }
        <span class="keyword">return</span> buf.toString();
    }

    <span class="comment">// }}</span>

    <span class="comment">// {{ Description</span>
    <span class="directive">private</span> <span class="predefined-type">String</span> description;

    <span class="annotation">@RegEx</span>(validation = <span class="string"><span class="delimiter">&quot;</span><span class="char">\\</span><span class="content">w[@&amp;:</span><span class="char">\\</span><span class="content">-</span><span class="char">\\</span><span class="content">,</span><span class="char">\\</span><span class="content">.</span><span class="char">\\</span><span class="content">+ </span><span class="char">\\</span><span class="content">w]*</span><span class="delimiter">&quot;</span></span>)
    <span class="comment">// words, spaces and selected punctuation</span>
    <span class="annotation">@MemberOrder</span>(sequence = <span class="string"><span class="delimiter">&quot;</span><span class="content">1</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@DescribedAs</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Enter the description</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getDescription() {
        <span class="keyword">return</span> description;
    }

    <span class="directive">public</span> <span class="type">void</span> setDescription(<span class="directive">final</span> <span class="predefined-type">String</span> description) {
        <span class="local-variable">this</span>.description = description;
    }
    <span class="comment">// }}</span>

    <span class="comment">// {{ DueBy (property)</span>
    <span class="directive">private</span> <span class="predefined-type">Date</span> dueBy;

    <span class="annotation">@javax</span>.jdo.annotations.Persistent
    <span class="annotation">@MemberOrder</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">Detail</span><span class="delimiter">&quot;</span></span>, sequence = <span class="string"><span class="delimiter">&quot;</span><span class="content">3</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Optional</span>
    <span class="annotation">@DescribedAs</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Enter the date</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Date</span> getDueBy() {
        <span class="keyword">return</span> dueBy;
    }

    <span class="directive">public</span> <span class="type">void</span> setDueBy(<span class="directive">final</span> <span class="predefined-type">Date</span> dueBy) {
        <span class="local-variable">this</span>.dueBy = dueBy;
    }
    <span class="directive">public</span> <span class="type">void</span> clearDueBy() {
        setDueBy(<span class="predefined-constant">null</span>);
    }
    <span class="comment">// proposed new value is validated before setting</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> validateDueBy(<span class="directive">final</span> <span class="predefined-type">Date</span> dueBy) {
        <span class="keyword">if</span> (dueBy == <span class="predefined-constant">null</span>) {
            <span class="keyword">return</span> <span class="predefined-constant">null</span>;
        }
        <span class="keyword">return</span> isMoreThanOneWeekInPast(dueBy) ? <span class="string"><span class="delimiter">&quot;</span><span class="content">Due by date cannot be more than one week old</span><span class="delimiter">&quot;</span></span> : <span class="predefined-constant">null</span>;
    }
    <span class="comment">// }}</span>

    <span class="comment">// {{ Category</span>
    <span class="directive">private</span> Category category;

    <span class="annotation">@MemberOrder</span>(sequence = <span class="string"><span class="delimiter">&quot;</span><span class="content">2</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@DescribedAs</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Enter the category</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> Category getCategory() {
        <span class="keyword">return</span> category;
    }

    <span class="directive">public</span> <span class="type">void</span> setCategory(<span class="directive">final</span> Category category) {
        <span class="local-variable">this</span>.category = category;
    }
    <span class="comment">// }}</span>

    <span class="comment">// {{ OwnedBy (property)</span>
    <span class="directive">private</span> <span class="predefined-type">String</span> ownedBy;

    <span class="annotation">@Hidden</span>
    <span class="comment">// not shown in the UI</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> getOwnedBy() {
        <span class="keyword">return</span> ownedBy;
    }

    <span class="directive">public</span> <span class="type">void</span> setOwnedBy(<span class="directive">final</span> <span class="predefined-type">String</span> ownedBy) {
        <span class="local-variable">this</span>.ownedBy = ownedBy;
    }

    <span class="comment">// }}</span>

    <span class="comment">// {{ Complete (property)</span>
    <span class="directive">private</span> <span class="type">boolean</span> complete;

    <span class="annotation">@Disabled</span>
    <span class="comment">// cannot be edited as a property</span>
    <span class="annotation">@MemberOrder</span>(sequence = <span class="string"><span class="delimiter">&quot;</span><span class="content">4</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="type">boolean</span> isComplete() {
        <span class="keyword">return</span> complete;
    }

    <span class="directive">public</span> <span class="type">void</span> setComplete(<span class="directive">final</span> <span class="type">boolean</span> complete) {
        <span class="local-variable">this</span>.complete = complete;
    }

    <span class="comment">// {{ Notes (property)</span>
    <span class="directive">private</span> <span class="predefined-type">String</span> notes;

    <span class="annotation">@Hidden</span>(where=Where.ALL_TABLES)
    <span class="annotation">@Optional</span>
    <span class="annotation">@MultiLine</span>(numberOfLines=<span class="integer">4</span>)
    <span class="annotation">@MemberOrder</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">Detail</span><span class="delimiter">&quot;</span></span>, sequence = <span class="string"><span class="delimiter">&quot;</span><span class="content">6</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getNotes() {
        <span class="keyword">return</span> notes;
    }

    <span class="directive">public</span> <span class="type">void</span> setNotes(<span class="directive">final</span> <span class="predefined-type">String</span> notes) {
        <span class="local-variable">this</span>.notes = notes;
    }
    <span class="comment">// }}</span>

    <span class="comment">// {{ Attachment (property)</span>
    <span class="directive">private</span> BlobKey attachment;

    <span class="annotation">@Persistent</span>
    <span class="annotation">@Optional</span>
    <span class="annotation">@MemberOrder</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">Detail</span><span class="delimiter">&quot;</span></span>, sequence = <span class="string"><span class="delimiter">&quot;</span><span class="content">7</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> BlobKey getAttachment() {
        <span class="keyword">return</span> attachment;
    }

    <span class="directive">public</span> <span class="type">void</span> setAttachment(<span class="directive">final</span> BlobKey attachment) {
        <span class="local-variable">this</span>.attachment = attachment;
    }
    <span class="comment">// }}</span>

    <span class="comment">// {{ Version (derived property)</span>
    <span class="annotation">@Hidden</span>(where=Where.ALL_TABLES)
    <span class="annotation">@Disabled</span>
    <span class="annotation">@MemberOrder</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">Detail</span><span class="delimiter">&quot;</span></span>, sequence = <span class="string"><span class="delimiter">&quot;</span><span class="content">99</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Named</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Version</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="predefined-type">Long</span> getVersionSequence() {
        <span class="keyword">if</span>(!(<span class="local-variable">this</span> <span class="keyword">instanceof</span> PersistenceCapable)) {
            <span class="keyword">return</span> <span class="predefined-constant">null</span>;
        }
        PersistenceCapable persistenceCapable = (PersistenceCapable) <span class="local-variable">this</span>;
        <span class="directive">final</span> <span class="predefined-type">Long</span> version = (<span class="predefined-type">Long</span>) JDOHelper.getVersion(persistenceCapable);
        <span class="keyword">return</span> version;
    }
    <span class="directive">public</span> <span class="type">boolean</span> hideVersionSequence() {
        <span class="keyword">return</span> !(<span class="local-variable">this</span> <span class="keyword">instanceof</span> PersistenceCapable);
    }
    <span class="comment">// }}</span>

    <span class="comment">// {{ completed (action)</span>
    <span class="annotation">@Bulk</span>
    <span class="annotation">@MemberOrder</span>(sequence = <span class="string"><span class="delimiter">&quot;</span><span class="content">1</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> ToDoItem completed() {
        setComplete(<span class="predefined-constant">true</span>);
        <span class="keyword">return</span> <span class="local-variable">this</span>;
    }

    <span class="comment">// disable action dependent on state of object</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> disableCompleted() {
        <span class="keyword">return</span> complete ? <span class="string"><span class="delimiter">&quot;</span><span class="content">Already completed</span><span class="delimiter">&quot;</span></span> : <span class="predefined-constant">null</span>;
    }
    <span class="comment">// }}</span>

    <span class="comment">// {{ notYetCompleted (action)</span>
    <span class="annotation">@MemberOrder</span>(sequence = <span class="string"><span class="delimiter">&quot;</span><span class="content">2</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> ToDoItem notYetCompleted() {
        setComplete(<span class="predefined-constant">false</span>);
        <span class="keyword">return</span> <span class="local-variable">this</span>;
    }

    <span class="comment">// disable action dependent on state of object</span>
    <span class="directive">public</span> <span class="predefined-type">String</span> disableNotYetCompleted() {
        <span class="keyword">return</span> !complete ? <span class="string"><span class="delimiter">&quot;</span><span class="content">Not yet completed</span><span class="delimiter">&quot;</span></span> : <span class="predefined-constant">null</span>;
    }
    <span class="comment">// }}</span>

    <span class="comment">// {{ dependencies (Collection)</span>
    <span class="annotation">@Unowned</span>
    <span class="directive">private</span> <span class="predefined-type">List</span>&lt;ToDoItem&gt; dependencies = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;ToDoItem&gt;();

    <span class="annotation">@Disabled</span>
    <span class="annotation">@MemberOrder</span>(sequence = <span class="string"><span class="delimiter">&quot;</span><span class="content">1</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@Resolve</span>(<span class="predefined-type">Type</span>.EAGERLY)
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;ToDoItem&gt; getDependencies() {
        <span class="keyword">return</span> dependencies;
    }

    <span class="directive">public</span> <span class="type">void</span> setDependencies(<span class="directive">final</span> <span class="predefined-type">List</span>&lt;ToDoItem&gt; dependencies) {
        <span class="local-variable">this</span>.dependencies = dependencies;
    }
    <span class="comment">// }}</span>

    <span class="comment">// {{ add (action)</span>
    <span class="annotation">@MemberOrder</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">dependencies</span><span class="delimiter">&quot;</span></span>, sequence = <span class="string"><span class="delimiter">&quot;</span><span class="content">3</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> ToDoItem add(<span class="directive">final</span> ToDoItem toDoItem) {
        getDependencies().add(toDoItem);
        <span class="keyword">return</span> <span class="local-variable">this</span>;
    }
    <span class="directive">public</span> <span class="predefined-type">String</span> validateAdd(<span class="directive">final</span> ToDoItem toDoItem) {
        <span class="keyword">if</span>(getDependencies().contains(toDoItem)) {
            <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Already a dependency</span><span class="delimiter">&quot;</span></span>;
        }
        <span class="keyword">if</span>(toDoItem == <span class="local-variable">this</span>) {
            <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Can't set up a dependency to self</span><span class="delimiter">&quot;</span></span>;
        }
        <span class="keyword">return</span> <span class="predefined-constant">null</span>;
    }
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;ToDoItem&gt; choices0Add() {
        <span class="keyword">return</span> toDoItems.allToDos();
    }

    <span class="comment">// }}</span>

    <span class="comment">// {{ remove (action)</span>
    <span class="annotation">@MemberOrder</span>(name=<span class="string"><span class="delimiter">&quot;</span><span class="content">dependencies</span><span class="delimiter">&quot;</span></span>, sequence = <span class="string"><span class="delimiter">&quot;</span><span class="content">4</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> ToDoItem remove(<span class="directive">final</span> ToDoItem toDoItem) {
        getDependencies().remove(toDoItem);
        <span class="keyword">return</span> <span class="local-variable">this</span>;
    }
    <span class="directive">public</span> <span class="predefined-type">String</span> disableRemove(<span class="directive">final</span> ToDoItem toDoItem) {
        <span class="keyword">return</span> getDependencies().isEmpty()? <span class="string"><span class="delimiter">&quot;</span><span class="content">No dependencies to remove</span><span class="delimiter">&quot;</span></span>: <span class="predefined-constant">null</span>;
    }
    <span class="directive">public</span> <span class="predefined-type">String</span> validateRemove(<span class="directive">final</span> ToDoItem toDoItem) {
        <span class="keyword">if</span>(!getDependencies().contains(toDoItem)) {
            <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">Not a dependency</span><span class="delimiter">&quot;</span></span>;
        }
        <span class="keyword">return</span> <span class="predefined-constant">null</span>;
    }
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;ToDoItem&gt; choices0Remove() {
        <span class="keyword">return</span> getDependencies();
    }
    <span class="comment">// }}</span>

    <span class="comment">// {{ clone (action)</span>
    <span class="annotation">@Named</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">Clone</span><span class="delimiter">&quot;</span></span>)
    <span class="comment">// the name of the action in the UI</span>
    <span class="annotation">@MemberOrder</span>(sequence = <span class="string"><span class="delimiter">&quot;</span><span class="content">3</span><span class="delimiter">&quot;</span></span>)
    <span class="comment">// nb: method is not called &quot;clone()&quot; is inherited by java.lang.Object and</span>
    <span class="comment">// (a) has different semantics and (b) is in any case automatically ignored</span>
    <span class="comment">// by the framework</span>
    <span class="directive">public</span> ToDoItem duplicate() {
        <span class="keyword">return</span> toDoItems.newToDo(getDescription() + <span class="string"><span class="delimiter">&quot;</span><span class="content"> - Copy</span><span class="delimiter">&quot;</span></span>, getCategory(), getDueBy());
    }
    <span class="comment">// }}</span>

    <span class="comment">// {{ isDue (programmatic)</span>
    <span class="annotation">@Programmatic</span>
    <span class="comment">// excluded from the framework's metamodel</span>
    <span class="directive">public</span> <span class="type">boolean</span> isDue() {
        <span class="keyword">if</span> (getDueBy() == <span class="predefined-constant">null</span>) {
            <span class="keyword">return</span> <span class="predefined-constant">false</span>;
        }
        <span class="keyword">return</span> !isMoreThanOneWeekInPast(getDueBy());
    }

    <span class="comment">// }}</span>

    <span class="comment">// {{ SimilarItems (derived collection)</span>
    <span class="annotation">@MemberOrder</span>(sequence = <span class="string"><span class="delimiter">&quot;</span><span class="content">5</span><span class="delimiter">&quot;</span></span>)
    <span class="annotation">@NotPersisted</span>
    <span class="annotation">@Resolve</span>(<span class="predefined-type">Type</span>.EAGERLY)
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;ToDoItem&gt; getSimilarItems() {
        <span class="keyword">return</span> toDoItems.similarTo(<span class="local-variable">this</span>);
    }

    <span class="comment">// }}</span>

    <span class="comment">// {{ compareTo (programmatic)</span>
    <span class="comment">/**
     * by complete flag, then due by date, then description
     */</span>
    <span class="comment">// exclude from the framework's metamodel</span>
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">int</span> compareTo(<span class="directive">final</span> ToDoItem other) {
        <span class="keyword">if</span> (isComplete() &amp;&amp; !other.isComplete()) {
            <span class="keyword">return</span> +<span class="integer">1</span>;
        }
        <span class="keyword">if</span> (!isComplete() &amp;&amp; other.isComplete()) {
            <span class="keyword">return</span> -<span class="integer">1</span>;
        }
        <span class="keyword">if</span> (getDueBy() == <span class="predefined-constant">null</span> &amp;&amp; other.getDueBy() != <span class="predefined-constant">null</span>) {
            <span class="keyword">return</span> +<span class="integer">1</span>;
        }
        <span class="keyword">if</span> (getDueBy() != <span class="predefined-constant">null</span> &amp;&amp; other.getDueBy() == <span class="predefined-constant">null</span>) {
            <span class="keyword">return</span> -<span class="integer">1</span>;
        }
        <span class="keyword">if</span> (getDueBy() == <span class="predefined-constant">null</span> &amp;&amp; other.getDueBy() == <span class="predefined-constant">null</span> || getDueBy().equals(<span class="local-variable">this</span>.getDueBy())) {
            <span class="keyword">return</span> getDescription().compareTo(other.getDescription());
        }
        <span class="keyword">return</span> getDueBy().compareTo(getDueBy());
    }
    <span class="comment">// }}</span>

    <span class="comment">// {{ helpers</span>
    <span class="directive">private</span> <span class="directive">static</span> <span class="type">boolean</span> isMoreThanOneWeekInPast(<span class="directive">final</span> <span class="predefined-type">Date</span> dueBy) {
        <span class="keyword">return</span> dueBy.getTime() &lt; Clock.getTime() - ONE_WEEK_IN_MILLIS;
    }

    <span class="comment">// }}</span>

    <span class="comment">// {{ filters (programmatic)</span>
    <span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">unchecked</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">public</span> <span class="directive">static</span> <span class="predefined-type">Filter</span>&lt;ToDoItem&gt; thoseDue() {
        <span class="keyword">return</span> Filters.and(Filters.not(thoseComplete()), <span class="keyword">new</span> <span class="predefined-type">Filter</span>&lt;ToDoItem&gt;() {
            <span class="annotation">@Override</span>
            <span class="directive">public</span> <span class="type">boolean</span> accept(<span class="directive">final</span> ToDoItem t) {
                <span class="keyword">return</span> t.isDue();
            }
        });
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="predefined-type">Filter</span>&lt;ToDoItem&gt; thoseComplete() {
        <span class="keyword">return</span> <span class="keyword">new</span> <span class="predefined-type">Filter</span>&lt;ToDoItem&gt;() {
            <span class="annotation">@Override</span>
            <span class="directive">public</span> <span class="type">boolean</span> accept(<span class="directive">final</span> ToDoItem t) {
                <span class="keyword">return</span> t.isComplete();
            }
        };
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="predefined-type">Filter</span>&lt;ToDoItem&gt; thoseOwnedBy(<span class="directive">final</span> <span class="predefined-type">String</span> currentUser) {
        <span class="keyword">return</span> <span class="keyword">new</span> <span class="predefined-type">Filter</span>&lt;ToDoItem&gt;() {
            <span class="annotation">@Override</span>
            <span class="directive">public</span> <span class="type">boolean</span> accept(<span class="directive">final</span> ToDoItem toDoItem) {
                <span class="keyword">return</span> Objects.equal(toDoItem.getOwnedBy(), currentUser);
            }

        };
    }

    <span class="directive">public</span> <span class="directive">static</span> <span class="predefined-type">Filter</span>&lt;ToDoItem&gt; thoseSimilarTo(<span class="directive">final</span> ToDoItem toDoItem) {
        <span class="keyword">return</span> <span class="keyword">new</span> <span class="predefined-type">Filter</span>&lt;ToDoItem&gt;() {
            <span class="annotation">@Override</span>
            <span class="directive">public</span> <span class="type">boolean</span> accept(<span class="directive">final</span> ToDoItem eachToDoItem) {
                <span class="keyword">return</span> Objects.equal(toDoItem.getCategory(), eachToDoItem.getCategory()) &amp;&amp;
                       Objects.equal(toDoItem.getOwnedBy(), eachToDoItem.getOwnedBy()) &amp;&amp;
                       eachToDoItem != toDoItem;
            }

        };
    }
    <span class="comment">// }}</span>

    <span class="comment">// {{ injected: DomainObjectContainer</span>
    <span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">&quot;</span><span class="content">unused</span><span class="delimiter">&quot;</span></span>)
    <span class="directive">private</span> DomainObjectContainer container;

    <span class="directive">public</span> <span class="type">void</span> setDomainObjectContainer(<span class="directive">final</span> DomainObjectContainer container) {
        <span class="local-variable">this</span>.container = container;
    }
    <span class="comment">// }}</span>

    <span class="comment">// {{ injected: ToDoItems</span>
    <span class="directive">private</span> ToDoItems toDoItems;

    <span class="directive">public</span> <span class="type">void</span> setToDoItems(<span class="directive">final</span> ToDoItems toDoItems) {
        <span class="local-variable">this</span>.toDoItems = toDoItems;
    }
    <span class="comment">// }}</span>

}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_isis_addons_not_asf">12. Isis Addons (not ASF)</h2>
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Note that Isis addons, while maintained by Isis committers, are not part of the ASF.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_command_service_persistence">12.1. Command Service (persistence)</h3>
<div class="sect3">
<h4 id="_api_4">12.1.1. API</h4>

</div>
<div class="sect3">
<h4 id="_isis_addons_implementation_not_asf">12.1.2. Isis addons implementation  (not ASF)</h4>

</div>
</div>
<div class="sect2">
<h3 id="_background_command_service">12.2. Background Command Service</h3>
<div class="sect3">
<h4 id="_api_5">12.2.1. API</h4>

</div>
<div class="sect3">
<h4 id="_background_execution_2">12.2.2. Background Execution</h4>

</div>
<div class="sect3">
<h4 id="_isis_addons_implementation_not_asf_2">12.2.3. Isis addons implementation (not ASF)</h4>

</div>
</div>
<div class="sect2">
<h3 id="_auditing">12.3. Auditing</h3>
<div class="sect3">
<h4 id="_auditing_api">12.3.1. Auditing API</h4>

</div>
<div class="sect3">
<h4 id="_isis_addons_implementation_not_asf_3">12.3.2. Isis addons implementation (not ASF)</h4>

</div>
</div>
<div class="sect2">
<h3 id="_publishing_service_2">12.4. Publishing Service</h3>
<div class="sect3">
<h4 id="_api_6">12.4.1. API</h4>

</div>
<div class="sect3">
<h4 id="_isis_addons_implementation_not_asf_4">12.4.2. Isis addons implementation (not ASF)</h4>

</div>
<div class="sect3">
<h4 id="_event_serializer_per_ro_spec_out_of_date">12.4.3. Event Serializer per RO Spec (out-of-date)</h4>

</div>
</div>
<div class="sect2">
<h3 id="_other_isis_addons">12.5. Other Isis Addons</h3>
<div class="sect3">
<h4 id="_developer_utilities_not_asf">12.5.1. Developer Utilities (not ASF)</h4>

</div>
<div class="sect3">
<h4 id="_docx_mail_merge_not_asf">12.5.2. Docx Mail merge (not ASF)</h4>

</div>
<div class="sect3">
<h4 id="_excel_download_upload_not_asf">12.5.3. Excel download/upload (not ASF)</h4>

</div>
<div class="sect3">
<h4 id="_fake_data_not_asf">12.5.4. Fake Data (not ASF)</h4>

</div>
<div class="sect3">
<h4 id="_poly_not_asf">12.5.5. Poly (not ASF)</h4>

</div>
<div class="sect3">
<h4 id="_security_not_asf">12.5.6. Security (not ASF)</h4>

</div>
<div class="sect3">
<h4 id="_session_logger_not_asf">12.5.7. Session Logger (not ASF)</h4>

</div>
<div class="sect3">
<h4 id="_settings_not_asf">12.5.8. Settings (not ASF)</h4>

</div>
<div class="sect3">
<h4 id="_string_interpolator_not_asf">12.5.9. String interpolator (not ASF)</h4>

</div>
<div class="sect3">
<h4 id="_tags_not_asf">12.5.10. Tags (not ASF)</h4>

</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_integrating_with_other_systems">13. Integrating with Other Systems</h2>
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_non_ui_execution">13.1. Non UI Execution</h3>
<div class="paragraph">
<p>Using <code>IsisSessionTemplate</code></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_extending">14. Extending</h2>
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_extending_the_programming_model">14.1. Extending the Programming Model</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_disallowing_deprecated_annotations">14.1.1. Disallowing deprecated annotations</h4>

</div>
<div class="sect3">
<h4 id="_custom_validator">14.1.2. Custom validator</h4>

</div>
<div class="sect3">
<h4 id="_finetuning_the_programming_model">14.1.3. Finetuning the Programming Model</h4>

</div>
<div class="sect3">
<h4 id="_layout_metadata_reader">14.1.4. Layout metadata reader</h4>

</div>
</div>
<div class="sect2">
<h3 id="_extending_the_wicket_viewer">14.2. Extending the Wicket viewer</h3>
<div class="sect3">
<h4 id="_writing_a_custom_theme">14.2.1. Writing a custom theme</h4>

</div>
<div class="sect3">
<h4 id="_replacing_page_elements">14.2.2. Replacing page elements</h4>

</div>
<div class="sect3">
<h4 id="_custom_pages">14.2.3. Custom pages</h4>

</div>
</div>
<div class="sect2">
<h3 id="_extending_the_restful_viewer">14.3. Extending the Restful viewer</h3>
<div class="sect3">
<h4 id="_custom_representations">14.3.1. Custom Representations</h4>

</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_trouble_shooting">15. Trouble Shooting</h2>
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_logging">15.1. Logging</h3>

</div>
<div class="sect2">
<h3 id="_enabling_logging">15.2. Enabling Logging</h3>
<div class="paragraph">
<p>Sometimes you just need to see what is going on. There are various ways in which logging can be enabled, here are the ones we tend to use.</p>
</div>
<div class="sect3">
<h4 id="_in_apache_isis">15.2.1. In Apache Isis</h4>
<div class="paragraph">
<p>Modify <code>WEB-INF/logging.properties</code> (a log4j config file)</p>
</div>
</div>
<div class="sect3">
<h4 id="_in_datanucleus">15.2.2. In DataNucleus</h4>
<div class="paragraph">
<p>As per the <a href="http://www.datanucleus.org/products/accessplatform/logging.html">DN logging page</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_in_the_jdbc_driver">15.2.3. In the JDBC Driver</h4>
<div class="paragraph">
<p>Configure log4jdbc JDBC rather than the vanilla driver (see <code>WEB-INF/persistor_datanucleus.properties</code>) and configure log4j logging (see <code>WEB-INF/logging.properties</code>).</p>
</div>
<div class="paragraph">
<p>There are examples of both in the <a href="#_simpleapp_archetype">SimpleApp archetype</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_in_the_database">15.2.4. In the Database</h4>
<div class="sect4">
<h5 id="_hsqldb_logging">HSQLDB Logging</h5>
<div class="paragraph">
<p>Add <code>;sqllog=3</code> to the end of the JDBC URL.</p>
</div>
</div>
<div class="sect4">
<h5 id="_postgresql_logging">PostgreSQL Logging</h5>
<div class="paragraph">
<p>In <code>postgresql\9.2\data\postgresql.conf</code>:</p>
</div>
<div class="paragraph">
<p>Will then log to <code>postgresql\9.2\data\pg_log</code> directory.</p>
</div>
<div class="paragraph">
<p>Note that you must restart the service for this to be picked up.</p>
</div>
</div>
<div class="sect4">
<h5 id="_ms_sql_server_logging">MS SQL Server Logging</h5>
<div class="paragraph">
<p>Use the excellent SQL Profiler tool.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_appendices">16. Appendices</h2>
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_setting_up_a_development_environment">16.1. Setting up a Development Environment</h3>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_developing_from_the_command_line">16.1.1. Developing from the Command Line</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_setting_up_intellij_idea">16.1.2. Setting up IntelliJ IDEA</h4>
<div class="sect4">
<h5 id="_installing_and_setting_up">Installing and Setting up</h5>
<div class="sect5">
<h6 id="_download_and_install">Download and Install</h6>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This doc used IntelliJ Community Edition 14.1.1, with screenshots taken for Windows.  If you&#8217;re a MacOS user, I&#8217;m sure you can adapt :-)
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p><a href="https://www.jetbrains.com/idea/download/">Download</a> latest version of IntelliJ Community Edition, and install:</p>
</div>
<div class="paragraph">
<p>Start the wizard, click through the welcome page:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/010-installing/010-welcome-page.png" alt="010 welcome page" width="400px">
</div>
<div class="title">Figure 5. IntelliJ Installation Wizard - Welcome page</div>
</div>
<div class="paragraph">
<p>Choose the location to install the IDE:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/010-installing/020-choose-location.png" alt="020 choose location" width="400px">
</div>
<div class="title">Figure 6. IntelliJ Installation Wizard - Choose Location</div>
</div>
<div class="paragraph">
<p>Adjust any installation options as you prefer:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/010-installing/030-installation-options.png" alt="030 installation options" width="400px">
</div>
<div class="title">Figure 7. IntelliJ Installation Wizard - Installation Options</div>
</div>
<div class="paragraph">
<p>and the start menu:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/010-installing/040-start-menu-folder.png" alt="040 start menu folder" width="400px">
</div>
<div class="title">Figure 8. IntelliJ Installation Wizard - Start Menu Folder</div>
</div>
<div class="paragraph">
<p>and finish up the wizard:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/010-installing/050-completing.png" alt="050 completing" width="400px">
</div>
<div class="title">Figure 9. IntelliJ Installation Wizard - Completing the Wizard</div>
</div>
<div class="paragraph">
<p>Later on we&#8217;ll specify the Apache Isis/ASF code style settings, so for now select <code>I do not want to import settings</code>:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/010-installing/060-import-settings-or-not.png" alt="060 import settings or not" width="400px">
</div>
<div class="title">Figure 10. IntelliJ Installation Wizard - Import Settings</div>
</div>
<div class="paragraph">
<p>Finally, if you are young and trendy, set the UI theme to Darcula:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/010-installing/070-set-ui-theme.png" alt="070 set ui theme" width="600px">
</div>
<div class="title">Figure 11. IntelliJ Installation Wizard Set UI Theme</div>
</div>
</div>
<div class="sect5">
<h6 id="_new_project">New Project</h6>
<div class="paragraph">
<p>In IntelliJ a project can contain multiple modules; these need not be physically located together.  (If you are previously an Eclipse user, you can think of it as similar to an Eclipse workspace).</p>
</div>
<div class="paragraph">
<p>Start off by creating a new project:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/020-create-new-project/010-new-project-create.png" alt="010 new project create" width="400px">
</div>
<div class="title">Figure 12. IntelliJ Create New Project</div>
</div>
<div class="paragraph">
<p>We want to create a new <strong>Java</strong> project:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/020-create-new-project/020-java-project-setup-jdk.png" alt="020 java project setup jdk" width="600px">
</div>
<div class="title">Figure 13. IntelliJ Create New Project - Create a Java project</div>
</div>
<div class="paragraph">
<p>We therefore need to specify the JDK.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
at the time of writing Isis supports only Java 7; Java 8 is scheduled for support in Isis v1.9.0
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/020-create-new-project/030-java-project-select-jdk.png" alt="030 java project select jdk" width="300px">
</div>
<div class="title">Figure 14. IntelliJ Create New Java Project - Select the JDK</div>
</div>
<div class="paragraph">
<p>Specify the directory containing the JDK:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/020-create-new-project/050-name-and-location.png" alt="050 name and location" width="400px">
</div>
<div class="title">Figure 15. IntelliJ Create New Project - Select the JDK location</div>
</div>
<div class="paragraph">
<p>Finally allow IntelliJ to create the directory for the new project:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/020-create-new-project/060-create-dir.png" alt="060 create dir" width="200px">
</div>
<div class="title">Figure 16. IntelliJ Create New Project</div>
</div>
</div>
<div class="sect5">
<h6 id="_import_settings">Import Settings</h6>
<div class="paragraph">
<p>Next we need to configure IntelliJ with ASF/Apache Isis' standard templates and coding conventions.  These are bundled as the <code>settings.jar</code> JAR file <a href="resources/appendices/dev-env/intellij/isis-settings.jar">download from the Isis website</a>).</p>
</div>
<div class="paragraph">
<p>Import using: <code>File &gt; Import Settings</code>, and specify the directory that you have downloaded the file to:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/030-import-settings/010-settings-import-jar.png" alt="010 settings import jar" width="400px">
</div>
<div class="title">Figure 17. IntelliJ Import Settings - Specify JAR file</div>
</div>
<div class="paragraph">
<p>Select all the (two) categories of settings available in the JAR file:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/030-import-settings/020-select-all.png" alt="020 select all" width="300px">
</div>
<div class="title">Figure 18. IntelliJ Import Settings - Select all categories</div>
</div>
<div class="paragraph">
<p>And then restart:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/030-import-settings/030-restart.png" alt="030 restart" width="200px">
</div>
<div class="title">Figure 19. IntelliJ Import Settings - Restart</div>
</div>
</div>
<div class="sect5">
<h6 id="_other_settings">Other Settings</h6>
<div class="paragraph">
<p>There are also some other miscellaneous settings that we recommend that you adjust (though these are not critical).</p>
</div>
<div class="paragraph">
<p>First, specify an up-to-date Maven installation, using <code>File &gt; Settings</code> (or <code>IntelliJ &gt; Preferences</code> if on MacOS):</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/040-other-settings/010-maven-installation.png" alt="010 maven installation" width="600px">
</div>
<div class="title">Figure 20. IntelliJ Other Settings - Maven Installation</div>
</div>
<div class="paragraph">
<p>Still on the Maven settings page, configure as follows:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/040-other-settings/020-maven-configuration.png" alt="020 maven configuration" width="600px">
</div>
<div class="title">Figure 21. IntelliJ Other Settings - Maven Configuration</div>
</div>
<div class="paragraph">
<p>On the compiler settings page, ensure that <code>build automatically</code> is enabled (and optionally <code>compile independent modules in parallel</code>):</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/040-other-settings/030-build-automatically.png" alt="030 build automatically" width="600px">
</div>
<div class="title">Figure 22. IntelliJ Other Settings - Compiler Settings</div>
</div>
<div class="paragraph">
<p>On the auto import page, check the <code>optimize imports on the fly</code> and <code>add unambiguous imports on the fly</code></p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/040-other-settings/040-auto-import.png" alt="040 auto import" width="600px">
</div>
<div class="title">Figure 23. IntelliJ Other Settings - Auto Import</div>
</div>
</div>
<div class="sect5">
<h6 id="_plugins">Plugins</h6>
<div class="paragraph">
<p>You might also want to set up some additional plugins, using <code>File &gt; Settings &gt; Plugins</code> (or equivalently <code>File &gt; Other Settings &gt; Configure Plugins</code>).</p>
</div>
<div class="paragraph">
<p>Recommended are:
* <a href="https://plugins.jetbrains.com/plugin/7179?pr=idea">Maven Helper</a> plugin</p>
</div>
<div class="paragraph">
<p>+
Provides better visualization of dependency trees (similar to Eclipse)
* <a href="https://github.com/asciidoctor/asciidoctor-intellij-plugin">AsciiDoctor</a> plugin</p>
</div>
<div class="paragraph">
<p>+
Useful if you are doing any authoring of documents.</p>
</div>
<div class="paragraph">
<p>Some others you might like to explore are:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/050-some-plugins/020-some-plugins-confirmation.png" alt="020 some plugins confirmation" width="400px">
</div>
<div class="title">Figure 24. IntelliJ Plugins</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_importing_and_managing_maven_modules">Importing and Managing Maven Modules</h5>
<div class="paragraph">
<p>Let&#8217;s load in some actual code!  We do this by importing the Maven modules.</p>
</div>
<div class="paragraph">
<p>First up, open up the Maven tool window (<code>View &gt; Tool Windows &gt; Maven Projects</code>).  You can then use the 'plus' button to add Maven modules.  In the screenshot you can see we&#8217;ve loaded in Isis core; the modules are listed in the <em>Maven Projects</em> window and corresponding (IntelliJ) modules are shown in the <em>Projects</em> window:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/100-maven-module-mgmt/010-maven-modules-view.png" alt="010 maven modules view" width="730px">
</div>
<div class="title">Figure 25. IntelliJ Maven Module Management - Importing Maven modules</div>
</div>
<div class="paragraph">
<p>We can then import another module (from some other directory).  For example, here we are importing the Isis Addons' todoapp example:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/100-maven-module-mgmt/020-adding-another-module.png" alt="020 adding another module" width="400px">
</div>
<div class="title">Figure 26. IntelliJ Maven Module Management - Importing another Module</div>
</div>
<div class="paragraph">
<p>You should then see the new Maven module loaded in the <em>Projects</em> window and also the <em>Maven Projects</em> window:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/100-maven-module-mgmt/030-other-module-added.png" alt="030 other module added" width="730px">
</div>
<div class="title">Figure 27. IntelliJ Maven Module Management -</div>
</div>
<div class="paragraph">
<p>If any dependencies are already loaded in the project, then IntelliJ will automatically update the CLASSPATH to resolve to locally held modules (rather from <code>.m2/repository</code> folder).  So, for example (assuming that the <code>&lt;version&gt;</code> is correct, of course), the Isis todoapp will have local dependencies on the Isis core.</p>
</div>
<div class="paragraph">
<p>You can press F4 (or use <code>File &gt; Project Structure</code>) to see the resolved classpath for any of the modules loaded into the project.</p>
</div>
<div class="paragraph">
<p>If you want to focus on one set of code (eg the Isis todoapp but not Isis core) then you <em>could</em> remove the module; but better is to ignore those modules.  This will remove from the the <em>Projects</em> window but keep them available in the <em>Maven Projects</em> window for when you next want to work on them:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/100-maven-module-mgmt/040-ignoring-modules.png" alt="040 ignoring modules" width="730px">
</div>
<div class="title">Figure 28. IntelliJ Maven Module Management - Ignoring Modules</div>
</div>
<div class="paragraph">
<p>Confirm that it&#8217;s ok to ignore these modules:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/100-maven-module-mgmt/050-ignoring-modules-2.png" alt="050 ignoring modules 2" width="300px">
</div>
<div class="title">Figure 29. IntelliJ Maven Module Management - Ignoring Modules (ctd)</div>
</div>
<div class="paragraph">
<p>All being well you should see that the <em>Projects</em> window now only contains the code you are working on.  Its classpath dependencies will be adjusted (eg to resolve to Isis core from <code>.m2/repository</code>):</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/100-maven-module-mgmt/060-ignored-modules.png" alt="060 ignored modules" width="730px">
</div>
<div class="title">Figure 30. IntelliJ Maven Module Management - Updated Projects Window</div>
</div>
</div>
<div class="sect4">
<h5 id="_running">Running</h5>
<div class="paragraph">
<p>Let&#8217;s see how to run both the app and the tests.</p>
</div>
<div class="sect5">
<h6 id="_running_the_app">Running the App</h6>
<div class="paragraph">
<p>Once you&#8217;ve imported your Isis application, we should run it.  We do this by creating a Run configuration, using <code>Run &gt; Edit Configurations</code>.</p>
</div>
<div class="paragraph">
<p>Set up the details as follows:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/110-running-the-app/010-run-configuration.png" alt="010 run configuration" width="600px">
</div>
<div class="title">Figure 31. IntelliJ Running the App - Run Configuration</div>
</div>
<div class="paragraph">
<p>We specify the <code>Main class</code> to be <code>org.apache.isis.WebServer</code>; this is a wrapper around Jetty.  It&#8217;s possible to pass program arguments to this (eg to automatically install fixtures), but for now leave this blank.</p>
</div>
<div class="paragraph">
<p>Also note that <code>Use classpath of module</code> is the webapp module for your app, and that the <code>working directory</code> is <code>$MODULE_DIR$</code>.</p>
</div>
<div class="paragraph">
<p>Next, and most importantly, configure the DataNucleus enhancer to run for your <code>dom</code> goal.  This can be done by defining a Maven goal to run before the app:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/110-running-the-app/020-datanucleus-enhancer-goal.png" alt="020 datanucleus enhancer goal" width="400px">
</div>
<div class="title">Figure 32. IntelliJ Running the App - Datanucleus Enhancer Goal</div>
</div>
<div class="paragraph">
<p>The <code>-o</code> flag in the goal means run off-line; this will run faster.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
if you forget to set up the enhancer goal, or don&#8217;t run it on the correct (dom) module, then you will get all sorts of errors when you startup.  These usually manifest themselves as class cast exception in DataNucleus.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You should now be able to run the app using <code>Run &gt; Run Configuration</code>.  The same configuration can also be used to debug the app if you so need.</p>
</div>
</div>
<div class="sect5">
<h6 id="_running_the_unit_tests">Running the Unit Tests</h6>
<div class="paragraph">
<p>The easiest way to run the unit tests is just to right click on the <code>dom</code> module in the <em>Project Window</em>, and choose run unit tests.  Hopefully your tests will pass (!).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/110-running-the-app/030-running-unit-tests.png" alt="030 running unit tests" width="600px">
</div>
<div class="title">Figure 33. IntelliJ Running the App - Unit Tests Run Configuration</div>
</div>
<div class="paragraph">
<p>As a side-effect, this will create a run configuration, very similar to the one we manually created for the main app:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/110-running-the-app/040-running-unit-tests-run-configuration.png" alt="040 running unit tests run configuration" width="600px">
</div>
<div class="title">Figure 34. IntelliJ Running the App - Unit Tests Run Configuration</div>
</div>
<div class="paragraph">
<p>Thereafter, you should run units by selecting this configuration (if you use the right click approach you&#8217;ll end up with lots of run configurations, all similar).</p>
</div>
</div>
<div class="sect5">
<h6 id="_running_the_integration_tests">Running the Integration Tests</h6>
<div class="paragraph">
<p>Integration tests can be run in the same way as unit tests, however the <code>dom</code> module must also have been enhanced.</p>
</div>
<div class="paragraph">
<p>One approach is to initially run the tests use the right click on the <code>integtests</code> module; the tests will fail because the code won&#8217;t have been enhanced, but we can then go and update the run configuration to run the datanucleus enhancer goal (same as when running the application):</p>
</div>
<div class="imageblock">
<div class="content">
<img src="images/appendices/dev-env/intellij-idea/110-running-the-app/050-running-integration-tests-run-configuration.png" alt="050 running integration tests run configuration" width="600px">
</div>
<div class="title">Figure 35. IntelliJ Running the App - Integration Tests Run Configuration</div>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_hints_and_tips_2">Hints and Tips</h5>
<div class="sect5">
<h6 id="_keyboard_shortcuts_cheat_sheets">Keyboard Shortcuts Cheat Sheets</h6>
<div class="paragraph">
<p>You can download 1-page PDFs cheat sheets for IntelliJ&#8217;s keyboard shortcuts:
* for <a href="https://www.jetbrains.com/idea/docs/IntelliJIDEA_ReferenceCard.pdf">Windows</a>
* for MacOS:https://www.jetbrains.com/idea/docs/IntelliJIDEA_ReferenceCard_Mac.pdf[MacOS]</p>
</div>
<div class="paragraph">
<p>Probably the most important shortcut on them is for <code>Find Action</code>:
- <code>ctrl-shift-A</code> on Windows
- <code>cmd-shift-A</code> on MacOS.</p>
</div>
<div class="paragraph">
<p>This will let you search for any action just by typing its name.</p>
</div>
</div>
<div class="sect5">
<h6 id="_switching_between_tool_windows_and_editors">Switching between Tool Windows and Editors</h6>
<div class="paragraph">
<p>The Tool Windows are the views around the editor (to left, bottom and right).  It&#8217;s possible to move these around to your preferred locations.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Use <code>alt-1</code> through <code>alt-9</code> (or <code>cmd-1</code> through <code>alt-9</code>) to select the tool windows</p>
<div class="ulist">
<ul>
<li>
<p>Press it twice and the tool window will hide itself; so can use to toggle</p>
</li>
</ul>
</div>
</li>
<li>
<p>If in the <em>Project Window</em> (say) and hit enter on a file, then it will be shown in the editor, but (conveniently) the focus remains in the tool window.  To switch to the editor, just press <code>Esc</code>.</p>
<div class="ulist">
<ul>
<li>
<p>If in the <em>Terminal Window</em>, you&#8217;ll need to press <code>Shift-Esc</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>If on the editor and want to locate the file in (say) the <em>Project Window</em>, use <code>alt-F1</code>.</p>
</li>
<li>
<p>To change the size of any tool window, use <code>ctrl-shift-arrow</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Using these shortcuts you can easily toggle between the tool windows and the editor, without using the mouse.  Peachy!</p>
</div>
</div>
<div class="sect5">
<h6 id="_navigating_around">Navigating Around</h6>
<div class="paragraph">
<p>For all of the following, you don&#8217;t need to type every letter, typing "ab" will actually search for ".<strong>a.*b.</strong>".</p>
</div>
<div class="ulist">
<ul>
<li>
<p>to open classes or files or methods that you know the name of:</p>
<div class="ulist">
<ul>
<li>
<p><code>ctrl-N</code> to open class</p>
</li>
<li>
<p><code>ctrl-shift-N</code> to open a file</p>
</li>
<li>
<p>(bit fiddly this) <code>ctrl-shift-alt-N</code> to search for any symbol.</p>
</li>
</ul>
</div>
</li>
<li>
<p>open up dialog of recent files: <code>ctrl-E</code></p>
</li>
<li>
<p>search for any file: <code>shift-shift</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Navigating around:
* find callers of a method (the call hierarchy): <code>ctrl-alt-H</code>
* find subclasses or overrides: <code>ctrl-alt-B</code>
* find superclasses/interface/declaration: <code>ctrl-B</code></p>
</div>
<div class="paragraph">
<p>Viewing the structure (ie outline) of a class
* <code>ctrl-F12</code> will pop-up a dialog showing all members
** hit <code>ctrl-F12</code> again to also see inherited members</p>
</div>
</div>
<div class="sect5">
<h6 id="_editing">Editing</h6>
<div class="ulist">
<ul>
<li>
<p>Extend selection using <code>ctrl-W</code></p>
<div class="ulist">
<ul>
<li>
<p>and contract it down again using <code>ctrl-shift-W</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>to duplicate a line, it&#8217;s <code>ctrl-D</code></p>
<div class="ulist">
<ul>
<li>
<p>if you have some text selected (or even some lines), it&#8217;ll actually duplicate the entire selection</p>
</li>
</ul>
</div>
</li>
<li>
<p>to delete a line, it&#8217;s <code>ctrl-X</code></p>
</li>
<li>
<p>to move a line up or down: <code>shift-alt-up</code> and <code>shift-alt-down</code></p>
<div class="ulist">
<ul>
<li>
<p>if you have selected several lines, it&#8217;ll move them all togethe</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>ctrl-shift-J</code> can be handy for joining lines together</p>
<div class="ulist">
<ul>
<li>
<p>just hit enter to split them apart (even in string quotes; IntelliJ will "do the right thing")</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="sect5">
<h6 id="_intentions_and_code_completion">Intentions and Code Completion</h6>
<div class="paragraph">
<p>Massively useful is the "Intentions" popup; IntelliJ tries to guess what you might want to do.  You can activate this using`alt-enter`, whenever you see a lightbulb/tooltip in the margin of the current line.</p>
</div>
<div class="paragraph">
<p>Code completion usually happens whenever you type '.'.  You can also use <code>ctrl-space</code> to bring these up.</p>
</div>
<div class="paragraph">
<p>In certain circumstances (eg in methods0) you can also type <code>ctrl-shift-space</code> to get a smart list of methods etc that you might want to call.  Can be useful.</p>
</div>
<div class="paragraph">
<p>Last, when invoking a method, use <code>ctrl-P</code> to see the parameter types.</p>
</div>
</div>
<div class="sect5">
<h6 id="_refactoring">Refactoring</h6>
<div class="paragraph">
<p>Loads of good stuff on the <code>Refactor</code> menu; most used are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Rename (<code>shift-F6</code>)</p>
</li>
<li>
<p>Extract</p>
<div class="ulist">
<ul>
<li>
<p>method: <code>ctrl-alt-M</code></p>
</li>
<li>
<p>variable: <code>ctrl-alt-V</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>Inline method/variable: <code>ctrl-alt-N</code></p>
</li>
<li>
<p>Change signature</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you can&#8217;t remember all those shortcuts, just use <code>ctrl-shift-alt-T</code> (might want to rebind that to something else!) and get a context-sensitive list of refactorings available for the currently selected object</p>
</div>
</div>
<div class="sect5">
<h6 id="_troubleshooting">Troubleshooting</h6>
<div class="paragraph">
<p>When a Maven module is imported, IntelliJ generates its own project files (suffix <code>.ipr</code>), and the application is actually built from that.</p>
</div>
<div class="paragraph">
<p>Occasionally these don&#8217;t keep in sync (even if auto-import of Maven modules has been enabled).</p>
</div>
<div class="paragraph">
<p>To fix the issue, try:
* reimport module
* rebuild selected modules/entire project
* remove and then re-add the project
* restart, invalidating caches
* hit StackOverflow (!)</p>
</div>
<div class="paragraph">
<p>One thing worth knowing; IntelliJ actively scans the filesystem all the time.  It&#8217;s therefore (almost always) fine to build the app from the Maven command line; IntelliJ will detect the changes and keep in sync.  If you want to force that, use <code>File &gt; Synchronize</code>, <code>ctrl-alt-Y</code>.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_advanced">Advanced</h5>
<div class="paragraph">
<p>In this section are a couple of options that will reduce the length of the change code/build/deploy/review feedback loop.</p>
</div>
<div class="sect5">
<h6 id="_setting_up_dynamic_reloading">Setting up Dynamic Reloading</h6>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect5">
<h6 id="_setting_up_jrebel">Setting up JRebel</h6>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_setting_up_eclipse">16.1.3. Setting up Eclipse</h4>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_release_notes">16.2. Release Notes</h3>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 14%;">
<col style="width: 14%;">
<col style="width: 28%;">
<col style="width: 42%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Version</th>
<th class="tableblock halign-left valign-top">Date</th>
<th class="tableblock halign-left valign-top">Components</th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.8.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">24-feb-2015</p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p><a href="https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12311171&amp;version=12328845">core-1.8.0</a></p>
</li>
<li>
<p><a href="https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12311171&amp;version=12328847">archetype-1.8.0</a></p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Wicket viewer moved into core; todoapp archetype moved to <a href="http://isisaddons.org">Isis Addons</a> (non-ASF).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.7.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">18-oct-2014</p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p><a href="https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12311171&amp;version=12326453">core-1.7.0</a></p>
</li>
<li>
<p><a href="https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12311171&amp;version=12326460">viewer-wicket-1.7.0</a></p>
</li>
<li>
<p><a href="https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12311171&amp;version=12327441">archetype-simpleapp-1.7.0</a></p>
</li>
<li>
<p><a href="https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12311171&amp;version=12327440">archetype-todoapp-1.7.0</a></p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Module functionality previously in 1.6.0 now retired; use <a href="http://isisaddons.org">Isis Addons</a> (non-ASF) instead.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.6.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28-jul-2014</p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p><a href="https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12311171&amp;version=12325314">core-1.6.0</a></p>
</li>
<li>
<p><a href="https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12311171&amp;version=12325318">viewer-wicket-1.6.0</a></p>
</li>
<li>
<p><a href="https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12311171&amp;version=12326462">archetype-simpleapp-1.6.0</a></p>
</li>
<li>
<p><a href="https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12311171&amp;version=12326461">archetype-todoapp-1.6.0</a></p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>RestfulObjects viewer, JDO/Datanucleus Objectstore and Shiro Security all moved into core.  Quickstart-wrj archetype renamed to todoapp; simple-wrj archetype renamed to simpleapp.  Some functionality copied/refactored as <a href="http://isisaddons.org">Isis Addons</a> (non-ASF).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.5.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">08-jun-2014</p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p><a href="https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12311171&amp;version=12326524">core-1.5.0</a></p>
</li>
<li>
<p><a href="https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12311171&amp;version=12326525">objectstore-jdo-1.5.0</a></p>
</li>
<li>
<p><a href="https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12311171&amp;version=12326529">security-shiro-1.5.0</a></p>
</li>
<li>
<p><a href="https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12311171&amp;version=12326947">viewer-restfulobjects-2.3.0</a></p>
</li>
<li>
<p><a href="https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12311171&amp;version=12326526">viewer-wicket-1.5.0</a></p>
</li>
<li>
<p><a href="https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12311171&amp;version=12326528">archetype-simple-wrj-1.5.0</a></p>
</li>
<li>
<p><a href="https://issues.apache.org/jira/secure/ReleaseNote.jspa?projectId=12311171&amp;version=12326527">archetype-quickstart-wrj-1.5.0</a></p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>No longer releasing security-file</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">14-mar-2014</p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>objectstore-jdo-1.4.1</p>
</li>
<li>
<p>viewer-wicket-1.4.1</p>
</li>
<li>
<p>archetype-simple-wrj-1.4.1</p>
</li>
<li>
<p>archetype-quickstart-wrj-1.4.1</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Patch release</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">11-mar-2014</p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>core-1.4.0</p>
</li>
<li>
<p>objectstore-jdo-1.4.0</p>
</li>
<li>
<p>security-file-1.4.0</p>
</li>
<li>
<p>security-shiro-1.4.0</p>
</li>
<li>
<p>viewer-restfulobjects-2.2.0</p>
</li>
<li>
<p>viewer-wicket-1.4.0</p>
</li>
<li>
<p>archetype-simple-wrj-1.4.0</p>
</li>
<li>
<p>archetype-quickstart-wrj-1.4.0</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">7-nov-2013</p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>viewer-wicket-1.3.1</p>
</li>
<li>
<p>archetype-simple-wrj-1.3.1</p>
</li>
<li>
<p>archetype-quickstart-wrj-1.3.1</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Patch release</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">25-oct-2013</p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>core-1.3.0</p>
</li>
<li>
<p>objectstore-jdo-1.3.0</p>
</li>
<li>
<p>security-file-1.0.2</p>
</li>
<li>
<p>security-shiro-1.3.0</p>
</li>
<li>
<p>viewer-restfulobjects-2.1.0</p>
</li>
<li>
<p>viewer-wicket-1.3.0</p>
</li>
<li>
<p>archetype-simple-wrj-1.3.0</p>
</li>
<li>
<p>archetype-quickstart-wrj-1.3.0</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>WRJ archetype renamed to Quickstart WRJ.  Simple WRJ archetype added.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.2.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30-may-2013</p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>core-1.2.0</p>
</li>
<li>
<p>objectstore-jdo-1.2.0</p>
</li>
<li>
<p>security-file-1.0.1</p>
</li>
<li>
<p>security-shiro-1.1.1</p>
</li>
<li>
<p>viewer-restfulobjects-2.0.0</p>
</li>
<li>
<p>viewer-wicket-1.2.0</p>
</li>
<li>
<p>archetype-wrj-1.0.3</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">31-jan-2013</p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>core-1.1.0</p>
</li>
<li>
<p>security-shiro-1.1.0</p>
</li>
<li>
<p>viewer-wicket-1.1.0</p>
</li>
<li>
<p>archetype-wrj-1.0.2</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10-jan-2013</p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>security-shiro-1.0.0</p>
</li>
<li>
<p>archetype-wrj-1.0.1</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>Combining RestfulObjects and Wicket viewers into a single webapp, along with Shiro security</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">24-dec-2012</p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>core-1.0.0</p>
</li>
<li>
<p>security-file-1.0.0</p>
</li>
<li>
<p>viewer-wicket-1.0.0</p>
</li>
<li>
<p>viewer-restfulobjects-1.0.0</p>
</li>
<li>
<p>archetype-wrj-1.0.0</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>First release having graduated</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.2.0-incubating</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">20-feb-2012</p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>0.2.0-incubating</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.1.2-incubating</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">13-jul-2011</p></td>
<td class="tableblock halign-left valign-top"><div><div class="ulist">
<ul>
<li>
<p>0.1.2-incubating</p>
</li>
</ul>
</div></div></td>
<td class="tableblock halign-left valign-top"><div><div class="paragraph">
<p>First release in the ASF incubator</p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_migration_notes">16.3. Migration Notes</h3>
<div class="sect3">
<h4 id="_upgrading_to_datanucleus_4_in_1_9_0_snapshot">16.3.1. Upgrading to DataNucleus 4 (in 1.9.0-SNAPSHOT)</h4>
<div class="paragraph">
<p>Isis 1.9.0 updates to DataNucleus 4.0.0, which requires some changes (simplifications) to the Maven configuration.</p>
</div>
<div class="paragraph">
<p>If you starting a new app then you can start from the <a href="#SimpleApp archetype">[SimpleApp archetype]</a>; its Maven configuration has been updated.</p>
</div>
<div class="paragraph">
<p>If you have an existing Isis app that you want to upgrade, then you&#8217;ll need to make some changes.</p>
</div>
<div class="sect4">
<h5 id="_in_the_parent_code_pom_xml_code">In the parent <code>pom.xml</code></h5>
<div class="paragraph">
<p>under the <code>&lt;project&gt;/&lt;properties&gt;</code>, remove:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="comment">&lt;!-- must be consistent with the versions defined by the JDO Objectstore --&gt;</span>
<span class="tag">&lt;datanucleus-accessplatform-jdo-rdbms.version&gt;</span>3.3.6<span class="tag">&lt;/datanucleus-accessplatform-jdo-rdbms.version&gt;</span>
<span class="tag">&lt;datanucleus-maven-plugin.version&gt;</span>3.3.2<span class="tag">&lt;/datanucleus-maven-plugin.version&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_in_code_dom_pom_xml_code">In <code>dom/pom.xml</code>,</h5>
<div class="paragraph">
<p>under <code>&lt;build&gt;/&lt;plugins&gt;</code>, remove:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;plugin&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.datanucleus<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>datanucleus-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>${datanucleus-maven-plugin.version}<span class="tag">&lt;/version&gt;</span>
    <span class="tag">&lt;configuration&gt;</span>
        <span class="tag">&lt;fork&gt;</span>false<span class="tag">&lt;/fork&gt;</span>
        <span class="tag">&lt;log4jConfiguration&gt;</span>${basedir}/log4j.properties<span class="tag">&lt;/log4jConfiguration&gt;</span>
        <span class="tag">&lt;verbose&gt;</span>true<span class="tag">&lt;/verbose&gt;</span>
        <span class="tag">&lt;props&gt;</span>${basedir}/datanucleus.properties<span class="tag">&lt;/props&gt;</span>
    <span class="tag">&lt;/configuration&gt;</span>
    <span class="tag">&lt;executions&gt;</span>
        <span class="tag">&lt;execution&gt;</span>
            <span class="tag">&lt;phase&gt;</span>compile<span class="tag">&lt;/phase&gt;</span>
            <span class="tag">&lt;goals&gt;</span>
                <span class="tag">&lt;goal&gt;</span>enhance<span class="tag">&lt;/goal&gt;</span>
            <span class="tag">&lt;/goals&gt;</span>
        <span class="tag">&lt;/execution&gt;</span>
    <span class="tag">&lt;/executions&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>and (if you have it) under <code>&lt;build&gt;/&lt;pluginManagement&gt;/&lt;plugins&gt;</code>, remove:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="comment">&lt;!--This plugin's configuration is used to store Eclipse m2e settings only. It has no influence on the Maven build itself.--&gt;</span>
<span class="tag">&lt;plugin&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.eclipse.m2e<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>lifecycle-mapping<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>1.0.0<span class="tag">&lt;/version&gt;</span>
    <span class="tag">&lt;configuration&gt;</span>
        <span class="tag">&lt;lifecycleMappingMetadata&gt;</span>
            <span class="tag">&lt;pluginExecutions&gt;</span>
                <span class="tag">&lt;pluginExecution&gt;</span>
                    <span class="tag">&lt;pluginExecutionFilter&gt;</span>
                        <span class="tag">&lt;groupId&gt;</span>
                            org.datanucleus
                        <span class="tag">&lt;/groupId&gt;</span>
                        <span class="tag">&lt;artifactId&gt;</span>
                            datanucleus-maven-plugin
                        <span class="tag">&lt;/artifactId&gt;</span>
                        <span class="tag">&lt;versionRange&gt;</span>
                            [3.2.0-release,)
                        <span class="tag">&lt;/versionRange&gt;</span>
                        <span class="tag">&lt;goals&gt;</span>
                            <span class="tag">&lt;goal&gt;</span>enhance<span class="tag">&lt;/goal&gt;</span>
                        <span class="tag">&lt;/goals&gt;</span>
                    <span class="tag">&lt;/pluginExecutionFilter&gt;</span>
                    <span class="tag">&lt;action&gt;</span>
                        <span class="tag">&lt;ignore&gt;</span><span class="tag">&lt;/ignore&gt;</span>
                    <span class="tag">&lt;/action&gt;</span>
                <span class="tag">&lt;/pluginExecution&gt;</span>
            <span class="tag">&lt;/pluginExecutions&gt;</span>
        <span class="tag">&lt;/lifecycleMappingMetadata&gt;</span>
    <span class="tag">&lt;/configuration&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>and instead in <code>&lt;profiles&gt;</code> add:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;profile&gt;</span>
    <span class="tag">&lt;id&gt;</span>enhance<span class="tag">&lt;/id&gt;</span>
    <span class="tag">&lt;activation&gt;</span>
        <span class="tag">&lt;activeByDefault&gt;</span>true<span class="tag">&lt;/activeByDefault&gt;</span>
    <span class="tag">&lt;/activation&gt;</span>
    <span class="tag">&lt;properties&gt;</span>
        <span class="tag">&lt;datanucleus-maven-plugin.version&gt;</span>4.0.0-release<span class="tag">&lt;/datanucleus-maven-plugin.version&gt;</span>
    <span class="tag">&lt;/properties&gt;</span>
    <span class="tag">&lt;build&gt;</span>
        <span class="tag">&lt;pluginManagement&gt;</span>
            <span class="tag">&lt;plugins&gt;</span>
                <span class="tag">&lt;plugin&gt;</span>
                    <span class="comment">&lt;!--This plugin's configuration is used to store Eclipse m2e settings only. It has no influence on the Maven build itself.--&gt;</span>
                    <span class="tag">&lt;groupId&gt;</span>org.eclipse.m2e<span class="tag">&lt;/groupId&gt;</span>
                    <span class="tag">&lt;artifactId&gt;</span>lifecycle-mapping<span class="tag">&lt;/artifactId&gt;</span>
                    <span class="tag">&lt;version&gt;</span>1.0.0<span class="tag">&lt;/version&gt;</span>
                    <span class="tag">&lt;configuration&gt;</span>
                        <span class="tag">&lt;lifecycleMappingMetadata&gt;</span>
                            <span class="tag">&lt;pluginExecutions&gt;</span>
                                <span class="tag">&lt;pluginExecution&gt;</span>
                                    <span class="tag">&lt;pluginExecutionFilter&gt;</span>
                                        <span class="tag">&lt;groupId&gt;</span>org.datanucleus<span class="tag">&lt;/groupId&gt;</span>
                                        <span class="tag">&lt;artifactId&gt;</span>datanucleus-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
                                        <span class="tag">&lt;versionRange&gt;</span>[${datanucleus-maven-plugin.version},)<span class="tag">&lt;/versionRange&gt;</span>
                                        <span class="tag">&lt;goals&gt;</span>
                                            <span class="tag">&lt;goal&gt;</span>enhance<span class="tag">&lt;/goal&gt;</span>
                                        <span class="tag">&lt;/goals&gt;</span>
                                    <span class="tag">&lt;/pluginExecutionFilter&gt;</span>
                                    <span class="tag">&lt;action&gt;</span>
                                        <span class="tag">&lt;ignore&gt;</span><span class="tag">&lt;/ignore&gt;</span>
                                    <span class="tag">&lt;/action&gt;</span>
                                <span class="tag">&lt;/pluginExecution&gt;</span>
                            <span class="tag">&lt;/pluginExecutions&gt;</span>
                        <span class="tag">&lt;/lifecycleMappingMetadata&gt;</span>
                    <span class="tag">&lt;/configuration&gt;</span>
                <span class="tag">&lt;/plugin&gt;</span>
            <span class="tag">&lt;/plugins&gt;</span>
        <span class="tag">&lt;/pluginManagement&gt;</span>
        <span class="tag">&lt;plugins&gt;</span>
            <span class="tag">&lt;plugin&gt;</span>
                <span class="tag">&lt;groupId&gt;</span>org.datanucleus<span class="tag">&lt;/groupId&gt;</span>
                <span class="tag">&lt;artifactId&gt;</span>datanucleus-maven-plugin<span class="tag">&lt;/artifactId&gt;</span>
                <span class="tag">&lt;version&gt;</span>${datanucleus-maven-plugin.version}<span class="tag">&lt;/version&gt;</span>
                <span class="tag">&lt;configuration&gt;</span>
                    <span class="tag">&lt;fork&gt;</span>false<span class="tag">&lt;/fork&gt;</span>
                    <span class="tag">&lt;log4jConfiguration&gt;</span>${basedir}/log4j.properties<span class="tag">&lt;/log4jConfiguration&gt;</span>
                    <span class="tag">&lt;verbose&gt;</span>true<span class="tag">&lt;/verbose&gt;</span>
                    <span class="tag">&lt;props&gt;</span>${basedir}/datanucleus.properties<span class="tag">&lt;/props&gt;</span>
                <span class="tag">&lt;/configuration&gt;</span>
                <span class="tag">&lt;executions&gt;</span>
                    <span class="tag">&lt;execution&gt;</span>
                        <span class="tag">&lt;phase&gt;</span>process-classes<span class="tag">&lt;/phase&gt;</span>
                        <span class="tag">&lt;goals&gt;</span>
                            <span class="tag">&lt;goal&gt;</span>enhance<span class="tag">&lt;/goal&gt;</span>
                        <span class="tag">&lt;/goals&gt;</span>
                    <span class="tag">&lt;/execution&gt;</span>
                <span class="tag">&lt;/executions&gt;</span>
            <span class="tag">&lt;/plugin&gt;</span>
        <span class="tag">&lt;/plugins&gt;</span>
    <span class="tag">&lt;/build&gt;</span>
    <span class="tag">&lt;dependencies&gt;</span>
        <span class="tag">&lt;dependency&gt;</span>
            <span class="tag">&lt;groupId&gt;</span>org.datanucleus<span class="tag">&lt;/groupId&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>datanucleus-core<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;/dependency&gt;</span>
        <span class="tag">&lt;dependency&gt;</span>
            <span class="tag">&lt;groupId&gt;</span>org.datanucleus<span class="tag">&lt;/groupId&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>datanucleus-jodatime<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;/dependency&gt;</span>
        <span class="tag">&lt;dependency&gt;</span>
            <span class="tag">&lt;groupId&gt;</span>org.datanucleus<span class="tag">&lt;/groupId&gt;</span>
            <span class="tag">&lt;artifactId&gt;</span>datanucleus-api-jdo<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;/dependency&gt;</span>
    <span class="tag">&lt;/dependencies&gt;</span>
<span class="tag">&lt;/profile&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If you don&#8217;t use Eclipse then you can omit the <code>org.eclipse.m2e</code> plugin in <code>&lt;pluginManagement&gt;</code>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_in_the_webapp_s_code_persistor_datanucleus_properties_code">In the webapp&#8217;s <code>persistor_datanucleus.properties</code></h5>
<div class="paragraph">
<p>in <code>src/main/webapp/WEB-INF/</code>,</p>
</div>
<div class="paragraph">
<p>change:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ini">isis.persistor.datanucleus.impl.datanucleus.autoCreateSchema=true
isis.persistor.datanucleus.impl.datanucleus.validateTables=true
isis.persistor.datanucleus.impl.datanucleus.validateConstraints=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ini">isis.persistor.datanucleus.impl.datanucleus.schema.autoCreateAll=true
isis.persistor.datanucleus.impl.datanucleus.schema.validateTables=true
isis.persistor.datanucleus.impl.datanucleus.schema.validateConstraints=true</code></pre>
</div>
</div>
<div class="paragraph">
<p>and change:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ini">isis.persistor.datanucleus.impl.datanucleus.identifier.case=PreserveCase</code></pre>
</div>
</div>
<div class="paragraph">
<p>to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="ini">isis.persistor.datanucleus.impl.datanucleus.identifier.case=MixedCase</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Be careful to ensure that your classes are only enhanced by the DataNucleus 4 enhancer, and <em>not</em> by the DataNucleus 3 enhancer.  Or even, be careful that they are not doubly enhanced.  One of our committers had this situation and it led to all sorts of bizarre issues.  The solution, it turned out, was actually just to do a full <code>mvn clean</code>.</p>
</div>
<div class="paragraph">
<p>If you are struggling and suspect you may have misconfigured the enhancer plugin, then you can decompile the bytecode (eg in IntelliJ) and take a look:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A class enhanced with DataNucleus 3 would implement <code>javax.jdo.spi.PersistenceCapable</code> interface</p>
</li>
<li>
<p>A class enhanced with DataNucleus 4 will implement <code>org.datanucleus.enhancer.Persistable</code>.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_upgrading_to_java_8_1_9_0_snapshot_and_later">16.3.2. Upgrading to Java 8 (1.9.0-SNAPSHOT and later)</h4>
<div class="paragraph">
<p>Apache Isis 1.9.0-SNAPSHOT is the first version to support Java 8.  You can continue to use Java 7, but if you want to move to Java 8 then there are several small changes to be made.</p>
</div>
<div class="sect4">
<h5 id="_in_the_parent_code_pom_xml_code_2">In the parent <code>pom.xml</code></h5>
<div class="paragraph">
<p>under <code>&lt;build&gt;/&lt;pluginManagement&gt;/&lt;plugins&gt;</code>, add (or update) maven-enforcer-plugin:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;plugin&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>maven-compiler-plugin<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>3.1<span class="tag">&lt;/version&gt;</span>
    <span class="tag">&lt;configuration&gt;</span>
        <span class="tag">&lt;source&gt;</span>1.8<span class="tag">&lt;/source&gt;</span>
        <span class="tag">&lt;target&gt;</span>1.8<span class="tag">&lt;/target&gt;</span>
        <span class="tag">&lt;compilerArgument&gt;</span>-parameters<span class="tag">&lt;/compilerArgument&gt;</span>
    <span class="tag">&lt;/configuration&gt;</span>
    <span class="tag">&lt;executions&gt;</span>
        <span class="tag">&lt;execution&gt;</span>
            <span class="tag">&lt;id&gt;</span>source<span class="tag">&lt;/id&gt;</span>
            <span class="tag">&lt;phase&gt;</span>compile<span class="tag">&lt;/phase&gt;</span>
        <span class="tag">&lt;/execution&gt;</span>
        <span class="tag">&lt;execution&gt;</span>
            <span class="tag">&lt;id&gt;</span>test<span class="tag">&lt;/id&gt;</span>
            <span class="tag">&lt;phase&gt;</span>test-compile<span class="tag">&lt;/phase&gt;</span>
        <span class="tag">&lt;/execution&gt;</span>
    <span class="tag">&lt;/executions&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>-parameters</code> argument causes the Java compiler to capture the names of method parameters in the <code>.class</code> files.  Isis can be configured to use this, thereby avoiding the requirement to annotate every parameter with <code>@ParameterLayout(named=&#8230;&#8203;)</code> or <code>@Named()</code>.  The necessary configuration is provided in an <a href="http://github.com/isisaddons/isis-metamodel-paraname8}">Isis addons' paraname8</a>  metamodel extension (non-ASF).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>We also recommend that you add the <code>maven-enforcer-plugin</code> (if not used already).  Again, this resides under <code>&lt;build&gt;/&lt;pluginManagement&gt;/&lt;plugins&gt;</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;plugin&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>maven-enforcer-plugin<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>1.3.1<span class="tag">&lt;/version&gt;</span>
    <span class="tag">&lt;configuration&gt;</span>
        <span class="tag">&lt;rules&gt;</span>
            <span class="tag">&lt;requireMavenVersion&gt;</span>
                <span class="tag">&lt;version&gt;</span>[3.2.1,)<span class="tag">&lt;/version&gt;</span>
            <span class="tag">&lt;/requireMavenVersion&gt;</span>
            <span class="tag">&lt;requireJavaVersion&gt;</span>
                <span class="tag">&lt;version&gt;</span>[1.8.0,)<span class="tag">&lt;/version&gt;</span>
            <span class="tag">&lt;/requireJavaVersion&gt;</span>
            <span class="tag">&lt;requirePluginVersions&gt;</span>
                <span class="tag">&lt;message&gt;</span>All plugin versions must be defined!<span class="tag">&lt;/message&gt;</span>
                <span class="tag">&lt;banLatest&gt;</span>true<span class="tag">&lt;/banLatest&gt;</span>
                <span class="tag">&lt;banRelease&gt;</span>true<span class="tag">&lt;/banRelease&gt;</span>
            <span class="tag">&lt;/requirePluginVersions&gt;</span>
            <span class="tag">&lt;DependencyConvergence</span> <span class="tag">/&gt;</span>
        <span class="tag">&lt;/rules&gt;</span>
    <span class="tag">&lt;/configuration&gt;</span>
    <span class="tag">&lt;executions&gt;</span>
        <span class="tag">&lt;execution&gt;</span>
            <span class="tag">&lt;id&gt;</span>validate-enforce<span class="tag">&lt;/id&gt;</span>
            <span class="tag">&lt;phase&gt;</span>validate<span class="tag">&lt;/phase&gt;</span>
            <span class="tag">&lt;goals&gt;</span>
                <span class="tag">&lt;goal&gt;</span>enforce<span class="tag">&lt;/goal&gt;</span>
            <span class="tag">&lt;/goals&gt;</span>
        <span class="tag">&lt;/execution&gt;</span>
    <span class="tag">&lt;/executions&gt;</span>
<span class="tag">&lt;/plugin&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>

        </div>



        <footer>

          <hr>

          <p class="small">

          Copyright &copy; 2010~2015 The Apache&nbsp;Software&nbsp;Foundation, licensed under the Apache&nbsp;License,&nbsp;v2.0.

          <br/>

          Apache, the Apache feather logo, Apache&nbsp;Isis, and the Apache&nbsp;Isis project logo are all trademarks of The&nbsp;Apache&nbsp;Software&nbsp;Foundation.

          </p>

        </footer>



    </div>



    <!--

    as a column to the right

    (previous was using foundation in a 9:3 ratio with the content, above... decided was too crammed.

    -->

    <div class="xlarge-3 xmedium-3 xcolumns">

        <div id="toc" class="toc2">

          <ul class="sectlevel1">
<li><a href="#_core_concepts">1. Core Concepts</a>
<ul class="sectlevel2">
<li><a href="#_philosophy_and_architecture">1.1. Philosophy and Architecture</a>
<ul class="sectlevel3">
<li><a href="#_domain_driven_design">1.1.1. Domain-Driven Design</a>
<ul class="sectlevel4">
<li><a href="#_ubiquitous_language">Ubiquitous Language</a></li>
<li><a href="#_model_driven_design">Model-Driven Design</a></li>
</ul>
</li>
<li><a href="#_naked_objects_pattern">1.1.2. Naked Objects Pattern</a>
<ul class="sectlevel5">
<li><a href="#_object_interface_mapping">Object Interface Mapping</a></li>
</ul>
</li>
<li><a href="#_hexagonal_architecture">1.1.3. Hexagonal Architecture</a></li>
<li><a href="#_aspect_oriented">1.1.4. Aspect Oriented</a></li>
<li><a href="#_how_apache_isis_eases_ddd">1.1.5. How Apache Isis eases DDD</a>
<ul class="sectlevel4">
<li><a href="#_ddd_takes_a_conscious_effort">DDD takes a conscious effort</a></li>
<li><a href="#_ddd_must_be_grounded">DDD must be grounded</a></li>
<li><a href="#_abstract_models_are_difficult_to_represent">Abstract models are difficult to represent</a></li>
<li><a href="#_layered_architectures_are_easily_compromised">Layered architectures are easily compromised</a></li>
<li><a href="#_extending_the_reach_of_ddd">Extending the reach of DDD</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_principles_and_values">1.2. Principles and Values</a>
<ul class="sectlevel3">
<li><a href="#_your_applications">1.2.1. Your Applications</a>
<ul class="sectlevel4">
<li><a href="#_decoupled">Decoupled</a></li>
<li><a href="#_honouring_the_single_responsibility_principle">Honouring the Single Responsibility Principle</a></li>
<li><a href="#_testable">Testable</a></li>
</ul>
</li>
<li><a href="#_isis_itself">1.2.2. Isis itself</a>
<ul class="sectlevel4">
<li><a href="#_full_stack_but_extensible">Full-stack but Extensible</a></li>
<li><a href="#_focuses_on_its_usp">Focuses on its USP</a></li>
</ul>
</li>
<li><a href="#_apache_isis_vs">1.2.3. Apache Isis vs &#8230;&#8203;</a>
<ul class="sectlevel4">
<li><a href="#_vs_mvc_server_side_frameworks">vs MVC server-side frameworks</a></li>
<li><a href="#_vs_angular">vs Angular</a></li>
<li><a href="#_vs_metawidget">vs MetaWidget</a></li>
<li><a href="#_vs_openxava">vs OpenXava</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_building_blocks">1.3. Building Blocks</a>
<ul class="sectlevel3">
<li><a href="#_a_metamodel_with_explicit_and_inferred_semantics">1.3.1. A MetaModel with Explicit and Inferred Semantics</a></li>
<li><a href="#_domain_objects_and_domain_services">1.3.2. Domain Objects and Domain Services</a></li>
<li><a href="#_properties_collections_and_actions">1.3.3. Properties, Collections and Actions</a></li>
<li><a href="#_domain_entities_vs_view_models">1.3.4. Domain Entities vs View Models</a></li>
<li><a href="#_domain_services">1.3.5. Domain Services</a>
<ul class="sectlevel4">
<li><a href="#_domain_services_vs_view_services">Domain Services vs View Services</a></li>
</ul>
</li>
<li><a href="#_value_objects_primitives">1.3.6. Value Objects (Primitives)</a></li>
<li><a href="#_contributions">1.3.7. Contributions</a></li>
<li><a href="#_event_bus">1.3.8. Event Bus</a>
<ul class="sectlevel4">
<li><a href="#_registering_domain_services">Registering domain services</a></li>
<li><a href="#_service_scopes">Service scopes</a></li>
<li><a href="#__suppressing_contributed_actions">(Suppressing) contributed actions</a></li>
<li><a href="#__suppressing_service_menu_items">(Suppressing) service menu items</a></li>
<li><a href="#__suppressing_service_menus">(Suppressing) service menus</a></li>
<li><a href="#_initializing_services">Initializing Services</a>
<ul class="sectlevel5">
<li><a href="#_initialization">Initialization</a></li>
<li><a href="#_shutdown">Shutdown</a></li>
</ul>
</li>
<li><a href="#_the_getid_method">The getId() method</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_framework_provided_services">1.4. Framework-provided Services</a>
<ul class="sectlevel3">
<li><a href="#_api_vs_spi">1.4.1. API vs SPI</a></li>
<li><a href="#_autoregistration_of_domain_services">1.4.2. Autoregistration of Domain services</a></li>
<li><a href="#_overview_of_domain_services">1.4.3. Overview of Domain Services</a>
<ul class="sectlevel4">
<li><a href="#__code_domainobjectcontainer_code"><code>DomainObjectContainer</code></a></li>
<li><a href="#__code_clockservice_code"><code>ClockService</code></a></li>
<li><a href="#__code_isissupportjdo_code"><code>IsisSupportJdo</code></a></li>
<li><a href="#__code_exceptionrecognizer_code"><code>ExceptionRecognizer</code></a></li>
<li><a href="#__code_wrapperfactory_code"><code>WrapperFactory</code></a></li>
<li><a href="#__code_eventbusservice_code"><code>EventBusService</code></a></li>
<li><a href="#_commands_background">Commands/Background</a>
<ul class="sectlevel5">
<li><a href="#__code_commandcontext_code"><code>CommandContext</code></a></li>
<li><a href="#__code_backgroundservice_code"><code>BackgroundService</code></a></li>
</ul>
</li>
<li><a href="#_information_sharing">Information Sharing</a>
<ul class="sectlevel5">
<li><a href="#__code_scratchpad_code"><code>ScratchPad</code></a></li>
<li><a href="#__code_actioninvocationcontext_code"><code>ActionInvocationContext</code></a></li>
<li><a href="#__code_queryresultscache_code"><code>QueryResultsCache</code></a></li>
</ul>
</li>
<li><a href="#__code_emailservice_code"><code>EmailService</code></a></li>
<li><a href="#_usermanagement">UserManagement</a>
<ul class="sectlevel5">
<li><a href="#__code_userprofileservice_code_spi"><code>UserProfileService</code> (SPI)</a></li>
<li><a href="#__code_userregistrationservice_code_spi"><code>UserRegistrationService</code> (SPI)</a></li>
<li><a href="#__code_emailnotificationservice_code"><code>EmailNotificationService</code></a></li>
</ul>
</li>
<li><a href="#_bookmarks_and_mementos">Bookmarks and Mementos</a>
<ul class="sectlevel5">
<li><a href="#__code_bookmarkservice_code"><code>BookmarkService</code></a></li>
<li><a href="#__code_mementoservice_code"><code>MementoService</code></a></li>
<li><a href="#__code_deeplinkservice_code"><code>DeepLinkService</code></a></li>
<li><a href="#__code_xmlsnapshotservice_code"><code>XmlSnapshotService</code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_add_ons">1.5. Add-ons</a></li>
</ul>
</li>
<li><a href="#_getting_started">2. Getting Started</a>
<ul class="sectlevel2">
<li><a href="#_simpleapp_archetype">2.1. SimpleApp Archetype</a></li>
<li><a href="#_datanucleus_enhancer">2.2. Datanucleus Enhancer</a>
<ul class="sectlevel3">
<li><a href="#__code_meta_inf_persistence_xml_code">2.2.1. <code>META-INF/persistence.xml</code></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_how_tos">3. How-tos</a>
<ul class="sectlevel2">
<li><a href="#_class_structure">3.1. Class Structure</a>
<ul class="sectlevel3">
<li><a href="#_class_definition">3.1.1. Class Definition</a></li>
<li><a href="#_property">3.1.2. Property</a>
<ul class="sectlevel4">
<li><a href="#_value_vs_reference_types">Value vs Reference Types</a></li>
<li><a href="#_optional_properties">Optional Properties</a></li>
<li><a href="#_mapping_string_length">Mapping String (Length)</a></li>
<li><a href="#_mapping_joda_dates">Mapping JODA Dates</a></li>
<li><a href="#_mapping_bigdecimals">Mapping BigDecimals</a></li>
<li><a href="#_mapping_blobs">Mapping Blobs</a></li>
<li><a href="#_mapping_passwords">Mapping Passwords</a></li>
</ul>
</li>
<li><a href="#_collection">3.1.3. Collection</a></li>
<li><a href="#_actions">3.1.4. Actions</a></li>
<li><a href="#_action_parameters">3.1.5. Action Parameters</a>
<ul class="sectlevel4">
<li><a href="#_string_length_of_action_parameter">String Length Of Action Parameter</a></li>
<li><a href="#_bigdecimal_precision_of_action_parameter">BigDecimal Precision Of Action Parameter</a></li>
<li><a href="#_optional_action_argument">Optional Action Argument</a></li>
</ul>
</li>
<li><a href="#_properties_vs_parameters">3.1.6. Properties vs Parameters</a></li>
<li><a href="#_ignoring_methods">3.1.7. Ignoring Methods</a></li>
</ul>
</li>
<li><a href="#_ui_hints">3.2. UI Hints</a>
<ul class="sectlevel3">
<li><a href="#_object_titles_and_icons">3.2.1. Object Titles and Icons</a>
<ul class="sectlevel4">
<li><a href="#_object_title">Object Title</a>
<ul class="sectlevel5">
<li><a href="#_titles_in_tables">Titles in Tables</a></li>
<li><a href="#_hide_part_of_a_title">Hide part of a title</a></li>
</ul>
</li>
<li><a href="#_object_icon">Object Icon</a></li>
<li><a href="#_object_css_styling">Object CSS Styling</a></li>
</ul>
</li>
<li><a href="#_names_and_descriptions">3.2.2. Names and Descriptions</a>
<ul class="sectlevel5">
<li><a href="#_class_object">Class (object)</a></li>
<li><a href="#_property_2">Property</a></li>
<li><a href="#_collections">Collections</a></li>
<li><a href="#_actions_2">Actions</a></li>
<li><a href="#_action_parameters_2">Action Parameters</a></li>
</ul>
</li>
<li><a href="#_layout">3.2.3. Layout</a>
<ul class="sectlevel4">
<li><a href="#_layout_using_annotations">Layout using annotations</a></li>
<li><a href="#_dynamic_layouts">Dynamic layouts</a></li>
<li><a href="#_application_menu_layout">Application menu layout</a></li>
</ul>
</li>
<li><a href="#_eager_rendering">3.2.4. Eager rendering</a></li>
<li><a href="#_action_icons_and_css">3.2.5. Action Icons and CSS</a>
<ul class="sectlevel4">
<li><a href="#_per_action">Per action</a></li>
<li><a href="#_per_pattern_matching">Per pattern matching</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_domain_services_2">3.3. Domain Services</a>
<ul class="sectlevel3">
<li><a href="#_singleton_request_scoped_services">3.3.1. Singleton &amp; request-scoped services</a></li>
</ul>
</li>
<li><a href="#_object_management_crud">3.4. Object Management (CRUD)</a>
<ul class="sectlevel3">
<li><a href="#_injecting_services">3.4.1. Injecting Services</a></li>
<li><a href="#_instantiating_and_persisting_objects">3.4.2. Instantiating and Persisting Objects</a></li>
<li><a href="#_finding_objects">3.4.3. Finding Objects</a>
<ul class="sectlevel4">
<li><a href="#_using_datanucleus_type_safe_queries">Using DataNucleus type-safe queries</a></li>
</ul>
</li>
<li><a href="#_deleting_objects">3.4.4. Deleting Objects</a></li>
</ul>
</li>
<li><a href="#_entity_relationships">3.5. Entity Relationships</a>
<ul class="sectlevel3">
<li><a href="#_mapping_mandatory_and_optional_properties">3.5.1. Mapping Mandatory and Optional Properties</a></li>
<li><a href="#_managed_1_m_bidirectional_relationships">3.5.2. Managed 1-m bidirectional relationships</a></li>
</ul>
</li>
<li><a href="#_contributed_members">3.6. Contributed Members</a>
<ul class="sectlevel3">
<li><a href="#_contributed_action">3.6.1. Contributed Action</a></li>
<li><a href="#_contributed_property">3.6.2. Contributed Property</a></li>
<li><a href="#_contributed_collection">3.6.3. Contributed Collection</a></li>
</ul>
</li>
<li><a href="#_business_rules">3.7. Business Rules</a>
<ul class="sectlevel3">
<li><a href="#_visibility_see_it">3.7.1. Visibility ("see it")</a>
<ul class="sectlevel4">
<li><a href="#_hide_a_property">Hide a Property</a></li>
<li><a href="#_hide_a_collection">Hide a Collection</a></li>
<li><a href="#_hide_an_action">Hide an Action</a></li>
<li><a href="#_hide_a_contributed_property_collection_or_action">Hide a Contributed Property, Collection or Action</a></li>
<li><a href="#_all_members_hidden">All Members Hidden</a></li>
</ul>
</li>
<li><a href="#_usability_use_it">3.7.2. Usability ("use it")</a>
<ul class="sectlevel4">
<li><a href="#_disable_a_property">Disable a Property</a></li>
<li><a href="#_disable_a_collection">Disable a Collection</a></li>
<li><a href="#_disable_an_action">Disable an Action</a></li>
<li><a href="#_disable_a_contributed_property_collection_or_action">Disable a Contributed Property, Collection or Action</a></li>
<li><a href="#_all_members_unmodifiable_disabling_the_edit_button">All Members Unmodifiable (Disabling the Edit Button)</a>
<ul class="sectlevel5">
<li><a href="#_declarative">Declarative</a></li>
<li><a href="#_imperative">Imperative</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_validity_do_it">3.7.3. Validity ("do it")</a>
<ul class="sectlevel4">
<li><a href="#_validate_change_to_a_property">Validate (change to) a Property</a></li>
<li><a href="#_validate_adding_or_removing_from_a_collection">Validate (adding or removing from) a Collection</a></li>
<li><a href="#_validate_arguments_to_invoke_an_action">Validate (arguments to invoke) an Action</a></li>
<li><a href="#_validating_a_contributed_property_collection_or_action">Validating a Contributed Property, Collection or Action</a></li>
<li><a href="#_declarative_validation_using_code_mustsatisfy_code">Declarative validation using <code>@MustSatisfy</code></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_derived_members">3.8. Derived Members</a>
<ul class="sectlevel3">
<li><a href="#_derived_property">3.8.1. Derived Property</a></li>
<li><a href="#_derived_collection">3.8.2. Derived Collection</a></li>
<li><a href="#_trigger_on_property_change">3.8.3. Trigger on property change</a></li>
<li><a href="#_trigger_on_collection_change">3.8.4. Trigger on collection change</a></li>
</ul>
</li>
<li><a href="#_drop_downs_and_defaults">3.9. Drop Downs and Defaults</a>
<ul class="sectlevel3">
<li><a href="#_for_properties">3.9.1. For Properties</a>
<ul class="sectlevel4">
<li><a href="#_choices_for_property">Choices for Property</a></li>
<li><a href="#_auto_complete_for_property">Auto-complete for property</a></li>
<li><a href="#_default_for_property">Default for property</a></li>
</ul>
</li>
<li><a href="#_for_action_parameters">3.9.2. For Action Parameters</a>
<ul class="sectlevel4">
<li><a href="#_choices_for_action_parameter">Choices for action parameter</a></li>
<li><a href="#_dependent_choices_for_action_params">Dependent choices for action params</a></li>
<li><a href="#_auto_complete_for_action_param">Auto-complete for action param</a></li>
<li><a href="#_default_for_action_param">Default for action param</a></li>
</ul>
</li>
<li><a href="#_for_both_properties_and_action_parameters">3.9.3. For both Properties and Action Parameters</a>
<ul class="sectlevel4">
<li><a href="#_drop_down_for_limited_number_of_instances">Drop-down for limited number of instances</a></li>
<li><a href="#_auto_complete_repository_based">Auto-complete (repository-based)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_bulk_actions">3.10. Bulk Actions</a></li>
<li><a href="#_triggering_events">3.11. Triggering Events</a>
<ul class="sectlevel3">
<li><a href="#_publishing_and_subscribing_to_events_pulling_changes">3.11.1. Publishing and Subscribing to Events (Pulling Changes)</a></li>
<li><a href="#_pushing_changes">3.11.2. Pushing Changes</a>
<ul class="sectlevel4">
<li><a href="#_when_a_property_is_changed">When a property is changed</a></li>
<li><a href="#_when_a_collection_is_added_to_or_removed_from">When a collection is added to or removed from</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_using_modules">3.12. Using Modules</a>
<ul class="sectlevel3">
<li><a href="#_listener_to_create_db_schema_objects">3.12.1. Listener to create DB schema objects</a></li>
<li><a href="#_registering_an_alternative_implementation">3.12.2. Registering an Alternative Implementation</a></li>
<li><a href="#_please_contribute_back">3.12.3. Please contribute back</a></li>
</ul>
</li>
<li><a href="#_view_models">3.13. View Models</a>
<ul class="sectlevel3">
<li><a href="#__code_viewmodel_code">3.13.1. <code>@ViewModel</code></a></li>
<li><a href="#__code_viewmodel_code_interface">3.13.2. <code>ViewModel</code> interface</a></li>
</ul>
</li>
<li><a href="#_tips_n_tricks">3.14. Tips n Tricks</a>
<ul class="sectlevel3">
<li><a href="#__are_you_sure_idiom">3.14.1. 'Are you sure?' idiom</a>
<ul class="sectlevel4">
<li><a href="#_screenshots">Screenshots</a></li>
<li><a href="#_code_example">Code example</a></li>
</ul>
</li>
<li><a href="#_overriding_jdo_annotations">3.14.2. Overriding JDO Annotations</a></li>
<li><a href="#_render_all_properties_in_tables">3.14.3. Render all Properties in Tables</a></li>
<li><a href="#_per_user_themes">3.14.4. Per-user Themes</a>
<ul class="sectlevel4">
<li><a href="#_question">Question:</a></li>
<li><a href="#_answer">Answer:</a></li>
</ul>
</li>
<li><a href="#_suppressing_actions_from_the_ui">3.14.5. Suppressing actions from the UI</a></li>
<li><a href="#_enhance_only_intellij">3.14.6. Enhance only (IntelliJ)</a>
<ul class="sectlevel4">
<li><a href="#_question_2">Question:</a></li>
<li><a href="#_answer_2">Answer:</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_error_handling">3.15. Error Handling</a>
<ul class="sectlevel3">
<li><a href="#_raise_message_errors_to_users">3.15.1. Raise message/errors to users</a></li>
<li><a href="#_exception_recognizers">3.15.2. Exception Recognizers</a></li>
</ul>
</li>
<li><a href="#_i18n">3.16. i18n</a></li>
<li><a href="#_multi_tenancy">3.17. Multi-tenancy</a></li>
<li><a href="#_persistence_lifecycle">3.18. Persistence Lifecycle</a></li>
</ul>
</li>
<li><a href="#_reference">4. Reference</a>
<ul class="sectlevel2">
<li><a href="#_recognized_methods">4.1. Recognized Methods</a></li>
<li><a href="#_annotations">4.2. Annotations</a></li>
<li><a href="#_configuration_properties">4.3. Configuration Properties</a>
<ul class="sectlevel3">
<li><a href="#_core">4.3.1. Core</a></li>
<li><a href="#_wicket_viewer">4.3.2. Wicket Viewer</a></li>
<li><a href="#_restfulobjects_viewer">4.3.3. RestfulObjects Viewer</a></li>
<li><a href="#_jdo_datanucleus_objectstore">4.3.4. JDO/Datanucleus Objectstore</a>
<ul class="sectlevel4">
<li><a href="#_disabling_persistence_by_reachability">Disabling Persistence by Reachability</a>
<ul class="sectlevel5">
<li><a href="#_explanation_of_the_issue_in_more_detail">Explanation of the issue in more detail</a></li>
</ul>
</li>
<li><a href="#_eagerly_registering_entity_types">Eagerly Registering Entity Types</a>
<ul class="sectlevel5">
<li><a href="#_specify_the_package_prefix_es">Specify the Package Prefix(es)</a></li>
<li><a href="#_integration_testing">Integration Testing</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_domain_services_3">4.4. Domain Services</a>
<ul class="sectlevel3">
<li><a href="#_action_invocation_context">4.4.1. Action Invocation Context</a></li>
<li><a href="#_auditing_service">4.4.2. Auditing Service</a>
<ul class="sectlevel4">
<li><a href="#_isis_addons_implementation">Isis Addons Implementation</a></li>
</ul>
</li>
<li><a href="#_background_command_1service">4.4.3. Background Command 1Service</a>
<ul class="sectlevel4">
<li><a href="#_isis_addons_implementation_2">Isis Addons Implementation</a></li>
</ul>
</li>
<li><a href="#_background_service">4.4.4. Background Service</a></li>
<li><a href="#_bookmark_service">4.4.5. Bookmark Service</a></li>
<li><a href="#_clock_service">4.4.6. Clock Service</a></li>
<li><a href="#_command_context">4.4.7. Command Context</a></li>
<li><a href="#_command_service">4.4.8. Command Service</a>
<ul class="sectlevel4">
<li><a href="#_isis_addons_implementation_3">Isis Addons Implementation</a></li>
</ul>
</li>
<li><a href="#_deep_link_service">4.4.9. Deep Link Service</a></li>
<li><a href="#_domain_object_container">4.4.10. Domain Object Container</a></li>
<li><a href="#_email_notification_service">4.4.11. Email Notification Service</a></li>
<li><a href="#_email_service">4.4.12. Email Service</a></li>
<li><a href="#_event_bus_service">4.4.13. Event Bus Service</a>
<ul class="sectlevel4">
<li><a href="#_implementation">Implementation</a></li>
<li><a href="#_registration">Registration</a></li>
</ul>
</li>
<li><a href="#_exception_recognizer">4.4.14. Exception Recognizer</a></li>
<li><a href="#_isis_jdo_support">4.4.15. Isis JDO Support</a>
<ul class="sectlevel4">
<li><a href="#_api">API</a></li>
<li><a href="#_executing_arbitrary_sql">Executing arbitrary SQL</a></li>
<li><a href="#_fixture_support">Fixture support</a></li>
<li><a href="#_reloading_entities">Reloading entities</a></li>
<li><a href="#_using_jdo_code_persistencemanager_code_directly">Using JDO <code>PersistenceManager</code> directly</a></li>
<li><a href="#_registering_the_service">Registering the Service</a></li>
</ul>
</li>
<li><a href="#_memento_service">4.4.16. Memento Service</a></li>
<li><a href="#_publishing_service">4.4.17. Publishing Service</a>
<ul class="sectlevel4">
<li><a href="#_isis_addons_implementation_4">Isis Addons Implementation</a></li>
</ul>
</li>
<li><a href="#_query_results_cache">4.4.18. Query Results Cache</a></li>
<li><a href="#_scratch_pad">4.4.19. Scratch Pad</a></li>
<li><a href="#_settings_service">4.4.20. Settings Service</a>
<ul class="sectlevel4">
<li><a href="#_application_settings">Application Settings</a>
<ul class="sectlevel5">
<li><a href="#_api_2">API</a></li>
<li><a href="#_implementation_2">Implementation</a></li>
</ul>
</li>
<li><a href="#_user_settings">User Settings</a>
<ul class="sectlevel5">
<li><a href="#_api_3">API</a></li>
<li><a href="#_implementation_3">Implementation</a></li>
</ul>
</li>
<li><a href="#_registration_and_configuration">Registration and Configuration</a></li>
</ul>
</li>
<li><a href="#_user_profile_service_spi">4.4.21. User Profile Service (SPI)</a></li>
<li><a href="#_user_registration_service_spi">4.4.22. User Registration Service (SPI)</a></li>
<li><a href="#_wrapper_factory">4.4.23. Wrapper Factory</a></li>
<li><a href="#_xml_snapshot_service">4.4.24. XML Snapshot Service</a></li>
</ul>
</li>
<li><a href="#_value_types">4.5. Value Types</a>
<ul class="sectlevel3">
<li><a href="#_jdk">4.5.1. JDK</a></li>
<li><a href="#_jodatime">4.5.2. JodaTime</a></li>
<li><a href="#_isis_applib">4.5.3. Isis Applib</a></li>
</ul>
</li>
<li><a href="#_applib_utility_classes">4.6. Applib Utility Classes</a>
<ul class="sectlevel3">
<li><a href="#_title_creation">4.6.1. Title creation</a></li>
<li><a href="#_reason_text_creation_for_disable_and_validate_methods">4.6.2. Reason text creation (for disable and validate methods)</a></li>
<li><a href="#_objectcontracts">4.6.3. ObjectContracts</a>
<ul class="sectlevel4">
<li><a href="#_explanation_of_the_issue_in_more_detail_2">Explanation of the issue in more detail</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_convenience_superclasses">4.7. Convenience Superclasses</a></li>
<li><a href="#_command_line_arguments">4.8. Command Line Arguments</a>
<ul class="sectlevel3">
<li><a href="#__code_org_apache_isis_webserver_code">4.8.1. <code>org.apache.isis.WebServer</code></a></li>
<li><a href="#_recommended_jvm_flags">4.8.2. Recommended JVM Flags</a></li>
</ul>
</li>
<li><a href="#_web_xml_configuration">4.9. web.xml Configuration</a></li>
</ul>
</li>
<li><a href="#_decoupling">5. Decoupling</a></li>
<li><a href="#_testing">6. Testing</a>
<ul class="sectlevel2">
<li><a href="#_unit_test_support">6.1. Unit Test Support</a>
<ul class="sectlevel3">
<li><a href="#__code_sortedset_code_s_contract_test">6.1.1. <code>SortedSet</code>s Contract Test</a></li>
<li><a href="#_injected_services_method_contract_test">6.1.2. Injected Services Method Contract Test</a></li>
<li><a href="#_bidirectional_contract_test">6.1.3. Bidirectional Contract Test</a></li>
<li><a href="#_jmock_extensions">6.1.4. JMock Extensions</a></li>
<li><a href="#_value_objects_contract_test">6.1.5. Value Objects Contract Test</a></li>
</ul>
</li>
<li><a href="#_integration_test_support">6.2. Integration Test Support</a>
<ul class="sectlevel3">
<li><a href="#_bootstrapping">6.2.1. Bootstrapping</a></li>
<li><a href="#_isisconfigurationforjdointegtests">6.2.2. IsisConfigurationForJdoIntegTests</a></li>
<li><a href="#_wrapperfactory">6.2.3. WrapperFactory</a></li>
</ul>
</li>
<li><a href="#_bdd_integ_test_support">6.3. BDD/Integ Test Support</a></li>
<li><a href="#_fixture_scripts">6.4. Fixture Scripts</a>
<ul class="sectlevel3">
<li><a href="#_api_and_usage">6.4.1. API and Usage</a></li>
<li><a href="#_sudoservice_1_9_0_snapshot">6.4.2. SudoService (1.9.0-SNAPSHOT)</a></li>
</ul>
</li>
<li><a href="#_fake_data">6.5. Fake Data</a></li>
</ul>
</li>
<li><a href="#_wicket_viewer_2">7. Wicket Viewer</a>
<ul class="sectlevel2">
<li><a href="#_features_end_user_usage">7.1. Features/end-user usage</a>
<ul class="sectlevel3">
<li><a href="#_file_upload_download">7.1.1. File upload/download</a></li>
<li><a href="#_bookmarked_pages_sliding_panel">7.1.2. Bookmarked pages (sliding panel)</a></li>
<li><a href="#_recent_pages_drop_down">7.1.3. Recent pages (drop down)</a></li>
<li><a href="#_hints_and_copy_url">7.1.4. Hints and copy URL</a></li>
<li><a href="#_user_registration">7.1.5. User Registration</a></li>
</ul>
</li>
<li><a href="#_configuration">7.2. Configuration</a>
<ul class="sectlevel3">
<li><a href="#_brand_logo">7.2.1. Brand logo</a></li>
<li><a href="#_suppressing_sign_up">7.2.2. Suppressing 'sign up'</a></li>
<li><a href="#_suppressing_password_reset">7.2.3. Suppressing 'password reset'</a></li>
<li><a href="#_suppressing_remember_me">7.2.4. Suppressing 'remember me'</a></li>
<li><a href="#_number_of_bookmarked_pages">7.2.5. Number of bookmarked pages</a></li>
<li><a href="#_stripped_wicket_tags">7.2.6. Stripped Wicket tags</a></li>
<li><a href="#_disabling_modal_dialogs">7.2.7. Disabling modal dialogs</a></li>
<li><a href="#_showing_a_theme_chooser">7.2.8. Showing a theme chooser</a></li>
<li><a href="#_suppressing_header_and_footer_embedded_view">7.2.9. Suppressing header and footer (embedded view)</a></li>
</ul>
</li>
<li><a href="#_application_specific_customisation">7.3. Application-specific Customisation</a>
<ul class="sectlevel3">
<li><a href="#_customising_the_welcome_page">7.3.1. Customising the Welcome page</a></li>
<li><a href="#_customising_the_about_page">7.3.2. Customising the About page</a></li>
<li><a href="#_specifying_a_default_theme">7.3.3. Specifying a default theme</a></li>
<li><a href="#_tweaking_css_classes">7.3.4. Tweaking CSS classes</a></li>
<li><a href="#_custom_javascript">7.3.5. Custom Javascript</a></li>
<li><a href="#_auto_refresh_page">7.3.6. Auto-refresh page</a></li>
</ul>
</li>
<li><a href="#_extending_the_viewer">7.4. Extending the viewer</a></li>
<li><a href="#_isis_add_ons_not_asf">7.5. Isis Add-ons (not ASF)</a>
<ul class="sectlevel3">
<li><a href="#_excel_download">7.5.1. Excel download</a></li>
<li><a href="#_fullcalendar2">7.5.2. Fullcalendar2</a></li>
<li><a href="#_gmap3">7.5.3. Gmap3</a></li>
<li><a href="#_wicked_charts">7.5.4. Wicked charts</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_restful_objects_viewer">8. Restful Objects Viewer</a>
<ul class="sectlevel2">
<li><a href="#_features">8.1. Features</a>
<ul class="sectlevel3">
<li><a href="#_restful_objects_specification">8.1.1. Restful Objects Specification</a></li>
<li><a href="#_pretty_printing">8.1.2. Pretty printing</a></li>
</ul>
</li>
<li><a href="#_configuration_2">8.2. Configuration</a>
<ul class="sectlevel3">
<li><a href="#_honor_ui_hints">8.2.1. Honor UI hints</a></li>
<li><a href="#_suppressing_elements_of_the_representations">8.2.2. Suppressing elements of the representations</a></li>
<li><a href="#_simplified_object_representation">8.2.3. Simplified object representation</a></li>
</ul>
</li>
<li><a href="#_extending_the_viewer_2">8.3. Extending the viewer</a></li>
<li><a href="#_hints_and_tips">8.4. Hints and Tips</a>
<ul class="sectlevel3">
<li><a href="#_using_chrome_tools">8.4.1. Using Chrome Tools</a></li>
<li><a href="#_angularjs_tips">8.4.2. AngularJS Tips</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_background_execution">9. Background Execution</a>
<ul class="sectlevel2">
<li><a href="#_abstractisissessiontemplate">9.1. AbstractIsisSessionTemplate</a></li>
<li><a href="#_backgroundcommandexecution">9.2. BackgroundCommandExecution</a>
<ul class="sectlevel3">
<li><a href="#_isis_addons_command_module">9.2.1. Isis Addons Command Module</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_configuration_3">10. Configuration</a>
<ul class="sectlevel2">
<li><a href="#_properties_and_files">10.1. Properties and Files</a>
<ul class="sectlevel3">
<li><a href="#_configuration_properties_2">10.1.1. Configuration Properties</a></li>
<li><a href="#_files">10.1.2. Files</a></li>
<li><a href="#_deployment_types">10.1.3. Deployment Types</a>
<ul class="sectlevel4">
<li><a href="#_configuring_isis_to_use_shiro">Configuring Isis to use Shiro</a></li>
</ul>
</li>
<li><a href="#_configuring_the_integration_tests">10.1.4. Configuring the Integration Tests</a></li>
</ul>
</li>
<li><a href="#_configuring_the_webapp">10.2. Configuring the Webapp</a>
<ul class="sectlevel3">
<li><a href="#_init_params">10.2.1. Init Params</a></li>
<li><a href="#_filters">10.2.2. Filters</a></li>
<li><a href="#_servlets">10.2.3. Servlets</a></li>
<li><a href="#_running_restful_objects_viewer_only">10.2.4. Running Restful Objects Viewer only</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_deployment">11. Deployment</a>
<ul class="sectlevel2">
<li><a href="#_deploying_to_tomcat">11.1. Deploying to Tomcat</a>
<ul class="sectlevel3">
<li><a href="#_externalized_configuration">11.1.1. Externalized Configuration</a></li>
<li><a href="#_jvm_args">11.1.2. JVM Args</a></li>
<li><a href="#_using_a_jndi_datasource">11.1.3. Using a JNDI Datasource</a></li>
</ul>
</li>
<li><a href="#_deploying_to_google_app_engine">11.2. Deploying to Google App Engine</a>
<ul class="sectlevel3">
<li><a href="#_primary_keys_and_owned_unowned_relationships">11.2.1. Primary Keys and Owned/Unowned Relationships</a></li>
<li><a href="#_custom_types">11.2.2. Custom Types</a>
<ul class="sectlevel4">
<li><a href="#_a_gae_compatible_version_of_code_todoitem_java_code">A GAE compatible version of <code>ToDoItem.java</code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_isis_addons_not_asf">12. Isis Addons (not ASF)</a>
<ul class="sectlevel2">
<li><a href="#_command_service_persistence">12.1. Command Service (persistence)</a>
<ul class="sectlevel3">
<li><a href="#_api_4">12.1.1. API</a></li>
<li><a href="#_isis_addons_implementation_not_asf">12.1.2. Isis addons implementation  (not ASF)</a></li>
</ul>
</li>
<li><a href="#_background_command_service">12.2. Background Command Service</a>
<ul class="sectlevel3">
<li><a href="#_api_5">12.2.1. API</a></li>
<li><a href="#_background_execution_2">12.2.2. Background Execution</a></li>
<li><a href="#_isis_addons_implementation_not_asf_2">12.2.3. Isis addons implementation (not ASF)</a></li>
</ul>
</li>
<li><a href="#_auditing">12.3. Auditing</a>
<ul class="sectlevel3">
<li><a href="#_auditing_api">12.3.1. Auditing API</a></li>
<li><a href="#_isis_addons_implementation_not_asf_3">12.3.2. Isis addons implementation (not ASF)</a></li>
</ul>
</li>
<li><a href="#_publishing_service_2">12.4. Publishing Service</a>
<ul class="sectlevel3">
<li><a href="#_api_6">12.4.1. API</a></li>
<li><a href="#_isis_addons_implementation_not_asf_4">12.4.2. Isis addons implementation (not ASF)</a></li>
<li><a href="#_event_serializer_per_ro_spec_out_of_date">12.4.3. Event Serializer per RO Spec (out-of-date)</a></li>
</ul>
</li>
<li><a href="#_other_isis_addons">12.5. Other Isis Addons</a>
<ul class="sectlevel3">
<li><a href="#_developer_utilities_not_asf">12.5.1. Developer Utilities (not ASF)</a></li>
<li><a href="#_docx_mail_merge_not_asf">12.5.2. Docx Mail merge (not ASF)</a></li>
<li><a href="#_excel_download_upload_not_asf">12.5.3. Excel download/upload (not ASF)</a></li>
<li><a href="#_fake_data_not_asf">12.5.4. Fake Data (not ASF)</a></li>
<li><a href="#_poly_not_asf">12.5.5. Poly (not ASF)</a></li>
<li><a href="#_security_not_asf">12.5.6. Security (not ASF)</a></li>
<li><a href="#_session_logger_not_asf">12.5.7. Session Logger (not ASF)</a></li>
<li><a href="#_settings_not_asf">12.5.8. Settings (not ASF)</a></li>
<li><a href="#_string_interpolator_not_asf">12.5.9. String interpolator (not ASF)</a></li>
<li><a href="#_tags_not_asf">12.5.10. Tags (not ASF)</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_integrating_with_other_systems">13. Integrating with Other Systems</a>
<ul class="sectlevel2">
<li><a href="#_non_ui_execution">13.1. Non UI Execution</a></li>
</ul>
</li>
<li><a href="#_extending">14. Extending</a>
<ul class="sectlevel2">
<li><a href="#_extending_the_programming_model">14.1. Extending the Programming Model</a>
<ul class="sectlevel3">
<li><a href="#_disallowing_deprecated_annotations">14.1.1. Disallowing deprecated annotations</a></li>
<li><a href="#_custom_validator">14.1.2. Custom validator</a></li>
<li><a href="#_finetuning_the_programming_model">14.1.3. Finetuning the Programming Model</a></li>
<li><a href="#_layout_metadata_reader">14.1.4. Layout metadata reader</a></li>
</ul>
</li>
<li><a href="#_extending_the_wicket_viewer">14.2. Extending the Wicket viewer</a>
<ul class="sectlevel3">
<li><a href="#_writing_a_custom_theme">14.2.1. Writing a custom theme</a></li>
<li><a href="#_replacing_page_elements">14.2.2. Replacing page elements</a></li>
<li><a href="#_custom_pages">14.2.3. Custom pages</a></li>
</ul>
</li>
<li><a href="#_extending_the_restful_viewer">14.3. Extending the Restful viewer</a>
<ul class="sectlevel3">
<li><a href="#_custom_representations">14.3.1. Custom Representations</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_trouble_shooting">15. Trouble Shooting</a>
<ul class="sectlevel2">
<li><a href="#_logging">15.1. Logging</a></li>
<li><a href="#_enabling_logging">15.2. Enabling Logging</a>
<ul class="sectlevel3">
<li><a href="#_in_apache_isis">15.2.1. In Apache Isis</a></li>
<li><a href="#_in_datanucleus">15.2.2. In DataNucleus</a></li>
<li><a href="#_in_the_jdbc_driver">15.2.3. In the JDBC Driver</a></li>
<li><a href="#_in_the_database">15.2.4. In the Database</a>
<ul class="sectlevel4">
<li><a href="#_hsqldb_logging">HSQLDB Logging</a></li>
<li><a href="#_postgresql_logging">PostgreSQL Logging</a></li>
<li><a href="#_ms_sql_server_logging">MS SQL Server Logging</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_appendices">16. Appendices</a>
<ul class="sectlevel2">
<li><a href="#_setting_up_a_development_environment">16.1. Setting up a Development Environment</a>
<ul class="sectlevel3">
<li><a href="#_developing_from_the_command_line">16.1.1. Developing from the Command Line</a></li>
<li><a href="#_setting_up_intellij_idea">16.1.2. Setting up IntelliJ IDEA</a>
<ul class="sectlevel4">
<li><a href="#_installing_and_setting_up">Installing and Setting up</a>
<ul class="sectlevel5">
<li><a href="#_download_and_install">Download and Install</a></li>
<li><a href="#_new_project">New Project</a></li>
<li><a href="#_import_settings">Import Settings</a></li>
<li><a href="#_other_settings">Other Settings</a></li>
<li><a href="#_plugins">Plugins</a></li>
</ul>
</li>
<li><a href="#_importing_and_managing_maven_modules">Importing and Managing Maven Modules</a></li>
<li><a href="#_running">Running</a>
<ul class="sectlevel5">
<li><a href="#_running_the_app">Running the App</a></li>
<li><a href="#_running_the_unit_tests">Running the Unit Tests</a></li>
<li><a href="#_running_the_integration_tests">Running the Integration Tests</a></li>
</ul>
</li>
<li><a href="#_hints_and_tips_2">Hints and Tips</a>
<ul class="sectlevel5">
<li><a href="#_keyboard_shortcuts_cheat_sheets">Keyboard Shortcuts Cheat Sheets</a></li>
<li><a href="#_switching_between_tool_windows_and_editors">Switching between Tool Windows and Editors</a></li>
<li><a href="#_navigating_around">Navigating Around</a></li>
<li><a href="#_editing">Editing</a></li>
<li><a href="#_intentions_and_code_completion">Intentions and Code Completion</a></li>
<li><a href="#_refactoring">Refactoring</a></li>
<li><a href="#_troubleshooting">Troubleshooting</a></li>
</ul>
</li>
<li><a href="#_advanced">Advanced</a>
<ul class="sectlevel5">
<li><a href="#_setting_up_dynamic_reloading">Setting up Dynamic Reloading</a></li>
<li><a href="#_setting_up_jrebel">Setting up JRebel</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_setting_up_eclipse">16.1.3. Setting up Eclipse</a></li>
</ul>
</li>
<li><a href="#_release_notes">16.2. Release Notes</a></li>
<li><a href="#_migration_notes">16.3. Migration Notes</a>
<ul class="sectlevel3">
<li><a href="#_upgrading_to_datanucleus_4_in_1_9_0_snapshot">16.3.1. Upgrading to DataNucleus 4 (in 1.9.0-SNAPSHOT)</a>
<ul class="sectlevel4">
<li><a href="#_in_the_parent_code_pom_xml_code">In the parent <code>pom.xml</code></a></li>
<li><a href="#_in_code_dom_pom_xml_code">In <code>dom/pom.xml</code>,</a></li>
<li><a href="#_in_the_webapp_s_code_persistor_datanucleus_properties_code">In the webapp&#8217;s <code>persistor_datanucleus.properties</code></a></li>
</ul>
</li>
<li><a href="#_upgrading_to_java_8_1_9_0_snapshot_and_later">16.3.2. Upgrading to Java 8 (1.9.0-SNAPSHOT and later)</a>
<ul class="sectlevel4">
<li><a href="#_in_the_parent_code_pom_xml_code_2">In the parent <code>pom.xml</code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>

    </div>



</div>





<script src="../js/foundation/5.5.1/vendor/jquery.js"></script>

<script src="../js/foundation/5.5.1/foundation.min.js"></script>





<script type="text/javascript">

      $(document).foundation();



      $(document).ready(function(){

        // Cache selectors

        var lastId,

            topMenu = $("div#toc ul"),

            topMenuHeight = 70,



            menuItems = topMenu.find("a"),

            menuItemsHrefs = menuItems.map(function(){

              var item = $($(this).attr("href"));

              if (item.length) { return item; }

            });



        // Bind click handler to menu items to scroll animation

        menuItems.click(function(e){

          var href = $(this).attr("href"),

              offsetTop = href === "#" ? 0 : $(href).offset().top-topMenuHeight+1;

          $('html, body').stop().animate({

              scrollTop: offsetTop

          }, 300);



          e.preventDefault();

        });



        // Bind to scroll of window

        $(  window ).scroll(function(){



           // Get container scroll position

           var fromTop = $(this).scrollTop()+topMenuHeight;



           var cur = menuItemsHrefs.map(function(){

             if ($(this).offset().top < fromTop)

               return this;

           });



           // Get the id of the current element

           cur = cur[cur.length-1];



           var id = cur && cur.length ? cur[0].id : "";



           if (lastId !== id && id) {

               scrollTo(id);

           }



           window.history.pushState({}, "", window.location.origin + window.location.pathname + "#" + id);

        });



        scrollTo = function(id) {

              lastId = id;



              menuItems

                .removeClass("active");



              menuItems

                .parents()

                .removeClass("active-region");



              menuItems

                .parents("ul").hide();



              menuItems

                .filter("[href=#"+id+"]")

                .addClass("active");



              menuItems

                .filter("[href=#"+id+"]")

                .parents("ul").show();



              menuItems

                .filter("[href=#"+id+"]")

                .parent().children("ul").show();



              menuItems

                .filter("[href=#"+id+"]")

                .parents("li").addClass("active-region");



        }

      menuItems

        .removeClass("active");



      menuItems

        .parents()

        .removeClass("active-region");



        var syncMenuItem;

        if(window.location.hash!=="") {

            var menuItemFor = $.grep(menuItems, function(e) {

                return e.hash === window.location.hash;

            });

            console.log(menuItemFor);

            if(menuItemFor.length === 1) {

                syncMenuItem = menuItemFor[0];

            }

        }



        if(!syncMenuItem){

            syncMenuItem = menuItems[0];

        }



        $(syncMenuItem).click();



      });



</script>



<script>



$( document ).ready(function() {

    console.log( "ready!" );



    (function() {

      $(function() {

        return $("#doc-content h2, #doc-content h3, #doc-content h4, #doc-content h5, #doc-content h6").each(function(i, el) {

          var $el, icon, id;

          $el = $(el);

          id = $el.attr('id');

          icon = '<i class="fa fa-link"></i>';

          if (id) {

            return $el.prepend($("<a />").addClass("header-link").attr("href", "#" + id).html(icon));

          }

        });

      });

    }).call(this);



});

</script>



</body>

</html>