<!doctype html>
<html>
 <head> 
  <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    --> 
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
  <meta charset="utf-8"> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <!-- No caching headers --> 
  <meta http-equiv="cache-control" content="no-cache"> 
  <meta http-equiv="pragma" content="no-cache"> 
  <meta http-equiv="expires" content="-1"> 
  <title>Beyond the Basics</title> 
  <link rel="icon" type="image/png" href="../../images/isis-favicon.png"> 
  <!--
        Based on DataNucleus' template,
        that was in turn based on an earlier version of Apache Isis' template,
        that was in turn based on Apache Deltaspike's template.

        This template uses
        * Bootstrap v3.3.7 (https://getbootstrap.com/) for navbar.
        * Bootstrap TOC plugin v0.4.1 (https://afeld.github.io/bootstrap-toc/)
          for the table of contents.
        * jQuery (necessary for Bootstrap's JavaScript plugins)
        * Font-Awesome for some icons used by Asciidoctor

        Also:
        * Bootswatch "flatly" theme for Bootstrap (https://bootswatch.com/flatly).
        * slick.js (carousel)
        * add a link to all headers (home-grown, adapted from blog posts)
        * integration of elasticlunr.js (home-grown, adapted from blog posts)
    --> 
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet"> 
  <link href="../../css/bootstrap-toc/0.4.1/bootstrap-toc.min.css" rel="stylesheet"> 
  <link href="../../css/asciidoctor/foundation.css" rel="stylesheet"> 
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet"> 
  <link href="../../css/slick/1.5.0/slick.css" rel="stylesheet"> 
  <link href="../../css/slick/1.5.0/slick-theme.css" rel="stylesheet"> 
  <link href="../../css/search-panel/search-panel.css" rel="stylesheet"> 
  <link href="../../css/header-links/header-links.css" rel="stylesheet"> 
  <link href="../../css/sticky-header/sticky-header.css" rel="stylesheet"> 
  <link href="../../css/customisations.css" rel="stylesheet"> 
  <!-- Coderay syntax formatter --> 
  <style type="text/css">
        /* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
    </style> 
 </head> 
 <body data-spy="scroll" data-target="#toc"> 
  <div id="basedir" style="display:none;">
   ../../
  </div> 
  <div id="docname" style="display:none;">
   ugbtb
  </div> 
  <div id="filetype" style="display:none;">
   html
  </div> 
  <!-- Navbar --> 
  <nav class="navbar navbar-default navbar-static-top header"> 
   <div class="container"> 
    <div class="navbar-header"> 
     <!-- Three line menu button for use on mobile screens --> 
     <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> 
     <a class="navbar-brand" href="../../index.html"> <img alt="Brand" src="../../images/isis-logo-48x48.png"> </a> 
     <a class="navbar-brand" href="../../index.html">Apache Isis</a> 
    </div> 
    <!-- Navbar that will collapse on mobile screens --> 
    <div id="navbar" class="navbar-collapse collapse"> 
     <ul class="nav navbar-nav"> 
      <li class="dropdown"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation<span class="caret"></span></a> 
       <ul class="dropdown-menu"> 
        <li><a href="../../documentation.html">Table of Contents</a></li> 
        <li role="separator" class="divider"></li> 
        <li class="dropdown-header">User Guides</li> 
        <li><a href="../../guides/ugfun/ugfun.html">Fundamentals</a></li> 
        <li><a href="../../guides/ugvw/ugvw.html">Wicket Viewer</a></li> 
        <li><a href="../../guides/ugvro/ugvro.html">Restful Objects Viewer</a></li> 
        <li><a href="../../guides/ugodn/ugodn.html">DataNucleus Object Store</a></li> 
        <li><a href="../../guides/ugsec/ugsec.html">Security</a></li> 
        <li><a href="../../guides/ugtst/ugtst.html">Testing</a></li> 
        <li><a href="../../guides/ugbtb/ugbtb.html">Beyond the Basics</a></li> 
        <li role="separator" class="divider"></li> 
        <li class="dropdown-header">Reference Guides</li> 
        <li><a href="../../guides/rgant/rgant.html">Annotations</a></li> 
        <li><a href="../../guides/rgsvc/rgsvc.html">Domain Services</a></li> 
        <li><a href="../../guides/rgcfg/rgcfg.html">Core Config' Properties</a></li> 
        <li><a href="../../guides/rgcms/rgcms.html">Classes, Methods and Schema</a></li> 
        <li><a href="../../guides/rgmvn/rgmvn.html">Maven plugin</a></li> 
        <li><a href="../../guides/rgfis/rgfis.html">Framework Internal Services</a></li> 
        <li role="separator" class="divider"></li> 
        <li class="dropdown-header">Javadoc</li> 
        <li><a href="http://javadoc.io/doc/org.apache.isis.core/isis-core-applib">Applib</a></li> 
       </ul> </li> 
      <li class="dropdown  hidden-sm hidden-md"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Downloads<span class="caret"></span></a> 
       <ul class="dropdown-menu"> 
        <li class="dropdown-header">Maven archetypes</li> 
        <li><a href="../../guides/ugfun/ugfun.html#_ugfun_getting-started_helloworld-archetype">helloworld</a></li> 
        <li><a href="../../guides/ugfun/ugfun.html#_ugfun_getting-started_simpleapp-archetype">simpleapp</a></li> 
        <li role="separator" class="divider"></li> 
        <li><a href="../../downloads.html">Downloads</a></li> 
        <li><a href="../../release-notes/release-notes.html">Release Notes</a></li> 
        <li><a href="../../migration-notes/migration-notes.html">Migration Notes</a></li> 
        <li role="separator" class="divider"></li> 
        <li><a href="https://github.com/apache/isis">Github mirror</a></li> 
       </ul> </li> 
      <li class="dropdown  hidden-sm"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Support<span class="caret"></span></a> 
       <ul class="dropdown-menu"> 
        <li class="dropdown-header">Guides</li> 
        <li><a href="../../guides/dg/dg.html">Developers' Guide</a></li> 
        <li><a href="../../guides/cgcom/cgcom.html">Committers' Guide</a></li> 
        <li><a href="../../guides/htg.html">Hints-n-Tips Guide</a></li> 
        <li role="separator" class="divider"></li> 
        <li class="dropdown-header">Mailing Lists</li> 
        <li><a href="../../support.html">How to subscribe</a></li> 
        <li><a href="https://lists.apache.org/list.html?users@isis.apache.org">Archives (ASF Pony mail)</a></li> 
        <li><a href="http://isis.markmail.org/search/?q=">Archives (Markmail)</a></li> 
        <li role="separator" class="divider"></li> 
        <li class="dropdown-header">Other Resources</li> 
        <li><a href="https://issues.apache.org/jira/browse/ISIS">ASF JIRA</a></li> 
        <li><a href="http://stackoverflow.com/questions/tagged/isis">Stack Overflow</a></li> 
        <li><a href="../../help.html">Wiki, Fisheye etc.</a></li> 
       </ul> </li> 
      <li class="dropdown hidden-sm hidden-md"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">@ASF<span class="caret"></span></a> 
       <ul class="dropdown-menu"> 
        <li><a href="http://www.apache.org/">Apache Homepage</a></li> 
        <li><a href="http://www.apache.org/licenses/">Licenses</a></li> 
        <li><a href="http://www.apache.org/security/">Security</a></li> 
        <li><a href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li> 
        <li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li> 
        <li role="separator" class="divider"></li> 
        <li><a href="https://whimsy.apache.org/board/minutes/Isis.html">PMC board minutes</a></li> 
       </ul> </li> 
     </ul> 
     <div class="nav navbar-nav navbar-right"> 
      <!-- 'style' added to fix height of input box. FIX THIS --> 
      <form class="navbar-form" role="search" id="search-form" style="padding: 1px 15px;"> 
       <div class="form-group"> 
        <input class="form-control" id="search-field" type="text" size="30" placeholder="Search"> 
       </div> 
      </form> 
     </div> 
    </div> 
   </div> 
  </nav> 
  <div class="container"> 
   <div class="row-fluid"> 
    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-9"> 
     <div id="search-panel"> 
      <div id="search-results"></div> 
      <div> 
       <br> 
       <a href="#" id="search-results-clear">clear</a> 
      </div> 
     </div> 
     <span class="pdf-link"><a href="ugbtb.pdf"><img src="../../images/PDF-50.png"></a></span> 
     <div class="page-title"> 
      <h1>Beyond the Basics</h1> 
     </div> 
     <div id="doc-content">
      <div class="btn-group" style="float: right; font-size: small; padding: 6px;  ">
       <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/ugbtb.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
       <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
       <ul class="dropdown-menu">
        <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/ugbtb.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
        <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/ugbtb.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
        <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/ugbtb.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
        <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/ugbtb.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
       </ul>
      </div> 
      <div class="sect1"> 
       <h2 id="__ugbtb">1. Beyond the Basics</h2> 
       <div class="sectionbody"> 
        <div class="paragraph"> 
         <p>This guide provides <a href="../ugbtb/ugbtb.html#_ugbtb_other-techniques">more advanced</a> guidance on writing maintainable larger applications.</p> 
        </div> 
        <div class="paragraph"> 
         <p>Later chapters discuss how to <a href="../ugbtb/ugbtb.html#_ugbtb_deployment">deploy</a> your app, and discuss other ways in which you can <a href="../ugbtb/ugbtb.html">extend</a> or adapt the framework itself to your particular needs.</p> 
        </div> 
        <div class="sect2"> 
         <h3 id="_other_guides">1.1. Other Guides</h3> 
         <div class="paragraph"> 
          <p>Apache Isis documentation is broken out into a number of user, reference and "supporting procedures" guides.</p> 
         </div> 
         <div class="paragraph"> 
          <p>The user guides available are:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p><a href="../ugfun/ugfun.html">Fundamentals</a></p> </li> 
           <li> <p><a href="../ugvw/ugvw.html">Wicket viewer</a></p> </li> 
           <li> <p><a href="../ugvro/ugvro.html">Restful Objects viewer</a></p> </li> 
           <li> <p><a href="../ugodn/ugodn.html">DataNucleus object store</a></p> </li> 
           <li> <p><a href="../ugsec/ugsec.html">Security</a></p> </li> 
           <li> <p><a href="../ugtst/ugtst.html">Testing</a></p> </li> 
           <li> <p><a href="../ugbtb/ugbtb.html">Beyond the Basics</a> (this guide)</p> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>The reference guides are:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p><a href="../rgant/rgant.html">Annotations</a></p> </li> 
           <li> <p><a href="../rgsvc/rgsvc.html">Domain Services</a></p> </li> 
           <li> <p><a href="../rgcfg/rgcfg.html">Configuration Properties</a></p> </li> 
           <li> <p><a href="../rgcms/rgcms.html">Classes, Methods and Schema</a></p> </li> 
           <li> <p><a href="../rgmvn/rgmvn.html">Apache Isis Maven plugin</a></p> </li> 
           <li> <p><a href="../rgfis/rgfis.html">Framework Internal Services</a></p> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>The remaining guides are:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p><a href="../dg/dg.html">Developers' Guide</a> (how to set up a development environment for Apache Isis and contribute back to the project)</p> </li> 
           <li> <p><a href="../cgcom/cgcom.html">Committers' Guide</a> (release procedures and related practices)</p> </li> 
          </ul> 
         </div> 
        </div> 
       </div> 
      </div> 
      <div class="sect1"> 
       <h2 id="_ugbtb_i18n">2. i18n</h2>
       <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
        <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_i18n.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
        <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
        <ul class="dropdown-menu">
         <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_i18n.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
         <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_i18n.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
         <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_i18n.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
         <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_i18n.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
        </ul>
       </div> 
       <div class="sectionbody"> 
        <div class="paragraph"> 
         <p>Apache Isis' support for internationlization (i18n) allows every element of the domain model (the class names, property names, action names, parameter names and so forth) to be translated.</p> 
        </div> 
        <div class="paragraph"> 
         <p>It also supports translations of messages raised imperatively, by which we mean as the result of a call to <code>title()</code> to obtain an object’s title, or messages resulting from any business rule violations (eg <a href="../rgcms/rgcms.html#_rgcms_methods_prefixes_disable"><code>disable…​()</code></a> or <a href="../rgcms/rgcms.html#_rgcms_methods_prefixes_validate"><code>validate…​()</code></a>, and so on.</p> 
        </div> 
        <div class="paragraph"> 
         <p>The <a href="../ugvw/ugvw.html">Wicket viewer</a> (that is, its labels and messages) is also internationalized using the same mechanism. If no translations are available, then the Wicket viewer falls back to using Wicket resource bundles.</p> 
        </div> 
        <div class="paragraph"> 
         <p>Isis does not translate the values of your domain objects, though. So, if you have a domain concept such as <code>Country</code> whose name is intended to be localized according to the current user, you will need to model this yourself.</p> 
        </div> 
        <div class="sect2"> 
         <h3 id="__ugbtb_i18n_implementation-approach">2.1. Implementation Approach</h3> 
         <div class="paragraph"> 
          <p>Most Java frameworks tackle i18n by using Java’s own <code>ResourceBundle</code> API. However, there are some serious drawbacks in this approach, including:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p>if a string appears more than once (eg "name" or "description") then it must be translated everywhere it appears in every resource bundle file</p> </li> 
           <li> <p>there is no support for plural forms (see this <a href="http://stackoverflow.com/questions/14326653/java-internationalization-i18n-with-proper-plurals/14327683#14327683">SO answer</a>)</p> </li> 
           <li> <p>there is no tooling support for translators</p> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>Apache Isis therefore takes a different approach, drawing inspiration from GNU’s <a href="https://www.gnu.org/software/gettext/manual/index.html">gettext</a> API and specifically its <code>.pot</code> and <code>.po</code> files. These are intended to be used as follows:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p>the <code>.pot</code> (portable object template) file holds the message text to be translated</p> </li> 
           <li> <p>this file is translated into multiple <code>.po</code> (portable object) files, one per supported locale</p> </li> 
           <li> <p>these <code>.po</code> files are renamed according to their locale, and placed into the 'appropriate' location to be picked up by the runtime. The name of each <code>.po</code> resolved in a very similar way to resource bundles.</p> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>The format of the <code>.pot</code> and <code>.po</code> files is identical; the only difference is that the <code>.po</code> file has translations for each of the message strings. These message strings can also have singular and plural forms.</p> 
         </div> 
         <div class="admonitionblock important"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-important" title="Important"></i> </td> 
             <td class="content"> 
              <div class="paragraph"> 
               <p>Although Apache Isis' implementation is modelled after GNU’s API, it does <em>not</em> use any GNU software. This is for two reasons: (a) to simplify the toolchain/developer experience, and (b) because GNU software is usually GPL, which would be incompatible with the Apache license.</p> 
              </div> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>This design tackles all the issues of <code>ResourceBundle</code>s:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p>the <code>.po</code> message format is such that any given message text to translate need only be translated once, even if it appears in multiple places in the application (eg "Name")</p> </li> 
           <li> <p>the <code>.po</code> message format includes translations for (optional) plural form as well as singular form</p> </li> 
           <li> <p>there are lots of freely available editors <a href="https://www.google.co.uk/search?q=.po+file+editor">to be found</a>, many summarized on this <a href="https://www.drupal.org/node/11131">Drupal.org</a> webpage.<br></p> 
            <div class="paragraph"> 
             <p>In fact, there are also online communities/platforms of translators to assist with translating files. One such is <a href="https://crowdin.com/">crowdin</a> (nb: this link does not imply endorsement).</p> 
            </div> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>In Apache Isis' implementation, if the translation is missing from the <code>.po</code> file then the original message text from the <code>.pot</code> file will be returned. In fact, it isn’t even necessary for there to be any <code>.po</code> files; <code>.po</code> translations can be added piecemeal as the need arises.</p> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="__ugbtb_i18n_translation-service">2.2. <code>TranslationService</code></h3> 
         <div class="paragraph"> 
          <p>The cornerstone of Apache Isis' support for i18n is the <code>TranslationService</code> service. This is defined in the applib with the following API:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">TranslationService</span> {
    <span class="directive">public</span> <span class="predefined-type">String</span> translate(      <i class="conum" data-value="1"></i><b>(1)</b>
            <span class="directive">final</span> <span class="predefined-type">String</span> context,
            <span class="directive">final</span> <span class="predefined-type">String</span> text);
    <span class="directive">public</span> <span class="predefined-type">String</span> translate(      <i class="conum" data-value="2"></i><b>(2)</b>
            <span class="directive">final</span> <span class="predefined-type">String</span> context,
            <span class="directive">final</span> <span class="predefined-type">String</span> singularText,
            <span class="directive">final</span> <span class="predefined-type">String</span> pluralText,
            <span class="directive">final</span> <span class="type">int</span> num);
    <span class="directive">public</span> <span class="type">enum</span> Mode {
        READ,
        WRITE;
    }
    Mode getMode();               <i class="conum" data-value="3"></i><b>(3)</b>
}</code></pre> 
          </div> 
         </div> 
         <div class="colist arabic"> 
          <table> 
           <tbody>
            <tr> 
             <td><i class="conum" data-value="1"></i><b>1</b></td> 
             <td>is to translate the singular form of the text</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="2"></i><b>2</b></td> 
             <td>is to translate the plural form of the text</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="3"></i><b>3</b></td> 
             <td>indicates whether the translation service is in read or write mode.</td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>The <code>translate(…​)</code> methods are closely modelled on GNU’s gettext API. The first version is used when no translation is required, the second is when both a singular and plural form will be required, with the <code>num</code> parameter being used to select which is returned. In both cases the <code>context</code> parameter provides some contextual information for the translator; this generally corresponds to the class member.</p> 
         </div> 
         <div class="paragraph"> 
          <p>The mode meanwhile determines the behaviour of the service. More on this below.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="__code_translationservicepo_code">2.2.1. <code>TranslationServicePo</code></h4> 
          <div class="paragraph"> 
           <p>Isis provides a default implementation of <code>TranslationService</code>, namely <code>TranslationServicePo</code>.</p> 
          </div> 
          <div class="paragraph"> 
           <p>If the service is running in the normal read mode, then it simply provides translations for the locale of the current user. This means locates the appropriate <code>.po</code> file (based on the requesting user’s locale), finds the translation and returns it.</p> 
          </div> 
          <div class="paragraph"> 
           <p>If however the service is configured to run in write mode, then it instead records the fact that the message was requested to be translated (a little like a spy/mock in unit testing mock), and returns the original message. The service can then be queried to discover which messages need to be translated. All requested translations are written into the <code>.pot</code> file.</p> 
          </div> 
          <div class="paragraph"> 
           <p>To make the service as convenient as possible to use, the service configures itself as follows:</p> 
          </div> 
          <div class="ulist"> 
           <ul> 
            <li> <p>if running in prototype mode <a href="../rgcfg/rgcfg.html#_rgcfg_deployment-types">deployment type</a> or during integration tests, then the service runs in <strong>write</strong> mode, in which case it records all translations into the <code>.pot</code> file. The <code>.pot</code> file is written out when the system is shutdown.</p> </li> 
            <li> <p>if running in server (production) mode <a href="../rgcfg/rgcfg.html#_rgcfg_deployment-types">deployment type</a>, then the service runs in <strong>read</strong> mode. It is also possible to set a configuration setting in <code>isis.properties</code> to force read mode even if running in prototype mode (useful to manually test/demo the translations).</p> </li> 
           </ul> 
          </div> 
          <div class="paragraph"> 
           <p>When running in write mode the original text is returned to the caller untranslated. If in read mode, then the translated <code>.po</code> files are read and translations provided as required.</p> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="__ugbtb_i18n_imperative-messages">2.3. Imperative messages</h3> 
         <div class="paragraph"> 
          <p>The <code>TranslationService</code> is used internally by Apache Isis when building up the metamodel; the name and description of every class, property, collection, action and action parameter is automatically translated. Thus the simple act of bootstrapping Apache Isis will cause most of the messages requiring translation (that is: those for the Apache Isis metamodel) to be captured by the <code>TranslationService</code>.</p> 
         </div> 
         <div class="paragraph"> 
          <p>However, for an application to be fully internationalized, any validation messages (from either <code>disableXxx()</code> or <code>validateXxx()</code> supporting methods) and also possibly an object’s title (from the <code>title()</code> method) will also require translation. Moreover, these messages must be captured in the <code>.pot</code> file such that they can be translated.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="__code_translatablestring_code">2.3.1. <code>TranslatableString</code></h4> 
          <div class="paragraph"> 
           <p>The first part of the puzzle is tackled by an extension to Apache Isis' programming model. Whereas previously the <code>disableXxx()</code> / <code>validateXxx()</code> / <code>title()</code> methods could only return a <code>java.lang.String</code>, they may now optionally return a <code>TranslatableString</code> (defined in Isis applib) instead.</p> 
          </div> 
          <div class="paragraph"> 
           <p>Here’s a (silly) example from the <a href="../ugfun/ugfun.html#_ugfun_getting-started_simpleapp-archetype">SimpleApp archetype</a>:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> TranslatableString validateUpdateName(<span class="directive">final</span> <span class="predefined-type">String</span> name) {
    <span class="keyword">return</span> name.contains(<span class="string"><span class="delimiter">"</span><span class="content">!</span><span class="delimiter">"</span></span>)? TranslatableString.tr(<span class="string"><span class="delimiter">"</span><span class="content">Exclamation mark is not allowed</span><span class="delimiter">"</span></span>): <span class="predefined-constant">null</span>;
}</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>This corresponds to the following entry in the <code>.pot</code> file:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="ini">#: dom.simple.SimpleObject#updateName()
msgid "Exclamation mark is not allowed"
msgstr ""</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>The full API of <code>TranslatableString</code> is modelled on the design of GNU gettext (in particular the <a href="https://code.google.com/p/gettext-commons/wiki/Tutorial">gettext-commons</a> library):</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">final</span> <span class="type">class</span> <span class="class">TranslatableString</span> {
    <span class="directive">public</span> <span class="directive">static</span> TranslatableString tr(       <i class="conum" data-value="1"></i><b>(1)</b>
            <span class="directive">final</span> <span class="predefined-type">String</span> pattern,
            <span class="directive">final</span> <span class="predefined-type">Object</span>... paramArgs) { ... }
    <span class="directive">public</span> <span class="directive">static</span> TranslatableString trn(      <i class="conum" data-value="2"></i><b>(2)</b>
            <span class="directive">final</span> <span class="predefined-type">String</span> singularPattern,
            <span class="directive">final</span> <span class="predefined-type">String</span> pluralPattern,
            <span class="directive">final</span> <span class="type">int</span> number,
            <span class="directive">final</span> <span class="predefined-type">Object</span>... paramArgs) { ... }
    <span class="directive">public</span> <span class="predefined-type">String</span> translate(                   <i class="conum" data-value="3"></i><b>(3)</b>
            <span class="directive">final</span> TranslationService translationService,
            <span class="directive">final</span> <span class="predefined-type">String</span> context) { ... }
}</code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>returns a translatable string with a single pattern for both singular and plural forms.</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="2"></i><b>2</b></td> 
              <td>returns a translatable string with different patterns for singular and plural forms; the one to use is determined by the 'number' argument</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="3"></i><b>3</b></td> 
              <td>translates the string using the provided <code>TranslationService</code>, using the appropriate singular/regular or plural form, and interpolating any arguments.</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
          <div class="paragraph"> 
           <p>The interpolation uses the format <code>{xxx}</code>, where the placeholder can occur multiple times.</p> 
          </div> 
          <div class="paragraph"> 
           <p>For example:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">final</span> TranslatableString ts = TranslatableString.tr(
    <span class="string"><span class="delimiter">"</span><span class="content">My name is {lastName}, {firstName} {lastName}.</span><span class="delimiter">"</span></span>,
    <span class="string"><span class="delimiter">"</span><span class="content">lastName</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Bond</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">firstName</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">James</span><span class="delimiter">"</span></span>);</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>would interpolate (for the English locale) as "My name is Bond, James Bond".</p> 
          </div> 
          <div class="paragraph"> 
           <p>For a German user, on the other hand, if the translation in the corresponding <code>.po</code> file was:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="ini">#: xxx.yyy.Whatever#context()
msgid "My name is {lastName}, {firstName} {lastName}."
msgstr "Ich heisse {firstName} {lastName}."</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>then the translation would be: "Ich heisse James Bond".</p> 
          </div> 
          <div class="paragraph"> 
           <p>The same class is used in <a href="../rgsvc/rgsvc.html#_rgsvc_core-domain-api_DomainObjectContainer"><code>DomainObjectContainer</code></a> so that you can raise translatable info, warning and error messages; each of the relevant methods are overloaded.</p> 
          </div> 
          <div class="paragraph"> 
           <p>For example:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">DomainObjectContainer</span> {
    <span class="type">void</span> informUser(<span class="predefined-type">String</span> message);
    <span class="type">void</span> informUser(
        TranslatableMessage message,
        <span class="directive">final</span> <span class="predefined-type">Class</span>&lt;?&gt; contextClass, <span class="directive">final</span> <span class="predefined-type">String</span> contextMethod); <i class="conum" data-value="1"></i><b>(1)</b>
    ...
}</code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>are concatenated together to form the context for the <code>.pot</code> file.</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="__code_translatableexception_code">2.3.2. <code>TranslatableException</code></h4> 
          <div class="paragraph"> 
           <p>Another mechanism by which messages can be rendered to the user are as the result of exception messages thrown and recognized by an <a href="../rgsvc/rgsvc.html#_rgsvc_presentation-layer-spi_ExceptionRecognizer"><code>ExceptionRecognizer</code></a>.</p> 
          </div> 
          <div class="paragraph"> 
           <p>In this case, if the exception implements <code>TranslatableException</code>, then the message will automatically be translated before being rendered. The <code>TranslatableException</code> itself takes the form:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">TranslatableException</span> {
    TranslatableString getTranslatableMessage(); <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="predefined-type">String</span> getTranslationContext();              <i class="conum" data-value="2"></i><b>(2)</b>
}</code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>the message to translate. If returns <code>null</code>, then the <code>Exception#getMessage()</code> is used as a fallback</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="2"></i><b>2</b></td> 
              <td>the context to use when translating the message</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="__ugbtb_i18n_wicket-viewer">2.4. Wicket Viewer</h3> 
         <div class="paragraph"> 
          <p>The <a href="../ugvw/ugvw.html">Wicket viewer</a> (its labels and messages) is also internationalized using the <code>TranslationService</code>. This is done through an Isis-specific implementation of the Wicket framework’s <code>org.apache.wicket.Localizer</code> class, namely <code>LocalizerForIsis</code>.</p> 
         </div> 
         <div class="paragraph"> 
          <p>The Wicket <code>Localizer</code> defines the following API:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="predefined-type">String</span> getString(
        <span class="directive">final</span> <span class="predefined-type">String</span> key,               <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="directive">final</span> <span class="predefined-type">Component</span> component,      <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="directive">final</span> IModel&lt;?&gt; model,
        <span class="directive">final</span> <span class="predefined-type">Locale</span> locale,
        <span class="directive">final</span> <span class="predefined-type">String</span> style,
        <span class="directive">final</span> <span class="predefined-type">String</span> defaultValue)
    <span class="directive">throws</span> <span class="exception">MissingResourceException</span> { ... }</code></pre> 
          </div> 
         </div> 
         <div class="colist arabic"> 
          <table> 
           <tbody>
            <tr> 
             <td><i class="conum" data-value="1"></i><b>1</b></td> 
             <td>The key to obtain the resource for</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="2"></i><b>2</b></td> 
             <td>The component to get the resource for (if any)</td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>For example, <code>key</code> might be a value such as "okLabel", while <code>component</code> an internal class of the Wicket viewer, such as <code>EntityPropertiesForm</code>.</p> 
         </div> 
         <div class="paragraph"> 
          <p>The <code>LocalizerForIsis</code> implementation uses the <code>key</code> as the <code>msgId</code>, while the fully qualified class name of the <code>component</code> is used as a context. There is one exception to this: if the component is the third-party select2 component (used for drop-downs), then that class name is used directly.</p> 
         </div> 
         <div class="paragraph"> 
          <p>In the main, using Isis' i18n support means simply adding the appropriate translations to the <code>translation.po</code> file, for each locale that you require. If the translations are missing then the original translations from the Wicket resource bundles will be used instead.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="_commonly_used">2.4.1. Commonly used</h4> 
          <div class="paragraph"> 
           <p>Most of the translation requirements can be covered by adding in the following <code>msgId</code>s:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="properties">#: org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage
msgid "CollectionContentsAsAjaxTablePanelFactory.Table"
msgstr "Table"

#: org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage
msgid "CollectionContentsAsUnresolvedPanel.Hide"
msgstr "Hide"

#: org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage
msgid "aboutLabel"
msgstr "About"

#: org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage
msgid "cancelLabel"
msgstr "Cancel"

#: org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage
msgid "datatable.no-records-found"
msgstr "No Records Found"

#: org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage
msgid "editLabel"
msgstr "Edit"

#: org.wicketstuff.select2.Select2Choice
msgid "inputTooShortPlural"
msgstr "Please enter {number} more characters"

#: org.wicketstuff.select2.Select2Choice
msgid "inputTooShortSingular"
msgstr "Please enter 1 more character"

#: org.wicketstuff.select2.Select2Choice
msgid "loadMore"
msgstr "Load more"

#: org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage
msgid "logoutLabel"
msgstr "Logout"

#: org.wicketstuff.select2.Select2Choice
msgid "noMatches"
msgstr "No matches"

#: org.apache.isis.viewer.wicket.ui.pages.entity.EntityPage
msgid "okLabel"
msgstr "OK"

#: org.wicketstuff.select2.Select2Choice
msgid "searching"
msgstr "Searching..."

#: org.wicketstuff.select2.Select2Choice
msgid "selectionTooBigPlural"
msgstr "You can only select {limit} items"

#: org.wicketstuff.select2.Select2Choice
msgid "selectionTooBigSingular"
msgstr "You can only select 1 item"</code></pre> 
           </div> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_login_self_sign_up">2.4.2. Login/self-sign-up</h4> 
          <div class="paragraph"> 
           <p>In addition, there are a reasonably large number of messages that are used for both login and the <a href="../ugvw/ugvw.html#_ugvw_features_user-registration">user registration</a> (self sign-up) and password reset features.</p> 
          </div> 
          <div class="paragraph"> 
           <p>These are:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="properties">#: org.apache.isis.viewer.wicket.ui.pages.login.WicketSignInPage
msgid "AutoLabel.CSS.required"
msgstr "Required"

#: org.apache.isis.viewer.wicket.ui.pages.accmngt.signup.RegistrationFormPage
#: org.apache.isis.viewer.wicket.ui.pages.accmngt.register.RegisterPage
#: org.apache.isis.viewer.wicket.ui.pages.accmngt.password_reset.PasswordResetPage
msgid "confirmPasswordLabel"
msgstr "Confirm password"

#: org.apache.isis.viewer.wicket.ui.pages.accmngt.signup.RegistrationFormPage
#: org.apache.isis.viewer.wicket.ui.pages.accmngt.register.RegisterPage
msgid "emailIsNotAvailable"
msgstr "The given email is already in use"

#: org.apache.isis.viewer.wicket.ui.pages.accmngt.password_reset.PasswordResetPage
msgid "emailPlaceholder"
msgstr "Enter your email"

#: org.apache.isis.viewer.wicket.ui.pages.accmngt.signup.RegistrationFormPage
#: org.apache.isis.viewer.wicket.ui.pages.accmngt.register.RegisterPage
msgid "emailPlaceholder"
msgstr "Enter an email for the new account"

#: org.apache.isis.viewer.wicket.ui.pages.accmngt.signup.RegistrationFormPage
#: org.apache.isis.viewer.wicket.ui.pages.accmngt.register.RegisterPage
#: org.apache.isis.viewer.wicket.ui.pages.accmngt.password_reset.PasswordResetPage
msgid "emailLabel"
msgstr "Email"

#: org.apache.isis.viewer.wicket.ui.pages.accmngt.signup.RegistrationFormPage
#: org.apache.isis.viewer.wicket.ui.pages.accmngt.register.RegisterPage
#: org.apache.isis.viewer.wicket.ui.pages.accmngt.password_reset.PasswordResetPage
msgid "emailSentMessage"
msgstr "An email has been sent to '${email}' for verification."

#: org.apache.isis.viewer.wicket.ui.pages.login.WicketSignInPage
msgid "forgotPasswordLinkLabel"
msgstr "Forgot your password?"

#: org.apache.isis.viewer.wicket.ui.pages.login.WicketSignInPage
msgid "loginHeader"
msgstr "Login"

#: org.apache.isis.viewer.wicket.ui.pages.accmngt.password_reset.PasswordResetPage
msgid "noSuchUserByEmail"
msgstr "There is no account with this email"

#: org.apache.isis.viewer.wicket.ui.pages.accmngt.password_reset.PasswordResetPage
msgid "noUserForAnEmailValidToken"
msgstr "The account seems to be either already deleted or has changed its email address. Please try again."

#: org.apache.isis.viewer.wicket.ui.pages.accmngt.password_reset.PasswordResetPage
msgid "passwordChangeSuccessful"
msgstr "The password has been changed successfully. You can &lt;a class=\"alert-success\" style=\"text-decoration:underline;\" href=\"${signInUrl}\"&gt;login&lt;/a&gt; now."

#: org.apache.isis.viewer.wicket.ui.pages.accmngt.password_reset.PasswordResetPage
msgid "passwordChangeUnsuccessful"
msgstr "There was a problem while updating the password. Please try again."

#: org.apache.isis.viewer.wicket.ui.pages.accmngt.signup.RegistrationFormPage
#: org.apache.isis.viewer.wicket.ui.pages.accmngt.register.RegisterPage
#: org.apache.isis.viewer.wicket.ui.pages.login.WicketSignInPage
#: org.apache.isis.viewer.wicket.ui.pages.accmngt.password_reset.PasswordResetPage
msgid "passwordLabel"
msgstr "Password"

#: org.apache.isis.viewer.wicket.ui.pages.accmngt.signup.RegistrationFormPage
#: org.apache.isis.viewer.wicket.ui.pages.accmngt.register.RegisterPage
#: org.apache.isis.viewer.wicket.ui.pages.login.WicketSignInPage
#: org.apache.isis.viewer.wicket.ui.pages.accmngt.password_reset.PasswordResetPage
msgid "passwordPlaceholder"
msgstr "Enter password"

#: org.apache.isis.viewer.wicket.ui.pages.accmngt.password_reset.PasswordResetPage
msgid "passwordResetExpiredOrInvalidToken"
msgstr "You are trying to reset the password for an expired or invalid token"

#: org.apache.isis.viewer.wicket.ui.pages.accmngt.password_reset.PasswordResetPage
msgid "passwordResetHeader"
msgstr "Forgot password"

#: org.apache.isis.viewer.wicket.ui.pages.accmngt.password_reset.PasswordResetPage
msgid "passwordResetSubmitLabel"
msgstr "Submit"

#: org.apache.isis.viewer.wicket.ui.pages.login.WicketSignInPage
msgid "registerButtonLabel"
msgstr "Register"

#: org.apache.isis.viewer.wicket.ui.pages.accmngt.register.RegisterPage
msgid "registerHeader"
msgstr "Register"

#: org.apache.isis.viewer.wicket.ui.pages.login.WicketSignInPage
msgid "rememberMeLabel"
msgstr "Remember Me"

#: org.apache.isis.viewer.wicket.ui.pages.login.WicketSignInPage
msgid "resetButtonLabel"
msgstr "Reset"

#: org.apache.isis.viewer.wicket.ui.pages.login.WicketSignInPage
msgid "signInButtonLabel"
msgstr "Sign in"

#: org.apache.isis.viewer.wicket.ui.pages.login.WicketSignInPage
msgid "signUpButtonLabel"
msgstr "Don't have an account? Sign up now."

#: org.apache.isis.viewer.wicket.ui.pages.accmngt.signup.RegistrationFormPage
#: org.apache.isis.viewer.wicket.ui.pages.accmngt.register.RegisterPage
#: org.apache.isis.viewer.wicket.ui.pages.accmngt.password_reset.PasswordResetPage
msgid "signUpButtonLabel"
msgstr "Verify email"

#: org.apache.isis.viewer.wicket.ui.pages.accmngt.signup.RegistrationFormPage
msgid "signUpHeader"
msgstr "Sign Up"

#: org.apache.isis.viewer.wicket.ui.pages.accmngt.signup.RegistrationFormPage
#: org.apache.isis.viewer.wicket.ui.pages.accmngt.register.RegisterPage
#: org.apache.isis.viewer.wicket.ui.pages.accmngt.password_reset.PasswordResetPage
msgid "usernameIsNotAvailable"
msgstr "The provided username is already in use"

#: org.apache.isis.viewer.wicket.ui.pages.accmngt.signup.RegistrationFormPage
#: org.apache.isis.viewer.wicket.ui.pages.accmngt.register.RegisterPage
#: org.apache.isis.viewer.wicket.ui.pages.login.WicketSignInPage
#: org.apache.isis.viewer.wicket.ui.pages.accmngt.password_reset.PasswordResetPage
msgid "usernameLabel"
msgstr "Username"

#: org.apache.isis.viewer.wicket.ui.pages.accmngt.signup.RegistrationFormPage
#: org.apache.isis.viewer.wicket.ui.pages.accmngt.register.RegisterPage
#: org.apache.isis.viewer.wicket.ui.pages.login.WicketSignInPage
#: org.apache.isis.viewer.wicket.ui.pages.accmngt.password_reset.PasswordResetPage
msgid "usernamePlaceholder"
msgstr "Username"</code></pre> 
           </div> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="__ugbtb_i18n_integration-testing">2.5. Integration Testing</h3> 
         <div class="paragraph"> 
          <p>So much for the API; but as noted, it is also necessary to ensure that the required translations are recorded (by the <code>TranslationService</code>) into the <code>.pot</code> file.</p> 
         </div> 
         <div class="paragraph"> 
          <p>For this, we recommend that you ensure that all such methods are tested through an <a href="../ugtst/ugtst.html#_ugtst_integ-test-support">integration test</a> (not unit test).</p> 
         </div> 
         <div class="paragraph"> 
          <p>For example, here’s the corresponding integration test for the "Exclamation mark" example from the simpleapp (above):</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Rule</span>
<span class="directive">public</span> ExpectedException expectedException = ExpectedException.none();

<span class="annotation">@Inject</span>
FixtureScripts fixtureScripts;

<span class="annotation">@Test</span>
<span class="directive">public</span> <span class="type">void</span> failsValidation() <span class="directive">throws</span> <span class="exception">Exception</span> {
    <span class="comment">// given</span>
    RecreateSimpleObjects fs = <span class="keyword">new</span> RecreateSimpleObjects().setNumber(<span class="integer">1</span>);
    fixtureScripts.runFixtureScript(fs, <span class="predefined-constant">null</span>);
    SimpleObject simpleObjectWrapped = wrap(fs.getSimpleObjects().get(<span class="integer">0</span>));

    <span class="comment">// expect</span>
    expectedExceptions.expect(InvalidException.class);
    expectedExceptions.expectMessage(<span class="string"><span class="delimiter">"</span><span class="content">Exclamation mark is not allowed</span><span class="delimiter">"</span></span>);

    <span class="comment">// when</span>
    simpleObjectWrapped.updateName(<span class="string"><span class="delimiter">"</span><span class="content">new name!</span><span class="delimiter">"</span></span>);
}</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>Running this test will result in the framework calling the <code>validateUpdateName(…​)</code> method, and thus to record that a translation is required in the <code>.pot</code> file.</p> 
         </div> 
         <div class="paragraph"> 
          <p>When the integration tests are complete (that is, when Apache Isis is shutdown), the <code>TranslationServicePo</code> will write out all captured translations to its log (more on this below). This will include all the translations captured from the Apache Isis metamodel, along with all translations as exercised by the integration tests.</p> 
         </div> 
         <div class="paragraph"> 
          <p>To ensure your app is fully internationalized app, you must therefore:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p>use <code>TranslatableString</code> rather than <code>String</code> for all validation/disable and title methods.</p> </li> 
           <li> <p>ensure that (at a minimum) all validation messages and title methods are integration tested.</p> </li> 
          </ul> 
         </div> 
         <div class="admonitionblock note"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
             <td class="content"> 
              <div class="paragraph"> 
               <p>We make no apologies for this requirement: one of the reasons that we decided to implement Apache Isis' i18n support in this way is because it encourages/requires the app to be properly tested.</p> 
              </div> 
              <div class="paragraph"> 
               <p>Behind the scenes Apache Isis uses a JUnit rule (<code>ExceptionRecognizerTranslate</code>) to intercept any exceptions that are thrown. These are simply passed through to the registered <a href="../rgsvc/rgsvc.html#_rgsvc_presentation-layer-spi_ExceptionRecognizer"><code>ExceptionRecognizer</code></a>s so that any messages are recorded as requiring translation.</p> 
              </div> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_escaped_strings">2.6. Escaped strings</h3> 
         <div class="paragraph"> 
          <p>Translated messages can be escaped if required, eg to include embedded markup.</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="ini">#: com.mycompany.myapp.OrderItem#quantity
msgid "&lt;i&gt;Quantity&lt;/i&gt;"
msgstr "&lt;i&gt;Quantité&lt;/i&gt;"</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>For this to work, the <code>namedEscaped()</code> attribute must be specified using either the <a href="../ugvw/ugvw.html#_ugvw_layout_file-based">layout file</a>, or using an annotation such as <a href="../rgant/rgant.html#_rgant-PropertyLayout"><code>@PropertyLayout</code></a> or <a href="../rgant/rgant.html#_rgant-ParameterLayout"><code>@ParameterLayout</code></a>.</p> 
         </div> 
         <div class="paragraph"> 
          <p>For example:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ParameterLayout</span>(
    named=<span class="string"><span class="delimiter">"</span><span class="content">&lt;i&gt;Quantity&lt;/i&gt;</span><span class="delimiter">"</span></span>,      <i class="conum" data-value="1"></i><b>(1)</b>
    namedEscaped=<span class="predefined-constant">false</span>
)
<span class="directive">public</span> <span class="predefined-type">Integer</span> getQuantity() { ... }</code></pre> 
          </div> 
         </div> 
         <div class="colist arabic"> 
          <table> 
           <tbody>
            <tr> 
             <td><i class="conum" data-value="1"></i><b>1</b></td> 
             <td>required (even though it won’t be used when a translation is read; otherwise the escaped flag is ignored)</td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="__ugbtb_i18n_configuration">2.7. Configuration</h3> 
         <div class="paragraph"> 
          <p>There are several different aspects of the translation service that can be configured.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="_logging">2.7.1. Logging</h4> 
          <div class="paragraph"> 
           <p>To configure the <code>TranslationServicePo</code> to write to out the <code>translations.pot</code> file, add the following to the <em>integtests</em> <code>logging.properties</code> file:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="ini">log4j.appender.translations-po=org.apache.log4j.FileAppender
log4j.appender.translations-po.File=./translations.pot
log4j.appender.translations-po.Append=false
log4j.appender.translations-po.layout=org.apache.log4j.PatternLayout
log4j.appender.translations-po.layout.ConversionPattern=%m%n

log4j.logger.org.apache.isis.core.runtime.services.i18n.po.PoWriter=INFO,translations-po
log4j.additivity.org.apache.isis.core.runtime.services.i18n.po.PotWriter=false</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>Just to repeat, this is <em>not</em> the <code>WEB-INF/logging.properties</code> file, it should instead be added to the <code>integtests/logging.properties</code> file.</p> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_location_of_the_code_po_code_files">2.7.2. Location of the <code>.po</code> files</h4> 
          <div class="paragraph"> 
           <p>The default location of the translated <code>.po</code> files is in the <code>WEB-INF</code> directory. These are named and searched for similarly to regular Java resource bundles.</p> 
          </div> 
          <div class="paragraph"> 
           <p>For example, assuming these translations:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="ini">/WEB-INF/translations-en-US.po
        /translations-en.po
        /translations-fr-FR.po
        /translations.po</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>then:</p> 
          </div> 
          <div class="ulist"> 
           <ul> 
            <li> <p>a user with <code>en-US</code> locale will use <code>translations-en-US.po</code></p> </li> 
            <li> <p>a user with <code>en-GB</code> locale will use <code>translations-en.po</code></p> </li> 
            <li> <p>a user with <code>fr-FR</code> locale will use <code>translations-fr-FR.po</code></p> </li> 
            <li> <p>a user with <code>fr-CA</code> locale will use <code>translations.po</code></p> </li> 
           </ul> 
          </div> 
          <div class="paragraph"> 
           <p>The basename for translation files is always <code>translations</code>; this cannot be altered.</p> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_externalized_translation_files">2.7.3. Externalized translation files</h4> 
          <div class="paragraph"> 
           <p>Normally Apache Isis configuration files are read from the <code>WEB-INF</code> file. However, Apache Isis can be configured to read config files from an <a href="../ugbtb/ugbtb.html#_ugbtb_deployment_externalized-configuration">external directory</a>; this is also supported for translations.</p> 
          </div> 
          <div class="paragraph"> 
           <p>Thus, if in <code>web.xml</code> the external configuration directory has been set:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;context-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>isis.config.dir<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>location of external config directory<span class="tag">&lt;/param-value&gt;</span>
<span class="tag">&lt;/context-param&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>Then this directory will be used as the base for searching for translations (rather than the default 'WEB-INF/' directory).</p> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_force_read_mode">2.7.4. Force read mode</h4> 
          <div class="paragraph"> 
           <p>As noted above, if running in prototype mode then <code>TranslationServicePo</code> will be in write mode, if in production mode then will be in read mode. To force read mode (ie use translations) even if in prototype mode, add the following configuration property to <code>isis.properties</code>:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="ini">isis.services.translation.po.mode=read</code></pre> 
           </div> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_supporting_services">2.8. Supporting services</h3> 
         <div class="paragraph"> 
          <p>The <code>TranslationServicePo</code> has a number of supporting/related services.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="__code_localeprovider_code">2.8.1. <code>LocaleProvider</code></h4> 
          <div class="paragraph"> 
           <p>The <code>LocaleProvider</code> API is used by the <code>TranslationServicePo</code> implementation to obtain the locale of the "current user".</p> 
          </div> 
          <div class="paragraph"> 
           <p>A default implementation is provided by the Wicket viewer.</p> 
          </div> 
          <div class="admonitionblock note"> 
           <table> 
            <tbody>
             <tr> 
              <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
              <td class="content"> 
               <div class="paragraph"> 
                <p>Note that this default implementation does not support requests made through the Restful Objects viewer (there is no Wicket 'application' object available); the upshot is that requests through Restful Objects are never translated. Registering a different implementation of <code>LocaleProvider</code> that taps into appropriate REST (RestEasy?) APIs would be the way to address this.</p> 
               </div> </td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="__code_translationsresolver_code">2.8.2. <code>TranslationsResolver</code></h4> 
          <div class="paragraph"> 
           <p>The <code>TranslationResolver</code> is used by the <code>TranslationService</code> implementation to lookup translations for a specified locale. It is this service that reads from the <code>WEB-INF/</code> (or externalized directory).</p> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="__code_translationservicepomenu_code">2.8.3. <code>TranslationServicePoMenu</code></h4> 
          <div class="paragraph"> 
           <p>The <code>TranslationServicePoMenu</code> provides a couple of menu actions in the UI (prototype mode only) that interacts with the underlying <code>TranslationServicePo</code>:</p> 
          </div> 
          <div class="ulist"> 
           <ul> 
            <li> <p>the <code>downloadTranslationsFile()</code> action - available only in write mode - allows the current <code>.pot</code> file to be downloaded.<br></p> 
             <div class="admonitionblock note"> 
              <table> 
               <tbody>
                <tr> 
                 <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
                 <td class="content"> 
                  <div class="paragraph"> 
                   <p>While this will contain all the translations from the metamodel, it will not necessarily contain all translations for all imperative methods returning <code>TranslatableString</code> instances; which are present and which are missing will depend on which imperative methods have been called (recorded by the service) prior to downloading.</p> 
                  </div> </td> 
                </tr> 
               </tbody>
              </table> 
             </div> </li> 
            <li> <p>the <code>clearTranslationsCache()</code> action - available only in read mode - will clear the cache so that new translations can be loaded.<br></p> 
             <div class="paragraph"> 
              <p>This allows a translator to edit the appropriate <code>translations-xx-XX.po</code> file and check the translation is correct without having to restart the app.</p> 
             </div> </li> 
           </ul> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
      <div class="sect1"> 
       <h2 id="_ugbtb_headless-access">3. Headless access</h2>
       <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
        <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_headless-access.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
        <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
        <ul class="dropdown-menu">
         <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_headless-access.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
         <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_headless-access.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
         <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_headless-access.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
         <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_headless-access.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
        </ul>
       </div> 
       <div class="sectionbody"> 
        <div class="paragraph"> 
         <p>This section tackles the topic of enabling access to an Isis application directly, or at least, not through either the <a href="../ugvw/ugvw.html">Wicket</a> or <a href="../ugvro/ugvro.html">Restful</a> viewers.</p> 
        </div> 
        <div class="paragraph"> 
         <p>There are several main use-cases:</p> 
        </div> 
        <div class="ulist"> 
         <ul> 
          <li> <p>enabling background execution, eg of a thread managed by Quartz scheduler and running within the webapp</p> </li> 
          <li> <p>integration from other systems, eg for a subscriber on a pub/sub mechanism such as Camel, pushing changes through an Apache Isis domain model.</p> </li> 
          <li> <p>leveraging an Isis application within a batch process</p> </li> 
         </ul> 
        </div> 
        <div class="paragraph"> 
         <p>Note that the calling thread runs in the same process space as the Apache Isis domain object model (must be physically linked to the JAR files containing the domain classes). For use cases where the calling thread runs in some other process space (eg migrating data from a legacy system), then the <a href="../ugvro/ugvro.html">Restful Objects viewer</a> is usually the way to go.</p> 
        </div> 
        <div class="paragraph"> 
         <p>The API described in this chapter is reasonably low-level, allowing code to interact very directly with the Apache Isis metamodel and runtime. Such callers should be considered trusted: they do not (by default) honour any business rules eg implicit in the Isis annotations or hide/disable/validate methods. However the <a href="../rgsvc/rgsvc.html#_rgsvc_application-layer-api_WrapperFactory"><code>WrapperFactory</code></a> service could be used to enforce such business rules if required.</p> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_headless-access_AbstractIsisSessionTemplate">3.1. AbstractIsisSessionTemplate</h3>
         <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
          <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_headless-access_AbstractIsisSessionTemplate.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
          <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
          <ul class="dropdown-menu">
           <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_headless-access_AbstractIsisSessionTemplate.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
           <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_headless-access_AbstractIsisSessionTemplate.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
           <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_headless-access_AbstractIsisSessionTemplate.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
           <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_headless-access_AbstractIsisSessionTemplate.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
          </ul>
         </div> 
         <div class="paragraph"> 
          <p>The <code>AbstractIsisSessionTemplate</code> class (whose name is inspired by the Spring framework’s naming convention for similar classes that query <a href="http://docs.spring.io/spring/docs/2.5.x/reference/jdbc.html#jdbc-JdbcTemplate">JDBC</a>, <a href="http://docs.spring.io/spring/docs/2.5.x/reference/jms.html#jms-jmstemplate">JMS</a>, <a href="http://docs.spring.io/spring/docs/2.5.x/reference/orm.html#orm-jpa-template">JPA</a> etc.) provides the mechanism to open up a 'session' within the Apache Isis framework, in order to resolve and interact with entities.</p> 
         </div> 
         <div class="paragraph"> 
          <p>The class itself is intended to be subclassed:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">abstract</span> <span class="type">class</span> <span class="class">AbstractIsisSessionTemplate</span> {

    <span class="directive">public</span> <span class="type">void</span> execute(<span class="directive">final</span> AuthenticationSession authSession, <span class="directive">final</span> <span class="predefined-type">Object</span> context) { ... } <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="directive">protected</span> <span class="directive">abstract</span> <span class="type">void</span> doExecute(<span class="predefined-type">Object</span> context); <i class="conum" data-value="2"></i><b>(2)</b>

    <span class="directive">protected</span> ObjectAdapter adapterFor(<span class="directive">final</span> <span class="predefined-type">Object</span> targetObject) { ... }
    <span class="directive">protected</span> ObjectAdapter adapterFor(<span class="directive">final</span> RootOid rootOid) { ... }

    <span class="directive">protected</span> PersistenceSession getPersistenceSession() { ... }
    <span class="directive">protected</span> IsisTransactionManager getTransactionManager() { ... }
    <span class="directive">protected</span> AdapterManager getAdapterManager() { ... }
}</code></pre> 
          </div> 
         </div> 
         <div class="colist arabic"> 
          <table> 
           <tbody>
            <tr> 
             <td><i class="conum" data-value="1"></i><b>1</b></td> 
             <td><code>execute(…​)</code> sets up the <code>IsisSession</code> and delegates to …​</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="2"></i><b>2</b></td> 
             <td><code>doExecute(…​)</code>, the mandatory hook method for subclasses to implement. The passed object represents passes a context from the caller (eg the scheduler, cron job, JMS etc) that instantiated and executed the class.</td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>The <code>protected</code> methods expose key internal APIs within Apache Isis, for the subclass to use as necessary.</p> 
         </div> 
         <div class="admonitionblock tip"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> 
             <td class="content"> 
              <div class="paragraph"> 
               <p>One notable feature of <code>AbstractIsisSessionTemplate</code> is that it will automatically inject any domain services into itself. Thus, it is relatively easy for the subclass to "reach into" the domain, through injected repository services.</p> 
              </div> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_headless-access_BackgroundCommandExecution">3.2. BackgroundCommandExecution</h3>
         <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
          <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_headless-access_BackgroundCommandExecution.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
          <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
          <ul class="dropdown-menu">
           <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_headless-access_BackgroundCommandExecution.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
           <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_headless-access_BackgroundCommandExecution.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
           <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_headless-access_BackgroundCommandExecution.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
           <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_headless-access_BackgroundCommandExecution.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
          </ul>
         </div> 
         <div class="paragraph"> 
          <p>The <code>BackgroundCommandExecution</code> class (a subclass of <a href="../ugbtb/ugbtb.html#_ugbtb_headless-access_AbstractIsisSessionTemplate">AbstractIsisSessionTemplate</a>) is intended to simplify the execution of background <code>Command</code>s persisted by way of the <a href="../rgsvc/rgsvc.html#_rgsvc_application-layer-spi_CommandService"><code>CommandService</code></a> and the <a href="../rgsvc/rgsvc.html#_rgsvc_application-layer-spi_BackgroundCommandService"><code>BackgroundCommandService</code></a>.</p> 
         </div> 
         <div class="paragraph"> 
          <p>Its signature is:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">abstract</span> <span class="type">class</span> <span class="class">BackgroundCommandExecution</span> <span class="directive">extends</span> AbstractIsisSessionTemplate {
    <span class="directive">protected</span> <span class="type">void</span> doExecute(<span class="predefined-type">Object</span> context) { ... }
    <span class="directive">protected</span> <span class="directive">abstract</span> <span class="predefined-type">List</span>&lt;? <span class="directive">extends</span> Command&gt; findBackgroundCommandsToExecute(); <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre> 
          </div> 
         </div> 
         <div class="colist arabic"> 
          <table> 
           <tbody>
            <tr> 
             <td><i class="conum" data-value="1"></i><b>1</b></td> 
             <td><code>findBackgroundCommandsToExecute()</code> is a mandatory hook method for subclasses to implement.</td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>This allows for different implementations of the <code>CommandService</code> and <code>BackgroundCommandService</code> to persist to wherever.</p> 
         </div> 
         <div class="paragraph"> 
          <p>The diagram below (<a href="http://yuml.me/edit/363b335f">yuml.me/363b335f</a>) shows the dependencies between these various classes:</p> 
         </div> 
         <div class="imageblock"> 
          <div class="content"> 
           <a class="image" href="images/headless-access/BackgroundCommandExecution.png"><img src="images/headless-access/BackgroundCommandExecution.png" alt="BackgroundCommandExecution" width="400px"></a> 
          </div> 
          <div class="title">
           Figure 1. Inheritance Hierarchy for 
           <code>BackgroundCommandExecution</code>
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_background_execution">3.2.1. Background Execution</h4> 
          <div class="paragraph"> 
           <p>The <code>BackgroundCommandExecutionFromBackgroundCommandServiceJdo</code> is a concrete subclass of <code>BackgroundCommandExecution</code> (see the <a href="../rgsvc/rgsvc.html#_rgsvc_application-layer-api_BackgroundService"><code>BackgroundCommandService</code></a>), the intended use being for the class to be instantiated regularly (eg every 10 seconds) by a scheduler such as <a href="http://quartz-scheduler.org">Quartz</a>) to poll for <code>Command</code>s to be executed, and then execute them.</p> 
          </div> 
          <div class="paragraph"> 
           <p>This implementation queries for <code>Command</code>s persisted by the (non-ASF) <a href="http://platform.incode.org" target="_blank">Incode Platform</a>'s command module’s implementations of <a href="../rgsvc/rgsvc.html#_rgsvc_application-layer-spi_CommandService"><code>CommandService</code></a> and <a href="../rgsvc/rgsvc.html#_rgsvc_application-layer-spi_BackgroundCommandService"><code>BackgroundCommandService</code></a> using the <code>BackgroundCommandServiceJdoRepository</code>.</p> 
          </div> 
          <div class="paragraph"> 
           <p>The diagram below (<a href="http://yuml.me/edit/25343da1">yuml.me/25343da1</a>) shows the inheritance hierarchy for this class:</p> 
          </div> 
          <div class="imageblock"> 
           <div class="content"> 
            <img src="images/headless-access/BackgroundCommandExecutionFromBackgroundCommandServiceJdo.png" alt="BackgroundCommandExecutionFromBackgroundCommandServiceJdo" width="500px"> 
           </div> 
           <div class="title">
            Figure 2. Inheritance Hierarchy for 
            <code>BackgroundCommandExecutionFromBackgroundCommandServiceJdo</code>
           </div> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
      <div class="sect1"> 
       <h2 id="_ugbtb_hints-and-tips">4. Hints and Tips</h2>
       <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
        <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
        <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
        <ul class="dropdown-menu">
         <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
         <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
         <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
         <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
        </ul>
       </div> 
       <div class="sectionbody"> 
        <div class="paragraph"> 
         <p>This chapter provides some solutions for problems we’ve encountered ourselves or have been raised on the Apache Isis mailing lists.</p> 
        </div> 
        <div class="paragraph"> 
         <p>See also hints-n-tips chapters in the:</p> 
        </div> 
        <div class="ulist"> 
         <ul> 
          <li> <p>the <a href="../dg/dg.html#_dg_hints-and-tips">Developers'</a> guide</p> </li> 
          <li> <p>the <a href="../ugvw/ugvw.html#_ugvw_hints-and-tips">Wicket viewer</a> guide</p> </li> 
          <li> <p>the <a href="../ugvro/ugvro.html#_ugvro_hints-and-tips">Restful Objects viewer</a> guide</p> </li> 
          <li> <p>the <a href="../ugodn/ugodn.html#_ugodn_hints-and-tips">Datanucleus ObjectStore</a> guide</p> </li> 
          <li> <p>the <a href="../ugsec/ugsec.html#_ugsec_hints-and-tips">Security</a> guide</p> </li> 
          <li> <p>the <a href="../ugbtb/ugbtb.html#_ugbtb_hints-and-tips">Beyond the Basics</a> guide (this chapter).</p> </li> 
         </ul> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_are-you-sure">4.1. 'Are you sure?' idiom</h3>
         <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
          <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_are-you-sure.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
          <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
          <ul class="dropdown-menu">
           <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_are-you-sure.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
           <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_are-you-sure.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
           <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_are-you-sure.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
           <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_are-you-sure.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
          </ul>
         </div> 
         <div class="paragraph"> 
          <p>Sometimes an action might perform irreversible changes. In such a case it’s probably a good idea for the UI to require that the end-user explicitly confirms that they intended to invoke the action.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="_using_action_semantics">4.1.1. Using action semantics</h4> 
          <div class="paragraph"> 
           <p>One way to meet this requirement is using the framework’s built-in <a href="../rgant/rgant.html#_rgant-Action_semantics"><code>@Action#semantics()</code></a> attribute:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Action</span>(
        semantics = SemanticsOf.IDEMPOTENT_ARE_YOU_SURE
)
<span class="directive">public</span> SimpleObject updateName(
        <span class="annotation">@Parameter</span>(maxLength = NAME_LENGTH)
        <span class="annotation">@ParameterLayout</span>(named = <span class="string"><span class="delimiter">"</span><span class="content">New name</span><span class="delimiter">"</span></span>)
        <span class="directive">final</span> <span class="predefined-type">String</span> name) {
    setName(name);
    <span class="keyword">return</span> <span class="local-variable">this</span>;
}</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>This will render as:</p> 
          </div> 
          <div class="imageblock"> 
           <div class="content"> 
            <a class="image" href="images/hints-and-tips/action-semantics-are-you-sure.png"><img src="images/hints-and-tips/action-semantics-are-you-sure.png" alt="action semantics are you sure"></a> 
           </div> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_using_a_checkbox">4.1.2. Using a checkbox</h4> 
          <div class="paragraph"> 
           <p>An alternative approach (for all versions of the framework) is to require the end-user to check a dummy checkbox parameter (and prevent the action from being invoked if the user hasn’t checked that parameter).</p> 
          </div> 
          <div class="paragraph"> 
           <p>For example:</p> 
          </div> 
          <div class="imageblock"> 
           <div class="content"> 
            <a class="image" href="images/hints-and-tips/are-you-sure.png"><img src="images/hints-and-tips/are-you-sure.png" alt="are you sure"></a> 
           </div> 
          </div> 
          <div class="admonitionblock note"> 
           <table> 
            <tbody>
             <tr> 
              <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
              <td class="content"> 
               <div class="paragraph"> 
                <p>Note that these screenshots shows an earlier version of the <a href="../ugvw/ugvw.html">Wicket viewer</a> UI (specifically, pre 1.8.0).</p> 
               </div> </td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
          <div class="paragraph"> 
           <p>If the user checks the box:</p> 
          </div> 
          <div class="imageblock"> 
           <div class="content"> 
            <a class="image" href="images/hints-and-tips/are-you-sure-happy-case.png"><img src="images/hints-and-tips/are-you-sure-happy-case.png" alt="are you sure happy case"></a> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>then the action will complete.</p> 
          </div> 
          <div class="paragraph"> 
           <p>However, if the user fails to check the box, then a validation message is shown:</p> 
          </div> 
          <div class="imageblock"> 
           <div class="content"> 
            <a class="image" href="images/hints-and-tips/are-you-sure-sad-case.png"><img src="images/hints-and-tips/are-you-sure-sad-case.png" alt="are you sure sad case"></a> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>The code for this is pretty simple:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="predefined-type">List</span>&lt;ToDoItem&gt; delete(<span class="annotation">@Named</span>(<span class="string"><span class="delimiter">"</span><span class="content">Are you sure?</span><span class="delimiter">"</span></span>) <span class="type">boolean</span> areYouSure) {
    container.removeIfNotAlready(<span class="local-variable">this</span>);
    container.informUser(<span class="string"><span class="delimiter">"</span><span class="content">Deleted </span><span class="delimiter">"</span></span> + container.titleOf(<span class="local-variable">this</span>));
    <span class="keyword">return</span> toDoItems.notYetComplete();          <i class="conum" data-value="1"></i><b>(1)</b>
}
<span class="directive">public</span> <span class="predefined-type">String</span> validateDelete(<span class="type">boolean</span> areYouSure) {
    <span class="keyword">return</span> areYouSure? <span class="predefined-constant">null</span>: <span class="string"><span class="delimiter">"</span><span class="content">Please confirm you are sure</span><span class="delimiter">"</span></span>;
}</code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>invalid to return <code>this</code> (cannot render a deleted object)</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
          <div class="paragraph"> 
           <p>Note that the action itself does not use the boolean parameter, it is only used by the supporting <a href="../rgcms/rgcms.html#_rgcms_methods_prefixes_validate"><code>validate…​()</code></a> method.</p> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_replacing-default-service-implementations">4.2. Overriding Default Service Implns</h3>
         <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
          <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_replacing-default-service-implementations.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
          <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
          <ul class="dropdown-menu">
           <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_replacing-default-service-implementations.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
           <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_replacing-default-service-implementations.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
           <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_replacing-default-service-implementations.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
           <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_replacing-default-service-implementations.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
          </ul>
         </div> 
         <div class="paragraph"> 
          <p>The framework provides default implementations for many of the <a href="../rgsvc/rgsvc.html">domain services</a>. This is convenient, but sometimes you will want to replace the default implementation with your own service implementation.</p> 
         </div> 
         <div class="paragraph"> 
          <p>For example, suppose you wanted to provide your own implementation of <a href="../rgsvc/rgsvc.html#_rgsvc_api_LocaleProvider"><code>LocaleProvider</code></a>. The trick is to use the <a href="../rgant/rgant.html#_rgant-DomainService_menuOrder"><code>@DomainService#menuOrder()</code></a> attribute, specifying a low number (typically <code>"1"</code>).</p> 
         </div> 
         <div class="paragraph"> 
          <p>Here’s how:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@DomainService</span>(
        nature = NatureOfService.DOMAIN
)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyLocaleProvider</span> <span class="directive">implements</span> LocaleProvider {
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">Locale</span> getLocale() {
        <span class="keyword">return</span> ...
    }
}</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>The framework uses the value of the <code>menuOrder</code> attribute to determine priority; lowest number wins.</p> 
         </div> 
         <div class="paragraph"> 
          <p>However, there is no need to specify the <code>menuOrder</code> attribute: its default value is now set to a lower value (specifically: <code>Integer.MAX_VALUE - 100</code>) than all of the framework-provided implementations, and thus always takes precedence.</p> 
         </div> 
         <div class="paragraph"> 
          <p>Thus, if a single instance is to be injected, eg:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@javax</span>.inject.Inject
LocalProvider localeProvider;</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>then the custom implementation will be used in preference to the framework’s default implementation.</p> 
         </div> 
         <div class="paragraph"> 
          <p>If multiple instances are injected, eg:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@javax</span>.inject.Inject
<span class="predefined-type">List</span>&lt;LocalProvider&gt; localeProviders;</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>then all implementations will be present in the list, ordered by priority; your custom implementation will be first in the list.</p> 
         </div> 
         <div class="admonitionblock note"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
             <td class="content"> 
              <div class="paragraph"> 
               <p>It is also possible to use <a href="../rgant/rgant.html#_rgant-DomainServiceLayout_menuOrder"><code>@DomainServiceLayout#menuOrder()</code></a> attribute, rather than <a href="../rgant/rgant.html#_rgant-DomainService_menuOrder"><code>@DomainService#menuOrder()</code></a>. The general convention is to use the former only for services that are rendered in the UI, the latter for programmatic services.</p> 
              </div> 
              <div class="paragraph"> 
               <p>If both attributes are present, then the value of <a href="../rgant/rgant.html#_rgant-DomainServiceLayout_menuOrder"><code>@DomainServiceLayout#menuOrder()</code></a> is used.</p> 
              </div> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="sect3"> 
          <h4 id="_decorating_existing_implementations">4.2.1. Decorating existing implementations</h4> 
          <div class="paragraph"> 
           <p>It’s also quite common to want to decorate the existing implementation (ie have your own implementation delegate to the default); this is also possible and quite easy:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@DomainService</span>(
        nature = NatureOfService.DOMAIN
)
<span class="annotation">@DomainServiceLayout</span>(
        menuOrder = <span class="string"><span class="delimiter">"</span><span class="content">1</span><span class="delimiter">"</span></span>                                                                             <i class="conum" data-value="1"></i><b>(1)</b>
)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyLocaleProvider</span> <span class="directive">implements</span> LocaleProvider {
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">Locale</span> getLocale() {
        <span class="keyword">return</span> getDelegateLocaleProvider().getLocale();                                             <i class="conum" data-value="2"></i><b>(2)</b>
    }
    Optional&lt;LocaleProvider&gt; delegateLocaleProvider;                                                <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="directive">private</span> LocaleProvider getDelegateLocaleProvider() {
        <span class="keyword">if</span>(delegateLocaleProvider == <span class="predefined-constant">null</span>) {
            delegateLocaleProvider = Iterables.tryFind(localeProviders, input -&gt; input != <span class="local-variable">this</span>);    <i class="conum" data-value="4"></i><b>(4)</b>
        }
        <span class="keyword">return</span> delegateLocaleProvider.orNull();
    }
    <span class="annotation">@Inject</span>
    <span class="predefined-type">List</span>&lt;LocaleProvider&gt; localeProviders;                                                           <i class="conum" data-value="5"></i><b>(5)</b>
}</code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>takes precedence over the default implementation when injected elsewhere.</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="2"></i><b>2</b></td> 
              <td>this implementation merely delegates to the default implementation</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="3"></i><b>3</b></td> 
              <td>lazily populated</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="4"></i><b>4</b></td> 
              <td>delegate to the first implementation that isn’t <em>this</em> implementation (else infinite loop!)</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="5"></i><b>5</b></td> 
              <td>Injects all implementations, including this implemenation</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_vetoing-visibility">4.3. Vetoing Visibility</h3>
         <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
          <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_vetoing-visibility.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
          <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
          <ul class="dropdown-menu">
           <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_vetoing-visibility.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
           <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_vetoing-visibility.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
           <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_vetoing-visibility.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
           <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_vetoing-visibility.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
          </ul>
         </div> 
         <div class="admonitionblock note"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
             <td class="content"> FIXME - a write-up of the "vetoing subscriber" design pattern, eg as described in the <a href="../rgsvc/rgsvc.html#_rgsvc_integration-api_BookmarkService"><code>BookmarkService</code></a> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>eg if included an addon such as auditing or security.</p> 
         </div> 
         <div class="paragraph"> 
          <p>solution is to write a domain event subscriber that vetoes the visibility</p> 
         </div> 
         <div class="paragraph"> 
          <p>All the addons actions inherit from common base classes so this can be as broad-brush or fine-grained as required</p> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_transactions-and-errors">4.4. Transactions and Errors</h3>
         <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
          <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_transactions-and-errors.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
          <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
          <ul class="dropdown-menu">
           <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_transactions-and-errors.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
           <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_transactions-and-errors.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
           <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_transactions-and-errors.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
           <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_transactions-and-errors.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
          </ul>
         </div> 
         <div class="paragraph"> 
          <p>In Apache Isis, every interaction (action invocation or property edit) is automatically wrapped in a transaction, and any repository query automatically does a flush before hand.</p> 
         </div> 
         <div class="paragraph"> 
          <p>What that means is that there’s no need to explicitly start or commit transactions in Apache Isis; this will be done for you. Indeed, if you do try to manage transactions (eg by reaching into the JDO <code>PersistenceManager</code> exposed by the <a href="../rgsvc/rgsvc.html#_rgsvc_persistence-layer-api_IsisJdoSupport">IsisJdoSupport</a> domain service, then you are likely to confuse the framework and get a stack trace for your trouble.</p> 
         </div> 
         <div class="paragraph"> 
          <p>However, you can complete a given transaction and start a new one. This is sometimes useful if writing a fixture script which is going to perform some sort of bulk migration of data from an old system. For this use case, use the <a href="../rgsvc/rgsvc.html#_rgsvc_application-layer-api_TransactionService"><code>TransactionService</code></a>.</p> 
         </div> 
         <div class="paragraph"> 
          <p>For example:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">SomeLongRunningFixtureScript</span> <span class="directive">extends</span> FixtureScript

    <span class="directive">protected</span> <span class="type">void</span> execute(<span class="directive">final</span> ExecutionContext executionContext) {
        <span class="comment">// do some work</span>
        transactionService.nextTransaction();
        <span class="comment">// do some work</span>
        transactionService.nextTransaction();
        <span class="comment">// do yet more work</span>
    }

    <span class="annotation">@javax</span>.inject.Inject
    TransactionService transactionService;
}</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>You get the idea.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="_raise_message_in_the_ui">4.4.1. Raise message in the UI</h4> 
          <div class="paragraph"> 
           <p>The framework provides the <a href="../rgsvc/rgsvc.html#_rgsvc_application-layer-api_MessageService"><code>MessageService</code></a> as a means to return an out-of-band message to the end-user. In the <a href="../ugvw/ugvw.html">Wicket viewer</a> these are shown as "toast" pop-ups; the <a href="../ugvro/ugvro.html">Restful Objects viewer</a> returns an HTTP header.</p> 
          </div> 
          <div class="paragraph"> 
           <p>The <code>UserService</code> provides three APIs, for different:</p> 
          </div> 
          <div class="ulist"> 
           <ul> 
            <li> <p><code>informUser()</code> - an informational message. In the Wicket viewer these are short-lived pop-ups that disappear after a short time.</p> </li> 
            <li> <p><code>warnUser()</code> - a warning. In the Wicket viewer these do not auto-close; they must be acknowledged.</p> </li> 
            <li> <p><code>raiseError()</code> - an error. In the Wicket viewer these do not auto-close; they must be acknowledged.</p> </li> 
           </ul> 
          </div> 
          <div class="paragraph"> 
           <p>Each pop-up has a different background colour indicating its severity.</p> 
          </div> 
          <div class="paragraph"> 
           <p>None of these messages/errors has any influence on the transaction; any changes to objects will be committed.</p> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_aborting_transactions">4.4.2. Aborting transactions</h4> 
          <div class="paragraph"> 
           <p>If you want to abort Apache Isis' transaction, this can be done by throwing an exception. The exception message is displayed to the user on the error page (if <a href="../ugvw/ugvw.html">Wicket viewer</a>) or a 500 status error code (if the <a href="../ugvro/ugvro.html">Restful Objects</a> viewer).</p> 
          </div> 
          <div class="paragraph"> 
           <p>If the exception thrown is because of an unexpected error (eg a <code>NullPointerException</code> in the domain app itself), then the error page will include a stack trace. If however you want to indicate that the exception is in some sense "expected", then throw a <code>RecoverableException</code> (or any subclass, eg <code>ApplicationException</code>); the stack trace will then be suppressed from the error page.</p> 
          </div> 
          <div class="paragraph"> 
           <p>Another way in which exceptions might be considered "expected" could be as the result of attempting to persist an object which then violates some type of database constraint. Even if the domain application checks beforehand, it could be that another user operating on the object at the same moment of time might result in the conflict.</p> 
          </div> 
          <div class="paragraph"> 
           <p>To handle this the <a href="../rgsvc/rgsvc.html#_rgsvc_presentation-layer-spi_ExceptionRecognizer"><code>ExceptionRecognizer</code></a> SPI can be used. The framework provides a number of implementations out-of-the-box; whenever an exception is thrown it is passed to each known recognizer implementation to see if it recognizes the exception and can return a user-meaningful error message. For example, <code>ExceptionRecognizerForSQLIntegrityConstraintViolationUniqueOrIndexException</code> checks if the exception inherits from <code>java.sql.SQLIntegrityConstraintViolationException</code>, and if so, constructs a suitable message.</p> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_persisted-title">4.5. Persisted Title</h3>
         <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
          <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_persisted-title.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
          <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
          <ul class="dropdown-menu">
           <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_persisted-title.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
           <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_persisted-title.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
           <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_persisted-title.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
           <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_persisted-title.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
          </ul>
         </div> 
         <div class="paragraph"> 
          <p>Normally the title of an object is not persisted to the database, rather it is recomputed automatically from underlying properties. On occasion though you might want the title to also be persisted; either to make things easier for the DBA, or for an integration scenario, or some other purpose.</p> 
         </div> 
         <div class="paragraph"> 
          <p>We can implement this feature by leveraging the <a href="../rgcms/rgcms.html#_rgcms_methods_lifecycle_jdo-api">JDO lifecycle</a>. In the design we discuss here we make it a responsibility of the entities to persist the title as a property, by implementing a <code>ObjectWithPersistedTitle</code> interface:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">ObjectWithPersistedTitle</span> {
    <span class="annotation">@PropertyLayout</span>(hidden = Where.EVERYWHERE)  <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="predefined-type">String</span> getTitle();
    <span class="type">void</span> setTitle(<span class="directive">final</span> <span class="predefined-type">String</span> title);
}</code></pre> 
          </div> 
         </div> 
         <div class="colist arabic"> 
          <table> 
           <tbody>
            <tr> 
             <td><i class="conum" data-value="1"></i><b>1</b></td> 
             <td>we don’t want to expose this in the UI because the title is already prominently displayed.</td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>We can then define a subscribing domain service that leverage this.</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@DomainService</span>(nature = NatureOfService.DOMAIN)
<span class="directive">public</span> <span class="type">class</span> <span class="class">TitlingService</span> <span class="directive">extends</span> AbstractSubscriber {
    <span class="annotation">@Subscribe</span>
    <span class="directive">public</span> <span class="type">void</span> on(<span class="directive">final</span> ObjectPersistingEvent ev) {
        handle(ev.getSource());
    }
    <span class="annotation">@Subscribe</span>
    <span class="directive">public</span> <span class="type">void</span> on(<span class="directive">final</span> ObjectUpdatingEvent ev) {
        handle(ev.getSource());
    }
    <span class="directive">private</span> <span class="type">void</span> handle(<span class="directive">final</span> <span class="predefined-type">Object</span> persistentInstance) {
        <span class="keyword">if</span>(persistentInstance <span class="keyword">instanceof</span> ObjectWithPersistedTitle) {
            <span class="directive">final</span> ObjectWithPersistedTitle objectWithPersistedTitle =
                (ObjectWithPersistedTitle) persistentInstance;
            objectWithPersistedTitle.setTitle(container.titleOf(objectWithPersistedTitle));
        }
    }
    <span class="annotation">@Inject</span>
    <span class="directive">private</span> DomainObjectContainer container;
}</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>It is also possible to accomplish this by accessing the JDO API directly:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@RequestScoped</span>
<span class="annotation">@DomainService</span>(nature = NatureOfService.DOMAIN)
<span class="directive">public</span> <span class="type">class</span> <span class="class">TitlingService</span> {
    <span class="annotation">@PostConstruct</span>
    <span class="directive">public</span> <span class="type">void</span> init() {
        isisJdoSupport.getJdoPersistenceManager().addInstanceLifecycleListener(
            <span class="keyword">new</span> StoreLifecycleListener() {
                <span class="annotation">@Override</span>
                <span class="directive">public</span> <span class="type">void</span> preStore(<span class="directive">final</span> InstanceLifecycleEvent event) {
                    <span class="directive">final</span> <span class="predefined-type">Object</span> persistentInstance = event.getPersistentInstance();
                    <span class="keyword">if</span>(persistentInstance <span class="keyword">instanceof</span> ObjectWithPersistedTitle) {
                        <span class="directive">final</span> ObjectWithPersistedTitle objectWithPersistedTitle =
                            (ObjectWithPersistedTitle) persistentInstance;
                        objectWithPersistedTitle.setTitle(container.titleOf(objectWithPersistedTitle));
                    }
                }
                <span class="annotation">@Override</span>
                <span class="directive">public</span> <span class="type">void</span> postStore(<span class="directive">final</span> InstanceLifecycleEvent event) {
                }
            }, <span class="predefined-constant">null</span>);
    }
    <span class="annotation">@Inject</span>
    <span class="directive">private</span> IsisJdoSupport isisJdoSupport;
    <span class="annotation">@Inject</span>
    <span class="directive">private</span> DomainObjectContainer container;
}</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>The above is probably the easiest and most straightforward design. One could imagine other designs where the persisted title is stored elsewhere. It could even be stored off into an <a href="http://lucene.apache.org/">Apache Lucene</a> (or similar) database to allow for free-text searches.</p> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_view-model-instantiation">4.6. View Model Instantiation</h3>
         <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
          <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_view-model-instantiation.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
          <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
          <ul class="dropdown-menu">
           <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_view-model-instantiation.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
           <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_view-model-instantiation.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
           <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_view-model-instantiation.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
           <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_view-model-instantiation.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
          </ul>
         </div> 
         <div class="paragraph"> 
          <p>Vith view models, some care must be taken in how they are instantiated. Specifically, it’s important that the framework doesn’t "know" about the view model until its state is "sufficiently" populated to distinguish from other view models.</p> 
         </div> 
         <div class="paragraph"> 
          <p>In practical terms, this means that view models should be instantiated using a constructor, and then injecting services (if required) using the <a href="../rgsvc/rgsvc.html#_rgsvc_metadata-api_ServiceRegistry"><code>ServiceRegistry</code></a> service:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java">CustomerViewModel viewModel = <span class="keyword">new</span> CustomerViewModel(<span class="string"><span class="delimiter">"</span><span class="content">Joe</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Bloggs</span><span class="delimiter">"</span></span>);
serviceRegistry.injectServicesInto(viewModel);</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>What will most likely <strong>fail</strong> is to use the <a href="../rgsvc/rgsvc.html#_rgsvc_core-domain-api_FactoryService"><code>FactoryService</code></a>:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// DON'T DO THIS WITH VIEW MODELS</span>
CustomerViewModel viewModel = factoryService.instantiate(CustomerViewModel.class);

viewModel.setFirstName(<span class="string"><span class="delimiter">"</span><span class="content">Joe</span><span class="delimiter">"</span></span>);
viewModel.setLastName(<span class="string"><span class="delimiter">"</span><span class="content">Bloggs</span><span class="delimiter">"</span></span>);
serviceRegistry.injectServicesInto(viewModel);</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>That’s because the internal "OID" identifier that the framework creates to handle this view model will be incomplete. Although the framework can handle changes to the OID (when the corresponding view model’s state changes) once created, this isn’t the case during initial instantiation process.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="_example">4.6.1. Example</h4> 
          <div class="paragraph"> 
           <p>To explain further, here’s an implementation using <code>FactoryService</code> that fails:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@XmlRootElement</span>(name = <span class="string"><span class="delimiter">"</span><span class="content">yearSummary</span><span class="delimiter">"</span></span>)
<span class="annotation">@XmlType</span>( propOrder = { ... } )
<span class="annotation">@XmlAccessorType</span>(XmlAccessType.FIELD)
<span class="directive">public</span> <span class="type">class</span> <span class="class">YearSummary</span> {                                                  <i class="conum" data-value="1"></i><b>(1)</b>
    ...
    <span class="annotation">@XmlTransient</span>
    <span class="annotation">@CollectionLayout</span>(defaultView = <span class="string"><span class="delimiter">"</span><span class="content">table</span><span class="delimiter">"</span></span>)
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;OfficeOptionViewModel&gt; getAmountsPerOffice() {
        <span class="predefined-type">List</span>&lt;OfficeOptionViewModel&gt; amountsPerOffice = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;();

        OfficeOptionViewModel office1 =                                     <i class="conum" data-value="2"></i><b>(2)</b>
            factoryService.instantiate(OfficeOptionViewModel.class);
        office1.setOffice(<span class="string"><span class="delimiter">"</span><span class="content">Amsterdam</span><span class="delimiter">"</span></span>);                                     <i class="conum" data-value="3"></i><b>(3)</b>
        office1.setAmount(<span class="integer">200</span>);
        amountsPerOffice.add(office1);

        OfficeOptionViewModel office2 =                                     <i class="conum" data-value="2"></i><b>(2)</b>
            factoryService.instantiate(OfficeOptionViewModel.class);
        office2.setOffice(<span class="string"><span class="delimiter">"</span><span class="content">London</span><span class="delimiter">"</span></span>);                                        <i class="conum" data-value="3"></i><b>(3)</b>
        office2.setAmount(<span class="integer">100</span>);
        amountsPerOffice.add(office2);

        <span class="keyword">return</span> amountsPerOffice;
    }
}</code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>Parent view model</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="2"></i><b>2</b></td> 
              <td>Using <code>FactoryService</code>, incorrectly.</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="3"></i><b>3</b></td> 
              <td>Hard-coded just for demo purposes</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
          <div class="paragraph"> 
           <p>This collection, is, confusing, rendered as:</p> 
          </div> 
          <div class="imageblock"> 
           <div class="content"> 
            <a class="image" href="images/hints-and-tips/view-model-fail.png"><img src="images/hints-and-tips/view-model-fail.png" alt="view model fail" width="800px"></a> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>Even though the <code>amountsPerOffice</code> collection of view models is correctly populated, the framework/viewer maps these to their corresponding OIDs before they are rendered. Because the "Amsterdam" pojo and "London" pojo each mapped to the same OID, when fetching out the results the viewer obtains the London pojo both times.</p> 
          </div> 
          <div class="paragraph"> 
           <p>The following implementation, on the other hand, succeeds:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@XmlRootElement</span>(name = <span class="string"><span class="delimiter">"</span><span class="content">yearSummary</span><span class="delimiter">"</span></span>)
<span class="annotation">@XmlType</span>( propOrder = { ... } )
<span class="annotation">@XmlAccessorType</span>(XmlAccessType.FIELD)
<span class="directive">public</span> <span class="type">class</span> <span class="class">YearSummary</span> {
    ...
    <span class="annotation">@XmlTransient</span>
    <span class="annotation">@CollectionLayout</span>(defaultView = <span class="string"><span class="delimiter">"</span><span class="content">table</span><span class="delimiter">"</span></span>)
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;OfficeOptionViewModel&gt; getAmountsPerOffice() {
        <span class="predefined-type">List</span>&lt;OfficeOptionViewModel&gt; amountsPerOffice = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;();

                OfficeOptionViewModel office1 = <span class="keyword">new</span> OfficeOptionViewModel(<span class="string"><span class="delimiter">"</span><span class="content">Amsterdam</span><span class="delimiter">"</span></span>, <span class="integer">200</span>);    <i class="conum" data-value="1"></i><b>(1)</b>
                serviceRegistry.injectServicesInto(office1);
                amountsPerOffice.add(office1);

                OfficeOptionViewModel office2 = <span class="keyword">new</span> OfficeOptionViewModel(<span class="string"><span class="delimiter">"</span><span class="content">London</span><span class="delimiter">"</span></span>, <span class="integer">100</span>);       <i class="conum" data-value="1"></i><b>(1)</b>
                serviceRegistry.injectServicesInto(office2);
                amountsPerOffice.add(office2);

        <span class="keyword">return</span> amountsPerOffice;
    }
}</code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>Just instantiate with constructor. The framework "sees" the domain object when services are injected into it.</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
          <div class="paragraph"> 
           <p>As can be seen, this renders just fine:</p> 
          </div> 
          <div class="imageblock"> 
           <div class="content"> 
            <a class="image" href="images/hints-and-tips/view-model-success.png"><img src="images/hints-and-tips/view-model-success.png" alt="view model success" width="800px"></a> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>To complicate matters a little, note though that following "incorrect" implementation using <code>FactoryService</code> does also work correctly:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@XmlRootElement</span>(name = <span class="string"><span class="delimiter">"</span><span class="content">yearSummary</span><span class="delimiter">"</span></span>)
<span class="annotation">@XmlType</span>( propOrder = { ..., <span class="string"><span class="delimiter">"</span><span class="content">amountsPerOffice</span><span class="delimiter">"</span></span> } )                     <i class="conum" data-value="1"></i><b>(1)</b>
<span class="annotation">@XmlAccessorType</span>(XmlAccessType.FIELD)
<span class="directive">public</span> <span class="type">class</span> <span class="class">YearSummary</span> {
        ...

    void init() {
        amountsPerOffice = calculateAmountsPerOffice();
    }

    <span class="annotation">@XmlElementWrapper</span>
    <span class="annotation">@XmlElement</span>(name = <span class="string"><span class="delimiter">"</span><span class="content">officeOption</span><span class="delimiter">"</span></span>)
    <span class="annotation">@CollectionLayout</span>(defaultView = <span class="string"><span class="delimiter">"</span><span class="content">table</span><span class="delimiter">"</span></span>)
    <span class="annotation">@Getter</span> <span class="annotation">@Setter</span>
    <span class="directive">private</span> <span class="predefined-type">List</span>&lt;OfficeOptionViewModel&gt; amountsPerOffice = Lists.newArrayList();

        <span class="annotation">@XmlTransient</span>
    <span class="annotation">@CollectionLayout</span>(defaultView = <span class="string"><span class="delimiter">"</span><span class="content">table</span><span class="delimiter">"</span></span>)
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;OfficeOptionViewModel&gt; calculateAmountsPerOffice() {
        <span class="predefined-type">List</span>&lt;OfficeOptionViewModel&gt; amountsPerOffice = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;();

                OfficeOptionViewModel office1 = factoryService.instantiate(OfficeOptionViewModel.class);
                office1.setOffice(<span class="string"><span class="delimiter">"</span><span class="content">Amsterdam</span><span class="delimiter">"</span></span>);
                office1.setAmount(<span class="integer">200</span>);

                amountsPerOffice.add(office1);

                OfficeOptionViewModel office2 = factoryService.instantiate(OfficeOptionViewModel.class);
                office2.setOffice(<span class="string"><span class="delimiter">"</span><span class="content">London</span><span class="delimiter">"</span></span>);
                office2.setAmount(<span class="integer">100</span>);

                amountsPerOffice.add(office2);

        <span class="keyword">return</span> amountsPerOffice;
    }
}</code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>"amountsPerOffice" is part of the state of the parent view model</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
          <div class="paragraph"> 
           <p>In this case the <code>amountsPerOffice</code> collection is part of the state of the parent view model and so in this particular case everything works with either <code>FactoryService#instantiate</code> or using <code>ServiceRegistry</code>.</p> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_simulating-collections-of-values">4.7. Collections of values</h3>
         <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
          <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_simulating-collections-of-values.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
          <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
          <ul class="dropdown-menu">
           <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_simulating-collections-of-values.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
           <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_simulating-collections-of-values.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
           <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_simulating-collections-of-values.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
           <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_simulating-collections-of-values.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
          </ul>
         </div> 
         <div class="paragraph"> 
          <p>Although in Apache Isis you can have properties of either values (string, number, date etc) or of (references to other) entities, with collections the framework (currently) only supports collections of (references to) entities. That is, collections of values (a bag of numbers, say) are not supported.</p> 
         </div> 
         <div class="paragraph"> 
          <p>However, it is possible to simulate a bag of numbers using view models.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="_view_model">4.7.1. View Model</h4> 
          <div class="admonitionblock note"> 
           <table> 
            <tbody>
             <tr> 
              <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
              <td class="content"> FIXME </td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_persistence_concerns">4.7.2. Persistence Concerns</h4> 
          <div class="admonitionblock note"> 
           <table> 
            <tbody>
             <tr> 
              <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
              <td class="content"> FIXME - easiest to simply store using DataNucleus' support for collections, marked as <a href="../rgant/rgant.html#_rgant-Programmatic"><code>@Programmatic</code></a> so that it is ignored by Apache Isis. Alternatively can store as json/xml in a varchar(4000) or clob and manually unpack. </td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_how-to-handle-void-and-null-results">4.8. How to handle void/null results</h3>
         <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
          <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_how-to-handle-void-and-null-results.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
          <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
          <ul class="dropdown-menu">
           <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_how-to-handle-void-and-null-results.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
           <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_how-to-handle-void-and-null-results.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
           <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_how-to-handle-void-and-null-results.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
           <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_how-to-handle-void-and-null-results.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
          </ul>
         </div> 
         <div class="paragraph"> 
          <p>From this <a href="http://isis.markmail.org/thread/yf7qdeiu3vrvk2ei">thread</a> on the Apache Isis users mailing list:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p><em>When using a <code>void</code> action, let’s say a remove action, the user is redirected to a page "no results". When clicking the back button in the browser the user sees "Object not found" (since you’ve just deleted this object).</em></p> </li> 
           <li> <p><em>You can return a list for example to prevent the user from being redirect to a "No results" page, but I think it’s not the responsibility of the controllers in the domain model.</em></p> </li> 
           <li> <p><em>A solution could be that wicket viewer goes back one page when encountering a deleted object. And refresh the current page when receiving a null response or invoking a void action. But how to implement this?</em></p> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>One way to implement this idea is to provide a custom implementation of the <a href="../rgsvc/rgsvc.html#_rgsvc_presentation-layer-spi_RoutingService"><code>RoutingService</code></a> SPI domain service. The default implementation will either return the current object (if not null), else the home page (as defined by <a href="../rgant/rgant.html#_rgant-HomePage"><code>@HomePage</code></a>) if one exists.</p> 
         </div> 
         <div class="paragraph"> 
          <p>The following custom implementation refines this to use the breadcrumbs (available in the Wicket viewer) to return the first non-deleted domain object found in the list of breadcrumbs:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@DomainService</span>(nature = NatureOfService.DOMAIN)
<span class="annotation">@DomainServiceLayout</span>(menuOrder = <span class="string"><span class="delimiter">"</span><span class="content">1</span><span class="delimiter">"</span></span>)                                           <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">RoutingServiceUsingBreadcrumbs</span> <span class="directive">extends</span> RoutingServiceDefault {
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">Object</span> route(<span class="directive">final</span> <span class="predefined-type">Object</span> original) {
        <span class="keyword">if</span>(original != <span class="predefined-constant">null</span>) {                                                  <i class="conum" data-value="2"></i><b>(2)</b>
            <span class="keyword">return</span> original;
        }
        container.flush();                                                      <i class="conum" data-value="3"></i><b>(3)</b>

        <span class="directive">final</span> BreadcrumbModelProvider wicketSession =                           <i class="conum" data-value="4"></i><b>(4)</b>
            (BreadcrumbModelProvider) AuthenticatedWebSession.get();
        <span class="directive">final</span> BreadcrumbModel breadcrumbModel =
            wicketSession.getBreadcrumbModel();
        <span class="directive">final</span> <span class="predefined-type">List</span>&lt;EntityModel&gt; breadcrumbs = breadcrumbModel.getList();

        <span class="directive">final</span> Optional&lt;<span class="predefined-type">Object</span>&gt; firstViewModelOrNonDeletedPojoIfAny =
                breadcrumbs.stream()                                            <i class="conum" data-value="5"></i><b>(5)</b>
                .filter(entityModel -&gt; entityModel != <span class="predefined-constant">null</span>)
                .map(EntityModel::getObject)                                    <i class="conum" data-value="6"></i><b>(6)</b>
                .filter(objectAdapter -&gt; objectAdapter != <span class="predefined-constant">null</span>)
                .map(ObjectAdapter::getObject)                                  <i class="conum" data-value="7"></i><b>(7)</b>
                .filter(pojo -&gt; !(pojo <span class="keyword">instanceof</span> Persistable) ||
                                !((Persistable)pojo).dnIsDeleted())             <i class="conum" data-value="8"></i><b>(8)</b>
                .findFirst();

        <span class="keyword">return</span> firstViewModelOrNonDeletedPojoIfAny.orElse(homePage());          <i class="conum" data-value="9"></i><b>(9)</b>
    }
    <span class="directive">private</span> <span class="predefined-type">Object</span> homePage() {
        <span class="keyword">return</span> homePageProviderService.homePage();
    }
    <span class="annotation">@Inject</span>
    HomePageProviderService homePageProviderService;
    <span class="annotation">@Inject</span>
    DomainObjectContainer container;
}</code></pre> 
          </div> 
         </div> 
         <div class="colist arabic"> 
          <table> 
           <tbody>
            <tr> 
             <td><i class="conum" data-value="1"></i><b>1</b></td> 
             <td>override the default imlpementation</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="2"></i><b>2</b></td> 
             <td>if a non-null object was returned, then return this</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="3"></i><b>3</b></td> 
             <td>ensure that any persisted objects have been deleted.</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="4"></i><b>4</b></td> 
             <td>reach inside the Wicket viewer’s internals to obtain the list of breadcrumbs.</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="5"></i><b>5</b></td> 
             <td>loop over all breadcrumbs</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="6"></i><b>6</b></td> 
             <td>unwrap the Wicket viewer’s serializable representation of each domain object (<code>EntityModel</code>) to the Isis runtime’s representation (<code>ObjectAdapter</code>)</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="7"></i><b>7</b></td> 
             <td>unwrap the Isis runtime’s representation of each domain object (<code>ObjectAdapter</code>) to the domain object pojo itself</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="8"></i><b>8</b></td> 
             <td>if object is persistable (not a view model) then make sure it is not deleted</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="9"></i><b>9</b></td> 
             <td>return the first object if any, otherwise the home page object (if any).</td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>Note that the above implementation uses Java 8, so if you are using Java 7 then you’ll need to backport accordingly.</p> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_multi-tenancy">4.9. Multi-tenancy</h3>
         <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
          <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_multi-tenancy.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
          <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
          <ul class="dropdown-menu">
           <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_multi-tenancy.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
           <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_multi-tenancy.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
           <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_multi-tenancy.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
           <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_multi-tenancy.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
          </ul>
         </div> 
         <div class="paragraph"> 
          <p>Of the various modules provided by the (non-ASF) <a href="http://platform.incode.org" target="_blank">Incode Platform</a>, the security module has the most features. One significant feature is the ability to associate users and objects with a "tenancy".</p> 
         </div> 
         <div class="paragraph"> 
          <p>For more details, see the <a href="http://platform.incode.org" target="_blank">Incode Platform</a>'s security module README.</p> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_subclass-properties-in-tables">4.10. Subclass properties in tables</h3>
         <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
          <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_subclass-properties-in-tables.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
          <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
          <ul class="dropdown-menu">
           <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_subclass-properties-in-tables.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
           <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_subclass-properties-in-tables.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
           <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_subclass-properties-in-tables.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
           <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_subclass-properties-in-tables.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
          </ul>
         </div> 
         <div class="paragraph"> 
          <p>Suppose you have a hierarchy of classes where a property is derived and abstract in the superclass, concrete implementations in the subclasses. For example:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">abstract</span> <span class="type">class</span> <span class="class">LeaseTerm</span> {
    <span class="directive">public</span> <span class="directive">abstract</span> <span class="predefined-type">BigDecimal</span> getEffectiveValue();
    ...
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">LeaseTermForIndexableTerm</span> <span class="directive">extends</span> LeaseTerm {
    <span class="directive">public</span> <span class="predefined-type">BigDecimal</span> getEffectveValue() { ... }
    ...
}</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>Currently the Wicket viewer will not render the property in tables (though the property is correctly rendered in views).</p> 
         </div> 
         <div class="admonitionblock note"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
             <td class="content"> 
              <div class="paragraph"> 
               <p>For more background on this workaround, see <a href="https://issues.apache.org/jira/browse/ISIS-582">ISIS-582</a>.</p> 
              </div> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>The work-around is simple enough; make the method concrete in the superclass and return a dummy implementation, eg:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">abstract</span> <span class="type">class</span> <span class="class">LeaseTerm</span> {
    <span class="directive">public</span> <span class="predefined-type">BigDecimal</span> getEffectiveValue() {
        <span class="keyword">return</span> <span class="predefined-constant">null</span>;        <span class="comment">// workaround for ISIS-582</span>
    }
    ...
}</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>Alternatively the implementation could throw a <code>RuntimeException</code>, eg</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">RuntimeException</span>(<span class="string"><span class="delimiter">"</span><span class="content">never called; workaround for ISIS-582</span><span class="delimiter">"</span></span>);</code></pre> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_pushing-changes">4.11. Pushing Changes (deprecated)</h3>
         <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
          <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_pushing-changes.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
          <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
          <ul class="dropdown-menu">
           <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_pushing-changes.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
           <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_pushing-changes.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
           <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_pushing-changes.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
           <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_pushing-changes.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
          </ul>
         </div> 
         <div class="admonitionblock note"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
             <td class="content"> 
              <div class="paragraph"> 
               <p>This technique is much less powerful than using ../ugfun/ugfun.adoc#_ugfun_building-blocks_events_domain-events[the event bus] or an SPI service. We present it mostly for completeness.</p> 
              </div> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="sect3"> 
          <h4 id="_when_a_property_is_changed">4.11.1. When a property is changed</h4> 
          <div class="paragraph"> 
           <p>If you want to invoke functionality whenever a property is changed by the user, then you can create a supporting <code>modifyXxx()</code> method and include the functionality within that. The syntax is:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> modifyPropertyName(PropertyType param) { ... }</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>Why not just put this functionality in the setter? Well, the setter is used by the object store to recreate the state of an already persisted object. Putting additional behaviour in the setter would cause it to be triggered incorrectly.</p> 
          </div> 
          <div class="paragraph"> 
           <p>For example:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Order</span>() {
    <span class="directive">public</span> <span class="predefined-type">Integer</span> getAmount() { ... }
    <span class="directive">public</span> <span class="type">void</span> setAmount(<span class="predefined-type">Integer</span> amount) { ... }
    <span class="directive">public</span> <span class="type">void</span> modifyAmount(<span class="predefined-type">Integer</span> amount) { <i class="conum" data-value="1"></i><b>(1)</b>
        setAmount(amount);  <i class="conum" data-value="3"></i><b>(3)</b>
        addToTotal(amount); <i class="conum" data-value="2"></i><b>(2)</b>
    }
    ...
}</code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>The <code>modifyAmount()</code> method calls …​</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="2"></i><b>2</b></td> 
              <td>…​ the <code>addToTotal()</code> (not shown) to maintain some running total.</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
          <div class="paragraph"> 
           <p>We don’t want this <code>addToCall()</code> method to be called when pulling the object back from the object store, so we put it into the modify, not the setter.</p> 
          </div> 
          <div class="paragraph"> 
           <p>You may optionally also specify a <code>clearXxx()</code> which works the same way as modify <code>modify Xxx()</code> but is called when the property is cleared by the user (i.e. the current value replaced by nothing). The syntax is:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> clearPropertyName() { ... }</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>To extend the above example:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Order</span>() {
    <span class="directive">public</span> <span class="predefined-type">Integer</span> getAmount() { ... }
    <span class="directive">public</span> <span class="type">void</span> setAmount(<span class="predefined-type">Integer</span> amount) { ... }
    <span class="directive">public</span> <span class="type">void</span> modifyAmount(<span class="predefined-type">Integer</span> amount) { ... }
    <span class="directive">public</span> <span class="type">void</span> clearAmount() {
        removeFromTotal(<span class="local-variable">this</span>.amount);
        setAmount(<span class="predefined-constant">null</span>);
    }
    ...
}</code></pre> 
           </div> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_when_a_collection_is_modified">4.11.2. When a collection is modified</h4> 
          <div class="paragraph"> 
           <p>A collection may have a corresponding <code>addToXxx()</code> and/or <code>removeFromXxx()</code> method. If present, and direct manipulation of the contents of the connection has not been disabled (see ?), then they will be called (instead of adding/removing an object directly to the collection returned by the accessor).</p> 
          </div> 
          <div class="paragraph"> 
           <p>The reason for this behaviour is to allow other behaviour to be triggered when the contents of the collection is altered. That is, it is directly equivalent to the supporting <code>modifyXxx()</code> and <code>clearXxx()</code> methods for properties (see ?).</p> 
          </div> 
          <div class="paragraph"> 
           <p>The syntax is:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> addTo&lt;CollectionName&gt;(EntityType param) { ... }</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>and</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> removeFromCollectionName(EntityType param) { ... }</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>where <code>EntityType</code> is the same type as the generic collection type.</p> 
          </div> 
          <div class="paragraph"> 
           <p>For example:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> { ... }

<span class="directive">public</span> <span class="type">class</span> <span class="class">Department</span> {

    <span class="directive">private</span> <span class="type">int</span> numMaleEmployees;                           <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="directive">private</span> <span class="type">int</span> numFemaleEmployees;                         <i class="conum" data-value="2"></i><b>(2)</b>

    <span class="directive">private</span> <span class="predefined-type">Set</span>&lt;Employee&gt; employees = <span class="keyword">new</span> <span class="predefined-type">TreeSet</span>&lt;Employee&gt;();
    <span class="directive">public</span> <span class="predefined-type">Set</span>&lt;Employee&gt; getEmployees() {
        <span class="keyword">return</span> employees;
    }
    <span class="directive">private</span> <span class="type">void</span> setEmployees(<span class="predefined-type">Set</span>&lt;Employee&gt; employees) {
        <span class="local-variable">this</span>.employees = employees;
    }
    <span class="directive">public</span> <span class="type">void</span> addToEmployees(Employee employee) {         <i class="conum" data-value="3"></i><b>(3)</b>
        numMaleEmployees += countOneMale(employee);
        numFemaleEmployees += countOneFemale(employee);
        employees.add(employee);
    }
    <span class="directive">public</span> <span class="type">void</span> removeFromEmployees(Employee employee) {    <i class="conum" data-value="4"></i><b>(4)</b>
        numMaleEmployees -= countOneMale(employee);
        numFemaleEmployees -= countOneFemale(employee);
        employees.remove(employee);
    }
    <span class="directive">private</span> <span class="type">int</span> countOneMale(Employee employee) { <span class="keyword">return</span> employee.isMale()?<span class="integer">1</span>:<span class="integer">0</span>; }
    <span class="directive">private</span> <span class="type">int</span> countOneFemale(Employee employee) { <span class="keyword">return</span> employee.isFemale()?<span class="integer">1</span>:<span class="integer">0</span>; }

    ...
}</code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>maintain a count of the number of male …​</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="2"></i><b>2</b></td> 
              <td>…​ and female employees (getters and setters omitted)</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="3"></i><b>3</b></td> 
              <td>the <a href="../rgcms/rgcms.html#_rgcms_methods_prefixes_addTo"><code>addTo…​()</code></a> method increments the derived properties</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="4"></i><b>4</b></td> 
              <td>the <a href="../rgcms/rgcms.html#_rgcms_methods_prefixes_removeFrom"><code>removeFrom…​()</code></a> method similarly decrements the derived properties</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_how-to-implement-a-spellchecker">4.12. How to implement a spellchecker?</h3>
         <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
          <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_how-to-implement-a-spellchecker.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
          <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
          <ul class="dropdown-menu">
           <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_how-to-implement-a-spellchecker.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
           <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_how-to-implement-a-spellchecker.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
           <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_how-to-implement-a-spellchecker.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
           <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_hints-and-tips_how-to-implement-a-spellchecker.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
          </ul>
         </div> 
         <div class="paragraph"> 
          <p>From this <a href="http://isis.markmail.org/thread/dduarjscrbnodfsi">thread</a> on the Apache Isis users mailing list:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p><em>What is the easiest way to add a spell checker to the text written in a field in a domain object, for instance to check English syntax?</em></p> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>One way to implement is to use the <a href="../rgsvc/rgsvc.html#_rgsvc_core-domain-api_EventBusService">event bus</a>:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p>Set up a <a href="../rgcms/rgcms.html#_rgcms_classes_domainevent">domain event</a> <a href="../rgcms/rgcms.html#_rgcms_classes_super_AbstractSubscriber">subscriber</a> that can veto the changes.</p> </li> 
           <li> <p>if the change is made through an action, you can use <a href="../rgant/rgant.html#_rgant-Action_domainEvent"><code>@Action#domainEvent()</code></a>.</p> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>if if the change is made through an edit, you can use <a href="../rgant/rgant.html#_rgant-Property_domainEvent"><code>@Property#domainEvent()</code></a>.</p> 
         </div> 
         <div class="paragraph"> 
          <p>You’ll need some way to know which fields should be spell checked. Two ways spring to mind:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p>either look at the domain event’s identifier</p> </li> 
           <li> <p>or subclass the domain event (recommended anyway) and have those subclass events implement some sort of marker interface, eg a <code>SpellCheckEvent</code>.</p> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>And you’ll (obviously) also need some sort of spell checker implementation to call.</p> 
         </div> 
        </div> 
       </div> 
      </div> 
      <div class="sect1"> 
       <h2 id="_ugbtb_programming-model">5. Customizing the Prog Model</h2>
       <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
        <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_programming-model.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
        <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
        <ul class="dropdown-menu">
         <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_programming-model.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
         <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_programming-model.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
         <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_programming-model.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
         <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_programming-model.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
        </ul>
       </div> 
       <div class="sectionbody"> 
        <div class="paragraph"> 
         <p>This chapter explains the main APIs to extend or alter the programming conventions that Apache Isis understands to build up its metamodel.</p> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_programming-model_custom-validator">5.1. Custom validator</h3>
         <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
          <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_programming-model_custom-validator.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
          <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
          <ul class="dropdown-menu">
           <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_programming-model_custom-validator.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
           <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_programming-model_custom-validator.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
           <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_programming-model_custom-validator.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
           <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_programming-model_custom-validator.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
          </ul>
         </div> 
         <div class="paragraph"> 
          <p>Apache Isis' programming model includes a validator component that detects and prevents (by failing fast) a number of situations where the domain model is logically inconsistent.</p> 
         </div> 
         <div class="paragraph"> 
          <p>For example, the validator will detect any orphaned supporting methods (eg <code>hideXxx()</code>) if the corresponding property or action has been renamed or deleted but the supporting method was not also updated. Another example is that a class cannot have a title specified both using <code>title()</code> method and also using <code>@Title</code> annotation.</p> 
         </div> 
         <div class="admonitionblock note"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
             <td class="content"> 
              <div class="paragraph"> 
               <p>The support for <a href="../rgant/rgant.html#_rgant-aaa_deprecated">disallowing deprecated annotations</a> is also implemented using the metamodel validator.</p> 
              </div> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>You can also impose your own application-specific rules by installing your own metamodel validator. To give just one example, you could impose naming standards such as ensuring that a domain-specific abbreviation such as "ISBN" is always consistently capitalized wherever it appears in a class member.</p> 
         </div> 
         <div class="admonitionblock tip"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> 
             <td class="content"> 
              <div class="paragraph"> 
               <p>Isis' <a href="../rgmvn/rgmvn.html">Maven plugin</a> will also validate the domain object model during build time.</p> 
              </div> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="sect3"> 
          <h4 id="_api_and_implementation">5.1.1. API and Implementation</h4> 
          <div class="paragraph"> 
           <p>There are several ways to go about implementing a validator.</p> 
          </div> 
          <div class="sect4"> 
           <h5 id="__code_metamodelvalidator_code"><code>MetaModelValidator</code></h5> 
           <div class="paragraph"> 
            <p>Any custom validator must implement Apache Isis' internal <code>MetaModelValidator</code> interface, so the simplest option is just to implement <code>MetaModelValidator</code> directly:</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">MetaModelValidator</span>
        <span class="directive">implements</span> SpecificationLoaderSpiAware { <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="directive">public</span> <span class="type">void</span> validate(
        ValidationFailures validationFailures);  <i class="conum" data-value="2"></i><b>(2)</b>
}</code></pre> 
            </div> 
           </div> 
           <div class="colist arabic"> 
            <table> 
             <tbody>
              <tr> 
               <td><i class="conum" data-value="1"></i><b>1</b></td> 
               <td>the <code>SpecificationLoader</code> is the internal API providing access to the Apache Isis metamodel.</td> 
              </tr> 
              <tr> 
               <td><i class="conum" data-value="2"></i><b>2</b></td> 
               <td>add any metamodel violations to the <code>ValidationFailures</code> parameter (the <a href="http://c2.com/cgi/wiki?CollectingParameter">collecting parameter</a> pattern)</td> 
              </tr> 
             </tbody>
            </table> 
           </div> 
          </div> 
          <div class="sect4"> 
           <h5 id="__code_visitor_code"><code>Visitor</code></h5> 
           <div class="paragraph"> 
            <p>More often than not, you’ll want to visit every element in the metamodel, and so for this you can instead subclass from <code>MetaModelValidatorVisiting.Visitor</code>:</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">final</span> <span class="type">class</span> <span class="class">MetaModelValidatorVisiting</span> ... {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">interface</span> <span class="class">Visitor</span> {
        <span class="directive">public</span> <span class="type">boolean</span> visit(                       <i class="conum" data-value="1"></i><b>(1)</b>
            ObjectSpecification objectSpec,         <i class="conum" data-value="2"></i><b>(2)</b>
            ValidationFailures validationFailures); <i class="conum" data-value="3"></i><b>(3)</b>
    }
    ...
}</code></pre> 
            </div> 
           </div> 
           <div class="colist arabic"> 
            <table> 
             <tbody>
              <tr> 
               <td><i class="conum" data-value="1"></i><b>1</b></td> 
               <td>return <code>true</code> continue visiting specs.</td> 
              </tr> 
              <tr> 
               <td><i class="conum" data-value="2"></i><b>2</b></td> 
               <td><code>ObjectSpecification</code> is the internal API representing a class</td> 
              </tr> 
              <tr> 
               <td><i class="conum" data-value="3"></i><b>3</b></td> 
               <td>add any metamodel violations to the <code>ValidationFailures</code> parameter</td> 
              </tr> 
             </tbody>
            </table> 
           </div> 
           <div class="paragraph"> 
            <p>You can then create your custom validator by subclassing <code>MetaModelValidatorComposite</code> and adding the visiting validator:</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">MyMetaModelValidator</span> <span class="directive">extends</span> MetaModelValidatorComposite {
    <span class="directive">public</span> MyMetaModelValidator() {
        add(<span class="keyword">new</span> MetaModelValidatorVisiting(<span class="keyword">new</span> MyVisitor()));
    }
}</code></pre> 
            </div> 
           </div> 
           <div class="paragraph"> 
            <p>If you have more than one rule then each can live in its own visitor.</p> 
           </div> 
          </div> 
          <div class="sect4"> 
           <h5 id="__code_summarizingvisitor_code"><code>SummarizingVisitor</code></h5> 
           <div class="paragraph"> 
            <p>As a slight refinement, you can also subclass from <code>MetaModelValidatorVisiting.SummarizingVisitor</code>:</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">final</span> <span class="type">class</span> <span class="class">MetaModelValidatorVisiting</span> ... {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">interface</span> <span class="class">SummarizingVisitor</span> <span class="directive">extends</span> Visitor {
        <span class="directive">public</span> <span class="type">void</span> summarize(ValidationFailures validationFailures);
    }
    ...
}</code></pre> 
            </div> 
           </div> 
           <div class="paragraph"> 
            <p>A <code>SummarizingVisitor</code> will be called once after every element in the metamodel has been visited. This is great for performing checks on the metamodel as a whole. For example, Apache Isis uses this to check that there is at least one <code>@Persistable</code> domain entity defined.</p> 
           </div> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_configuration">5.1.2. Configuration</h4> 
          <div class="paragraph"> 
           <p>Once you have implemented your validator, you must register it with the framework by defining the appropriate configuration property:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="ini">isis.reflector.validator=com.mycompany.myapp.MyMetaModelValidator</code></pre> 
           </div> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_programming-model_finetuning">5.2. Finetuning</h3>
         <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
          <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_programming-model_finetuning.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
          <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
          <ul class="dropdown-menu">
           <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_programming-model_finetuning.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
           <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_programming-model_finetuning.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
           <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_programming-model_finetuning.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
           <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_programming-model_finetuning.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
          </ul>
         </div> 
         <div class="paragraph"> 
          <p>The core metamodel defines APIs and implementations for building the Apache Isis metamodel: a description of the set of entities, domain services and values that make up the domain model.</p> 
         </div> 
         <div class="paragraph"> 
          <p>The description of each domain class consists of a number of elements:</p> 
         </div> 
         <div class="dlist"> 
          <dl> 
           <dt class="hdlist1">
            <a href="https://github.com/apache/isis/blob/master/core/metamodel/src/main/java/org/apache/isis/core/metamodel/spec/ObjectSpecification.java">ObjectSpecification</a>
           </dt> 
           <dd> 
            <p>Analogous to <code>java.lang.Class</code>; holds information about the class itself and holds collections of each of the three types of class' members (below);</p> 
           </dd> 
           <dt class="hdlist1">
            <a href="https://github.com/apache/isis/blob/master/core/metamodel/src/main/java/org/apache/isis/core/metamodel/spec/feature/OneToOneAssociation.java">OneToOneAssociation</a>
           </dt> 
           <dd> 
            <p>Represents a class member that is a single-valued property of the class. The property’s type is either a reference to another entity, or is a value type.</p> 
           </dd> 
           <dt class="hdlist1">
            <a href="https://github.com/apache/isis/blob/master/core/metamodel/src/main/java/org/apache/isis/core/metamodel/spec/feature/OneToManyAssociation.java">OneToManyAssociation</a>
           </dt> 
           <dd> 
            <p>Represents a class member that is a collection of references to other entities. Note that Apache Isis does not currently support collections of values.</p> 
           </dd> 
           <dt class="hdlist1">
            <a href="https://github.com/apache/isis/blob/master/core/metamodel/src/main/java/org/apache/isis/core/metamodel/spec/feature/ObjectAction.java">ObjectAction</a>
           </dt> 
           <dd> 
            <p>Represents a class member that is an operation that can be performed on the action. Returns either a single value, a collection of entities, or is <code>void</code>.</p> 
           </dd> 
          </dl> 
         </div> 
         <div class="paragraph"> 
          <p>The metamodel is built up through the <a href="https://github.com/apache/isis/blob/master/core/metamodel/src/main/java/org/apache/isis/core/metamodel/progmodel/ProgrammingModel.java">ProgrammingModel</a>, which defines an API for registering a set of <a href="https://github.com/apache/isis/blob/master/core/metamodel/src/main/java/org/apache/isis/core/metamodel/facets/FacetFactory.java">FacetFactory</a>s. Two special <code>FacetFactory</code> implementations - <a href="https://github.com/apache/isis/blob/master/core/metamodel/src/main/java/org/apache/isis/core/metamodel/facets/properties/accessor/PropertyAccessorFacetViaAccessorFactory.java">PropertyAccessorFacetFactory</a> and <a href="https://github.com/apache/isis/blob/master/core/metamodel/src/main/java/org/apache/isis/core/metamodel/facets/collections/accessor/CollectionAccessorFacetViaAccessorFactory.java">CollectionAccessorFacetFactory</a> - are used to identify the class members. Pretty much all the other <code>FacetFactory</code>s are responsible for installing <a href="https://github.com/apache/isis/blob/master/core/metamodel/src/main/java/org/apache/isis/core/metamodel/facetapi/Facet.java">Facet</a>s onto the metamodel elements.</p> 
         </div> 
         <div class="paragraph"> 
          <p>There are many many such <code>Facet</code>s, and are used to do such things get values from properties or collections, modify properties or collections, invoke action, hide or disable class members, provide UI hints for class members, and so on. In short, the <code>FacetFactory</code>s registered defines the Apache Isis programming conventions.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="_modifying_the_prog_model">5.2.1. Modifying the Prog. Model</h4> 
          <div class="paragraph"> 
           <p>The default implementation of <code>ProgrammingModel</code> is <a href="https://github.com/apache/isis/blob/master/core/metamodel/src/main/java/org/apache/isis/progmodels/dflt/ProgrammingModelFacetsJava5.java">ProgrammingModelFacetsJava5</a>, which registers a large number of <code>FacetFactory</code>s.</p> 
          </div> 
          <div class="paragraph"> 
           <p>By editing <code>isis.properties</code> you can modify the programming conventions either by (a) using the default programming model, but tweaking it to include new `FacetFactory`s or exclude existing, or (b) by specifying a completely different programming model implementation.</p> 
          </div> 
          <div class="paragraph"> 
           <p>Let’s see how this is done.</p> 
          </div> 
          <div class="sect4"> 
           <h5 id="_including_or_excluding_facets">Including or excluding facets</h5> 
           <div class="paragraph"> 
            <p>Suppose that you wanted to completely remove support for the (already deprecated) <code>@ActionOrder</code> annotation. This would be done using:</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay highlight"><code data-lang="ini">isis.reflector.facets.exclude=org.apache.isis.core.metamodel.facets.object.actionorder.annotation.ActionOrderFacetAnnotationFactory</code></pre> 
            </div> 
           </div> 
           <div class="paragraph"> 
            <p>Or, suppose you wanted to use add some custom facet factory of your own, use:</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay highlight"><code data-lang="ini">isis.reflector.facets.include=com.mycompany.isis.facets.MyCoolFacetFactory</code></pre> 
            </div> 
           </div> 
           <div class="paragraph"> 
            <p>To include/exclude more than one <code>FacetFactory</code>, specify as a comma-separated list.</p> 
           </div> 
           <div class="admonitionblock tip"> 
            <table> 
             <tbody>
              <tr> 
               <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> 
               <td class="content"> 
                <div class="paragraph"> 
                 <p>This <a href="http://isis.markmail.org/thread/472c3mrvcgnripst">thread</a> from the users mailing list (in Apr 2014) shows a typical customization (to enable per-instance security) (though note that <a href="../ugbtb/ugbtb.html#_ugbtb_hints-and-tips_multi-tenancy">Multi-Tenancy</a> is now a better solution to that particular use-case.</p> 
                </div> </td> 
              </tr> 
             </tbody>
            </table> 
           </div> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_programming-model_layout-metadata-reader">5.3. Layout Metadata Reader (deprecated)</h3>
         <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
          <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_programming-model_layout-metadata-reader.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
          <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
          <ul class="dropdown-menu">
           <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_programming-model_layout-metadata-reader.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
           <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_programming-model_layout-metadata-reader.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
           <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_programming-model_layout-metadata-reader.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
           <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_programming-model_layout-metadata-reader.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
          </ul>
         </div> 
         <div class="paragraph"> 
          <p>The metadata for domain objects is obtained both <a href="../ugvw/ugvw.html#_ugvw_layout_annotation-based">annotations</a> and <a href="../ugvw/ugvw.html#_ugvw_layout_file-based">files</a>. There is also deprecated support for reading layouts from <code>.layout.json</code> files. This service provides an SPI (and default implementation) for reading layouts defined in this fashion.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="_default_implementation">5.3.1. Default implementation</h4> 
          <div class="paragraph"> 
           <p>The default implementation for reading dynamic layout metadata is <code>org.apache.isis.core.metamodel.layoutmetadata.json.LayoutMetadataReaderFromJson</code>, which is responsible for reading from the <code>Xxx.layout.json</code> files on the classpath (for each domain entity <code>Xxx</code>).</p> 
          </div> 
          <div class="paragraph"> 
           <p>You can also implement your own metadata readers and plug them into Apache Isis. These could read from a different file format, or they could, even, read data dynamically from a URL or database. (Indeed, one could imagine an implementation whereby users could share layouts, all stored in some central repository).</p> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_api_and_implementation_2">5.3.2. API and Implementation</h4> 
          <div class="paragraph"> 
           <p>Any reader must implement Apache Isis' internal <code>LayoutMetadataReader</code> interface:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">LayoutMetadataReader</span> {
    <span class="directive">public</span> <span class="predefined-type">Properties</span> asProperties(<span class="predefined-type">Class</span>&lt;?&gt; domainClass) <span class="directive">throws</span> ReaderException;
}</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>The implementation "simply" returns a set of properties where the property key is a unique identifier to both the class member and also the facet of the class member to which the metadata relates.</p> 
          </div> 
          <div class="paragraph"> 
           <p>See the implementation of the built-in <code>LayoutMetadataReaderFromJson</code> for more detail.</p> 
          </div> 
          <div class="paragraph"> 
           <p>Returning either <code>null</code> or throwing an exception indicates that the reader was unable to load any metadata for the specified class.</p> 
          </div> 
          <div class="sect4"> 
           <h5 id="_extended_api">Extended API</h5> 
           <div class="paragraph"> 
            <p>Optionally the reader can implement the extended <code>LayoutMetadaReader2</code> API:</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">LayoutMetadataReader2</span> <span class="directive">extends</span> LayoutMetadataReader {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">Support</span> {
        <span class="directive">public</span> <span class="directive">static</span> Support entitiesOnly() {
            <span class="keyword">return</span> <span class="keyword">new</span> Support(<span class="predefined-constant">false</span>,<span class="predefined-constant">false</span>,<span class="predefined-constant">false</span>,<span class="predefined-constant">false</span>,<span class="predefined-constant">false</span>,<span class="predefined-constant">false</span>,<span class="predefined-constant">false</span>);
        }
        ...
        public <span class="type">boolean</span> interfaces() { ... } <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="directive">public</span> <span class="type">boolean</span> anonymous() { ... }  <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="directive">public</span> <span class="type">boolean</span> synthetic() { ... }  <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="directive">public</span> <span class="type">boolean</span> array() { ... }      <i class="conum" data-value="4"></i><b>(4)</b>
        <span class="directive">public</span> <span class="type">boolean</span> enums() { ... }      <i class="conum" data-value="5"></i><b>(5)</b>
        <span class="directive">public</span> <span class="type">boolean</span> applibValueTypes() { <i class="conum" data-value="6"></i><b>(6)</b>
        <span class="directive">public</span> <span class="type">boolean</span> services() { ... }   <i class="conum" data-value="7"></i><b>(7)</b>
    }
    Support support();
}</code></pre> 
            </div> 
           </div> 
           <div class="colist arabic"> 
            <table> 
             <tbody>
              <tr> 
               <td><i class="conum" data-value="1"></i><b>1</b></td> 
               <td>whether this implementation can provide metadata for interface types.</td> 
              </tr> 
              <tr> 
               <td><i class="conum" data-value="2"></i><b>2</b></td> 
               <td>whether this implementation can provide metadata for anonymous classes.</td> 
              </tr> 
              <tr> 
               <td><i class="conum" data-value="3"></i><b>3</b></td> 
               <td>whether this implementation can provide metadata for synthetic types.</td> 
              </tr> 
              <tr> 
               <td><i class="conum" data-value="4"></i><b>4</b></td> 
               <td>whether this implementation can provide metadata for arrays.</td> 
              </tr> 
              <tr> 
               <td><i class="conum" data-value="5"></i><b>5</b></td> 
               <td>whether this implementation can provide metadata for enums.</td> 
              </tr> 
              <tr> 
               <td><i class="conum" data-value="6"></i><b>6</b></td> 
               <td>whether this implementation can provide metadata for applib value types.</td> 
              </tr> 
              <tr> 
               <td><i class="conum" data-value="7"></i><b>7</b></td> 
               <td>whether this implementation can provide metadata for domain services.</td> 
              </tr> 
             </tbody>
            </table> 
           </div> 
           <div class="paragraph"> 
            <p>The <code>support()</code> method returns a struct class that describes the types of classes are supported by this implementation.</p> 
           </div> 
           <div class="paragraph"> 
            <p>The <code>LayoutMetadataReaderFromJson</code> implements this extended API.</p> 
           </div> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_configuration_2">5.3.3. Configuration</h4> 
          <div class="paragraph"> 
           <p>Once you have implemented your validator, you must register it with the framework by defining the appropriate configuration property:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="ini">isis.reflector.layoutMetadataReaders=\
           com.mycompany.myapp.MyMetaModelValidator,\
           org.apache.isis.core.metamodel.layoutmetadata.json.LayoutMetadataReaderFromJson   <i class="conum" data-value="1"></i><b>(1)</b></code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>the property replaces any existing metadata readers; if you want to preserve the ability to read from <code>Xxx.layout.json</code> then also register Apache Isis' built-in implementation.</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
      <div class="sect1"> 
       <h2 id="_ugbtb_deployment">6. Deployment</h2>
       <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
        <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
        <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
        <ul class="dropdown-menu">
         <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
         <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
         <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
         <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
        </ul>
       </div> 
       <div class="sectionbody"> 
        <div class="paragraph"> 
         <p>This chapter provides guidance on some common deployment scenarios.</p> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_deployment_cmd-line">6.1. Command Line (<code>WebServer</code>)</h3>
         <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
          <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_cmd-line.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
          <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
          <ul class="dropdown-menu">
           <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_cmd-line.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
           <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_cmd-line.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
           <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_cmd-line.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
           <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_cmd-line.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
          </ul>
         </div> 
         <div class="paragraph"> 
          <p>As well as deploying an Apache Isis application into a servlet container, it is also possible to invoke from the command line using the <code>org.apache.isis.WebServer</code> utility class. This is especially useful while developing and testing, but may also suit some deployment scenarios (eg running as a standalone EXE within a Docker container, for example). Internally the <code>WebServer</code> spins up a Jetty servlet container.</p> 
         </div> 
         <div class="paragraph"> 
          <p>The class also supports a number of command line arguments:</p> 
         </div> 
         <table class="tableblock frame-all grid-all spread"> 
          <caption class="title">
           Table 1. Command line args for 
           <code>org.apache.isis.Webserver</code>
          </caption> 
          <colgroup> 
           <col style="width: 11.1111%;"> 
           <col style="width: 22.2222%;"> 
           <col style="width: 22.2222%;"> 
           <col style="width: 44.4445%;"> 
          </colgroup> 
          <thead> 
           <tr> 
            <th class="tableblock halign-left valign-top">Flag</th> 
            <th class="tableblock halign-left valign-top">Long format</th> 
            <th class="tableblock halign-left valign-top">Values<br> (default)</th> 
            <th class="tableblock halign-left valign-top">Description</th> 
           </tr> 
          </thead> 
          <tbody> 
           <tr> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><code>-t</code></p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><code>--type</code></p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><code>server_prototype</code>, <code>server</code><br> (<code>server</code>)</p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p>Deployment type</p> 
              </div>
             </div></td> 
           </tr> 
           <tr> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><code>-m</code></p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><code>--manifest</code></p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p>FQCN</p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p>Fully qualified class name of the <a href="../rgcms/rgcms.html#_rgcms_classes_super_AppManifest"><code>AppManifest</code></a> to use to bootstrap the system.<br></p> 
              </div> 
              <div class="paragraph"> 
               <p>This flag sets/overrides the <code>isis.appManifest</code> configuration property to the specified class name.</p> 
              </div>
             </div></td> 
           </tr> 
           <tr> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><code>-f</code></p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><code>--fixture</code></p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p>FQCN</p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p>Fully qualified class name of the fixture (extending <a href="../rgcms/rgcms.html#_rgcms_classes_super_FixtureScript"><code>FixtureScript</code></a>) to be run to setup data.<br></p> 
              </div> 
              <div class="paragraph"> 
               <p>This flag sets/overrides the <code>isis.fixtures</code> configuration property to the specified class name, and also sets the <code>isis.persistor.datanucleus.install-fixtures</code> configuration property to <code>true</code> to instruct the JDO/DataNucleus objectstore to actually load in the fixtures.<br></p> 
              </div> 
              <div class="paragraph"> 
               <p>It is also possible to specify the fixture class name using either the <code>$IsisFixture</code> or <code>$IsisFixtures</code> environment variable (case insensitive).</p> 
              </div>
             </div></td> 
           </tr> 
           <tr> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><code>-p</code></p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><code>--port</code></p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p>(8080)</p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p>The port number to listen on.<br></p> 
              </div> 
              <div class="paragraph"> 
               <p>This flag sets/overrides the <code>isis.embedded-web-server.port</code> configuration property.</p> 
              </div>
             </div></td> 
           </tr> 
           <tr> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><code>-c</code></p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><code>--config</code></p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p>filename</p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p>configuration file containing additional configuration properties</p> 
              </div>
             </div></td> 
           </tr> 
           <tr> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><code>-D</code></p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div></div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p>xxx=yyy</p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p>Specify additional arbitrary configuration properties. This can be specified multiple times.<br></p> 
              </div> 
              <div class="paragraph"> 
               <p>Further discussion below.</p> 
              </div>
             </div></td> 
           </tr> 
           <tr> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><code>-v</code></p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><code>--version</code></p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div></div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p>Prints the version, then quits</p> 
              </div>
             </div></td> 
           </tr> 
           <tr> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><code>-h</code></p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><code>--help</code></p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div></div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p>Prints a usage message, then quits</p> 
              </div>
             </div></td> 
           </tr> 
          </tbody> 
         </table> 
         <div class="paragraph"> 
          <p>Note that the <code>-D</code> argument is <strong>not</strong> a system property, it is parsed by <code>WebServer</code> itself. That said, it is <em>also</em> possible to specify system properties, and these will also be processed in the exact same way.<br></p> 
         </div> 
         <div class="paragraph"> 
          <p>Said another way, properties can be specified either as application arguments:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="ini">java org.apache.isis.WebServer -Dxxx=yyy -Daaa=bbb</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>or as system properties:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="ini">java -Dxxx=yyy -Daaa=bbb org.apache.isis.WebServer</code></pre> 
          </div> 
         </div> 
         <div class="admonitionblock tip"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> 
             <td class="content"> 
              <div class="title">
               The 
               <code>Dummy</code> class
              </div> 
              <div class="paragraph"> 
               <p>The framework also provides the <code>org.apache.isis.Dummy</code> class, which consists of a single empty <code>main(String[])</code> method. It was introduced as a convenience for developers using Eclipse in combination with the DataNucleus plugin; if used as a launch target then it allow the entities to be enhanced withouth the running an app.</p> 
              </div> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="literalblock"> 
          <div class="content"> 
           <pre>    [[_ugbtb_deployment_externalized-configuration]]
= Externalized Configuration
:Notice: Licensed to the Apache Software Foundation (ASF) under one or more contributor license agreements. See the NOTICE file distributed with this work for additional information regarding copyright ownership. The ASF licenses this file to you under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You may obtain a copy of the License at. http://www.apache.org/licenses/LICENSE-2.0 . Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR  CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License.
:_basedir: ../../
:_imagesdir: images/</pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>As described <a href="../rgcfg/rgcfg.html#_rgcfg_configuration-files">here</a>, by default Apache Isis itself bootstraps from the <code>isis.properties</code> configuration file. It will also read configuration from the (optional) component/implementation-specific configuration files (such as <code>persistor_datanucleus.properties</code> or <code>viewer_wicket.properties</code>), and also (optional) component-specific configuration files (such as <code>persistor.properties</code> or <code>viewer.properties</code>).</p> 
         </div> 
         <div class="paragraph"> 
          <p>It’s generally not good practice to have the same configuration property in more than one file, but if that does occur, then the subsequent configuration property will be ignored.</p> 
         </div> 
         <div class="admonitionblock tip"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> 
             <td class="content"> 
              <div class="paragraph"> 
               <p>In addition the framework will also load the <code>overrides.properties</code> file. This is intended to support deployment through Docker, as discussed <a href="../ugbtb/ugbtb.html#_ugbtb_deployment_docker">next</a>.</p> 
              </div> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>All of these files are read from the <code>WEB-INF</code> directory. Having this configuration "baked into" the application is okay in a development environment, but when the app needs to be deployed to a test or production environment, this configuration should be read from an external location.</p> 
         </div> 
         <div class="paragraph"> 
          <p>There are in fact several frameworks involved here, all of which need to be pointed to this external location:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p>Apache Isis itself, which (as already discussed) reads <code>isis.properties</code> and optional component-specific config files.</p> </li> 
           <li> <p><a href="http://shiro.apache.org">Apache Shiro</a>, which reads the <code>shiro.ini</code> file (and may read other files referenced from that file)</p> </li> 
           <li> <p><a href="http://logging.apache.org/log4j/1.2">Apache log4j 1.2</a>, for logging, which reads <code>logging.properties</code> file</p> </li> 
           <li> <p>although not used by Apache Isis, there’s a good chance you may be using the Spring framework (eg if using <a href="http://activemq.apache.org">Apache Active MQ</a> or <a href="http://camel.apache.org">Apache Camel</a>.</p> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>Each of these frameworks has its own way of externalizing its configuration.</p> 
         </div> 
         <div class="admonitionblock tip"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> 
             <td class="content"> 
              <div class="paragraph"> 
               <p>Subsequent sections explain how to externalize configuration for <a href="#_ugbtb_deployment_tomcat">Tomcat</a> and for <a href="#_ugbtb_deployment_docker">Docker</a>.</p> 
              </div> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="sect3"> 
          <h4 id="__ugbtb_deployment_externalized-configuration_Isis">6.1.1. Apache Isis' Config</h4> 
          <div class="paragraph"> 
           <p>To tell Apache Isis to load configuration from an external directory, specify the <code>isis.config.dir</code> context parameter.</p> 
          </div> 
          <div class="paragraph"> 
           <p>If the external configuration directory is fixed for all environments (systest, UAT, prod etc), then you can specify within the <code>web.xml</code> itself:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;context-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>isis.config.dir<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>location of external config directory<span class="tag">&lt;/param-value&gt;</span>
<span class="tag">&lt;/context-param&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>If however the configuration directory varies by environment, then the context parameter will be specified to each installation of your servlet container. Most (if not all) servlet containers will provide a means to define context parameters through proprietary config files.</p> 
          </div> 
          <div class="admonitionblock note"> 
           <table> 
            <tbody>
             <tr> 
              <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
              <td class="content"> 
               <div class="paragraph"> 
                <p>Note that running the app using Apache Isis' <code>org.apache.isis.WebServer</code> bootstrapper does not use externalized Apache Isis configuration.</p> 
               </div> </td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="__ugbtb_deployment_externalized-configuration_Shiro">6.1.2. Shiro Config</h4> 
          <div class="paragraph"> 
           <p>If using Apache Isis' <a href="../ugsec/ugsec.html#_ugsec_configuring-isis-to-use-shiro">Shiro integration</a> for authentication and/or authorization, note that it reads from the <code>shiro.ini</code> configuration file. By default this also resides in <code>WEB-INF</code>.</p> 
          </div> 
          <div class="paragraph"> 
           <p>Similar to Apache Isis, Shiro lets this configuration directory be altered, by specifying the <code>shiroConfigLocations</code> context parameter.</p> 
          </div> 
          <div class="paragraph"> 
           <p>You can therefore override the default location using the same technique as described above for Apache Isis' <code>isis.config.dir</code> context parameter. For example:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;Parameter</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">shiroConfigLocations</span><span class="delimiter">"</span></span>
           <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">"</span><span class="content">file:/usr/local/myapp/conf/shiro.ini</span><span class="delimiter">"</span></span>
           <span class="attribute-name">override</span>=<span class="string"><span class="delimiter">"</span><span class="content">false</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="admonitionblock tip"> 
           <table> 
            <tbody>
             <tr> 
              <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> 
              <td class="content"> 
               <div class="paragraph"> 
                <p>Note that Shiro is more flexible than Apache Isis; it will read its configuration from any URL, not just a directory on the local filesystem.</p> 
               </div> </td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="__ugbtb_deployment_externalized-configuration_Log4j">6.1.3. Log4j Config</h4> 
          <div class="paragraph"> 
           <p>By default Apache Isis configures log4j to read the <code>logging.properties</code> file in the <code>WEB-INF</code> directory. This can be overridden by setting the <code>log4j.properties</code> system property to the URL of the log4j properties file.</p> 
          </div> 
          <div class="sect4"> 
           <h5 id="_tomcat">Tomcat</h5> 
           <div class="paragraph"> 
            <p>For example, if deploying to Tomcat7 or Tomcat8, this amounts to adding the following to the <code>CATALINA_OPTS</code> flags:</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay highlight"><code data-lang="bash">export CATALINA_OPTS="-Dlog4j.configuration=/usr/local/tomcat/myapp/conf/logging.properties"</code></pre> 
            </div> 
           </div> 
           <div class="admonitionblock tip"> 
            <table> 
             <tbody>
              <tr> 
               <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> 
               <td class="content"> 
                <div class="paragraph"> 
                 <p><code>CATALINA_OPTS</code> was called <code>TOMCAT_OPTS</code> in earlier versions of Tomcat.</p> 
                </div> </td> 
              </tr> 
             </tbody>
            </table> 
           </div> 
           <div class="paragraph"> 
            <p>Further details an be found in the <a href="https://logging.apache.org/log4j/1.2/manual.html#Example_Configurations">log4j documentation</a>.</p> 
           </div> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_spring_config">6.1.4. Spring Config</h4> 
          <div class="paragraph"> 
           <p>Although Apache Isis does not use Spring, it’s possible that your app may use other components that do use Spring. For example, the (non-ASF) <a href="http://platform.incode.org" target="_blank">Incode Platform</a>'s publishmq module uses ActiveMQ and Camel to support publishing; both of these leverage Spring.</p> 
          </div> 
          <div class="paragraph"> 
           <p>There are several ways to externalized Spring config, but the mechanism described here is similar in nature to those that we use for externalizing Apache Isis' and Shiro’s configuration. In your <code>web.xml</code>, you will probably load the Spring application context using code such as:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;listener&gt;</span>
    <span class="tag">&lt;listener-class&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/listener-class&gt;</span>
<span class="tag">&lt;/listener&gt;</span>
<span class="tag">&lt;context-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>contextConfigLocation<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>
        classpath:my-application-context-config.xml
    <span class="tag">&lt;/param-value&gt;</span>
<span class="tag">&lt;/context-param&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>Add a new application context <code>propertyPlaceholderConfigurer-config.xml</code> defining a <code>PropertyPlaceholderConfigurer</code> bean.</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;beans</span>
  <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.springframework.org/schema/beans</span><span class="delimiter">"</span></span>
  <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">"</span></span>
  <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd</span> <span class="content">http://activemq.apache.org/schema/core http://activemq.apache.org/schema/core/activemq-core.xsd</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">org.springframework.beans.factory.config.PropertyPlaceholderConfigurer</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">locations</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;list&gt;</span>
                <span class="tag">&lt;value&gt;</span>${spring.config.file}<span class="tag">&lt;/value&gt;</span>
            <span class="tag">&lt;/list&gt;</span>
        <span class="tag">&lt;/property&gt;</span>
    <span class="tag">&lt;/bean&gt;</span>
<span class="tag">&lt;/beans&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>This reads the properties from a <code>spring.config.file</code>, defined as a context-param in the <code>web.xml</code>:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;context-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>spring.config.file<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>classpath:spring.properties<span class="tag">&lt;/param-value&gt;</span>
<span class="tag">&lt;/context-param&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>Then update the bootstrapping in <code>web.xml</code> to use this new application context, eg:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;context-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>contextConfigLocation<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>
        classpath:my-application-context-config.xml,
        classpath:propertyPlaceholderConfigurer-config.xml
    <span class="tag">&lt;/param-value&gt;</span>
<span class="tag">&lt;/context-param&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>To use some other externalized configuration, override the <code>spring.config.file</code> property, eg using Tomcat’s config file:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;Parameter</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">spring.config.dir</span><span class="delimiter">"</span></span>
           <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">"</span><span class="content">file:/usr/local/myapp/conf/spring.properties</span><span class="delimiter">"</span></span>
           <span class="attribute-name">override</span>=<span class="string"><span class="delimiter">"</span><span class="content">false</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="sect4"> 
           <h5 id="_an_alternative_approach">An alternative approach</h5> 
           <div class="paragraph"> 
            <p>As mentioned, there are several other ways to externalize Spring’s config; one approach is to use Spring’s profile support.</p> 
           </div> 
           <div class="paragraph"> 
            <p>For example, in the application context you could have:</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;beans</span> <span class="attribute-name">profile</span>=<span class="string"><span class="delimiter">"</span><span class="content">default</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;bean</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">org.springframework.beans.factory.config.PropertyPlaceholderConfigurer</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">locations</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;list&gt;</span>
                <span class="tag">&lt;value&gt;</span>classpath:dev.properties<span class="tag">&lt;/value&gt;</span>
            <span class="tag">&lt;/list&gt;</span>
        <span class="tag">&lt;/property&gt;</span>
    <span class="tag">&lt;/bean&gt;</span>
<span class="tag">&lt;/beans&gt;</span>
<span class="tag">&lt;beans</span> <span class="attribute-name">profile</span>=<span class="string"><span class="delimiter">"</span><span class="content">externalized</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
    <span class="tag">&lt;bean</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">"</span><span class="content">propertyPlaceHolder</span><span class="delimiter">"</span></span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">org.springframework.beans.factory.config.PropertyPlaceholderConfigurer</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;property</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">locations</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
            <span class="tag">&lt;list&gt;</span>
                <span class="tag">&lt;value&gt;</span>classpath:prod.properties<span class="tag">&lt;/value&gt;</span>
            <span class="tag">&lt;/list&gt;</span>
        <span class="tag">&lt;/property&gt;</span>
    <span class="tag">&lt;/bean&gt;</span>
<span class="tag">&lt;/beans&gt;</span></code></pre> 
            </div> 
           </div> 
           <div class="paragraph"> 
            <p>The idea being that specifying the "prod" profile rather than the "default" profile would cause a different set of configuration properties to be read.</p> 
           </div> 
           <div class="paragraph"> 
            <p>The active profile can be overridden with a system property, eg:</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay highlight"><code data-lang="bash">-Dspring.active.profiles=prod</code></pre> 
            </div> 
           </div> 
           <div class="paragraph"> 
            <p>take a look at <a href="http://stackoverflow.com/a/10041835/56880">this SO answer</a> on using Spring profiles.</p> 
           </div> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_jvm_args">6.1.5. JVM Args</h4> 
          <div class="paragraph"> 
           <p>The <a href="../rgsvc/rgsvc.html#_rgsvc_application-layer-api_WrapperFactory"><code>WrapperFactory</code></a> uses <a href="http://www.javassist.org">Javassist</a> to create on-the-fly classes acting as a proxy. The cost of these proxies can be mitigated using:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="ini">-XX:+CMSClassUnloadingEnabled -XX:+UseConcMarkSweepGC</code></pre> 
           </div> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_using_a_jndi_datasource">6.1.6. Using a JNDI Datasource</h4> 
          <div class="paragraph"> 
           <p>See the guidance in the <a href="../ugodn/ugodn.html#_ugodn_configuring_using-jndi-data-source">configuring datanucleus</a> section.</p> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_deployment_tomcat">6.2. Deploying to Tomcat</h3>
         <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
          <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_tomcat.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
          <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
          <ul class="dropdown-menu">
           <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_tomcat.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
           <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_tomcat.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
           <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_tomcat.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
           <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_tomcat.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
          </ul>
         </div> 
         <div class="paragraph"> 
          <p>Some pointers on how to <a href="#_ugbtb_deployment_externalized-configuration">externalize configuration</a> when deploying to Tomcat. Other servlet containers have similar mechanisms.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="_tomcat_8_0">6.2.1. Tomcat 8.0</h4> 
          <div class="paragraph"> 
           <p>If deploying Tomcat 8.0, create a file called <code>$TOMCAT_HOME/conf/Catalina/localhost/todoapp.xml</code>, where <code>todoapp.xml</code> corresponds to the name of the webapp being deployed, eg <code>todoapp.war</code>.</p> 
          </div> 
          <div class="paragraph"> 
           <p>The contents of this file would be something like:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="tag">&lt;Context&gt;</span>

    <span class="tag">&lt;WatchedResource&gt;</span>WEB-INF/web.xml<span class="tag">&lt;/WatchedResource&gt;</span>
    <span class="tag">&lt;Manager</span> <span class="attribute-name">pathname</span>=<span class="string"><span class="delimiter">"</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>

    <span class="tag">&lt;Parameter</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">shiroConfigLocations</span><span class="delimiter">"</span></span>
               <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">"</span><span class="content">file:/var/todoapp/dev/shiro.ini</span><span class="delimiter">"</span></span>
               <span class="attribute-name">override</span>=<span class="string"><span class="delimiter">"</span><span class="content">false</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>

    <span class="tag">&lt;Parameter</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">isis.config.dir</span><span class="delimiter">"</span></span>
               <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">"</span><span class="content">/var/todoapp/dev/</span><span class="delimiter">"</span></span>
               <span class="attribute-name">override</span>=<span class="string"><span class="delimiter">"</span><span class="content">false</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>

    <span class="tag">&lt;Parameter</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">spring.config.file</span><span class="delimiter">"</span></span>
               <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">"</span><span class="content">file:/var/todoapp/dev/spring.properties</span><span class="delimiter">"</span></span>
               <span class="attribute-name">override</span>=<span class="string"><span class="delimiter">"</span><span class="content">false</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>

    <span class="tag">&lt;Parameter</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">wicket.configuration</span><span class="delimiter">"</span></span>
               <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">"</span><span class="content">development</span><span class="delimiter">"</span></span>
               <span class="attribute-name">override</span>=<span class="string"><span class="delimiter">"</span><span class="content">false</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>

<span class="tag">&lt;/Context&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="admonitionblock important"> 
           <table> 
            <tbody>
             <tr> 
              <td class="icon"> <i class="fa icon-important" title="Important"></i> </td> 
              <td class="content"> 
               <div class="paragraph"> 
                <p>Note that the <code>override</code> key should be set to "false", not "true". It indicates whether the application’s own <code>web.xml</code> can override the setting. In most cases, you probably want to disallow that.</p> 
               </div> </td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
          <div class="paragraph"> 
           <p>Thus, when <code>todoapp.war</code> is deployed to <code>$CATALINA_HOME/webapp</code>, then this configuration will be used.</p> 
          </div> 
          <div class="paragraph"> 
           <p>For more detail, see the Tomcat 8.0 documentation on <a href="http://tomcat.apache.org/tomcat-8.0-doc/config/context.html#Defining_a_context">defining a context</a> and on <a href="http://tomcat.apache.org/tomcat-8.0-doc/config/context.html#Context_Parameters">context parameters</a>.</p> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_tomcat_7_0">6.2.2. Tomcat 7.0</h4> 
          <div class="paragraph"> 
           <p>If using Tomcat 7.0, the process is similar to that of Tomcat 8.0, however the override file resides in <code>$TOMCAT_HOME/conf</code>, rather than <code>$TOMCAT_HOME/conf/Catalina/localhost</code>.</p> 
          </div> 
          <div class="paragraph"> 
           <p>For more detail, see the Tomcat 7.0 documentation on <a href="http://tomcat.apache.org/tomcat-7.0-doc/config/context.html#Defining_a_context">defining a context</a> and on <a href="http://tomcat.apache.org/tomcat-7.0-doc/config/context.html#Context_Parameters">context parameters</a>.</p> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_deployment_docker">6.3. Docker</h3>
         <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
          <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_docker.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
          <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
          <ul class="dropdown-menu">
           <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_docker.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
           <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_docker.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
           <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_docker.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
           <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_docker.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
          </ul>
         </div> 
         <div class="paragraph"> 
          <p>When running the application within a Docker container, the problem that must be solved is to override the configuration properties baked into the war file, eg to point to the app to a different JDBC URL.</p> 
         </div> 
         <div class="paragraph"> 
          <p>There are several options.</p> 
         </div> 
         <div class="admonitionblock warning"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-warning" title="Warning"></i> </td> 
             <td class="content"> 
              <div class="paragraph"> 
               <p>All the options here rely on starting the Docker container with a set of arguments, some of which would very likely be passwords for database connections etc. As such these techniques are only suitable where the security of the Docker host can be assured.</p> 
              </div> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="sect3"> 
          <h4 id="_using_an_code_overrides_properties_code">6.3.1. Using an <code>overrides.properties</code></h4> 
          <div class="paragraph"> 
           <p>In addition to loading the regular configuration properties from <code>WEB-INF</code> directory (described <a href="../rgcfg/rgcfg.html#_rgcfg_configuration-files">here</a>), Apache Isis will also load the <code>overrides.properties</code> file.</p> 
          </div> 
          <div class="paragraph"> 
           <p>This file is treated slightly differently than the other configuration files; it is loaded last, and any configuration properties defined in it will <em>override</em> any configuration properties already read from other files (this includes any properties specified via the command line).</p> 
          </div> 
          <div class="paragraph"> 
           <p>While the regular configuration files are "baked into" the application WAR file, the <code>overrides.properties</code> file is created dynamically as part of the Docker <code>ENTRYPOINT</code> script, eg as documented in the <a href="https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/">Dockerfile best practices</a>.</p> 
          </div> 
          <div class="paragraph"> 
           <p>Thus, Docker can be supported as follows:</p> 
          </div> 
          <div class="ulist"> 
           <ul> 
            <li> <p>use <code>mvn</code> (as currently) to create a WAR file; set up with the <code>pom.xml</code> with the JDBC drivers of all DB servers that you might want to connect to (hsqldb, sql server, postgresql etc)</p> </li> 
            <li> <p>in the <code>Dockerfile</code>, specify a base image containing Tomcat 8 + Java 8 (say)</p> </li> 
            <li> <p>also in the <code>Dockerfile</code>, arrange it such that the WAR file is "exploded" (there is no need to copy over the WAR file itself)</p> </li> 
            <li> <p>write a script that:</p> 
             <div class="ulist"> 
              <ul> 
               <li> <p>explodes the WAR file, copying it into the Tomcat’s <code>webapp</code> directory. There is no need to copy over the WAR file itself.</p> </li> 
               <li> <p>creates the <code>overrides.properties</code> file from any input arguments, placing it into the <code>WEB-INF</code> directory</p> </li> 
               <li> <p>sets all files to read-only</p> </li> 
              </ul> 
             </div> </li> 
            <li> <p>use <code>ENTRYPOINT</code> (and probably also <code>CMD</code>) to invoke above script.</p> </li> 
           </ul> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_using_system_properties">6.3.2. Using system properties</h4> 
          <div class="paragraph"> 
           <p>The servlet context initializer will search for any system properties called <code>isis.xxx</code> and if present will use them as overrides.</p> 
          </div> 
          <div class="paragraph"> 
           <p>Thus, an alternative option for a Docker image is to bootstrap the servlet container (Tomcat, Jetty) with appropriate system properties set up. For example, with Tomcat this can be done by writing into the <code>conf/catalina.properties</code> file (see for example <a href="http://stackoverflow.com/a/16566920">this stackoverflow</a> post).</p> 
          </div> 
          <div class="paragraph"> 
           <p>The Docker’s <code>ENTRYPOINT</code> therefore just needs to parse the Docker container’s own command line arguments and use to create this file.</p> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_using_code_isis_opts_code">6.3.3. Using <code>$ISIS_OPTS</code></h4> 
          <div class="paragraph"> 
           <p>The servlet context initializer will search for an environment variable called <code>$ISIS_OPTS</code> and if present will parse the content as a set of key/value pairs. Each key/value pair is separated by "||".</p> 
          </div> 
          <div class="paragraph"> 
           <p>For example:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="bash">export ISIS_OPTS="isis.appManifest=domainapp.app.DomainAppAppManifestWithFixtures||isis.objects.editing=false"</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>can be used to run with a different app manifest, and also to disable editing of properties.</p> 
          </div> 
          <div class="paragraph"> 
           <p>To use a different separator, set the (optional) <code>$ISIS_OPTS_SEPARATOR</code> variable.</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="bash">export ISIS_OPTS_SEPARATOR=";"
export ISIS_OPTS="isis.appManifest=domainapp.app.DomainAppAppManifestWithFixtures;isis.objects.editing=false"</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>The Docker’s <code>ENTRYPOINT</code> therefore just needs to parse the Docker container’s own command line arguments and use to set this environment variable.</p> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_deployment_gae">6.4. Deploying to Google App Engine</h3>
         <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
          <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_gae.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
          <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
          <ul class="dropdown-menu">
           <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_gae.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
           <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_gae.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
           <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_gae.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
           <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_gae.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
          </ul>
         </div> 
         <div class="paragraph"> 
          <p>The <a href="https://cloud.google.com/appengine/docs">Google App Engine</a> (GAE) provides a JDO API, meaning that you can deploy Apache Isis onto GAE using the JDO objectstore.</p> 
         </div> 
         <div class="paragraph"> 
          <p>However, GAE is not an RDBMS, and so there are some limitations that it imposes. This page gathers together various hints, tips and workarounds.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="_primary_keys_and_owned_unowned_relationships">6.4.1. Primary Keys and Owned/Unowned Relationships</h4> 
          <div class="paragraph"> 
           <p>All entities must have a <code>@PrimaryKey</code>. Within GAE, the type of this key matters.</p> 
          </div> 
          <div class="paragraph"> 
           <p>For an entity to be an aggregate root, (ie a root of an GAE entity group), its key must be a <code>Long</code>, eg:</p> 
          </div> 
          <div class="paragraph"> 
           <p>Any collection that holds this entity type (eg <code>ToDoItem#dependencies</code> holding a collection of <code>ToDoItem`s) should then be annotated with `@Unowned</code> (a GAE annotation).</p> 
          </div> 
          <div class="paragraph"> 
           <p>If on the other hand you want the object to be owned (through a 1:m relationship somewhere) by some other root, then use a String:</p> 
          </div> 
          <div class="paragraph"> 
           <p>Note: if you store a relationship with a String key it means that the parent object <em>owns</em> the child, any attempt to change the relationship raise and exception.</p> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_custom_types">6.4.2. Custom Types</h4> 
          <div class="paragraph"> 
           <p>Currently Apache Isis' <code>Blob</code> and <code>Clob</code> types and the JODA types (<code>LocalDate</code> et al) are <em>not</em> supported in GAE.</p> 
          </div> 
          <div class="paragraph"> 
           <p>Instead, GAE defines a <a href="https://cloud.google.com/appengine/docs/java/datastore/entities#Properties_and_Value_Types">fixed set of value types</a>, including <code>BlobKey</code>. Members of the Apache Isis community have this working, though I haven’t seen the code.</p> 
          </div> 
          <div class="paragraph"> 
           <p>The above notwithstanding, Andy Jefferson at DataNucleus tells us:</p> 
          </div> 
          <div class="paragraph"> 
           <p></p>
           <div class="extended-quote-first">
            <p>GAE JDO/JPA does support <em>some</em> type conversion, because looking at <a href="http://code.google.com/p/datanucleus-appengine/source/browse/trunk/src/com/google/appengine/datanucleus/StoreFieldManager.java#349">StoreFieldManager.java</a> for any field that is Object-based and not a relation nor Serialized it will call <a href="http://code.google.com/p/datanucleus-appengine/source/browse/trunk/src/com/google/appengine/datanucleus/TypeConversionUtils.java#736">TypeConverstionUtils.java</a> and that looks for a <code>TypeConverter</code> (specify <code>@Extension</code> with key of "type-converter-name" against a field and value as the <code>TypeConverter</code> class) and it should convert it. Similarly when getting the value from the datastore. </p>
           </div>
           <p></p> 
          </div> 
          <div class="paragraph"> 
           <p>On further investigation, it seems that the GAE implementation performs a type check on a <code>SUPPORTED_TYPES</code> Java set, in <code>com.google.appengine.api.datastore.DataTypeUtils</code>:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">if</span> (!supportedTypes.contains(value.getClass())) {
    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">IllegalArgumentException</span>(prefix + value.getClass().getName() + <span class="string"><span class="delimiter">"</span><span class="content"> is not a supported property type.</span><span class="delimiter">"</span></span>);
}</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>We still need to try out Andy’s recipe, above.</p> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_deployment_neo4j">6.5. Neo4J</h3>
         <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
          <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_neo4j.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
          <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
          <ul class="dropdown-menu">
           <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_neo4j.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
           <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_neo4j.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
           <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_neo4j.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
           <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_neo4j.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
          </ul>
         </div> 
         <div class="paragraph"> 
          <p>Apache Isis has experimental support for Neo4J, courtesy of DataNucleus' <a href="http://www.datanucleus.org/products/datanucleus/datastores/neo4j.html">Neo4J Datastore</a> implementation.</p> 
         </div> 
         <div class="admonitionblock tip"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> 
             <td class="content"> 
              <div class="paragraph"> 
               <p>In addition, the <a href="http://github.com/isisaddons/isis-app-neoapp">Isis addons' neoapp</a> (non-ASF) is configured to run with an embedded Neo4J server running alongside the Apache Isis webapp.</p> 
              </div> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>The steps below describe the configuration steps required to update an existing app.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="_connectionurl">6.5.1. ConnectionURL</h4> 
          <div class="paragraph"> 
           <p>In <code>persistor.properties</code>, update the JDO <code>ConnectionURL</code> property, eg:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="ini">isis.persistor.datanucleus.impl.javax.jdo.option.ConnectionURL=neo4j:neo4j_DB</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>The other connection properties (<code>ConnectionDriverName</code>, <code>ConnectionUserName</code> and <code>ConnectionPassword</code>) should be commented out.</p> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_update_pom_xml">6.5.2. Update pom.xml</h4> 
          <div class="paragraph"> 
           <p>Add the following dependency to the <code>webapp</code> project’s <code>pom.xml</code>:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependencies&gt;</span>
    ...
    <span class="tag">&lt;dependency&gt;</span>
        <span class="tag">&lt;groupId&gt;</span>org.datanucleus<span class="tag">&lt;/groupId&gt;</span>
        <span class="tag">&lt;artifactId&gt;</span>datanucleus-neo4j<span class="tag">&lt;/artifactId&gt;</span>
        <span class="tag">&lt;version&gt;</span>4.0.5<span class="tag">&lt;/version&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tag">&lt;/dependency&gt;</span>
    ...
<span class="tag">&lt;/dependencies&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>for Isis v1.9.0, use the value shown. for Isis v1.8.0, use 3.2.3.</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
          <div class="paragraph"> 
           <p>In the <a href="../ugfun/ugfun.html#_ugfun_getting-started_simpleapp-archetype">SimpleApp archetype</a> this is defined under the "neo4j" profile so can be activated using <code>-P neo4j</code>.</p> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_try_it_out">6.5.3. Try it out!</h4> 
          <div class="paragraph"> 
           <p>If you want to quickly try out neo4j for yourself:</p> 
          </div> 
          <div class="ulist"> 
           <ul> 
            <li> <p>run the <a href="../ugfun/ugfun.html#_ugfun_getting-started_simpleapp-archetype">SimpleApp archetype</a> (v1.8.0)</p> </li> 
            <li> <p>build the app:</p> </li> 
            <li> <p>run the app:</p> </li> 
           </ul> 
          </div> 
          <div class="paragraph"> 
           <p>If you visit the about page you should see the neo4j JAR files are linked in, and a <code>neo4j_DB</code> subdirectory within the <code>webapp</code> directory.</p> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_deployment_jvm-flags">6.6. JVM Flags</h3>
         <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
          <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_jvm-flags.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
          <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
          <ul class="dropdown-menu">
           <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_jvm-flags.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
           <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_jvm-flags.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
           <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_jvm-flags.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
           <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_deployment_jvm-flags.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
          </ul>
         </div> 
         <div class="admonitionblock note"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
             <td class="content"> FIXME </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>The default JVM configuration will most likely not be appropriate for running Isis as a webapp. The table below suggests some JVM args that you will probably want to modify:</p> 
         </div> 
         <table class="tableblock frame-all grid-all spread"> 
          <caption class="title">
           Table 2. JVM args
          </caption> 
          <colgroup> 
           <col style="width: 50%;"> 
           <col style="width: 50%;"> 
          </colgroup> 
          <thead> 
           <tr> 
            <th class="tableblock halign-left valign-top">Flag</th> 
            <th class="tableblock halign-left valign-top">Description</th> 
           </tr> 
          </thead> 
          <tbody> 
           <tr> 
            <td class="tableblock halign-left valign-top"><p class="tableblock">-server</p></td> 
            <td class="tableblock halign-left valign-top"><p class="tableblock">Run the JVM in server mode, meaning that the JVM should spend more time on the optimization of the fragments of codes that are most often used (hotspots). This leads to better performance at the price of a higher overhead at startup.</p></td> 
           </tr> 
           <tr> 
            <td class="tableblock halign-left valign-top"><p class="tableblock">-Xms128m Minimum heap size</p></td> 
            <td class="tableblock halign-left valign-top"><p class="tableblock">-Xmx768m</p></td> 
           </tr> 
           <tr> 
            <td class="tableblock halign-left valign-top"><p class="tableblock">Maximum heap size</p></td> 
            <td class="tableblock halign-left valign-top"><p class="tableblock">-XX:PermSize=64m</p></td> 
           </tr> 
           <tr> 
            <td class="tableblock halign-left valign-top"><p class="tableblock">Minimum perm size (for class definitions)</p></td> 
            <td class="tableblock halign-left valign-top"><p class="tableblock">-XX:MaxPermSize=256m</p></td> 
           </tr> 
           <tr> 
            <td class="tableblock halign-left valign-top"><p class="tableblock">Maximum perm size (for class definitions)</p></td> 
            <td class="tableblock halign-left valign-top"><p class="tableblock">-XX:+DisableExplicitGC</p></td> 
           </tr> 
          </tbody> 
         </table> 
         <div class="paragraph"> 
          <p>There are also a whole bunch of GC-related flags, that you might want to explore; see this detailed <a href="http://www.oracle.com/technetwork/java/javase/tech/vmoptions-jsp-140102.html">Hotspot JVM</a> documentation and also this <a href="http://blog.ragozin.info/2011/09/hotspot-jvm-garbage-collection-options.html">blog post</a>.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="_configuring_in_tomcat">6.6.1. Configuring in Tomcat</h4> 
          <div class="paragraph"> 
           <p>If using Tomcat, update the <code>CATALINA_OPTS</code> variable. (This variable is also updated if <a href="../ugbtb/ugbtb.html#__ugbtb_deployment_externalized-configuration_Log4j">configuring logging to run externally</a>).</p> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
      <div class="sect1"> 
       <h2 id="_ugbtb_web-xml">7. <code>web.xml</code></h2>
       <div class="btn-group" style="float: right; font-size: small; padding: 6px; margin-top: -55px; ">
        <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_web-xml.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
        <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
        <ul class="dropdown-menu">
         <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_web-xml.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
         <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_web-xml.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
         <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_web-xml.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
         <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/ugbtb/_ugbtb_web-xml.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
        </ul>
       </div> 
       <div class="sectionbody"> 
        <div class="paragraph"> 
         <p>Apache Isis provides two different viewers, the <a href="../ugvw/ugvw.html">Wicket viewer</a> and the <a href="../ugvro/ugvro.html">RestfulObjects viewer</a>. You can deploy both of these concurrently, or deploy just the Wicket viewer, or deploy just the Restful Objects viewer. The configuration in <code>web.xml</code> varies accordingly, both in terms of the servlet context listeners, filters and servlets.</p> 
        </div> 
        <div class="paragraph"> 
         <p>If you are using Apache Isis' integration with Apache Shiro (for security) then this also needs configuring in <code>web.xml</code>. See the <a href="../ugsec/ugsec.html#_ugsec_configuring-isis-to-use-shiro">security chapter</a> for full details on this topic.</p> 
        </div> 
        <div class="paragraph"> 
         <p>The servlets and filters are mapped to three main pipelines:</p> 
        </div> 
        <div class="ulist"> 
         <ul> 
          <li> <p><code>/wicket</code> - the Wicket viewer UI</p> </li> 
          <li> <p><code>/restful</code> - the Restful Objects resources (REST API)</p> </li> 
          <li> <p>other paths, also static resources (such as <code>.png</code>, <code>.css</code>)</p> </li> 
         </ul> 
        </div> 
        <div class="paragraph"> 
         <p>With the following key:</p> 
        </div> 
        <div class="imageblock"> 
         <div class="content"> 
          <a class="image" href="images/runtime/web-xml/key.png"><img src="images/runtime/web-xml/key.png" alt="key" width="800px"></a> 
         </div> 
        </div> 
        <div class="paragraph"> 
         <p>the diagram below shows the components to be configured if deploying both the Wicket viewer and Restful Objects viewer:</p> 
        </div> 
        <div class="imageblock"> 
         <div class="content"> 
          <a class="image" href="images/runtime/web-xml/wicket-and-ro.png"><img src="images/runtime/web-xml/wicket-and-ro.png" alt="wicket and ro" width="800px"></a> 
         </div> 
        </div> 
        <div class="paragraph"> 
         <p>Here the Wicket viewer is responsible for the main bootstrapping of Apache Isis itself, in other words the shared (global) metadata; this is done by the <code>IsisWicketApplication</code> class (extending the <code>WicketApplication</code> Wicket API). This class is also responsible for Apache Isis' own session and transaction management.</p> 
        </div> 
        <div class="paragraph"> 
         <p>The Restful Objects viewer - being a JAX-RS application implemented using the RestEasy framework - requires the <code>RestEasyBootstrapper</code> servlet context listener. It is this context listener that also sets up the <code>RestfulObjectsApplication</code>, which is then delegated to by the RestEasy <code>HttpServletDispatcher</code>. This pipeline uses the <code>IsisSessionFilter</code> and <code>IsisTransactionFilterForRestfulObjects</code> to perform the session and transaction management before it hits the RestEasy servlet.</p> 
        </div> 
        <div class="paragraph"> 
         <p>If only the Wicket viewer is deployed, then the diagram is more or less the same: the RestEasy servlet, context listener and supporting filters are simply removed:</p> 
        </div> 
        <div class="imageblock"> 
         <div class="content"> 
          <a class="image" href="images/runtime/web-xml/wicket-only.png"><img src="images/runtime/web-xml/wicket-only.png" alt="wicket only" width="800px"></a> 
         </div> 
        </div> 
        <div class="paragraph"> 
         <p>Finally, if only the Restful Objects viewer is deployed, then things change a little more subtly. Here, the Wicket filter is no longer needed. In its place, though the <code>IsisWebAppBootstrapper</code> context listener is required: this is responsible for seting up the shared (global) metadata.</p> 
        </div> 
        <div class="imageblock"> 
         <div class="content"> 
          <a class="image" href="images/runtime/web-xml/ro-only.png"><img src="images/runtime/web-xml/ro-only.png" alt="ro only" width="800px"></a> 
         </div> 
        </div> 
        <div class="paragraph"> 
         <p>The following sections detail these various listeners, filters and servlets in more detail.</p> 
        </div> 
        <div class="sect2"> 
         <h3 id="__ugbtb_web-xml_servlet-context-listeners">7.1. Servlet Context Listeners</h3> 
         <div class="paragraph"> 
          <p>Servlet context listeners are used to perform initialization on application startup. Both Shiro (if configured as the security mechanism) and RestEasy (for the Restful Objects viewer) require their own context listener. In addition, if the Wicket viewer is <em>not</em> being used, then additional Apache Isis-specific listener is required for bootstrapping of the Apache Isis framework itself.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="__code_environmentloaderlistener_code_shiro">7.1.1. <code>EnvironmentLoaderListener</code> (Shiro)</h4> 
          <div class="paragraph"> 
           <p>Bootstrap listener to startup and shutdown the web application’s Shiro <code>WebEnvironment</code> at startup and shutdown respectively.</p> 
          </div> 
          <div class="paragraph"> 
           <p>Its definition is:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;listener&gt;</span>
    <span class="tag">&lt;listener-class&gt;</span>org.apache.shiro.web.env.EnvironmentLoaderListener<span class="tag">&lt;/listener-class&gt;</span>
<span class="tag">&lt;/listener&gt;</span></code></pre> 
           </div> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="__code_isiswebappbootstrapper_code">7.1.2. <code>IsisWebAppBootstrapper</code></h4> 
          <div class="paragraph"> 
           <p>The <code>IsisWebAppBootstrapper</code> servlet context listener bootstraps the shared (global) metadata for the Apache Isis framework. This listener is not required (indeed must not be configured) if the Wicket viewer is in use.</p> 
          </div> 
          <div class="paragraph"> 
           <p>Its definition is:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;listener&gt;</span>
    <span class="tag">&lt;listener-class&gt;</span>org.apache.isis.core.webapp.IsisWebAppBootstrapper<span class="tag">&lt;/listener-class&gt;</span>
<span class="tag">&lt;/listener&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>Its context parameters are:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;context-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>deploymentType<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>SERVER_PROTOTYPE<span class="tag">&lt;/param-value&gt;</span>
<span class="tag">&lt;/context-param&gt;</span>
<span class="tag">&lt;context-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>isis.viewers<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>restfulobjects<span class="tag">&lt;/param-value&gt;</span>
<span class="tag">&lt;/context-param&gt;</span></code></pre> 
           </div> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="__code_resteasybootstrap_code_resteasy">7.1.3. <code>ResteasyBootstrap</code> (RestEasy)</h4> 
          <div class="paragraph"> 
           <p>The <code>ResteasyBootstrap</code> servlet context listener initializes the RestEasy runtime, specifying that classes (namely, those specified in Isis' <code>RestfulObjectsApplication</code>) to be exposed as REST resources. It is required if the Restful Objects viewer is to be deployed.</p> 
          </div> 
          <div class="paragraph"> 
           <p>Its definition is:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;listener&gt;</span>
    <span class="tag">&lt;listener-class&gt;</span>org.jboss.resteasy.plugins.server.servlet.ResteasyBootstrap<span class="tag">&lt;/listener-class&gt;</span>
<span class="tag">&lt;/listener&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>There are two relevant context parameters:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;context-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>javax.ws.rs.Application<span class="tag">&lt;/param-name&gt;</span>        <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tag">&lt;param-value&gt;</span>org.apache.isis.viewer.restfulobjects.server.RestfulObjectsApplication<span class="tag">&lt;/param-value&gt;</span>
<span class="tag">&lt;/context-param&gt;</span>
<span class="tag">&lt;context-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>resteasy.servlet.mapping.prefix<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>/restful/<span class="tag">&lt;/param-value&gt;</span>                    <i class="conum" data-value="2"></i><b>(2)</b>
<span class="tag">&lt;/context-param&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>used by RestEasy to determine the JAX-RS resources and other related configuration</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="2"></i><b>2</b></td> 
              <td>should correspond to the filter mapping of the <code>HttpServletDispatcher</code> servlet</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="__ugbtb_web-xml_servlets">7.2. Servlets</h3> 
         <div class="paragraph"> 
          <p>Servlets process HTTP requests and return corresponding responses.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="__code_httpservletdispatcher_code_resteasy">7.2.1. <code>HttpServletDispatcher</code> (RestEasy)</h4> 
          <div class="paragraph"> 
           <p>This servlet is provided by the RestEasy framework, and does the dispatching to the resources defined by Apache Isis' <code>RestfulObjectsApplication</code> (see above).</p> 
          </div> 
          <div class="paragraph"> 
           <p>Its definition is:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;servlet&gt;</span>
    <span class="tag">&lt;servlet-name&gt;</span>RestfulObjectsRestEasyDispatcher<span class="tag">&lt;/servlet-name&gt;</span>
    <span class="tag">&lt;servlet-class&gt;</span>org.jboss.resteasy.plugins.server.servlet.HttpServletDispatcher<span class="tag">&lt;/servlet-class&gt;</span>
<span class="tag">&lt;/servlet&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>Its mapping is:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;servlet-mapping&gt;</span>
    <span class="tag">&lt;servlet-name&gt;</span>RestfulObjectsRestEasyDispatcher<span class="tag">&lt;/servlet-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>/restful/*<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/servlet-mapping&gt;</span></code></pre> 
           </div> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="__code_resourceservlet_code">7.2.2. <code>ResourceServlet</code></h4> 
          <div class="paragraph"> 
           <p>The <code>ResourceServlet</code> loads and services static content either from the filesystem or from the classpath, each with an appropriate mime type.</p> 
          </div> 
          <div class="paragraph"> 
           <p>Static content here means request paths ending in <code>.js</code>, <code>.css</code>, <code>.html</code>, <code>.png</code>, <code>.jpg</code>, <code>.jpeg</code> and <code>gif</code>.</p> 
          </div> 
          <div class="paragraph"> 
           <p>Its definition is:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;servlet&gt;</span>
    <span class="tag">&lt;servlet-name&gt;</span>Resource<span class="tag">&lt;/servlet-name&gt;</span>
    <span class="tag">&lt;servlet-class&gt;</span>org.apache.isis.core.webapp.content.ResourceServlet<span class="tag">&lt;/servlet-class&gt;</span>
<span class="tag">&lt;/servlet&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>Its mapping is:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;servlet-mapping&gt;</span>
    <span class="tag">&lt;servlet-name&gt;</span>Resource<span class="tag">&lt;/servlet-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>*.css<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/servlet-mapping&gt;</span>
<span class="tag">&lt;servlet-mapping&gt;</span>
    <span class="tag">&lt;servlet-name&gt;</span>Resource<span class="tag">&lt;/servlet-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>*.png<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/servlet-mapping&gt;</span>
<span class="tag">&lt;servlet-mapping&gt;</span>
    <span class="tag">&lt;servlet-name&gt;</span>Resource<span class="tag">&lt;/servlet-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>*.jpg<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/servlet-mapping&gt;</span>
<span class="tag">&lt;servlet-mapping&gt;</span>
    <span class="tag">&lt;servlet-name&gt;</span>Resource<span class="tag">&lt;/servlet-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>*.jpeg<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/servlet-mapping&gt;</span>
<span class="tag">&lt;servlet-mapping&gt;</span>
    <span class="tag">&lt;servlet-name&gt;</span>Resource<span class="tag">&lt;/servlet-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>*.gif<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/servlet-mapping&gt;</span>
<span class="tag">&lt;servlet-mapping&gt;</span>
    <span class="tag">&lt;servlet-name&gt;</span>Resource<span class="tag">&lt;/servlet-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>*.svg<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/servlet-mapping&gt;</span>
<span class="tag">&lt;servlet-mapping&gt;</span>
    <span class="tag">&lt;servlet-name&gt;</span>Resource<span class="tag">&lt;/servlet-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>*.js<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/servlet-mapping&gt;</span>
<span class="tag">&lt;servlet-mapping&gt;</span>
    <span class="tag">&lt;servlet-name&gt;</span>Resource<span class="tag">&lt;/servlet-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>*.html<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/servlet-mapping&gt;</span>
<span class="tag">&lt;servlet-mapping&gt;</span>
    <span class="tag">&lt;servlet-name&gt;</span>Resource<span class="tag">&lt;/servlet-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>*.swf<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/servlet-mapping&gt;</span></code></pre> 
           </div> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="__ugbtb_web-xml_filters">7.3. Filters</h3> 
         <div class="paragraph"> 
          <p>The order in which filters appear in <code>web.xml</code> matters: first to last they define a pipeline. This is shown in the above diagrams, and the subsections also list the in the same order that they should appear in your <code>web.xml</code>.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="__code_shirofilter_code_shiro">7.3.1. <code>ShiroFilter</code> (Shiro)</h4> 
          <div class="paragraph"> 
           <p>Shiro filter that sets up a Shiro security manager for the request, obtained from the Shiro <code>WebEnvironment</code> set up by the Shiro <code>EnvironmentLoaderListener</code> (discussed above).</p> 
          </div> 
          <div class="paragraph"> 
           <p>Its definition is:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;filter&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>ShiroFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;filter-class&gt;</span>org.apache.shiro.web.servlet.ShiroFilter<span class="tag">&lt;/filter-class&gt;</span>
<span class="tag">&lt;/filter&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>Its mapping is:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;filter-mapping&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>ShiroFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>/*<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/filter-mapping&gt;</span></code></pre> 
           </div> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="__code_isislogonexceptionfilter_code">7.3.2. <code>IsisLogOnExceptionFilter</code></h4> 
          <div class="paragraph"> 
           <p>The <code>IsisLogOnExceptionFilter</code> filter simply logs the URL of any request that causes an exception to be thrown, then re-propagates the exception. The use case is simply to ensure that all exceptions are logged (against the <code>IsisLogOnExceptionFilter</code> slf4j appender).</p> 
          </div> 
          <div class="paragraph"> 
           <p>Its definition is:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;filter&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>IsisLogOnExceptionFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;filter-class&gt;</span>org.apache.isis.core.webapp.diagnostics.IsisLogOnExceptionFilter<span class="tag">&lt;/filter-class&gt;</span>
<span class="tag">&lt;/filter&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>Its mapping is:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;filter-mapping&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>IsisLogOnExceptionFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>/wicket/*<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/filter-mapping&gt;</span>
<span class="tag">&lt;filter-mapping&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>IsisLogOnExceptionFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>/restful/*<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/filter-mapping&gt;</span></code></pre> 
           </div> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="__code_resourcecachingfilter_code">7.3.3. <code>ResourceCachingFilter</code></h4> 
          <div class="paragraph"> 
           <p>The <code>ResourceCachingFilter</code> adds HTTP cache headers to specified resources, based on their pattern.</p> 
          </div> 
          <div class="paragraph"> 
           <p>Its definition is:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;filter&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>ResourceCachingFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;filter-class&gt;</span>org.apache.isis.core.webapp.content.ResourceCachingFilter<span class="tag">&lt;/filter-class&gt;</span>
    <span class="tag">&lt;init-param&gt;</span>
        <span class="tag">&lt;param-name&gt;</span>CacheTime<span class="tag">&lt;/param-name&gt;</span>      <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="tag">&lt;param-value&gt;</span>86400<span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;/init-param&gt;</span>
<span class="tag">&lt;/filter&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>cache time, in seconds</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
          <div class="paragraph"> 
           <p>Its mapping is:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;filter-mapping&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>ResourceCachingFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>*.css<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/filter-mapping&gt;</span>
<span class="tag">&lt;filter-mapping&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>ResourceCachingFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>*.png<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/filter-mapping&gt;</span>
<span class="tag">&lt;filter-mapping&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>ResourceCachingFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>*.jpg<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/filter-mapping&gt;</span>
<span class="tag">&lt;filter-mapping&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>ResourceCachingFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>*.jpeg<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/filter-mapping&gt;</span>
<span class="tag">&lt;filter-mapping&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>ResourceCachingFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>*.gif<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/filter-mapping&gt;</span>
<span class="tag">&lt;filter-mapping&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>ResourceCachingFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>*.svg<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/filter-mapping&gt;</span>
<span class="tag">&lt;filter-mapping&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>ResourceCachingFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>*.html<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/filter-mapping&gt;</span>
<span class="tag">&lt;filter-mapping&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>ResourceCachingFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>*.js<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/filter-mapping&gt;</span>
<span class="tag">&lt;filter-mapping&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>ResourceCachingFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>*.swf<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/filter-mapping&gt;</span></code></pre> 
           </div> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="__code_wicketfilter_code">7.3.4. <code>WicketFilter</code></h4> 
          <div class="paragraph"> 
           <p>The <code>WicketFilter</code> is responsible for initiating the handling of Wicket requests.</p> 
          </div> 
          <div class="paragraph"> 
           <p>Its definition is:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;filter&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>WicketFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;filter-class&gt;</span>org.apache.wicket.protocol.http.WicketFilter<span class="tag">&lt;/filter-class&gt;</span>
    <span class="tag">&lt;init-param&gt;</span>
        <span class="tag">&lt;param-name&gt;</span>applicationClassName<span class="tag">&lt;/param-name&gt;</span>   <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="tag">&lt;param-value&gt;</span>domainapp.webapp.SimpleApplication<span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;/init-param&gt;</span>
<span class="tag">&lt;/filter&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>specify the application (subclass of <code>IsisWicketApplication</code>) to use</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
          <div class="paragraph"> 
           <p>Its mapping is:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;filter-mapping&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>WicketFilter<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;url-pattern&gt;</span>/wicket/*<span class="tag">&lt;/url-pattern&gt;</span>
<span class="tag">&lt;/filter-mapping&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>This filter reads one context parameter:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;context-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>configuration<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>deployment<span class="tag">&lt;/param-value&gt;</span>   <i class="conum" data-value="1"></i><b>(1)</b>
<span class="tag">&lt;/context-param&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>alternatively set to "development"; see <a href="../rgcfg/rgcfg.html#_rgcfg_deployment-types">deployment types</a> for further discussion.</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="__code_isissessionfilter_code">7.3.5. <code>IsisSessionFilter</code></h4> 
          <div class="paragraph"> 
           <p>The <code>IsisSessionFilter</code> is responsible for the (persistence) session management; in effect a wrapper around DataNucleus' <code>PersistenceManager</code> object. It is only required for the Restful Objects viewer.</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;filter&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>IsisSessionFilterForRestfulObjects<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;filter-class&gt;</span>org.apache.isis.core.webapp.IsisSessionFilter<span class="tag">&lt;/filter-class&gt;</span>
    <span class="tag">&lt;init-param&gt;</span>
        <span class="tag">&lt;param-name&gt;</span>authenticationSessionStrategy<span class="tag">&lt;/param-name&gt;</span>  <i class="conum" data-value="1"></i><b>(1)</b>
        <span class="tag">&lt;param-value&gt;</span>
            org.apache.isis.viewer.restfulobjects.server.authentication.AuthenticationSessionStrategyBasicAuth
        <span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;/init-param&gt;</span>
    <span class="tag">&lt;init-param&gt;</span>
        <span class="tag">&lt;param-name&gt;</span>whenNoSession<span class="tag">&lt;/param-name&gt;</span>                  <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="tag">&lt;param-value&gt;</span>basicAuthChallenge<span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;/init-param&gt;</span>
    <span class="tag">&lt;init-param&gt;</span>
        <span class="tag">&lt;param-name&gt;</span>passThru<span class="tag">&lt;/param-name&gt;</span>                       <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="tag">&lt;param-value&gt;</span>/restful/swagger<span class="tag">&lt;/param-value&gt;</span>
    <span class="tag">&lt;/init-param&gt;</span>
    <span class="comment">&lt;!-- &lt;init-param&gt; &lt;param-name&gt;restricted&lt;/param-name&gt; <i class="conum" data-value="4"></i><b>(4)</b> &lt;param-value&gt;...&lt;/param-value&gt; &lt;/init-param&gt; &lt;init-param&gt; &lt;param-name&gt;redirectToOnException&lt;/param-name&gt; <i class="conum" data-value="5"></i><b>(5)</b> &lt;param-value&gt;...&lt;/param-value&gt; &lt;/init-param&gt; --&gt;</span>
<span class="tag">&lt;/filter&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>pluggable strategy for determining what the authentication session (credentials) are of the request</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="2"></i><b>2</b></td> 
              <td>what the servlet should do if no existing session was found. Usual values are either <code>unauthorized</code>, <code>basicAuthChallenge</code> or <code>auto</code>. Discussed in more detail below.</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="3"></i><b>3</b></td> 
              <td>specify which URIs to ignore and simply passthru. Originally introduced to allow the <code>SwaggerSpec</code> resource (which does not require a session) to be invoked.</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="4"></i><b>4</b></td> 
              <td>List of paths that are allowed through even if not authenticated. The servlets mapped to these paths are expected to be able to deal with there being no session. Typically they will be logon pages. See below for further details.</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="5"></i><b>5</b></td> 
              <td>where to redirect to if an exception occurs.</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
          <div class="paragraph"> 
           <p>The <code>whenNoSession</code> parameter determines what the behaviour should be if no existing session can be found. There are a number of predetermined values available:</p> 
          </div> 
          <div class="ulist"> 
           <ul> 
            <li> <p><code>unauthorized</code> will generates a 401 response</p> </li> 
            <li> <p><code>basicAuthChallenge</code> will also generate a 401 response, and also issues a Basic Auth challenge using <code>WWW-Authenticate</code> response header</p> </li> 
            <li> <p><code>auto</code> combines the <code>unauthorized</code> and <code>basicAuthChallenge</code> strategies: it will generate a 401 response, but only issues a Basic Auth challenge if it detects that the request originates from a web browser (ie that the HTTP <code>Accept</code> header is set to <code>text/html</code>). This means that custom Javascript apps can perform their authentication correctly, while the REST API can still be explored using the web browser (relying upon the web browser’s in-built support for HTTP Basic Auth).</p> </li> 
            <li> <p><code>continue</code>, in which case the request is allowed to continue but the destination expected to know that there will be no open session</p> </li> 
            <li> <p><code>restricted</code>, which allows access to a restricted list of URLs, otherwise will redirect to the first of that list of URLs</p> </li> 
           </ul> 
          </div> 
          <div class="paragraph"> 
           <p>If accessing the REST API through a web browser, then normally <code>basicAuthChallenge</code> is appropriate; the browser will automatically display a simple prompt. If accessing the REST API through a custom Javascript app, then <code>unauthorized</code> is usually the one to use.</p> 
          </div> 
          <div class="paragraph"> 
           <p>This filter should be mapped to the <code>servlet-name</code> for the RestEasy <code>HttpServletDispatcher</code>; for example:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;filter-mapping&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>IsisSessionFilterForRestfulObjects<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;servlet-name&gt;</span>RestfulObjectsRestEasyDispatcher<span class="tag">&lt;/servlet-name&gt;</span>
<span class="tag">&lt;/filter-mapping&gt;</span></code></pre> 
           </div> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="__code_isistransactionfilterforrestfulobjects_code">7.3.6. <code>IsisTransactionFilterForRestfulObjects</code></h4> 
          <div class="paragraph"> 
           <p>The <code>IsisTransactionFilterForRestfulObjects</code> filter simply ensures that a transaction is in progress for all calls routed to the <a href="../ugvro/ugvro.html">RestfulObjects viewer</a>.</p> 
          </div> 
          <div class="paragraph"> 
           <p>Its definition is:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;filter&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>IsisTransactionFilterForRestfulObjects<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;filter-class&gt;</span>org.apache.isis.viewer.restfulobjects.server.webapp.IsisTransactionFilterForRestfulObjects<span class="tag">&lt;/filter-class&gt;</span>
<span class="tag">&lt;/filter&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>This filter should be mapped to the <code>servlet-name</code> for the RestEasy <code>HttpServletDispatcher</code>; for example:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;filter-mapping&gt;</span>
    <span class="tag">&lt;filter-name&gt;</span>IsisTransactionFilterForRestfulObjects<span class="tag">&lt;/filter-name&gt;</span>
    <span class="tag">&lt;servlet-name&gt;</span>RestfulObjectsRestEasyDispatcher<span class="tag">&lt;/servlet-name&gt;</span>
<span class="tag">&lt;/filter-mapping&gt;</span></code></pre> 
           </div> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="__ugbtb_web-xml_context-parameters">7.4. Configuration Files</h3> 
         <div class="paragraph"> 
          <p>However Apache Isis is bootstrapped (using the <code>IsisWicketApplication</code> or using <code>IsisWebAppBootstrapper</code>), it will read a number of configuration files, such as <code>isis.properties</code>.</p> 
         </div> 
         <div class="paragraph"> 
          <p>By default these are read from <code>WEB-INF</code> directory. This can be overriden using the <code>isis.config.dir</code> context parameter:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;context-param&gt;</span>
  <span class="tag">&lt;param-name&gt;</span>isis.config.dir<span class="tag">&lt;/param-name&gt;</span>
  <span class="tag">&lt;param-value&gt;</span>location of your config directory if fixed<span class="tag">&lt;/param-value&gt;</span>
<span class="tag">&lt;/context-param&gt;</span></code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>Another context parameter, <code>isis.viewres</code> specifies which additional configuration files to search for (over and above the default ones of <code>isis.properties</code> et al):</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;context-param&gt;</span>
    <span class="tag">&lt;param-name&gt;</span>isis.viewers<span class="tag">&lt;/param-name&gt;</span>
    <span class="tag">&lt;param-value&gt;</span>wicket,restfulobjects<span class="tag">&lt;/param-value&gt;</span>
<span class="tag">&lt;/context-param&gt;</span></code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>For example, this will cause <code>viewer_wicket.properties</code> and <code>viewer_restfulobjects.properties</code> to also be loaded.</p> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
    </div> 
    <div class="hidden-xs hidden-sm hidden-md col-lg-3"> 
     <nav id="toc" data-spy="affix" data-toggle="toc"></nav> 
    </div> 
   </div> 
  </div> 
  <footer class="footer"> 
   <div class="container"> 
    <div class="row"> 
     <p class="text-center small text-muted"> Copyright © 2010~2017 The Apache&nbsp;Software&nbsp;Foundation, licensed under the Apache&nbsp;License,&nbsp;v2.0. <br> Apache, the Apache feather logo, Apache&nbsp;Isis, and the Apache&nbsp;Isis project logo are all trademarks of The&nbsp;Apache&nbsp;Software&nbsp;Foundation. </p> 
    </div> 
   </div> 
  </footer> 
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script> 
  <script src="../../js/bootstrap/3.3.7/bootstrap.min.js"></script> 
  <script src="../../js/bootstrap-toc/0.4.1/bootstrap-toc.min.js"></script> 
  <script src="../../js/slick/1.5.0/slick.min.js"></script> 
  <script src="../../js/elasticlunr/elasticlunr.min.js"></script> 
  <script src="../../js/sticky-header/sticky-header.js"></script> 
  <script src="../../js/search-panel/search-panel.js"></script> 
  <script src="../../js/header-link/header-link.js"></script> 
  <script src="../../js/toc-scroll/toc-scroll.js"></script>  
 </body>
</html>
