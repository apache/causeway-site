<!doctype html>
<html>
 <head> 
  <!--
        Licensed to the Apache Software Foundation (ASF) under one
        or more contributor license agreements.  See the NOTICE file
        distributed with this work for additional information
        regarding copyright ownership.  The ASF licenses this file
        to you under the Apache License, Version 2.0 (the
        "License"); you may not use this file except in compliance
        with the License.  You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

        Unless required by applicable law or agreed to in writing,
        software distributed under the License is distributed on an
        "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
        KIND, either express or implied.  See the License for the
        specific language governing permissions and limitations
        under the License.
    --> 
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
  <meta charset="utf-8"> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <!-- No caching headers --> 
  <meta http-equiv="cache-control" content="no-cache"> 
  <meta http-equiv="pragma" content="no-cache"> 
  <meta http-equiv="expires" content="-1"> 
  <title>Hints &amp; Tips Guide</title> 
  <link rel="icon" type="image/png" href="../../images/isis-favicon.png"> 
  <!--
        Based on DataNucleus' template,
        that was in turn based on an earlier version of Apache Isis' template,
        that was in turn based on Apache Deltaspike's template.

        This template uses
        * Bootstrap v3.3.7 (https://getbootstrap.com/) for navbar.
        * Bootstrap TOC plugin v0.4.1 (https://afeld.github.io/bootstrap-toc/)
          for the table of contents.
        * jQuery (necessary for Bootstrap's JavaScript plugins)
        * Font-Awesome for some icons used by Asciidoctor

        Also:
        * Bootswatch "flatly" theme for Bootstrap (https://bootswatch.com/flatly).
        * slick.js (carousel)
        * add a link to all headers (home-grown, adapted from blog posts)
        * integration of elasticlunr.js (home-grown, adapted from blog posts)
    --> 
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet"> 
  <link href="../../css/bootstrap-toc/0.4.1/bootstrap-toc.min.css" rel="stylesheet"> 
  <link href="../../css/asciidoctor/foundation.css" rel="stylesheet"> 
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet"> 
  <link href="../../css/slick/1.5.0/slick.css" rel="stylesheet"> 
  <link href="../../css/slick/1.5.0/slick-theme.css" rel="stylesheet"> 
  <link href="../../css/search-panel/search-panel.css" rel="stylesheet"> 
  <link href="../../css/header-links/header-links.css" rel="stylesheet"> 
  <link href="../../css/sticky-header/sticky-header.css" rel="stylesheet"> 
  <link href="../../css/customisations.css" rel="stylesheet"> 
  <!-- Coderay syntax formatter --> 
  <style type="text/css">
        /* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{color:rgba(0,0,0,.4)}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top;line-height:1.45}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
    </style> 
 </head> 
 <body data-spy="scroll" data-target="#toc"> 
  <div id="basedir" style="display:none;">
   ../../
  </div> 
  <div id="docname" style="display:none;">
   htg
  </div> 
  <div id="filetype" style="display:none;">
   html
  </div> 
  <!-- Navbar --> 
  <nav class="navbar navbar-default navbar-static-top header"> 
   <div class="container"> 
    <div class="navbar-header"> 
     <!-- Three line menu button for use on mobile screens --> 
     <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> 
     <a class="navbar-brand" href="../../index.html"> <img alt="Brand" src="../../images/isis-logo-48x48.png"> </a> 
     <a class="navbar-brand" href="../../index.html">Apache Isis</a> 
    </div> 
    <!-- Navbar that will collapse on mobile screens --> 
    <div id="navbar" class="navbar-collapse collapse"> 
     <ul class="nav navbar-nav"> 
      <li class="dropdown"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation<span class="caret"></span></a> 
       <ul class="dropdown-menu"> 
        <li><a href="../../documentation.html">Table of Contents</a></li> 
        <li role="separator" class="divider"></li> 
        <li class="dropdown-header">User Guides</li> 
        <li><a href="../../guides/ugfun/ugfun.html">Fundamentals</a></li> 
        <li><a href="../../guides/ugvw/ugvw.html">Wicket Viewer</a></li> 
        <li><a href="../../guides/ugvro/ugvro.html">Restful Objects Viewer</a></li> 
        <li><a href="../../guides/ugodn/ugodn.html">DataNucleus Object Store</a></li> 
        <li><a href="../../guides/ugsec/ugsec.html">Security</a></li> 
        <li><a href="../../guides/ugtst/ugtst.html">Testing</a></li> 
        <li><a href="../../guides/ugbtb/ugbtb.html">Beyond the Basics</a></li> 
        <li role="separator" class="divider"></li> 
        <li class="dropdown-header">Reference Guides</li> 
        <li><a href="../../guides/rgant/rgant.html">Annotations</a></li> 
        <li><a href="../../guides/rgsvc/rgsvc.html">Domain Services</a></li> 
        <li><a href="../../guides/rgcfg/rgcfg.html">Core Config' Properties</a></li> 
        <li><a href="../../guides/rgcms/rgcms.html">Classes, Methods and Schema</a></li> 
        <li><a href="../../guides/rgmvn/rgmvn.html">Maven plugin</a></li> 
        <li><a href="../../guides/rgfis/rgfis.html">Framework Internal Services</a></li> 
        <li role="separator" class="divider"></li> 
        <li class="dropdown-header">Javadoc</li> 
        <li><a href="http://javadoc.io/doc/org.apache.isis.core/isis-core-applib">Applib</a></li> 
       </ul> </li> 
      <li class="dropdown  hidden-sm hidden-md"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Downloads<span class="caret"></span></a> 
       <ul class="dropdown-menu"> 
        <li class="dropdown-header">Maven archetypes</li> 
        <li><a href="../../guides/ugfun/ugfun.html#_ugfun_getting-started_helloworld-archetype">helloworld</a></li> 
        <li><a href="../../guides/ugfun/ugfun.html#_ugfun_getting-started_simpleapp-archetype">simpleapp</a></li> 
        <li role="separator" class="divider"></li> 
        <li><a href="../../downloads.html">Downloads</a></li> 
        <li><a href="../../release-notes/release-notes.html">Release Notes</a></li> 
        <li><a href="../../migration-notes/migration-notes.html">Migration Notes</a></li> 
        <li role="separator" class="divider"></li> 
        <li><a href="https://github.com/apache/isis">Github mirror</a></li> 
       </ul> </li> 
      <li class="dropdown  hidden-sm"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Support<span class="caret"></span></a> 
       <ul class="dropdown-menu"> 
        <li class="dropdown-header">Guides</li> 
        <li><a href="../../guides/dg/dg.html">Developers' Guide</a></li> 
        <li><a href="../../guides/cgcom/cgcom.html">Committers' Guide</a></li> 
        <li><a href="../../guides/htg.html">Hints-n-Tips Guide</a></li> 
        <li role="separator" class="divider"></li> 
        <li class="dropdown-header">Mailing Lists</li> 
        <li><a href="../../support.html">How to subscribe</a></li> 
        <li><a href="https://lists.apache.org/list.html?users@isis.apache.org">Archives (ASF Pony mail)</a></li> 
        <li><a href="http://isis.markmail.org/search/?q=">Archives (Markmail)</a></li> 
        <li role="separator" class="divider"></li> 
        <li class="dropdown-header">Other Resources</li> 
        <li><a href="https://issues.apache.org/jira/browse/ISIS">ASF JIRA</a></li> 
        <li><a href="https://stackoverflow.com/questions/tagged/isis">Stack Overflow</a></li> 
        <li><a href="../../help.html">Wiki, Fisheye etc.</a></li> 
       </ul> </li> 
      <li class="dropdown hidden-sm hidden-md"> <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">@ASF<span class="caret"></span></a> 
       <ul class="dropdown-menu"> 
        <li><a href="https://www.apache.org/">Apache Homepage</a></li> 
        <li><a href="https://www.apache.org/events/current-event">Events</a></li> 
        <li><a href="https://www.apache.org/licenses/">Licenses</a></li> 
        <li><a href="https://www.apache.org/security/">Security</a></li> 
        <li><a href="https://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li> 
        <li><a href="https://www.apache.org/foundation/thanks.html">Thanks</a></li> 
        <li role="separator" class="divider"></li> 
        <li><a href="https://whimsy.apache.org/board/minutes/Isis.html">PMC board minutes</a></li> 
       </ul> </li> 
     </ul> 
     <div class="nav navbar-nav navbar-right"> 
      <!-- 'style' added to fix height of input box. FIX THIS --> 
      <form class="navbar-form" role="search" id="search-form" style="padding: 1px 15px;"> 
       <div class="form-group"> 
        <input class="form-control" id="search-field" type="text" size="30" placeholder="Search"> 
       </div> 
      </form> 
     </div> 
     <p class="nav navbar-text navbar-right small">v1.17.0</p> 
    </div> 
   </div> 
  </nav> 
  <div class="container"> 
   <div class="row-fluid"> 
    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-9"> 
     <div id="search-panel"> 
      <div id="search-results"></div> 
      <div> 
       <br> 
       <a href="#" id="search-results-clear">clear</a> 
      </div> 
     </div> 
     <div class="page-title"> 
      <h1>Hints &amp; Tips Guide</h1> 
     </div> 
     <div id="doc-content">
      <div class="btn-group" style="float: right; font-size: small; padding: 6px;  ">
       <button type="button" class="btn btn-xs btn-default" onclick="window.location.href=&quot;https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/htg.adoc&quot;"><i class="fa fa-pencil-square-o"></i>&nbsp;Edit</button>
       <button type="button" class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="caret"></span><span class="sr-only">Toggle Dropdown</span></button>
       <ul class="dropdown-menu">
        <li><a href="https://github.com/apache/isis/edit/master/adocs/documentation/src/main/asciidoc/guides/htg.adoc" target="_blank"><i class="fa fa-pencil-square-o fa-fw" aria-hidden="true"></i>&nbsp; Edit</a></li>
        <li><a href="https://github.com/apache/isis/commits/master/adocs/documentation/src/main/asciidoc/guides/htg.adoc" target="_blank"><i class="fa fa-clock-o fa-fw" aria-hidden="true"></i>&nbsp; History</a></li>
        <li><a href="https://github.com/apache/isis/raw/master/adocs/documentation/src/main/asciidoc/guides/htg.adoc" target="_blank"><i class="fa fa-file-text-o fa-fw" aria-hidden="true"></i>&nbsp; Raw</a></li>
        <li><a href="https://github.com/apache/isis/blame/master/adocs/documentation/src/main/asciidoc/guides/htg.adoc" target="_blank"><i class="fa fa-hand-o-right fa-fw" aria-hidden="true"></i>&nbsp; Blame</a></li>
       </ul>
      </div> 
      <div id="preamble"> 
       <div class="sectionbody"> 
        <div class="paragraph"> 
         <p>This document brings together the hints-n-tips chapters from the various user guides.</p> 
        </div> 
       </div> 
      </div> 
      <div class="sect1"> 
       <h2 id="_fundamentals_ui_hints">1. Fundamentals (UI Hints)</h2> 
       <div class="sectionbody"> 
        <div class="paragraph"> 
         <p>Hints and tips for the most commonly used techniques for customising the way that the framework renders domain objects in the user interface. Taken from the <a href="#ugfun/ugfun.adoc">Fundamentals</a> guide.</p> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugfun_ui-hints_layout">1.1. Layout</h3> 
         <div class="paragraph"> 
          <p>The most significant aspect of the UI is the layout of the object’s members: its properties, collections and actions. These can be organized into columns, rows and tabs.</p> 
         </div> 
         <div class="paragraph"> 
          <p>This can be accomplished using either annotations or through a separate file-based layout. Since this is a large topic, it has its own <a href="../ugvw/ugvw.html#_ugvw_layout">layout chapter</a> in the Wicket viewer guide.</p> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugfun_ui-hints_object-titles-and-icons">1.2. Object Titles and Icons</h3> 
         <div class="paragraph"> 
          <p>In Apache Isis every object is identified to the user by a title (label) and an icon. This is shown in several places: as the main heading for an object; as a link text for an object referencing another object, and also in tables representing collections of objects.</p> 
         </div> 
         <div class="paragraph"> 
          <p>The icon is often the same for all instances of a particular class, but it’s also possible for an individual instance to return a custom icon. This could represent the state of that object (eg a shipped order, say, or overdue library book).</p> 
         </div> 
         <div class="paragraph"> 
          <p>It is also possible for an object to provide a CSS class hint. In conjunction with <a href="../ugvw/ugvw.html#_ugvw_customisation_tweaking-css-classes">customized CSS</a> this can be used to apply arbitrary styling; for example each object could be rendered in a page with a different background colour.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="_object_title">1.2.1. Object Title</h4> 
          <div class="paragraph"> 
           <p>The object title is a label to identify an object to the end-user. Generally the object title is a label to identify an object to the end-user. There is no requirement for it to be absolutely unique, but it should be "unique enough" to distinguish the object from other object’s likely to be rendered on the same page.</p> 
          </div> 
          <div class="paragraph"> 
           <p>The title is always shown with an icon, so there is generally no need for the title to include information about the object’s type. For example the title of a customer object shouldn’t include the literal string "Customer"; it can just have the customer’s name, reference or some other meaningful business identifier.</p> 
          </div> 
          <div class="sect4"> 
           <h5 id="_declarative_style">Declarative style</h5> 
           <div class="paragraph"> 
            <p>The <a href="../rgant/rgant.html#_rgant-Title"><code>@Title</code></a> annotation can be used build up the title of an object from its constituent parts.</p> 
           </div> 
           <div class="paragraph"> 
            <p>For example:</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Customer</span> {
    <span class="annotation">@Title</span>(sequence=<span class="string"><span class="delimiter">"</span><span class="content">1</span><span class="delimiter">"</span></span>, append=<span class="string"><span class="delimiter">"</span><span class="content"> </span><span class="delimiter">"</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getFirstName() { ... }
    <span class="annotation">@Title</span>(sequence=<span class="string"><span class="delimiter">"</span><span class="content">2</span><span class="delimiter">"</span></span>)
    <span class="directive">public</span> Product getLastName() { ... }
    ...
}</code></pre> 
            </div> 
           </div> 
           <div class="paragraph"> 
            <p>might return "Arthur Clarke", while:</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">CustomerAlt</span> {
    <span class="annotation">@Title</span>(sequence=<span class="string"><span class="delimiter">"</span><span class="content">2</span><span class="delimiter">"</span></span>, prepend=<span class="string"><span class="delimiter">"</span><span class="content">, </span><span class="delimiter">"</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getFirstName() { ... }

    <span class="annotation">@Title</span>(sequence=<span class="string"><span class="delimiter">"</span><span class="content">1</span><span class="delimiter">"</span></span>)
    <span class="directive">public</span> Product getLastName() { ... }
    ...
}</code></pre> 
            </div> 
           </div> 
           <div class="paragraph"> 
            <p>could return "Clarke, Arthur".</p> 
           </div> 
           <div class="paragraph"> 
            <p>Note that the sequence is in Dewey Decimal Format. This allows a subclass to intersperse information within the title. For example (please forgive this horrible domain modelling (!)):</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Author</span> <span class="directive">extends</span> Customer {
    <span class="annotation">@Title</span>(sequence=<span class="string"><span class="delimiter">"</span><span class="content">1.5</span><span class="delimiter">"</span></span>, append=<span class="string"><span class="delimiter">"</span><span class="content">. </span><span class="delimiter">"</span></span>)
    <span class="directive">public</span> <span class="predefined-type">String</span> getMiddleInitial() { ... }
    ...
}</code></pre> 
            </div> 
           </div> 
           <div class="paragraph"> 
            <p>could return "Arthur C. Clarke".</p> 
           </div> 
           <div class="admonitionblock tip"> 
            <table> 
             <tbody>
              <tr> 
               <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> 
               <td class="content"> 
                <div class="paragraph"> 
                 <p>Titles can sometimes get be long and therefore rather cumbersome in "parented" tables. If <code>@Title</code> has been used then the Wicket viewer will automatically exclude portions of the title belonging to the owning object.</p> 
                </div> </td> 
              </tr> 
             </tbody>
            </table> 
           </div> 
          </div> 
          <div class="sect4"> 
           <h5 id="_imperative_style">Imperative style</h5> 
           <div class="paragraph"> 
            <p>Alternatively, the title can be provided simply by implementing the <a href="../rgcms/rgcms.html#_rgcms_methods_reserved_title"><code>title()</code></a> reserved method.</p> 
           </div> 
           <div class="paragraph"> 
            <p>For example:</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Author</span> <span class="directive">extends</span> Customer {

    <span class="directive">public</span> <span class="predefined-type">String</span> title() {
        <span class="predefined-type">StringBuilder</span> buf = <span class="keyword">new</span> <span class="predefined-type">StringBuilder</span>();
        buf.append(getFirstName());
        <span class="keyword">if</span>(getMiddleInitial() != <span class="predefined-constant">null</span>) {
            buf.append(getMiddleInitial()).append(<span class="string"><span class="delimiter">"</span><span class="content">. </span><span class="delimiter">"</span></span>);
        }
        buf.append(getLastName();
        <span class="keyword">return</span> buf.toString();
    }
    ...
}</code></pre> 
            </div> 
           </div> 
           <div class="paragraph"> 
            <p>A variation on this approach also supports localized names; see <a href="../ugbtb/ugbtb.html#_ugbtb_i18n">beyond-the-basics</a> guide for further details.</p> 
           </div> 
          </div> 
          <div class="sect4"> 
           <h5 id="_using_a_ui_subscriber">Using a UI subscriber</h5> 
           <div class="paragraph"> 
            <p>A third alternative is to move the responsibility for deriving the title into a separate subscriber object.</p> 
           </div> 
           <div class="paragraph"> 
            <p>In the target object, we define an appropriate event type and use the <a href="../rgant/rgant.html#_rgant-DomainObjectLayout_titleUiEvent"><code>@DomainObjectLayout#titleUiEvent()</code></a> attribute to specify:</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@DomainObjectLayout</span>(
    titleUiEvent = Author.TitleUiEvent.class
)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Author</span> <span class="directive">extends</span> Customer {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">TitleUiEvent</span>
            <span class="directive">extends</span> org.apache.isis.applib.services.eventbus.TitleUiEvent&lt;Author&gt; {}
    ...
}</code></pre> 
            </div> 
           </div> 
           <div class="paragraph"> 
            <p>The subscriber can then populate this event:</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@DomainService</span>(nature=NatureOfService.DOMAIN)
<span class="directive">public</span> <span class="type">class</span> <span class="class">AuthorSubscriptions</span> <span class="directive">extends</span> AbstractSubscriber {

    <span class="annotation">@org</span>.axonframework.eventhandling.annotation.EventHandler
    <span class="annotation">@com</span>.google.common.eventbus.Subscribe
    <span class="directive">public</span> <span class="type">void</span> on(Author.TitleUiEvent ev) {
        Author author = ev.getSource();
        ev.setTitle(titleOf(author);
    }

    <span class="directive">private</span> <span class="predefined-type">String</span> titleOf(Author author) {
        <span class="predefined-type">StringBuilder</span> buf = <span class="keyword">new</span> <span class="predefined-type">StringBuilder</span>();
        buf.append(author.getFirstName());
        <span class="keyword">if</span>(author.getMiddleInitial() != <span class="predefined-constant">null</span>) {
            buf.append(author.getMiddleInitial()).append(<span class="string"><span class="delimiter">"</span><span class="content">. </span><span class="delimiter">"</span></span>);
        }
        buf.append(author.getLastName();
        <span class="keyword">return</span> buf.toString();
    }
}</code></pre> 
            </div> 
           </div> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_object_icon">1.2.2. Object Icon</h4> 
          <div class="paragraph"> 
           <p>The icon is often the same for all instances of a particular class, and is picked up by convention.</p> 
          </div> 
          <div class="paragraph"> 
           <p>It’s is also possible for an individual instance to return a custom icon, typically so that some significant state of that domain object is represented. For example, a custom icon could be used to represent a shipped order, say, or an overdue library loan.</p> 
          </div> 
          <div class="sect4"> 
           <h5 id="_declarative_style_2">Declarative style</h5> 
           <div class="paragraph"> 
            <p>If there is no requirement to customize the icon (the normal case), then the icon is usually picked up as the <code>.png</code> file in the same package as the class. For example, the icon for a class <code>org.mydomain.myapp.Customer</code> will be <code>org/mydomain/myapp/Customer.png</code> (if it exists).</p> 
           </div> 
           <div class="paragraph"> 
            <p>Alternatively, font-awesome icon can be used. This is specified using the <a href="../rgant/rgant.html#_rgant-DomainObjectLayout_cssClassFa"><code>@DomainObjectLayout#cssClassFa()</code></a> attribute.</p> 
           </div> 
           <div class="paragraph"> 
            <p>For example:</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@DomainObjectLayout</span>(
    cssClassFa=<span class="string"><span class="delimiter">"</span><span class="content">play</span><span class="delimiter">"</span></span>               <i class="conum" data-value="1"></i><b>(1)</b>
)
<span class="directive">public</span> <span class="type">class</span> <span class="class">InvoiceRun</span> {
    ...
}</code></pre> 
            </div> 
           </div> 
           <div class="colist arabic"> 
            <table> 
             <tbody>
              <tr> 
               <td><i class="conum" data-value="1"></i><b>1</b></td> 
               <td>will use the "fa-play" icon.</td> 
              </tr> 
             </tbody>
            </table> 
           </div> 
          </div> 
          <div class="sect4"> 
           <h5 id="_imperative_style_2">Imperative style</h5> 
           <div class="paragraph"> 
            <p>To customise the icon on an instance-by-instance basis, we implement the reserved <a href="../rgcms/rgcms.html#_rgcms_methods_reserved_iconName"><code>iconName()</code></a> method.</p> 
           </div> 
           <div class="paragraph"> 
            <p>For example:</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Order</span> {
    <span class="directive">public</span> <span class="predefined-type">String</span> iconName() {
        <span class="keyword">return</span> isShipped() ? <span class="string"><span class="delimiter">"</span><span class="content">shipped</span><span class="delimiter">"</span></span>: <span class="predefined-constant">null</span>;
    }
    ...
}</code></pre> 
            </div> 
           </div> 
           <div class="paragraph"> 
            <p>In this case, if the <code>Order</code> has shipped then the framework will look for an icon image named "Order-shipped.png" (in the same package as the class). Otherwise it will just use "Order.png", as normal.</p> 
           </div> 
          </div> 
          <div class="sect4"> 
           <h5 id="_using_a_ui_subscriber_2">Using a UI subscriber</h5> 
           <div class="paragraph"> 
            <p>As for title, the determination of which image file to use for the icon can be externalized into a UI event subscriber.</p> 
           </div> 
           <div class="paragraph"> 
            <p>In the target object, we define an appropriate event type and use the <a href="../rgant/rgant.html#_rgant-DomainObjectLayout_iconUiEvent"><code>@DomainObjectLayout#iconUiEvent()</code></a> attribute to specify.</p> 
           </div> 
           <div class="paragraph"> 
            <p>For example</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@DomainObjectLayout</span>(
    iconUiEvent = Author.IconUiEvent.class
)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Order</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">IconUiEvent</span>
            <span class="directive">extends</span> org.apache.isis.applib.services.eventbus.IconUiEvent&lt;Order&gt; {}
    ...
}</code></pre> 
            </div> 
           </div> 
           <div class="paragraph"> 
            <p>The subscriber can then populate this event:</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@DomainService</span>(nature=NatureOfService.DOMAIN)
<span class="directive">public</span> <span class="type">class</span> <span class="class">OrderSubscriptions</span> <span class="directive">extends</span> AbstractSubscriber {

    <span class="annotation">@org</span>.axonframework.eventhandling.annotation.EventHandler
    <span class="annotation">@com</span>.google.common.eventbus.Subscribe
    <span class="directive">public</span> <span class="type">void</span> on(Order.IconUiEvent ev) {
        Order order = ev.getSource();
        ev.setIconName(iconNameOf(order);
    }

    <span class="directive">private</span> <span class="predefined-type">String</span> iconNameOf(Order order) {
        <span class="predefined-type">StringBuilder</span> buf = <span class="keyword">new</span> <span class="predefined-type">StringBuilder</span>();
        <span class="keyword">return</span> order.isShipped() ? <span class="string"><span class="delimiter">"</span><span class="content">shipped</span><span class="delimiter">"</span></span>: <span class="predefined-constant">null</span>;
    }
}</code></pre> 
            </div> 
           </div> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_object_css_styling">1.2.3. Object CSS Styling</h4> 
          <div class="paragraph"> 
           <p>It is also possible for an object to return a <a href="../rgcms/rgcms.html#_rgcms_methods_reserved_cssClass">CSS class</a>. In conjunction with <a href="../ugvw/ugvw.html#_ugvw_customisation_tweaking-css-classes">customized CSS</a> this can be used to apply arbitrary styling; for example each object could be rendered in a page with a different background colour.</p> 
          </div> 
          <div class="sect4"> 
           <h5 id="_declarative_style_3">Declarative style</h5> 
           <div class="paragraph"> 
            <p>To render an object with a particular CSS, use <a href="../rgant/rgant.html#_rgant-DomainObjectLayout_cssClass"><code>@DomainObjectLayout#cssClass()</code></a>.</p> 
           </div> 
           <div class="paragraph"> 
            <p>When the domain object is rendered on its own page, this CSS class will appear on a top-level <code>&lt;div&gt;</code>. Or, when the domain object is rendered as a row in a collection, then the CSS class will appear in a <code>&lt;div&gt;</code> wrapped by the <code>&lt;tr&gt;</code> of the row.</p> 
           </div> 
           <div class="paragraph"> 
            <p>One possible use case would be to render the most important object types with a subtle background colour: <code>Customer</code>s shown in light green, or <code>Order</code>s shown in a light pink, for example.</p> 
           </div> 
          </div> 
          <div class="sect4"> 
           <h5 id="_imperative_style_3">Imperative style</h5> 
           <div class="paragraph"> 
            <p>To customise the icon on an instance-by-instance basis, we implement the reserved <a href="../rgcms/rgcms.html#_rgcms_methods_reserved_cssClass"><code>cssClass()</code></a> method.</p> 
           </div> 
           <div class="paragraph"> 
            <p>For example:</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Order</span> {
    <span class="directive">public</span> <span class="predefined-type">String</span> cssClass() {
        <span class="keyword">return</span> isShipped() ? <span class="string"><span class="delimiter">"</span><span class="content">shipped</span><span class="delimiter">"</span></span>: <span class="predefined-constant">null</span>;       <i class="conum" data-value="1"></i><b>(1)</b>
    }
    ...
}</code></pre> 
            </div> 
           </div> 
           <div class="colist arabic"> 
            <table> 
             <tbody>
              <tr> 
               <td><i class="conum" data-value="1"></i><b>1</b></td> 
               <td>the implementation might well be the same as the <code>iconName()</code>.</td> 
              </tr> 
             </tbody>
            </table> 
           </div> 
           <div class="paragraph"> 
            <p>If non-null value is returned then the CSS class will be rendered <em>in addition</em> to any declarative CSS class also specified.</p> 
           </div> 
          </div> 
          <div class="sect4"> 
           <h5 id="_using_a_ui_subscriber_3">Using a UI subscriber</h5> 
           <div class="paragraph"> 
            <p>As for title and icon, the determination of which CSS class to render can be externalized into a UI event subscriber.</p> 
           </div> 
           <div class="paragraph"> 
            <p>In the target object, we define an appropriate event type and use the <a href="../rgant/rgant.html#_rgant-DomainObjectLayout_cssClassUiEvent"><code>@DomainObjectLayout#cssClassUiEvent()</code></a> attribute to specify.</p> 
           </div> 
           <div class="paragraph"> 
            <p>For example</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@DomainObjectLayout</span>(
    cssClassUiEvent = Author.CssClassUiEvent.class
)
<span class="directive">public</span> <span class="type">class</span> <span class="class">Order</span> {
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">CssClassUiEvent</span>
            <span class="directive">extends</span> org.apache.isis.applib.services.eventbus.CssClassUiEvent&lt;Order&gt; {}
    ...
}</code></pre> 
            </div> 
           </div> 
           <div class="paragraph"> 
            <p>The subscriber can then populate this event:</p> 
           </div> 
           <div class="listingblock"> 
            <div class="content"> 
             <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@DomainService</span>(nature=NatureOfService.DOMAIN)
<span class="directive">public</span> <span class="type">class</span> <span class="class">OrderSubscriptions</span> <span class="directive">extends</span> AbstractSubscriber {

    <span class="annotation">@org</span>.axonframework.eventhandling.annotation.EventHandler
    <span class="annotation">@com</span>.google.common.eventbus.Subscribe
    <span class="directive">public</span> <span class="type">void</span> on(Order.CssClassUiEvent ev) {
        Order order = ev.getSource();
        ev.setIconName(iconNameOf(order);
    }

    <span class="directive">private</span> <span class="predefined-type">String</span> cssClassOf(Order order) {
        <span class="predefined-type">StringBuilder</span> buf = <span class="keyword">new</span> <span class="predefined-type">StringBuilder</span>();
        <span class="keyword">return</span> order.isShipped() ? <span class="string"><span class="delimiter">"</span><span class="content">shipped</span><span class="delimiter">"</span></span>: <span class="predefined-constant">null</span>;
    }
}</code></pre> 
            </div> 
           </div> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugfun_ui-hints_action-icons-and-css">1.3. Action Icons and CSS</h3> 
         <div class="paragraph"> 
          <p>Apache Isis allows <a href="http://fortawesome.github.io/Font-Awesome/icons/">font awesome</a> icons to be associated with each action, and for <a href="http://getbootstrap.com/css/#buttons">Bootstrap CSS</a> to be applied to action rendered as buttons. These UI hints can be applied either to individual actions, or can be applied en-masse using pattern matching.</p> 
         </div> 
         <div class="paragraph"> 
          <p>It is also possible to specify additional CSS for an object’s members (not just actions).</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="_icons">1.3.1. Icons</h4> 
          <div class="paragraph"> 
           <p>Action icons can be specified in several ways.</p> 
          </div> 
          <div class="paragraph"> 
           <p>One option is to use the <a href="../rgant/rgant.html#_rgant-ActionLayout_cssClassFa"><code>@ActionLayout#cssClassFa()</code></a>. For example:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@ActionLayout</span>(cssClassFa=<span class="string"><span class="delimiter">"</span><span class="content">refresh</span><span class="delimiter">"</span></span>)
<span class="directive">public</span> <span class="type">void</span> renew() {
    ...
}</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>Alternatively, you can specify these hints dynamically in the <a href="../ugvw/ugvw.html#_ugvw_layout"><code>Xxx.layout.xml</code></a> for the entity:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;cpt:action</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">"</span><span class="content">renew</span><span class="delimiter">"</span></span> <span class="attribute-name">cssClassFa</span>=<span class="string"><span class="delimiter">"</span><span class="content">refresh</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>Rather than annotating every action with <a href="../rgant/rgant.html#_rgant-ActionLayout_cssClassFa"><code>@ActionLayout#cssClassFa()</code></a> and <a href="../rgant/rgant.html#_rgant-ActionLayout_cssClass"><code>@ActionLayout#cssClass()</code></a> you can instead specify the UI hint globally using regular expressions. Not only does this save a lot of boilerplate/editing, it helps ensure consistency across all actions.</p> 
          </div> 
          <div class="paragraph"> 
           <p>To declare fa classes globally, use the <a href="../rgcfg/rgcfg.html#_rgcfg_configuring-core">configuration property</a> <code>isis.reflector.facet.cssClassFa.patterns</code> (a comma separated list of key:value pairs).</p> 
          </div> 
          <div class="paragraph"> 
           <p>For example:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="ini">isis.reflector.facet.cssClassFa.patterns=\
                        new.*:fa-plus,\
                        add.*:fa-plus-square,\
                        create.*:fa-plus,\
                        renew.*:fa-refresh,\
                        list.*:fa-list, \
                        all.*:fa-list, \
                        download.*:fa-download, \
                        upload.*:fa-upload, \
                        execute.*:fa-bolt, \
                        run.*:fa-bolt</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>Here:</p> 
          </div> 
          <div class="ulist"> 
           <ul> 
            <li> <p>the key is a regex matching action names (eg <code>create.*</code>), and</p> </li> 
            <li> <p>the value is a <a href="http://fortawesome.github.io/Font-Awesome/icons/">font-awesome</a> icon name</p> </li> 
           </ul> 
          </div> 
          <div class="paragraph"> 
           <p>For example, "fa-plus" is applied to all action members called "newXxx"</p> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_css">1.3.2. CSS</h4> 
          <div class="paragraph"> 
           <p>Similarly, a CSS class can be specified for object members:</p> 
          </div> 
          <div class="ulist"> 
           <ul> 
            <li> <p><a href="../rgant/rgant.html#_rgant-ActionLayout_cssClass"><code>@ActionLayout#cssClass()</code></a> for actions</p> </li> 
            <li> <p><a href="../rgant/rgant.html#_rgant-PropertyLayout_cssClass"><code>@PropertyLayout#cssClass()</code></a> for properties, and</p> </li> 
            <li> <p><a href="../rgant/rgant.html#_rgant-CollectionLayout_cssClass"><code>@CollectionLayout#cssClass()</code></a> for collections.</p> </li> 
           </ul> 
          </div> 
          <div class="paragraph"> 
           <p>Again, this CSS class will be attached to an appropriate containing <code>&lt;div&gt;</code> or <code>&lt;span&gt;</code> on the rendered page.</p> 
          </div> 
          <div class="paragraph"> 
           <p>Possible use cases for this is to highlight the most important properties of a domain object.</p> 
          </div> 
          <div class="paragraph"> 
           <p>It is also possible to specify CSS classes globally, using the <a href="../rgcfg/rgcfg.html#_rgcfg_configuring-core">configuration property</a> <code>isis.reflector.facet.cssClass.patterns</code> configuration property.</p> 
          </div> 
          <div class="paragraph"> 
           <p>For example:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="ini">isis.reflector.facet.cssClass.patterns=\
                        delete.*:btn-warning</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>where (again):</p> 
          </div> 
          <div class="ulist"> 
           <ul> 
            <li> <p>the key is a regex matching action names (eg <code>delete.*</code>), and</p> </li> 
            <li> <p>the value is a <a href="http://getbootstrap.com/css/">Bootstrap</a> CSS button class (eg `btn-warning) to be applied</p> </li> 
           </ul> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugfun_ui-hints_names-and-descriptions">1.4. Names and Descriptions</h3> 
         <div class="paragraph"> 
          <p>The name of classes and class members are usually inferred from the Java source code directly. For example, an action method called <code>placeOrder</code> will be rendered as "Place Order", and a collection called <code>orderItems</code> is rendered as "Order Items".</p> 
         </div> 
         <div class="paragraph"> 
          <p>Occasionally though the desired name is not possible; either the name is a Java reserved word (eg "class"), or might require characters that are not valid, for example abbreviations.</p> 
         </div> 
         <div class="paragraph"> 
          <p>In such cases the name can be specified declaratively.</p> 
         </div> 
         <div class="paragraph"> 
          <p>It is also possible to specify a description declaratively; this is used as a tooltip in the UI.</p> 
         </div> 
         <div class="paragraph"> 
          <p>The table below summarizes the annotations available:</p> 
         </div> 
         <table class="tableblock frame-all grid-all spread"> 
          <caption class="title">
           Table 1. Names and descriptions
          </caption> 
          <colgroup> 
           <col style="width: 33.3333%;"> 
           <col style="width: 33.3333%;"> 
           <col style="width: 33.3334%;"> 
          </colgroup> 
          <thead> 
           <tr> 
            <th class="tableblock halign-left valign-top">Feature</th> 
            <th class="tableblock halign-left valign-top">Named</th> 
            <th class="tableblock halign-left valign-top">Description</th> 
           </tr> 
          </thead> 
          <tbody> 
           <tr> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p>Class</p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><a href="../rgant/rgant.html#_rgant-DomainObjectLayout_named"><code>@DomainObjectLayout#named()</code></a></p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><a href="../rgant/rgant.html#_rgant-DomainObjectLayout_describedAs"><code>@DomainObjectLayout#describedAs()</code></a></p> 
              </div>
             </div></td> 
           </tr> 
           <tr> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p>Property</p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><a href="../rgant/rgant.html#_rgant-PropertyLayout_named"><code>@PropertyLayout#named()</code></a></p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><a href="../rgant/rgant.html#_rgant-PropertyLayout_describedAs"><code>@PropertyLayout#describedAs()</code></a></p> 
              </div>
             </div></td> 
           </tr> 
           <tr> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p>Collection</p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><a href="../rgant/rgant.html#_rgant-CollectionLayout_named"><code>@CollectionLayout#named()</code></a></p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><a href="../rgant/rgant.html#_rgant-CollectionLayout_describedAs"><code>@CollectionLayout#describedAs()</code></a></p> 
              </div>
             </div></td> 
           </tr> 
           <tr> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p>Action</p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><a href="../rgant/rgant.html#_rgant-ActionLayout_named"><code>@ActionLayout#named()</code></a></p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><a href="../rgant/rgant.html#_rgant-ActionLayout_describedAs"><code>@ActionLayout#describedAs()</code></a></p> 
              </div>
             </div></td> 
           </tr> 
           <tr> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p>Action Parameters</p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><a href="../rgant/rgant.html#_rgant-ParameterLayout_named"><code>@ParameterLayout#named()</code></a></p> 
              </div>
             </div></td> 
            <td class="tableblock halign-left valign-top">
             <div>
              <div class="paragraph"> 
               <p><a href="../rgant/rgant.html#_rgant-ParameterLayout_describedAs"><code>@ParameterLayout#describedAs()</code></a></p> 
              </div>
             </div></td> 
           </tr> 
          </tbody> 
         </table> 
         <div class="admonitionblock tip"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-tip" title="Tip"></i> </td> 
             <td class="content"> 
              <div class="paragraph"> 
               <p>If you’re running on Java 8, then note that it’s possible to write Isis applications without using <code>@ParameterLayout(named=…​)</code> annotation. Support for this can be found in the (non-ASF) <a href="http://platform.incode.org" target="_blank" rel="noopener">Incode Platform</a>'s paraname8 metamodel extension (non-ASF). (In the future we’ll fold this into core).</p> 
              </div> 
              <div class="paragraph"> 
               <p>See also our guidance on <a href="../../migration-notes/migration-notes.html#_migration-notes_1.8.0-to-1.9.0_upgrading-to-java8">upgrading to Java 8</a>.</p> 
              </div> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>The framework also supports i18n: locale-specific names and descriptions. For more information, see the <a href="../ugbtb/ugbtb.html#_ugbtb_i18n">beyond-the-basics</a> guide.</p> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugfun_ui-hints_eager-rendering">1.5. Eager rendering</h3> 
         <div class="paragraph"> 
          <p>By default, parented collections all rendered lazily, in other words in a "collapsed" table view.</p> 
         </div> 
         <div class="paragraph"> 
          <p>For the more commonly used collections we want to show the table expanded:</p> 
         </div> 
         <div class="imageblock"> 
          <div class="content"> 
           <a class="image" href="ugfun/images/programming-model/todoapp-Dashboard.png"><img src="ugfun/images/programming-model/todoapp-Dashboard.png" alt="todoapp Dashboard" width="px"></a> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>For this we annotate the collection using <a href="../rgant/rgant.html#_rgant-CollectionLayout_defaultView"><code>@CollectionLayout#defaultView()</code></a>; for example</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@javax</span>.jdo.annotations.Persistent(table=<span class="string"><span class="delimiter">"</span><span class="content">ToDoItemDependencies</span><span class="delimiter">"</span></span>)
<span class="directive">private</span> <span class="predefined-type">Set</span>&lt;ToDoItem&gt; dependencies = <span class="keyword">new</span> <span class="predefined-type">TreeSet</span>&lt;&gt;();
<span class="annotation">@Collection</span>
<span class="annotation">@CollectionLayout</span>(
    defaultView = <span class="string"><span class="delimiter">"</span><span class="content">table</span><span class="delimiter">"</span></span>
)
<span class="directive">public</span> <span class="predefined-type">Set</span>&lt;ToDoItem&gt; getDependencies() {
    <span class="keyword">return</span> dependencies;
}</code></pre> 
          </div> 
         </div> 
         <div class="admonitionblock note"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
             <td class="content"> 
              <div class="paragraph"> 
               <p>The <code>defaultView()</code> attribute replaces the deprecated approach of using <a href="../rgant/rgant.html#_rgant-CollectionLayout_render"><code>@CollectionLayout#render()</code></a> eagerly.</p> 
              </div> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>Alternatively, it can be specified the <code>Xxx.layout.xml</code> file:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="javascript">&lt;bs3:col span=<span class="string"><span class="delimiter">"</span><span class="content">5</span><span class="delimiter">"</span></span> cssClass=<span class="string"><span class="delimiter">"</span><span class="content">custom-padding-top-20</span><span class="delimiter">"</span></span>&gt;
    <span class="tag">&lt;cpt:collection</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">"</span><span class="content">notYetComplete</span><span class="delimiter">"</span></span> <span class="attribute-name">defaultView</span>=<span class="string"><span class="delimiter">"</span><span class="content">table</span><span class="delimiter">"</span></span> <span class="tag">/&gt;</span>
    <span class="tag">&lt;cpt:collection</span> <span class="attribute-name">id</span>=<span class="string"><span class="delimiter">"</span><span class="content">complete</span><span class="delimiter">"</span></span> <span class="attribute-name">defaultView</span>=<span class="string"><span class="delimiter">"</span><span class="content">table</span><span class="delimiter">"</span></span><span class="tag">/&gt;</span>
&lt;<span class="regexp"><span class="delimiter">/</span><span class="content">bs3col&gt;</span></span></code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>It might be thought that collections that are eagerly rendered should also be eagerly loaded from the database by enabling the <code>defaultFetchGroup</code> attribute:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@javax</span>.jdo.annotations.Persistent(table=<span class="string"><span class="delimiter">"</span><span class="content">ToDoItemDependencies</span><span class="delimiter">"</span></span>, defaultFetchGroup=<span class="string"><span class="delimiter">"</span><span class="content">true</span><span class="delimiter">"</span></span>)
<span class="directive">private</span> <span class="predefined-type">Set</span>&lt;ToDoItem&gt; dependencies = <span class="keyword">new</span> <span class="predefined-type">TreeSet</span>&lt;&gt;();
...</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>While this can be done, it’s likely to be a bad idea, because doing so will cause DataNucleus to query for more data irrespective of how the object is used/rendered.</p> 
         </div> 
         <div class="paragraph"> 
          <p>Of course, your mileage may vary, so do experiment.</p> 
         </div> 
        </div> 
       </div> 
      </div> 
      <div class="sect1"> 
       <h2 id="_wicket_viewer">2. Wicket Viewer</h2> 
       <div class="sectionbody"> 
        <div class="paragraph"> 
         <p>Hints and tips for more advanced customisation of the UI. Taken from the <a href="#ugvw/ugvw.adoc">Wicket viewer</a> guide.</p> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugvw_hints-and-tips_per-user-themes">2.1. Per-user Themes</h3> 
         <div class="paragraph"> 
          <p>From <a href="http://isis.markmail.org/thread/kb4442niwwbnghey">this thread</a> on the Apache Isis users mailing list:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p><em>Is it possible to have each of our resellers (using our Apache Isis application) use there own theme/branding with their own logo and colors? Would this also be possible for the login page, possibly depending on the used host name?</em></p> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>Yes, you can do this, by installing a custom implementation of the Wicket Bootstrap’s <code>ActiveThemeProvider</code>.</p> 
         </div> 
         <div class="paragraph"> 
          <p>The <a href="http://github.com/isisaddons/isis-app-todoapp">Isis addons' todoapp</a> (non-ASF) actually <a href="https://github.com/isisaddons/isis-app-todoapp/tree/61b8114a8e01dbb3c380b31cf09eaed456407570">does this</a>, storing the info via the (non-ASF) <a href="http://platform.incode.org/modules/dom/settings/dom-settings.html">Incode Platform’s settings module</a> :</p> 
         </div> 
         <div class="listingblock"> 
          <div class="title">
           IActiveThemeProvider implementation
          </div> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">UserSettingsThemeProvider</span> <span class="directive">implements</span> ActiveThemeProvider {
    ...
    <span class="annotation">@Override</span>
    <span class="directive">public</span> ITheme getActiveTheme() {
        <span class="keyword">if</span>(IsisContext.getSpecificationLoader().isInitialized()) {
            <span class="directive">final</span> <span class="predefined-type">String</span> themeName = IsisContext.doInSession(<span class="keyword">new</span> <span class="predefined-type">Callable</span>&lt;<span class="predefined-type">String</span>&gt;() {
                <span class="annotation">@Override</span>
                <span class="directive">public</span> <span class="predefined-type">String</span> call() <span class="directive">throws</span> <span class="exception">Exception</span> {
                    <span class="directive">final</span> UserSettingsService userSettingsService =
                        lookupService(UserSettingsService.class);
                    <span class="directive">final</span> UserSetting activeTheme = userSettingsService.find(
                            IsisContext.getAuthenticationSession().getUserName(),
                            ACTIVE_THEME);
                    <span class="keyword">return</span> activeTheme != <span class="predefined-constant">null</span> ? activeTheme.valueAsString() : <span class="predefined-constant">null</span>;
                }
            });
            <span class="keyword">return</span> themeFor(themeName);
        }
        <span class="keyword">return</span> <span class="keyword">new</span> SessionThemeProvider().getActiveTheme();
    }
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="type">void</span> setActiveTheme(<span class="directive">final</span> <span class="predefined-type">String</span> themeName) {
        IsisContext.doInSession(<span class="keyword">new</span> <span class="predefined-type">Runnable</span>() {
            <span class="annotation">@Override</span>
            <span class="directive">public</span> <span class="type">void</span> run() {
                <span class="directive">final</span> <span class="predefined-type">String</span> currentUsrName =
                    IsisContext.getAuthenticationSession().getUserName();
                <span class="directive">final</span> UserSettingsServiceRW userSettingsService =
                        lookupService(UserSettingsServiceRW.class);
                <span class="directive">final</span> UserSettingJdo activeTheme =
                        (UserSettingJdo) userSettingsService.find(
                                                currentUsrName, ACTIVE_THEME);
                <span class="keyword">if</span>(activeTheme != <span class="predefined-constant">null</span>) {
                    activeTheme.updateAsString(themeName);
                } <span class="keyword">else</span> {
                    userSettingsService.newString(
                        currentUsrName, ACTIVE_THEME, <span class="string"><span class="delimiter">"</span><span class="content">Active Bootstrap theme for user</span><span class="delimiter">"</span></span>, themeName);
                }
            }
        });
    }
    <span class="directive">private</span> ITheme themeFor(<span class="directive">final</span> <span class="predefined-type">String</span> themeName) {
        <span class="directive">final</span> ThemeProvider themeProvider = settings.getThemeProvider();
        <span class="keyword">if</span>(themeName != <span class="predefined-constant">null</span>) {
            <span class="keyword">for</span> (<span class="directive">final</span> ITheme theme : themeProvider.available()) {
                <span class="keyword">if</span> (themeName.equals(theme.name()))
                    <span class="keyword">return</span> theme;
            }
        }
        <span class="keyword">return</span> themeProvider.defaultTheme();
    }
    ...
}</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>and</p> 
         </div> 
         <div class="listingblock"> 
          <div class="title">
           Using the ActiveThemeProvider
          </div> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Override</span>
<span class="directive">protected</span> <span class="type">void</span> init() {
    <span class="local-variable">super</span>.init();

    <span class="directive">final</span> IBootstrapSettings settings = Bootstrap.getSettings();
    settings.setThemeProvider(<span class="keyword">new</span> BootswatchThemeProvider(BootswatchTheme.Flatly));

    settings.setActiveThemeProvider(<span class="keyword">new</span> UserSettingsThemeProvider(settings));
}</code></pre> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugvw_hints-and-tips_i18n-label-in-wicket-viewer">2.2. How i18n the Wicket viewer?</h3> 
         <div class="paragraph"> 
          <p>From <a href="http://isis.markmail.org/thread/ctppmtcbsf4iskzi">this thread</a> on the Apache Isis users mailing list:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p><em>I am trying to internationalize the label descriptions of form actions, eg those in <code>ActionParametersFormPanel</code>. Referencing those via their message id inside a .po file didn’t work either. Can this be done?</em></p> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>Yes, it <em>is</em> possible to internationalize both the Wicket viewer’s labels as well as the regular translations of the domain object metadata using the <code>.po</code> translation files as supported by the <a href="../rgsvc/rgsvc.html#_rgsvc_presentation-layer-spi_TranslationService"><code>TranslationService</code></a>.</p> 
         </div> 
         <div class="paragraph"> 
          <p>Full details of the <code>msgId</code>s that must be added to the <code>translations.po</code> file can be found in <a href="../ugbtb/ugbtb.html#__ugbtb_i18n_wicket-viewer">i18n</a> section of the <a href="../ugbtb/ugbtb.html">beyond the basics</a> guide.</p> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugvw_hints-and-tips_highlight-current-row">2.3. Highlight Current Row</h3> 
         <div class="paragraph"> 
          <p>Demo App: Highlighting Current As a by-the-by, the demo app has one further "trick up its sleeve". If you run the app you’ll notice that the currently selected <code>DemoObject</code> is highlighted in the left-hand table of the <code>HomePageViewModel</code>.</p> 
         </div> 
         <div class="paragraph"> 
          <p>This is accomplished by having the view model collaborate with a subscribing domain service that configures a CSS class.</p> 
         </div> 
         <div class="paragraph"> 
          <p>We start by ensuring that the <code>DemoObject</code> emits an event for its CSS class:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="title">
           DemoObject.java
          </div> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@DomainObjectLayout</span>(
...
cssClassUiEvent = DemoObject.CssClassUiEvent.class
)
<span class="directive">public</span> <span class="type">class</span> <span class="class">DemoObject</span> ... {

<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">CssClassUiEvent</span>
<span class="directive">extends</span> org.apache.isis.applib.services.eventbus.CssClassUiEvent&lt;DemoObject&gt; {}
...
}</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>Next, we define the domain service to act as the subscriber:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="title">
           HomePageViewModel.java
          </div> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">HomePageViewModel</span> ... {
    <span class="annotation">@DomainService</span>(nature = NatureOfService.DOMAIN)
    <span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">CssHighlighter</span> <span class="directive">extends</span> AbstractSubscriber {
        <span class="annotation">@org</span>.axonframework.eventhandling.annotation.EventHandler <span class="comment">// if using axon</span>
        <span class="annotation">@com</span>.google.common.eventbus.Subscribe                    <span class="comment">// if using guava</span>
        <span class="directive">public</span> <span class="type">void</span> on(DemoObject.CssClassUiEvent ev) {
            <span class="keyword">if</span>(getContext() == <span class="predefined-constant">null</span>) { <span class="keyword">return</span>; }
            <span class="keyword">if</span>(ev.getSource() == getContext().getSelected()) {      <i class="conum" data-value="1"></i><b>(1)</b>
                ev.setCssClass(<span class="string"><span class="delimiter">"</span><span class="content">selected</span><span class="delimiter">"</span></span>);
            }
        }
        <span class="directive">private</span> HomePageViewModel getContext() {                    <i class="conum" data-value="2"></i><b>(2)</b>
            <span class="keyword">return</span> (HomePageViewModel) scratchpad.get(<span class="string"><span class="delimiter">"</span><span class="content">context</span><span class="delimiter">"</span></span>);
        }
        <span class="type">void</span> setContext(<span class="directive">final</span> HomePageViewModel homePageViewModel) {
            scratchpad.put(<span class="string"><span class="delimiter">"</span><span class="content">context</span><span class="delimiter">"</span></span>, homePageViewModel);
        }
        <span class="annotation">@Inject</span>
        Scratchpad scratchpad;                                      <i class="conum" data-value="3"></i><b>(3)</b>
    }
}</code></pre> 
          </div> 
         </div> 
         <div class="colist arabic"> 
          <table> 
           <tbody>
            <tr> 
             <td><i class="conum" data-value="1"></i><b>1</b></td> 
             <td>If the domain object is the currently selected then set the CSS class</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="2"></i><b>2</b></td> 
             <td>Provide methods to set and get the current <code>HomePageViewModel</code> (acting as the context)</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="3"></i><b>3</b></td> 
             <td>Store the context using the <code>Scratchpad</code> domain service (request-scoped so thread-safe).</td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>The <code>HomePageViewModel</code> is responsible for setting itself as the context for the domain service:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="title">
           HomePageViewModel.java
          </div> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">HomePageViewModel</span> ... {
    ...
    public TranslatableString title() {
        cssHighlighter.setContext(<span class="local-variable">this</span>);        <i class="conum" data-value="1"></i><b>(1)</b>
        ...
    }
    ...
    <span class="annotation">@javax</span>.inject.Inject
    CssHighlighter cssHighlighter;
}</code></pre> 
          </div> 
         </div> 
         <div class="colist arabic"> 
          <table> 
           <tbody>
            <tr> 
             <td><i class="conum" data-value="1"></i><b>1</b></td> 
             <td>set the context on the domain service</td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>Finally we just need some CSS, in the <code>application.css</code> file:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="title">
           application.css
          </div> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="css"><span class="class">.selected</span> {
    <span class="key">font-style</span>: <span class="value">italic</span>; <span class="key">font-weight</span>: <span class="value">bolder</span>;
}</code></pre> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugvw_hints-and-tips_svg-support">2.4. SVG Support</h3> 
         <div class="paragraph"> 
          <p>(As per <a href="https://issues.apache.org/jira/browse/ISIS-1604">ISIS-1604</a>), SVG images can be used:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p>as Logo in the upper left corner (Wicket Menubar)</p> </li> 
           <li> <p>on the Login Page (<code>login.html</code>)</p> </li> 
           <li> <p>as favicon (<code>image/svg+xml</code>, cf. <a href="https://issues.apache.org/jira/browse/ISIS-1115">ISIS-1115</a>)</p> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>However, SVGs are not, by default, displayed on the welcome page. SVGs can be attached as <code>Blob</code>s, but they are displayed as bitmaps (by means of the Batik rasterizer) and do not scale. The rasterizer (of course) can not deal with animations (cf. attachment).</p> 
         </div> 
         <div class="paragraph"> 
          <p>To fix this, you can add the following dependencies:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>com.twelvemonkeys.imageio<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>imageio-batik<span class="tag">&lt;/artifactId&gt;</span> <span class="comment">&lt;!-- svg --&gt;</span>
    <span class="tag">&lt;version&gt;</span>3.3.2<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>com.twelvemonkeys.imageio<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>imageio-batik<span class="tag">&lt;/artifactId&gt;</span> <span class="comment">&lt;!-- svg --&gt;</span>
    <span class="tag">&lt;version&gt;</span>3.3.2<span class="tag">&lt;/version&gt;</span>
    <span class="tag">&lt;type&gt;</span>test-jar<span class="tag">&lt;/type&gt;</span>
    <span class="tag">&lt;scope&gt;</span>test<span class="tag">&lt;/scope&gt;</span>
<span class="tag">&lt;/dependency&gt;</span>
<span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.apache.xmlgraphics<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>batik-transcoder<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>1.8<span class="tag">&lt;/version&gt;</span>
<span class="tag">&lt;/dependency&gt;</span></code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>However, <strong>please note</strong> that these dependencies have high CVE values, and so may constitute a security risk.</p> 
         </div> 
         <div class="paragraph"> 
          <p>Further discussion on <a href="https://lists.apache.org/thread.html/68f16dd0306a8101c1cde06e5e6309b8d1b81b388a1f59e123cfc2f3@%3Cusers.isis.apache.org%3E">this mailing list thread</a>.</p> 
         </div> 
        </div> 
       </div> 
      </div> 
      <div class="sect1"> 
       <h2 id="_restful_objects_viewer">3. Restful Objects Viewer</h2> 
       <div class="sectionbody"> 
        <div class="paragraph"> 
         <p>Hints and tips for working with the REST API, for example when developing a custom application. Taken from the <a href="#ugvro/ugvro.adoc">Restful Objects viewer</a> guide.</p> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugvro_hints-and-tips_using-chrome-devtools">3.1. Using Chrome Dev Tools</h3> 
         <div class="paragraph"> 
          <p>This <a href="https://www.youtube.com/watch?v=_-TOvVYWCHc">screencast</a> shows how to explore the Restful API using Chrome plugins/extensions, and how we use them to write end-2-end (TCK) tests for the Restful Objects viewer.</p> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugvro_hints-and-tips_angular-tips">3.2. Angular Tips</h3> 
         <div class="paragraph"> 
          <p>The hypermedia API exposed by Apache Isis' Restful Objects viewer is intended be support both bespoke custom-written viewers as well as generic viewers. Indeed, we expect most clients consuming the API will be bespoke, not generic.</p> 
         </div> 
         <div class="paragraph"> 
          <p>This page captures one or two tips on using Angular to write such a bespoke client.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="_invoking_a_get_link_eg_invoking_a_query_action">3.2.1. Invoking a GET link (eg invoking a query action)</h4> 
          <div class="paragraph"> 
           <p>Suppose you have a <code>CustomerService</code> providing a <code>findCustomer</code> action:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">CustomerService</span> {
    <span class="directive">public</span> <span class="predefined-type">String</span> id() { <span class="keyword">return</span> <span class="string"><span class="delimiter">"</span><span class="content">customers</span><span class="delimiter">"</span></span>; }
    <span class="annotation">@Action</span>(semantics=SemanticsOf.SAFE)
    <span class="directive">public</span> Customer findCustomer(
            <span class="annotation">@ParameterLayout</span>(named=<span class="string"><span class="delimiter">"</span><span class="content">customerName</span><span class="delimiter">"</span></span>)
            <span class="directive">final</span> <span class="predefined-type">String</span> customerName) {
        ...
    }
}</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>Restful Objects will expose this as action with the following link that looks something like:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="javascript">{
  <span class="key"><span class="delimiter">"</span><span class="content">rel</span><span class="delimiter">"</span></span> : <span class="string"><span class="delimiter">"</span><span class="content">urn:org.restfulobjects:rels/invoke</span><span class="delimiter">"</span></span>,
  <span class="key"><span class="delimiter">"</span><span class="content">href</span><span class="delimiter">"</span></span> : <span class="string"><span class="delimiter">"</span><span class="content">http://localhost:8080/restful/services/customers/actions/findCustomer/invoke</span><span class="delimiter">"</span></span>,
  <span class="key"><span class="delimiter">"</span><span class="content">method</span><span class="delimiter">"</span></span> : <span class="string"><span class="delimiter">"</span><span class="content">GET</span><span class="delimiter">"</span></span>,
  <span class="key"><span class="delimiter">"</span><span class="content">type</span><span class="delimiter">"</span></span> : <span class="string"><span class="delimiter">"</span><span class="content">application/json;profile=</span><span class="char">\"</span><span class="content">urn:org.restfulobjects:repr-types/action-result</span><span class="char">\"</span><span class="delimiter">"</span></span>,
  <span class="key"><span class="delimiter">"</span><span class="content">arguments</span><span class="delimiter">"</span></span> : {
    <span class="key"><span class="delimiter">"</span><span class="content">customerName</span><span class="delimiter">"</span></span> : {
      <span class="key"><span class="delimiter">"</span><span class="content">value</span><span class="delimiter">"</span></span> : <span class="predefined-constant">null</span>
    }
  }
}</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>You can then invoke this using Angular' <code>$resource</code> service as follows.</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="javascript"><span class="keyword">var</span> findCustomer = <span class="predefined">$resource</span>(<span class="string"><span class="delimiter">"</span><span class="content">http://localhost:8080/restful/services/customers/actions/findCustomer/invoke?:queryString</span><span class="delimiter">"</span></span>);
<span class="keyword">var</span> findCustomerArgs = {
  <span class="key"><span class="delimiter">"</span><span class="content">customerName</span><span class="delimiter">"</span></span>: {
      <span class="key"><span class="delimiter">"</span><span class="content">value</span><span class="delimiter">"</span></span>: <span class="string"><span class="delimiter">"</span><span class="content">Fred</span><span class="delimiter">"</span></span>
    }
};
findCustomer.get({<span class="key">queryString</span>: JSON.stringify(findCustomerArgs)}, <span class="keyword">function</span>(data) { ... } )</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>Here the <code>:queryString</code> placeholder in the initial <code>$resource</code> constructor is expanded with a stringified version of the JSON object representing the args. Note how the <code>findCustomerArgs</code> is the same as the <code>"arguments"</code> attribute in the original link (with a value provided instead of <code>null</code>).</p> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_invoking_a_put_or_post_link">3.2.2. Invoking a PUT or POST link</h4> 
          <div class="paragraph"> 
           <p>If the method is a PUT or a POST, then no <code>:queryString</code> placeholder is required in the URL, and the args are instead part of the body.</p> 
          </div> 
          <div class="paragraph"> 
           <p>Use <code>$resource.put(…​)</code> or <code>$resource.post(…​)</code> instead.</p> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugvro_hints-and-tips_pretty-printing">3.3. Pretty printing</h3> 
         <div class="paragraph"> 
          <p>The JSON representations generated by the Restful Objects viewer are in compact form if the <a href="../rgcfg/rgcfg.html#_rgcfg_deployment-types">deployment type</a> is SERVER (ie production), but will automatically be "pretty printed" (in other words indented) if the deployment type is PROTOTYPE.</p> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugvro_hints-and-tips_restful-image-property">3.4. How parse images in RO viewer?</h3> 
         <div class="paragraph"> 
          <p>From this <a href="http://markmail.org/message/4kcu7sml4ufdsah3">thread</a> on the Apache Isis users mailing list:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p><em>I am trying to display an image in a JavaScript client app, the image comes from an Isis RO web service as a string, but it won’t show. Is there something I should do to change the message?</em></p> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>The RO viewer returns the image as a string, in the form:</p> 
         </div> 
         <div class="literalblock"> 
          <div class="content"> 
           <pre>"Tacos.jpg:image/jpeg:/9j//4AAQSkZJRgABAQEAlgCWAAD/  ...."</pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>This is in the form:</p> 
         </div> 
         <div class="literalblock"> 
          <div class="content"> 
           <pre>(filename):(mime type):(binary data in base64)</pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>This is basically the <a href="../rgcms/rgcms.html#_rgcms_classes_value-types_Blob"><code>Blob</code></a> value type, in string form.</p> 
         </div> 
         <div class="paragraph"> 
          <p>To use, split the parts then format the mime type and base64 data correctly before using as source in an <code>&lt;img&gt;</code> tag.</p> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugvro_hints-and-tips_view-model-as-parameter">3.5. View Model as Parameter</h3> 
         <div class="paragraph"> 
          <p>As discussed <a href="https://lists.apache.org/thread.html/cbd18320bbf6e5c5e767283f9e675cf56e7f4692c109e1e79dbaa90a@%3Cusers.isis.apache.org%3E">on the mailing list</a>.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="_query">3.5.1. Query</h4> 
          <div class="paragraph"> 
           <p>I must provide a REST service accepting more complex view model as input parameter.</p> 
          </div> 
          <div class="paragraph"> 
           <p>My view model parameter would look like</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@DomainObject</span>(
    nature = Nature.VIEW_MODEL,
    objectType = <span class="string"><span class="delimiter">"</span><span class="content">OfferTemplateFilter</span><span class="delimiter">"</span></span>
)
<span class="annotation">@XmlRootElement</span>(name = <span class="string"><span class="delimiter">"</span><span class="content">OfferTemplateFilter</span><span class="delimiter">"</span></span>)
<span class="annotation">@XmlAccessorType</span>(XmlAccessType.FIELD)
<span class="annotation">@Getter</span> <span class="annotation">@Setter</span>
<span class="directive">public</span> <span class="type">class</span> <span class="class">OfferTemplateFilter</span> {
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; selectedDeviceManufacturer = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;();
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;<span class="predefined-type">String</span>&gt; selectedDeviceSizes = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;();
}</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>My REST domain service would be someting like</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@DomainService</span>(
    nature = NatureOfService.VIEW_REST_ONLY,
    objectType = <span class="string"><span class="delimiter">"</span><span class="content">OfferRestService</span><span class="delimiter">"</span></span>
)
<span class="directive">public</span> <span class="type">class</span> <span class="class">OfferRestService</span> {

    <span class="annotation">@Action</span>(semantics = SemanticsOf.IDEMPOTENT)
    <span class="directive">public</span> OfferTemplateSelectorForCustomer
        offerSelectorForCustomer(
            <span class="directive">final</span> <span class="predefined-type">String</span> subscriberNumber,
            <span class="directive">final</span> OfferTemplateFilter filter) {
        <span class="keyword">return</span> offerSelectorRepository.create(subscriberNumber, filter);
    }
    ...
}</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>I’m wondering how this could be achieved without custom rest service. Ideally the service consumer would post a kind of JSON structure where my view model OfferTemplateFilter would be created?</p> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_possible_answer">3.5.2. Possible Answer…​</h4> 
          <div class="paragraph"> 
           <p>Rather than try to "upload" the <code>OfferTemplateFilter</code> view model as a parameter, instead treat it as a resource.</p> 
          </div> 
          <div class="paragraph"> 
           <p>That is:</p> 
          </div> 
          <div class="ulist"> 
           <ul> 
            <li> <p>have a new service to create an instance of the filter, and then</p> </li> 
            <li> <p>update this filter (adding/removing from its two collections).</p> </li> 
            <li> <p>When done, pass a reference to the filter to the original REST service, as a regular reference.</p> </li> 
           </ul> 
          </div> 
          <div class="paragraph"> 
           <p>Obviously the URL passed in the last step will be rather long and messy, but that’s not a problem per-se.</p> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugvro_hints-and-tips_troubleshooting">3.6. Troubleshooting</h3> 
         <div class="sect3"> 
          <h4 id="_exception">3.6.1. Exception</h4> 
          <div class="paragraph"> 
           <p>When invoking a REST service and getting a response with an embeded stacktrace like:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="json">{
        <span class="key"><span class="delimiter">"</span><span class="content">httpStatusCode</span><span class="delimiter">"</span></span>: <span class="integer">500</span>,
        <span class="key"><span class="delimiter">"</span><span class="content">message</span><span class="delimiter">"</span></span>: <span class="string"><span class="delimiter">"</span><span class="content">com.sun.xml.bind.v2.runtime.IllegalAnnotationsException: 1 counts of IllegalAnnotationExceptions Klasse enthält zwei Eigenschaften mit demselben Namen </span><span class="char">\"</span><span class="content">name</span><span class="char">\"</span><span class="content"> this problem is related to the following location: at public java.lang.String ife.dep.ServiceName.getName() at ife.dep.ServiceName at public ife.dep.ServiceName ife.dep.ProvidedService.getServiceName() at ife.dep.ProvidedService at public java.util.SortedSet ife.dep.Release.getCapabilities() at ife.dep.Release at public ife.dep.Release ife.cfg.Configuration.getRelease() at ife.cfg.Configuration at public ife.cfg.Configuration ife.cfg.ConfigEntry.getConfiguration() at ife.cfg.ConfigEntry at public java.util.SortedSet ife.cfg.Endpoint.getCfgEntries() at ife.cfg.Endpoint this problem is related to the following location: at public java.lang.String ife.dep.ServiceName.name at ife.dep.ServiceName at public ife.dep.ServiceName ife.dep.ProvidedService.getServiceName() at ife.dep.ProvidedService at public java.util.SortedSet ife.dep.Release.getCapabilities() at ife.dep.Release at public ife.dep.Release ife.cfg.Configuration.getRelease() at ife.cfg.Configuration at public ife.cfg.Configuration ife.cfg.ConfigEntry.getConfiguration() at ife.cfg.ConfigEntry at public java.util.SortedSet ife.cfg.Endpoint.getCfgEntries() at ife.cfg.Endpoint </span><span class="delimiter">"</span></span>,
[<span class="error">.</span><span class="error">.</span><span class="error">.</span>]
}</code></pre> 
           </div> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_solution">3.6.2. Solution</h4> 
          <div class="paragraph"> 
           <p>Add <code>@XmlAccessorType(XmlAccessType.FIELD)</code> to your domain entity:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@javax</span>.jdo.annotations.PersistenceCapable(identityType = IdentityType.DATASTORE)
<span class="annotation">@javax</span>.jdo.annotations.DatastoreIdentity(strategy = javax.jdo.annotations.IdGeneratorStrategy.NATIVE, column = <span class="string"><span class="delimiter">"</span><span class="content">id</span><span class="delimiter">"</span></span>)
<span class="annotation">@javax</span>.jdo.annotations.Version(strategy = VersionStrategy.VERSION_NUMBER, column = <span class="string"><span class="delimiter">"</span><span class="content">version</span><span class="delimiter">"</span></span>)
<span class="annotation">@DomainObject</span>(objectType = <span class="string"><span class="delimiter">"</span><span class="content">ServiceName</span><span class="delimiter">"</span></span>, bounded = <span class="predefined-constant">true</span>)
<span class="annotation">@DomainObjectLayout</span>(cssClassFa = <span class="string"><span class="delimiter">"</span><span class="content">tag</span><span class="delimiter">"</span></span>, describedAs = <span class="string"><span class="delimiter">"</span><span class="delimiter">"</span></span>)
<span class="annotation">@XmlAccessorType</span>(XmlAccessType.FIELD)
<span class="annotation">@SuppressWarnings</span>(<span class="string"><span class="delimiter">"</span><span class="content">javadoc</span><span class="delimiter">"</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ServiceName</span> <span class="directive">implements</span> Capability, <span class="predefined-type">Comparable</span>&lt;ServiceName&gt; {

        <span class="directive">public</span> <span class="predefined-type">String</span> title() {
                <span class="keyword">return</span> getName();
        }

        <span class="directive">public</span> <span class="type">int</span> compareTo(ServiceName o) {
                <span class="keyword">return</span> name.compareTo(o.name);
        }

        <span class="annotation">@Override</span>
        <span class="directive">public</span> <span class="predefined-type">String</span> toString() {
                <span class="keyword">return</span> title();
        }

        <span class="annotation">@MemberOrder</span>(sequence = <span class="string"><span class="delimiter">"</span><span class="content">1</span><span class="delimiter">"</span></span>)
        <span class="annotation">@javax</span>.jdo.annotations.Column(allowsNull = <span class="string"><span class="delimiter">"</span><span class="content">false</span><span class="delimiter">"</span></span>)
        <span class="annotation">@Getter</span>        <span class="annotation">@Setter</span>
        <span class="directive">public</span> <span class="predefined-type">String</span> name;

        <span class="directive">public</span> <span class="type">boolean</span> isSynchronous() {
                <span class="keyword">return</span> !isAsynchonous();
        }

        <span class="directive">public</span> <span class="type">boolean</span> isAsynchonous() {
                <span class="keyword">return</span> name.startsWith(Constants.ESB_JMS_PREFIX);
        }
}</code></pre> 
           </div> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
      <div class="sect1"> 
       <h2 id="_datanucleus_object_store">4. DataNucleus Object Store</h2> 
       <div class="sectionbody"> 
        <div class="paragraph"> 
         <p>Hints and tips for working with persistent entities. Taken from the <a href="#ugodn/ugodn.adoc">DataNucleus Object Store</a>.</p> 
        </div> 
        <div class="paragraph"> 
         <p>See also the official <a href="http://www.datanucleus.org">DataNucleus</a> documentation, for much more on mappings and so forth.</p> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugodn_hints-and-tips_overriding-jdo-annotations">4.1. Overriding JDO Annotations</h3> 
         <div class="paragraph"> 
          <p>The JDO Objectstore (or rather, the underlying DataNucleus implementation) builds its own persistence metamodel by reading both annotations on the class and also by searching for metadata in XML files. The metadata in the XML files takes precedence over the annotations, and so can be used to override metadata that is "hard-coded" in annotations.</p> 
         </div> 
         <div class="paragraph"> 
          <p>In fact, JDO/DataNucleus provides two different XML files that have slightly different purposes and capabilities:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p>first, a <code>.jdo</code> file can be provided which - if found - completely replaces the annotations.<br></p> 
            <div class="paragraph"> 
             <p>The idea here is simply to use XML as the means by which metadata is specified.</p> 
            </div> </li> 
           <li> <p>second, an <code>.orm</code> file can be provided which - if found - provides individual overrides for a particular database vendor.<br></p> 
            <div class="paragraph"> 
             <p>The idea here is to accommodate for subtle differences in support for SQL between vendors. A good example is the default schema for a table: <code>dbo</code> for SQL Server, <code>public</code> for HSQLDB, <code>sys</code> for Oracle, and so on.</p> 
            </div> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>If you want to use the first approach (the <code>.jdo</code> file), you’ll find that you can download the effective XML representation of domain entities using the <a href="../rgcms/rgcms.html#__rgcms_classes_mixins_Persistable_downloadJdoMetadata">downloadJdoMetadata</a> mixin action available in prototyping mode. This then needs to be renamed and placed in the appropriate location on the classpath; see the <a href="http://www.datanucleus.org">DataNucleus documentation</a> for details.</p> 
         </div> 
         <div class="paragraph"> 
          <p>However, using this first approach does create a maintenance effort; if the domain entity’s class structure changes over time, then the XML metadata file will need to be updated.</p> 
         </div> 
         <div class="paragraph"> 
          <p>The second approach (using an <code>.orm</code> file) is therefore often more useful than the first, because the metadata provided overrides rather than replaces the annotations (and annotations not overridden continue to be honoured).</p> 
         </div> 
         <div class="paragraph"> 
          <p>A typical use case is to change the database schema for an entity. For example, the various (non-ASF) <a href="http://platform.incode.org" target="_blank" rel="noopener">Incode Platform</a> modules use schemas for each entity. For example, the <code>AuditEntry</code> entity in the (non-ASF) <a href="http://platform.incode.org" target="_blank" rel="noopener">Incode Platform</a>'s audit module is annotated as:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@javax</span>.jdo.annotations.PersistenceCapable(
        identityType=IdentityType.DATASTORE,
        schema = <span class="string"><span class="delimiter">"</span><span class="content">IsisAddonsAudit</span><span class="delimiter">"</span></span>,
        table=<span class="string"><span class="delimiter">"</span><span class="content">AuditEntry</span><span class="delimiter">"</span></span>)
<span class="directive">public</span> <span class="type">class</span> <span class="class">AuditEntry</span> {
    ...
}</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>This will map the <code>AuditEntry</code> class to a table <code>"IsisAddonsAudit"."AuditEntry"</code>; that is using a custom schema to own the object.</p> 
         </div> 
         <div class="paragraph"> 
          <p>Suppose though that for whatever reason we didn’t want to use a custom schema but would rather use the default. Also suppose we are using SQL Server as our target database.</p> 
         </div> 
         <div class="paragraph"> 
          <p>We can override the above annotation using a <code>AuditEntry-sqlserver.orm</code> file, placed in the same package as the <code>AuditEntry</code> entity. For example:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="title">
           AuditEntry-sqlserver.orm
          </div> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="tag">&lt;orm</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/jdo/orm</span><span class="delimiter">"</span></span>
     <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">"</span></span>
     <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://xmlns.jcp.org/xml/ns/jdo/orm</span> <span class="content">http://xmlns.jcp.org/xml/ns/jdo/orm_3_0.xsd</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>

    <span class="tag">&lt;package</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">org.isisaddons.module.audit.dom</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;class</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">AuditEntry</span><span class="delimiter">"</span></span>
               <span class="attribute-name">schema</span>=<span class="string"><span class="delimiter">"</span><span class="content">isisaudit</span><span class="delimiter">"</span></span>
               <span class="attribute-name">table</span>=<span class="string"><span class="delimiter">"</span><span class="content">AuditEntry</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
        <span class="tag">&lt;/class&gt;</span>
    <span class="tag">&lt;/package&gt;</span>
<span class="tag">&lt;/orm&gt;</span></code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>It’s also necessary to tell JDO/DataNucleus about which vendor is being used (<code>sqlserver</code> in the example above). This is done using a configuration property:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="title">
           isis.properties
          </div> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="ini">isis.persistor.datanucleus.impl.datanucleus.Mapping=sqlserver</code></pre> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugodn_hints-and-tips_subtype-entity-not-fully-populated">4.2. Subtype not fully populated</h3> 
         <div class="paragraph"> 
          <p>Taken from <a href="http://markmail.org/message/ovgai56uqgfgnrx7">this thread</a> on the Apache Isis users mailing list…​</p> 
         </div> 
         <div class="paragraph"> 
          <p>If it seems that Apache Isis (or rather DataNucleus) isn’t fully populating domain entities (ie leaving some properties as <code>null</code>), then check that your actions are not accessing the fields directly. Use getters instead.</p> 
         </div> 
         <div class="admonitionblock warning"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-warning" title="Warning"></i> </td> 
             <td class="content"> 
              <div class="paragraph"> 
               <p>Properties of domain entities should always be accessed using getters. The only code that should access to fields should be the getters themselves.</p> 
              </div> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>Why so? Because DataNucleus will potentially lazy load some properties, but to do this it needs to know that the field is being requested. This is the purpose of the enhancement phase: the bytecode of the original getter method is actually wrapped in code that does the lazy loading checking. But hitting the field directly means that the lazy loading code does not run.</p> 
         </div> 
         <div class="paragraph"> 
          <p>This error can be subtle: sometimes "incorrect" code that accesses the fields will seem to work. But that will be because the field has been populated already, for whatever reason.</p> 
         </div> 
         <div class="paragraph"> 
          <p>One case where you will find the issue highlighted is for subtype tables that have been mapped using an inheritance strategy of <code>NEW_TABLE</code>, eg:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@javax</span>.jdo.annotations.PersistenceCapable
<span class="annotation">@javax</span>.jdo.annotations.Inheritance(strategy = InheritanceStrategy.NEW_TABLE)
<span class="directive">public</span> <span class="type">class</span> <span class="class">SupertypeEntity</span> {
    ...
}</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>and then:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@javax</span>.jdo.annotations.PersistenceCapable
<span class="annotation">@javax</span>.jdo.annotations.Inheritance(strategy = InheritanceStrategy.NEW_TABLE)
<span class="directive">public</span> <span class="type">class</span> <span class="class">SubtypeEntity</span> <span class="directive">extends</span> SupertypeEntity {
    ...
}</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>This will generate two tables in the database, with the primary key of the supertype table propagated as a foreign key (also primary key) of the subtype table (sometimes called "table per type" strategy). This means that DataNucleus might retrieve data from only the supertype table, and the lazily load the subtype fields only as required. This is preferable to doing a left outer join from the super- to the subtype tables to retrieve data that might not be needed.</p> 
         </div> 
         <div class="paragraph"> 
          <p>On the other hand, if the <code>SUPERCLASS_TABLE</code> strategy (aka "table per hierarchy" or roll-up) or the <code>SUBCLASS_TABLE</code> strategy (roll-down) was used, then the problem is less likely to occur because DataNucleus would obtain all the data for any given instance from a single table.</p> 
         </div> 
         <div class="paragraph"> 
          <p>Final note: references to other objects (either scalar references or in collections) in particular require that getters rather than fields to be used to obtain them: it’s hopefully obvious that DataNucleus (like all ORMs) should not and will not resolve such references (otherwise, where to stop…​ and the whole database would be loaded into memory).</p> 
         </div> 
         <div class="paragraph"> 
          <p>In summary, there’s just one rule: <strong>always use the getters, never the fields</strong>.</p> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugodn_hints-and-tips_java8">4.3. Java8</h3> 
         <div class="paragraph"> 
          <p>DataNucleus 4.x supports Java 7, but can also be used with Java 8, eg for streams support against collections managed by DataNucleus.</p> 
         </div> 
         <div class="paragraph"> 
          <p>Just include within <code>&lt;dependencies&gt;</code> of your <code>dom</code> module’s <code>pom.xml</code>:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="xml"><span class="tag">&lt;dependency&gt;</span>
    <span class="tag">&lt;groupId&gt;</span>org.datanucleus<span class="tag">&lt;/groupId&gt;</span>
    <span class="tag">&lt;artifactId&gt;</span>datanucleus-java8<span class="tag">&lt;/artifactId&gt;</span>
    <span class="tag">&lt;version&gt;</span>4.2.0-release<span class="tag">&lt;/version&gt;</span>t
<span class="tag">&lt;/dependency&gt;</span></code></pre> 
          </div> 
         </div> 
         <div class="admonitionblock note"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
             <td class="content"> 
              <div class="paragraph"> 
               <p>The DataNucleus website includes a <a href="http://www.datanucleus.org/products/accessplatform/compatibility.html">page</a> listing version compatibility of these extensions vis-a-vis the core DataNucleus platform.</p> 
              </div> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugodn_hints-and-tips_diagnosing-n-plus-1">4.4. Diagnosing n+1 Issues</h3> 
         <div class="paragraph"> 
          <p>(As of DN 4.1) set a break point in <code>FetchRequest#execute(…​)</code>:</p> 
         </div> 
         <div class="imageblock"> 
          <div class="content"> 
           <a class="image" href="ugodn/images/hints-n-tips/diagnosing-n-plus-1.png"><img src="ugodn/images/hints-n-tips/diagnosing-n-plus-1.png" alt="diagnosing n plus 1" width="800px"></a> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>The "Variables" pane will tell you which field(s) are being loaded, and the stack trace should help explain why the field is required.</p> 
         </div> 
         <div class="paragraph"> 
          <p>For example, it may be that an object is being loaded in a table and the initial query did not eagerly load that field. In such a case, consider using fetch groups in the initial repository query to bring the required data into memory with just one SQL call. See <a href="ugodb.html#_ugodn_hints-and-tips_typesafe-queries-and-fetchgroups">this hint/tip</a> for further details.</p> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugodn_hints-and-tips_typesafe-queries-and-fetchgroups">4.5. Typesafe Queries and Fetch-groups</h3> 
         <div class="paragraph"> 
          <p>Fetch groups provide a means to hint to DataNucleus that it should perform a SQL join when querying. A common use case is to avoid the <a href="ugodn.html#_ugodn_hints-and-tips_diagnosing-n-plus-1">n+1</a> issue.</p> 
         </div> 
         <div class="paragraph"> 
          <p>(So far as I could ascertain) it isn’t possible to specify fetch group hints using JDOQL, but it is possible to specify them using the programmatic API or using typesafe queries.</p> 
         </div> 
         <div class="paragraph"> 
          <p>For example, here’s a JDOQL query:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Query</span>(
                name = <span class="string"><span class="delimiter">"</span><span class="content">findCompletedOrLaterWithItemsByReportedDate</span><span class="delimiter">"</span></span>, language = <span class="string"><span class="delimiter">"</span><span class="content">JDOQL</span><span class="delimiter">"</span></span>,
                value = <span class="string"><span class="delimiter">"</span><span class="content">SELECT </span><span class="delimiter">"</span></span>
                                + <span class="string"><span class="delimiter">"</span><span class="content">FROM org.estatio.capex.dom.invoice.IncomingInvoice </span><span class="delimiter">"</span></span>
                                + <span class="string"><span class="delimiter">"</span><span class="content">WHERE items.contains(ii) </span><span class="delimiter">"</span></span>
                                + <span class="string"><span class="delimiter">"</span><span class="content"> &amp;&amp; (ii.reportedDate == :reportedDate) </span><span class="delimiter">"</span></span>
                                + <span class="string"><span class="delimiter">"</span><span class="content"> &amp;&amp; (approvalState != 'NEW' &amp;&amp; approvalState != 'DISCARDED') </span><span class="delimiter">"</span></span>
                                + <span class="string"><span class="delimiter">"</span><span class="content">VARIABLES org.estatio.capex.dom.invoice.IncomingInvoiceItem ii </span><span class="delimiter">"</span></span>
),
<span class="directive">public</span> <span class="type">class</span> <span class="class">IncomingInvoice</span> ... { ... }</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>which normally would be used from a repository:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="predefined-type">List</span>&lt;IncomingInvoice&gt; findCompletedOrLaterWithItemsByReportedDate(
        <span class="directive">final</span> LocalDate reportedDate) {
    <span class="keyword">return</span> repositoryService.allMatches(
            <span class="keyword">new</span> QueryDefault&lt;&gt;(
                    IncomingInvoice.class,
                    <span class="string"><span class="delimiter">"</span><span class="content">findCompletedOrLaterWithItemsByReportedDate</span><span class="delimiter">"</span></span>,
                    <span class="string"><span class="delimiter">"</span><span class="content">reportedDate</span><span class="delimiter">"</span></span>, reportedDate));
}</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>This can be re-written as a type-safe query as follows:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="predefined-type">List</span>&lt;IncomingInvoice&gt; findCompletedOrLaterWithItemsByReportedDate(<span class="directive">final</span> LocalDate reportedDate) {

    <span class="directive">final</span> QIncomingInvoice ii = QIncomingInvoice.candidate();
    <span class="directive">final</span> QIncomingInvoiceItem iii = QIncomingInvoiceItem.variable(<span class="string"><span class="delimiter">"</span><span class="content">iii</span><span class="delimiter">"</span></span>);

    <span class="directive">final</span> TypesafeQuery&lt;IncomingInvoice&gt; q =
        isisJdoSupport.newTypesafeQuery(IncomingInvoice.class);

    q.filter(
            ii.items.contains(iii)
        .and(iii.reportedDate.eq(reportedDate))
        .and(ii.approvalState.ne(IncomingInvoiceApprovalState.NEW))
        .and(ii.approvalState.ne(IncomingInvoiceApprovalState.DISCARDED)));
    <span class="directive">final</span> <span class="predefined-type">List</span>&lt;IncomingInvoice&gt; incomingInvoices = Lists.newArrayList(q.executeList());
    q.closeAll();
    <span class="keyword">return</span> incomingInvoices;
}</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>Now the <code>IncomingInvoice</code> has four fields that require eager loading. This can be specified by defining a named fetch group:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@FetchGroup</span>(
        name=<span class="string"><span class="delimiter">"</span><span class="content">seller_buyer_property_bankAccount</span><span class="delimiter">"</span></span>,
        members={
                <span class="annotation">@Persistent</span>(name=<span class="string"><span class="delimiter">"</span><span class="content">seller</span><span class="delimiter">"</span></span>),
                <span class="annotation">@Persistent</span>(name=<span class="string"><span class="delimiter">"</span><span class="content">buyer</span><span class="delimiter">"</span></span>),
                <span class="annotation">@Persistent</span>(name=<span class="string"><span class="delimiter">"</span><span class="content">property</span><span class="delimiter">"</span></span>),
                <span class="annotation">@Persistent</span>(name=<span class="string"><span class="delimiter">"</span><span class="content">bankAccount</span><span class="delimiter">"</span></span>)
        })
<span class="directive">public</span> <span class="type">class</span> <span class="class">IncomingInvoice</span> ... { ... }</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>This fetch group can then be used in the query using <code>q.getFetchPlan().addGroup(…​)</code>. Putting this all together, we get:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="predefined-type">List</span>&lt;IncomingInvoice&gt; findCompletedOrLaterWithItemsByReportedDate(<span class="directive">final</span> LocalDate reportedDate) {

    <span class="directive">final</span> QIncomingInvoice ii = QIncomingInvoice.candidate();
    <span class="directive">final</span> QIncomingInvoiceItem iii = QIncomingInvoiceItem.variable(<span class="string"><span class="delimiter">"</span><span class="content">iii</span><span class="delimiter">"</span></span>);

    <span class="directive">final</span> TypesafeQuery&lt;IncomingInvoice&gt; q =
        isisJdoSupport.newTypesafeQuery(IncomingInvoice.class);

    q.getFetchPlan().addGroup(<span class="string"><span class="delimiter">"</span><span class="content">seller_buyer_property_bankAccount</span><span class="delimiter">"</span></span>);     <i class="conum" data-value="1"></i><b>(1)</b>

    q.filter(
            ii.items.contains(iii)
        .and(iii.reportedDate.eq(reportedDate))
        .and(ii.approvalState.ne(IncomingInvoiceApprovalState.NEW))
        .and(ii.approvalState.ne(IncomingInvoiceApprovalState.DISCARDED)));
    <span class="directive">final</span> <span class="predefined-type">List</span>&lt;IncomingInvoice&gt; incomingInvoices = Lists.newArrayList(q.executeList());
    q.closeAll();
    <span class="keyword">return</span> incomingInvoices;
}</code></pre> 
          </div> 
         </div> 
         <div class="colist arabic"> 
          <table> 
           <tbody>
            <tr> 
             <td><i class="conum" data-value="1"></i><b>1</b></td> 
             <td>specify the fetch group to use.</td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugodn_hints-and-tips_jdoql-and-timestamps">4.6. JDOQL and Timestamps</h3> 
         <div class="paragraph"> 
          <p>Beware of entities with a property called "timestamp": you run the risk of "timestamp" being treated as a keyword in certain contexts, probably not as you intended.</p> 
         </div> 
         <div class="paragraph"> 
          <p>By way of example, the (non-ASF) <a href="http://platform.incode.org">Incode Platform</a>'s command module has an entity called <code>CommandJdo</code>. This has a property called "timestamp", of type <code>java.sql.Timestamp</code>.</p> 
         </div> 
         <div class="paragraph"> 
          <p>This defines a query using JDOQL:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java">SELECT
FROM org.isisaddons.module.command.dom.CommandJdo
WHERE executeIn == <span class="string"><span class="delimiter">'</span><span class="content">FOREGROUND</span><span class="delimiter">'</span></span>
   &amp;&amp; timestamp &gt; :timestamp
   &amp;&amp; startedAt != <span class="predefined-constant">null</span>
   &amp;&amp; completedAt != <span class="predefined-constant">null</span>
ORDER BY timestamp ASC</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>This is declared using a JDO <code>@Query</code>; no errors are thrown at any stage.</p> 
         </div> 
         <div class="paragraph"> 
          <p>However, running this query against SQL Server 2016 produced a different result first time it was run compared to subsequent times.</p> 
         </div> 
         <div class="paragraph"> 
          <p>Running SQL Profiler showed the underlying SQL as:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="sql">exec sp_prepexec <span class="variable">@p1</span> output,<span class="string"><span class="modifier">N</span><span class="delimiter">'</span><span class="content">@P0 datetime2</span><span class="delimiter">'</span></span>,
<span class="string"><span class="modifier">N</span><span class="delimiter">'</span><span class="content">SELECT ''org.isisaddons.module.command.dom.CommandJdo'' AS NUCLEUS_TYPE, A0.arguments, ..., A0.target, A0."timestamp", A0.transactionId, A0."user", ''2018-01-24 17:29:18.3'' AS NUCORDER0 <i class="conum" data-value="1"></i><b>(1)</b> FROM isiscommand.Command A0 WHERE A0.executeIn = ''FOREGROUND'' AND A0."timestamp" &gt; @P0 AND A0.startedAt IS NOT NULL AND A0.completedAt IS NOT NULL ORDER BY NUCORDER0 OFFSET 0 ROWS FETCH NEXT 2 ROWS ONLY </span><span class="delimiter">'</span></span>,   <i class="conum" data-value="2"></i><b>(2)</b>
<span class="string"><span class="delimiter">'</span><span class="content">2018-01-24 17:29:18.3000000</span><span class="delimiter">'</span></span>               <i class="conum" data-value="3"></i><b>(3)</b></code></pre> 
          </div> 
         </div> 
         <div class="colist arabic"> 
          <table> 
           <tbody>
            <tr> 
             <td><i class="conum" data-value="1"></i><b>1</b></td> 
             <td>discussed below …​ this is the issue</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="2"></i><b>2</b></td> 
             <td>because the query is submitted with max rows programmatically set to 2.</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="3"></i><b>3</b></td> 
             <td>argument for @P0 (the timestamp parametr)</td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>To unpick this, the key issue is the <code>NUCORDER0</code> column, which is then used in the <code>ORDER BY</code>. However, because this is a literal value, the effect is no defined ordering.</p> 
         </div> 
         <div class="paragraph"> 
          <p>The problem therefore is that in the JDOQL the "ORDER BY timestamp ASC", the "timestamp" is being evaluated as the current time - a built-in function.</p> 
         </div> 
         <div class="paragraph"> 
          <p>My fix was to change the JDOQL to be:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="sql"><span class="class">SELECT</span>
<span class="keyword">FROM</span> org.isisaddons.module.command.dom.CommandJdo
<span class="keyword">WHERE</span> executeIn == <span class="string"><span class="delimiter">'</span><span class="content">FOREGROUND</span><span class="delimiter">'</span></span>
   &amp;&amp; <span class="predefined-type">timestamp</span> &gt; :<span class="predefined-type">timestamp</span>
   &amp;&amp; startedAt != <span class="predefined-constant">null</span>
   &amp;&amp; completedAt != <span class="predefined-constant">null</span>
<span class="keyword">ORDER</span> <span class="keyword">BY</span> this.timestamp <span class="directive">ASC</span>             <i class="conum" data-value="1"></i><b>(1)</b></code></pre> 
          </div> 
         </div> 
         <div class="colist arabic"> 
          <table> 
           <tbody>
            <tr> 
             <td><i class="conum" data-value="1"></i><b>1</b></td> 
             <td>Use "this." to qualify the timestamp</td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>It wasn’t necessary to qualify the other occurances of "timestamp" (though it would be no harm to do so, either).</p> 
         </div> 
        </div> 
       </div> 
      </div> 
      <div class="sect1"> 
       <h2 id="_security">5. Security</h2> 
       <div class="sectionbody"> 
        <div class="paragraph"> 
         <p>Hints and tips for working with security module. Taken from the <a href="#ugsec/ugsec.adoc">Security</a> guide.</p> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugsec_hints-and-tips_configuring-isis-to-use-bypass">5.1. Bypassing security</h3> 
         <div class="paragraph"> 
          <p>The bypass security component consists of an implementation of both the <code>AuthenticationManager</code> and <code>AuthorizationManager</code> APIs, and are intended for prototyping use only.</p> 
         </div> 
         <div class="paragraph"> 
          <p>The authentication manager allows access with any credentials (in a sense, "bypassing" authentication), while the authorization manager provides access to all class members (in a sense, "bypassing" authorization).</p> 
         </div> 
         <div class="paragraph"> 
          <p>To tell Apache Isis to bypass security, just update the <code>WEB-INF/isis.properties</code> file:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="ini">isis.authentication=bypass
isis.authorization=bypass</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>This installs the appropriate no-op implementations for both authentication and authorization:</p> 
         </div> 
         <div class="imageblock"> 
          <div class="content"> 
           <a class="image" href="ugsec/images/security/security-apis-impl/configure-isis-to-use-bypass.PNG"><img src="ugsec/images/security/security-apis-impl/configure-isis-to-use-bypass.PNG" alt="configure isis to use bypass" width="600px"></a> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugsec_hints-and-tips_run-as">5.2. Run-as</h3> 
         <div class="paragraph"> 
          <p>This hint shows how to temporarily change the current user as reported by Shiro. This can be useful to support "Run As", for example.</p> 
         </div> 
         <div class="paragraph"> 
          <p>The heavy lifting is done in <code>ShiroService</code>:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@DomainService</span>(nature = NatureOfService.DOMAIN)
<span class="directive">public</span> <span class="type">class</span> <span class="class">ShiroService</span> {

    <span class="directive">public</span> <span class="type">void</span> runAs(<span class="predefined-type">String</span> userName) {
        SimplePrincipalCollection principals =
            <span class="keyword">new</span> SimplePrincipalCollection(userName, <span class="string"><span class="delimiter">"</span><span class="content">jdbcRealm</span><span class="delimiter">"</span></span>);                       <i class="conum" data-value="1"></i><b>(1)</b>
        getSubject().runAs(principals);
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> releaseRunAs() {
        <span class="directive">final</span> PrincipalCollection principals = getSubject().releaseRunAs();
        <span class="predefined-type">String</span> username = (<span class="predefined-type">String</span>)principals.asList().get(<span class="integer">0</span>);
        <span class="keyword">return</span> username;
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getUsername() {                                                       <i class="conum" data-value="2"></i><b>(2)</b>
        <span class="predefined-type">String</span> principalAsString = ((<span class="predefined-type">String</span>)getSubject().getPrincipal());
        <span class="keyword">return</span> principalAsString.toLowerCase();
    }

    <span class="directive">public</span> <span class="predefined-type">String</span> getRealUsername() {                                                   <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="keyword">return</span> userService.getUser().getName().toLowerCase();
    }

    <span class="directive">public</span> <span class="type">boolean</span> isRunAs() {
        <span class="keyword">return</span> getSubject().isRunAs();
    }

    <span class="directive">private</span> <span class="directive">static</span> <span class="predefined-type">Subject</span> getSubject() {
        <span class="keyword">return</span> org.apache.shiro.SecurityUtils.getSubject();
    }

    <span class="annotation">@Inject</span>
    <span class="directive">private</span> UserService userService;
}</code></pre> 
          </div> 
         </div> 
         <div class="colist arabic"> 
          <table> 
           <tbody>
            <tr> 
             <td><i class="conum" data-value="1"></i><b>1</b></td> 
             <td>"jdbcRealm" is realm as configured in Shiro config (shiro.ini). Might want to look this up from <code>ConfigurationService</code>.</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="2"></i><b>2</b></td> 
             <td>The username of the currently logged in user (by which permissions are determined). This could be the user name the real user is running as.</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="3"></i><b>3</b></td> 
             <td>The username of the real currently logged in user.</td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>This could be exposed in the UI using a simple <code>RunAsService</code>, for example:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@DomainService</span>(nature = NatureOfService.VIEW_MENU_ONLY)
<span class="annotation">@DomainServiceLayout</span>(menuBar = DomainServiceLayout.MenuBar.TERTIARY)
<span class="directive">public</span> <span class="type">class</span> <span class="class">RunAsService</span> {

    <span class="directive">public</span> Dashboard runAs(User user) {
        shiroService.runAs(user.getUsername());
        <span class="keyword">return</span> dashboardService.openDashboard();                    <i class="conum" data-value="1"></i><b>(1)</b>
    }
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;User&gt; choices0RunAs() {
        <span class="keyword">return</span> ...                                                  <i class="conum" data-value="2"></i><b>(2)</b>
    }
    <span class="directive">public</span> <span class="type">boolean</span> hideRunAs() {
        <span class="keyword">return</span> shiroService.isRunAs();
    }



    <span class="directive">public</span> User releaseRunAs() {
        <span class="predefined-type">String</span> username = shiroService.releaseRunAs();
        <span class="keyword">return</span> usersRepository.findByUsername(username);
    }
    <span class="directive">public</span> <span class="type">boolean</span> hideReleaseRunAs() {
        <span class="keyword">return</span> !shiroService.isRunAs();
    }


    <span class="annotation">@Inject</span>
    <span class="directive">private</span> ShiroService shiroService;
    <span class="annotation">@Inject</span>
    <span class="directive">private</span> UsersRepository usersRepository;
    <span class="annotation">@Inject</span>
    <span class="directive">private</span> DashboardService dashboardService;                      <i class="conum" data-value="1"></i><b>(1)</b>
}</code></pre> 
          </div> 
         </div> 
         <div class="colist arabic"> 
          <table> 
           <tbody>
            <tr> 
             <td><i class="conum" data-value="1"></i><b>1</b></td> 
             <td>go to the home page (application-specific)</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="2"></i><b>2</b></td> 
             <td>return a list of users to run as</td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>Credits: adapted from <a href="https://gist.github.com/erikdehair/efa3005440ca982cca41ebe5347e82d8">this gist</a>.</p> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugsec_hints-and-tips_shiro-caching">5.3. Caching and other Shiro Features</h3> 
         <div class="paragraph"> 
          <p>We don’t want to repeat the entire <a href="http://shiro.apache.org/documentation.html">Shiro documentation set</a> here, but we should flag a number of other features that are worth checking out.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="_caching">5.3.1. Caching</h4> 
          <div class="paragraph"> 
           <p>To ensure that security operations does not impede performance, Shiro supports caching. For example, this sets up a simple memory-based cache manager:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="ini">memoryCacheManager = org.apache.shiro.cache.MemoryConstrainedCacheManager
securityManager.cacheManager = $memoryCacheManager</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>Other implementations can be plugged in; see the Shiro <a href="http://shiro.apache.org/caching.html">documentation</a> for further details.</p> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_further_reading">5.3.2. Further Reading</h4> 
          <div class="ulist"> 
           <ul> 
            <li> <p>Shiro’s documentation page can be found <a href="http://shiro.apache.org/documentation.html">here</a>.</p> </li> 
            <li> <p>community-contributed articles can be found <a href="http://shiro.apache.org/articles.html">here</a>.<br></p> 
             <div class="paragraph"> 
              <p>These include for instance <a href="http://meri-stuff.blogspot.co.uk/2011/04/apache-shiro-part-2-realms-database-and.html">this interesting article</a> describing how to perform certificate-based authentication (ie login using Google or Facebook credentials).</p> 
             </div> </li> 
           </ul> 
          </div> 
         </div> 
        </div> 
       </div> 
      </div> 
      <div class="sect1"> 
       <h2 id="_beyond_the_basics">6. Beyond the Basics</h2> 
       <div class="sectionbody"> 
        <div class="paragraph"> 
         <p>Miscellaneous hints and tips, either advanced or just obscure. Taken from the <a href="#ugbtb/ugbtb.adoc">Beyond the Basics</a> guide.</p> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_are-you-sure">6.1. 'Are you sure?' idiom</h3> 
         <div class="paragraph"> 
          <p>Sometimes an action might perform irreversible changes. In such a case it’s probably a good idea for the UI to require that the end-user explicitly confirms that they intended to invoke the action.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="_using_action_semantics">6.1.1. Using action semantics</h4> 
          <div class="paragraph"> 
           <p>One way to meet this requirement is using the framework’s built-in <a href="../rgant/rgant.html#_rgant-Action_semantics"><code>@Action#semantics()</code></a> attribute:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@Action</span>(
        semantics = SemanticsOf.IDEMPOTENT_ARE_YOU_SURE
)
<span class="directive">public</span> SimpleObject updateName(
        <span class="annotation">@Parameter</span>(maxLength = NAME_LENGTH)
        <span class="annotation">@ParameterLayout</span>(named = <span class="string"><span class="delimiter">"</span><span class="content">New name</span><span class="delimiter">"</span></span>)
        <span class="directive">final</span> <span class="predefined-type">String</span> name) {
    setName(name);
    <span class="keyword">return</span> <span class="local-variable">this</span>;
}</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>This will render as:</p> 
          </div> 
          <div class="imageblock"> 
           <div class="content"> 
            <a class="image" href="ugbtb/images/hints-and-tips/action-semantics-are-you-sure.png"><img src="ugbtb/images/hints-and-tips/action-semantics-are-you-sure.png" alt="action semantics are you sure"></a> 
           </div> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_using_a_checkbox">6.1.2. Using a checkbox</h4> 
          <div class="paragraph"> 
           <p>An alternative approach (for all versions of the framework) is to require the end-user to check a dummy checkbox parameter (and prevent the action from being invoked if the user hasn’t checked that parameter).</p> 
          </div> 
          <div class="paragraph"> 
           <p>For example:</p> 
          </div> 
          <div class="imageblock"> 
           <div class="content"> 
            <a class="image" href="ugbtb/images/hints-and-tips/are-you-sure.png"><img src="ugbtb/images/hints-and-tips/are-you-sure.png" alt="are you sure"></a> 
           </div> 
          </div> 
          <div class="admonitionblock note"> 
           <table> 
            <tbody>
             <tr> 
              <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
              <td class="content"> 
               <div class="paragraph"> 
                <p>Note that these screenshots shows an earlier version of the <a href="../ugvw/ugvw.html">Wicket viewer</a> UI (specifically, pre 1.8.0).</p> 
               </div> </td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
          <div class="paragraph"> 
           <p>If the user checks the box:</p> 
          </div> 
          <div class="imageblock"> 
           <div class="content"> 
            <a class="image" href="ugbtb/images/hints-and-tips/are-you-sure-happy-case.png"><img src="ugbtb/images/hints-and-tips/are-you-sure-happy-case.png" alt="are you sure happy case"></a> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>then the action will complete.</p> 
          </div> 
          <div class="paragraph"> 
           <p>However, if the user fails to check the box, then a validation message is shown:</p> 
          </div> 
          <div class="imageblock"> 
           <div class="content"> 
            <a class="image" href="ugbtb/images/hints-and-tips/are-you-sure-sad-case.png"><img src="ugbtb/images/hints-and-tips/are-you-sure-sad-case.png" alt="are you sure sad case"></a> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>The code for this is pretty simple:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="predefined-type">List</span>&lt;ToDoItem&gt; delete(<span class="annotation">@Named</span>(<span class="string"><span class="delimiter">"</span><span class="content">Are you sure?</span><span class="delimiter">"</span></span>) <span class="type">boolean</span> areYouSure) {
    container.removeIfNotAlready(<span class="local-variable">this</span>);
    container.informUser(<span class="string"><span class="delimiter">"</span><span class="content">Deleted </span><span class="delimiter">"</span></span> + container.titleOf(<span class="local-variable">this</span>));
    <span class="keyword">return</span> toDoItems.notYetComplete();          <i class="conum" data-value="1"></i><b>(1)</b>
}
<span class="directive">public</span> <span class="predefined-type">String</span> validateDelete(<span class="type">boolean</span> areYouSure) {
    <span class="keyword">return</span> areYouSure? <span class="predefined-constant">null</span>: <span class="string"><span class="delimiter">"</span><span class="content">Please confirm you are sure</span><span class="delimiter">"</span></span>;
}</code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>invalid to return <code>this</code> (cannot render a deleted object)</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
          <div class="paragraph"> 
           <p>Note that the action itself does not use the boolean parameter, it is only used by the supporting <a href="../rgcms/rgcms.html#_rgcms_methods_prefixes_validate"><code>validate…​()</code></a> method.</p> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_replacing-default-service-implementations">6.2. Overriding Default Service Implns</h3> 
         <div class="paragraph"> 
          <p>The framework provides default implementations for many of the <a href="../rgsvc/rgsvc.html">domain services</a>. This is convenient, but sometimes you will want to replace the default implementation with your own service implementation.</p> 
         </div> 
         <div class="paragraph"> 
          <p>For example, suppose you wanted to provide your own implementation of <a href="../rgsvc/rgsvc.html#_rgsvc_presentation-layer-spi_LocaleProvider"><code>LocaleProvider</code></a>. The trick is to use the <a href="../rgant/rgant.html#_rgant-DomainService_menuOrder"><code>@DomainService#menuOrder()</code></a> attribute, specifying a low number (typically <code>"1"</code>).</p> 
         </div> 
         <div class="paragraph"> 
          <p>Here’s how:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@DomainService</span>(
        nature = NatureOfService.DOMAIN
)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyLocaleProvider</span> <span class="directive">implements</span> LocaleProvider {
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">Locale</span> getLocale() {
        <span class="keyword">return</span> ...
    }
}</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>The framework uses the value of the <code>menuOrder</code> attribute to determine priority; lowest number wins.</p> 
         </div> 
         <div class="paragraph"> 
          <p>However, there is no need to specify the <code>menuOrder</code> attribute: its default value is now set to a lower value (specifically: <code>Integer.MAX_VALUE - 100</code>) than all of the framework-provided implementations, and thus always takes precedence.</p> 
         </div> 
         <div class="paragraph"> 
          <p>Thus, if a single instance is to be injected, eg:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@javax</span>.inject.Inject
LocalProvider localeProvider;</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>then the custom implementation will be used in preference to the framework’s default implementation.</p> 
         </div> 
         <div class="paragraph"> 
          <p>If multiple instances are injected, eg:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@javax</span>.inject.Inject
<span class="predefined-type">List</span>&lt;LocalProvider&gt; localeProviders;</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>then all implementations will be present in the list, ordered by priority; your custom implementation will be first in the list.</p> 
         </div> 
         <div class="admonitionblock note"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
             <td class="content"> 
              <div class="paragraph"> 
               <p>It is also possible to use <a href="../rgant/rgant.html#_rgant-DomainServiceLayout_menuOrder"><code>@DomainServiceLayout#menuOrder()</code></a> attribute, rather than <a href="../rgant/rgant.html#_rgant-DomainService_menuOrder"><code>@DomainService#menuOrder()</code></a>. The general convention is to use the former only for services that are rendered in the UI, the latter for programmatic services.</p> 
              </div> 
              <div class="paragraph"> 
               <p>If both attributes are present, then the value of <a href="../rgant/rgant.html#_rgant-DomainServiceLayout_menuOrder"><code>@DomainServiceLayout#menuOrder()</code></a> is used.</p> 
              </div> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="sect3"> 
          <h4 id="_decorating_existing_implementations">6.2.1. Decorating existing implementations</h4> 
          <div class="paragraph"> 
           <p>It’s also quite common to want to decorate the existing implementation (ie have your own implementation delegate to the default); this is also possible and quite easy:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@DomainService</span>(
        nature = NatureOfService.DOMAIN
)
<span class="annotation">@DomainServiceLayout</span>(
        menuOrder = <span class="string"><span class="delimiter">"</span><span class="content">1</span><span class="delimiter">"</span></span>                                                                             <i class="conum" data-value="1"></i><b>(1)</b>
)
<span class="directive">public</span> <span class="type">class</span> <span class="class">MyLocaleProvider</span> <span class="directive">implements</span> LocaleProvider {
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">Locale</span> getLocale() {
        <span class="keyword">return</span> getDelegateLocaleProvider().getLocale();                                             <i class="conum" data-value="2"></i><b>(2)</b>
    }
    Optional&lt;LocaleProvider&gt; delegateLocaleProvider;                                                <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="directive">private</span> LocaleProvider getDelegateLocaleProvider() {
        <span class="keyword">if</span>(delegateLocaleProvider == <span class="predefined-constant">null</span>) {
            delegateLocaleProvider = Iterables.tryFind(localeProviders, input -&gt; input != <span class="local-variable">this</span>);    <i class="conum" data-value="4"></i><b>(4)</b>
        }
        <span class="keyword">return</span> delegateLocaleProvider.orNull();
    }
    <span class="annotation">@Inject</span>
    <span class="predefined-type">List</span>&lt;LocaleProvider&gt; localeProviders;                                                           <i class="conum" data-value="5"></i><b>(5)</b>
}</code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>takes precedence over the default implementation when injected elsewhere.</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="2"></i><b>2</b></td> 
              <td>this implementation merely delegates to the default implementation</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="3"></i><b>3</b></td> 
              <td>lazily populated</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="4"></i><b>4</b></td> 
              <td>delegate to the first implementation that isn’t <em>this</em> implementation (else infinite loop!)</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="5"></i><b>5</b></td> 
              <td>Injects all implementations, including this implemenation</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_vetoing-visibility">6.3. Vetoing Visibility</h3> 
         <div class="admonitionblock note"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
             <td class="content"> FIXME - a write-up of the "vetoing subscriber" design pattern, eg as described in the <a href="../rgsvc/rgsvc.html#_rgsvc_integration-api_BookmarkService"><code>BookmarkService</code></a> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>eg if included an addon such as auditing or security.</p> 
         </div> 
         <div class="paragraph"> 
          <p>solution is to write a domain event subscriber that vetoes the visibility</p> 
         </div> 
         <div class="paragraph"> 
          <p>All the addons actions inherit from common base classes so this can be as broad-brush or fine-grained as required</p> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_transactions-and-errors">6.4. Transactions and Errors</h3> 
         <div class="paragraph"> 
          <p>In Apache Isis, every interaction (action invocation or property edit) is automatically wrapped in a transaction, and any repository query automatically does a flush before hand.</p> 
         </div> 
         <div class="paragraph"> 
          <p>What that means is that there’s no need to explicitly start or commit transactions in Apache Isis; this will be done for you. Indeed, if you do try to manage transactions (eg by reaching into the JDO <code>PersistenceManager</code> exposed by the <a href="../rgsvc/rgsvc.html#_rgsvc_persistence-layer-api_IsisJdoSupport">IsisJdoSupport</a> domain service, then you are likely to confuse the framework and get a stack trace for your trouble.</p> 
         </div> 
         <div class="paragraph"> 
          <p>However, you can complete a given transaction and start a new one. This is sometimes useful if writing a fixture script which is going to perform some sort of bulk migration of data from an old system. For this use case, use the <a href="../rgsvc/rgsvc.html#_rgsvc_application-layer-api_TransactionService"><code>TransactionService</code></a>.</p> 
         </div> 
         <div class="paragraph"> 
          <p>For example:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">SomeLongRunningFixtureScript</span> <span class="directive">extends</span> FixtureScript

    <span class="directive">protected</span> <span class="type">void</span> execute(<span class="directive">final</span> ExecutionContext executionContext) {
        <span class="comment">// do some work</span>
        transactionService.nextTransaction();
        <span class="comment">// do some work</span>
        transactionService.nextTransaction();
        <span class="comment">// do yet more work</span>
    }

    <span class="annotation">@javax</span>.inject.Inject
    TransactionService transactionService;
}</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>You get the idea.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="_raise_message_in_the_ui">6.4.1. Raise message in the UI</h4> 
          <div class="paragraph"> 
           <p>The framework provides the <a href="../rgsvc/rgsvc.html#_rgsvc_application-layer-api_MessageService"><code>MessageService</code></a> as a means to return an out-of-band message to the end-user. In the <a href="../ugvw/ugvw.html">Wicket viewer</a> these are shown as "toast" pop-ups; the <a href="../ugvro/ugvro.html">Restful Objects viewer</a> returns an HTTP header.</p> 
          </div> 
          <div class="paragraph"> 
           <p>The <code>UserService</code> provides three APIs, for different:</p> 
          </div> 
          <div class="ulist"> 
           <ul> 
            <li> <p><code>informUser()</code> - an informational message. In the Wicket viewer these are short-lived pop-ups that disappear after a short time.</p> </li> 
            <li> <p><code>warnUser()</code> - a warning. In the Wicket viewer these do not auto-close; they must be acknowledged.</p> </li> 
            <li> <p><code>raiseError()</code> - an error. In the Wicket viewer these do not auto-close; they must be acknowledged.</p> </li> 
           </ul> 
          </div> 
          <div class="paragraph"> 
           <p>Each pop-up has a different background colour indicating its severity.</p> 
          </div> 
          <div class="paragraph"> 
           <p>None of these messages/errors has any influence on the transaction; any changes to objects will be committed.</p> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_aborting_transactions">6.4.2. Aborting transactions</h4> 
          <div class="paragraph"> 
           <p>If you want to abort Apache Isis' transaction, this can be done by throwing an exception. The exception message is displayed to the user on the error page (if <a href="../ugvw/ugvw.html">Wicket viewer</a>) or a 500 status error code (if the <a href="../ugvro/ugvro.html">Restful Objects</a> viewer).</p> 
          </div> 
          <div class="paragraph"> 
           <p>If the exception thrown is because of an unexpected error (eg a <code>NullPointerException</code> in the domain app itself), then the error page will include a stack trace. If however you want to indicate that the exception is in some sense "expected", then throw a <code>RecoverableException</code> (or any subclass, eg <code>ApplicationException</code>); the stack trace will then be suppressed from the error page.</p> 
          </div> 
          <div class="paragraph"> 
           <p>Another way in which exceptions might be considered "expected" could be as the result of attempting to persist an object which then violates some type of database constraint. Even if the domain application checks beforehand, it could be that another user operating on the object at the same moment of time might result in the conflict.</p> 
          </div> 
          <div class="paragraph"> 
           <p>To handle this the <a href="../rgsvc/rgsvc.html#_rgsvc_presentation-layer-spi_ExceptionRecognizer"><code>ExceptionRecognizer</code></a> SPI can be used. The framework provides a number of implementations out-of-the-box; whenever an exception is thrown it is passed to each known recognizer implementation to see if it recognizes the exception and can return a user-meaningful error message. For example, <code>ExceptionRecognizerForSQLIntegrityConstraintViolationUniqueOrIndexException</code> checks if the exception inherits from <code>java.sql.SQLIntegrityConstraintViolationException</code>, and if so, constructs a suitable message.</p> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_persisted-title">6.5. Persisted Title</h3> 
         <div class="paragraph"> 
          <p>Normally the title of an object is not persisted to the database, rather it is recomputed automatically from underlying properties. On occasion though you might want the title to also be persisted; either to make things easier for the DBA, or for an integration scenario, or some other purpose.</p> 
         </div> 
         <div class="paragraph"> 
          <p>We can implement this feature by leveraging the <a href="../rgcms/rgcms.html#_rgcms_methods_lifecycle_jdo-api">JDO lifecycle</a>. In the design we discuss here we make it a responsibility of the entities to persist the title as a property, by implementing a <code>ObjectWithPersistedTitle</code> interface:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">interface</span> <span class="class">ObjectWithPersistedTitle</span> {
    <span class="annotation">@PropertyLayout</span>(hidden = Where.EVERYWHERE)  <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="predefined-type">String</span> getTitle();
    <span class="type">void</span> setTitle(<span class="directive">final</span> <span class="predefined-type">String</span> title);
}</code></pre> 
          </div> 
         </div> 
         <div class="colist arabic"> 
          <table> 
           <tbody>
            <tr> 
             <td><i class="conum" data-value="1"></i><b>1</b></td> 
             <td>we don’t want to expose this in the UI because the title is already prominently displayed.</td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>We can then define a subscribing domain service that leverage this.</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@DomainService</span>(nature = NatureOfService.DOMAIN)
<span class="directive">public</span> <span class="type">class</span> <span class="class">TitlingService</span> <span class="directive">extends</span> AbstractSubscriber {
    <span class="annotation">@Subscribe</span>
    <span class="directive">public</span> <span class="type">void</span> on(<span class="directive">final</span> ObjectPersistingEvent ev) {
        handle(ev.getSource());
    }
    <span class="annotation">@Subscribe</span>
    <span class="directive">public</span> <span class="type">void</span> on(<span class="directive">final</span> ObjectUpdatingEvent ev) {
        handle(ev.getSource());
    }
    <span class="directive">private</span> <span class="type">void</span> handle(<span class="directive">final</span> <span class="predefined-type">Object</span> persistentInstance) {
        <span class="keyword">if</span>(persistentInstance <span class="keyword">instanceof</span> ObjectWithPersistedTitle) {
            <span class="directive">final</span> ObjectWithPersistedTitle objectWithPersistedTitle =
                (ObjectWithPersistedTitle) persistentInstance;
            objectWithPersistedTitle.setTitle(titleService.titleOf(objectWithPersistedTitle));
        }
    }
    <span class="annotation">@Inject</span>
    TitleService titleService;
}</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>It is also possible to accomplish this by accessing the JDO API directly:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@RequestScoped</span>
<span class="annotation">@DomainService</span>(nature = NatureOfService.DOMAIN)
<span class="directive">public</span> <span class="type">class</span> <span class="class">TitlingService</span> {
    <span class="annotation">@PostConstruct</span>
    <span class="directive">public</span> <span class="type">void</span> init() {
        isisJdoSupport.getJdoPersistenceManager().addInstanceLifecycleListener(
            <span class="keyword">new</span> StoreLifecycleListener() {
                <span class="annotation">@Override</span>
                <span class="directive">public</span> <span class="type">void</span> preStore(<span class="directive">final</span> InstanceLifecycleEvent event) {
                    <span class="directive">final</span> <span class="predefined-type">Object</span> persistentInstance = event.getPersistentInstance();
                    <span class="keyword">if</span>(persistentInstance <span class="keyword">instanceof</span> ObjectWithPersistedTitle) {
                        <span class="directive">final</span> ObjectWithPersistedTitle objectWithPersistedTitle =
                            (ObjectWithPersistedTitle) persistentInstance;
                        objectWithPersistedTitle.setTitle(titleService.titleOf(objectWithPersistedTitle));
                    }
                }
                <span class="annotation">@Override</span>
                <span class="directive">public</span> <span class="type">void</span> postStore(<span class="directive">final</span> InstanceLifecycleEvent event) {
                }
            }, <span class="predefined-constant">null</span>);
    }
    <span class="annotation">@Inject</span>
    IsisJdoSupport isisJdoSupport;
    <span class="annotation">@Inject</span>
    TitleService titleService;
}</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>The above is probably the easiest and most straightforward design. One could imagine other designs where the persisted title is stored elsewhere. It could even be stored off into an <a href="http://lucene.apache.org/">Apache Lucene</a> (or similar) database to allow for free-text searches.</p> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_view-model-instantiation">6.6. View Model Instantiation</h3> 
         <div class="paragraph"> 
          <p>Vith view models, some care must be taken in how they are instantiated. Specifically, it’s important that the framework doesn’t "know" about the view model until its state is "sufficiently" populated to distinguish from other view models.</p> 
         </div> 
         <div class="paragraph"> 
          <p>In practical terms, this means that view models should be instantiated using a constructor, and then injecting services (if required) using the <a href="../rgsvc/rgsvc.html#_rgsvc_metadata-api_ServiceRegistry"><code>ServiceRegistry</code></a> service:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java">CustomerViewModel viewModel = <span class="keyword">new</span> CustomerViewModel(<span class="string"><span class="delimiter">"</span><span class="content">Joe</span><span class="delimiter">"</span></span>, <span class="string"><span class="delimiter">"</span><span class="content">Bloggs</span><span class="delimiter">"</span></span>);
serviceRegistry.injectServicesInto(viewModel);</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>What will most likely <strong>fail</strong> is to use the <a href="../rgsvc/rgsvc.html#_rgsvc_core-domain-api_FactoryService"><code>FactoryService</code></a>:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="comment">// DON'T DO THIS WITH VIEW MODELS</span>
CustomerViewModel viewModel = factoryService.instantiate(CustomerViewModel.class);

viewModel.setFirstName(<span class="string"><span class="delimiter">"</span><span class="content">Joe</span><span class="delimiter">"</span></span>);
viewModel.setLastName(<span class="string"><span class="delimiter">"</span><span class="content">Bloggs</span><span class="delimiter">"</span></span>);
serviceRegistry.injectServicesInto(viewModel);</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>That’s because the internal "OID" identifier that the framework creates to handle this view model will be incomplete. Although the framework can handle changes to the OID (when the corresponding view model’s state changes) once created, this isn’t the case during initial instantiation process.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="_example">6.6.1. Example</h4> 
          <div class="paragraph"> 
           <p>To explain further, here’s an implementation using <code>FactoryService</code> that fails:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@XmlRootElement</span>(name = <span class="string"><span class="delimiter">"</span><span class="content">yearSummary</span><span class="delimiter">"</span></span>)
<span class="annotation">@XmlType</span>( propOrder = { ... } )
<span class="annotation">@XmlAccessorType</span>(XmlAccessType.FIELD)
<span class="directive">public</span> <span class="type">class</span> <span class="class">YearSummary</span> {                                                  <i class="conum" data-value="1"></i><b>(1)</b>
    ...
    <span class="annotation">@XmlTransient</span>
    <span class="annotation">@CollectionLayout</span>(defaultView = <span class="string"><span class="delimiter">"</span><span class="content">table</span><span class="delimiter">"</span></span>)
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;OfficeOptionViewModel&gt; getAmountsPerOffice() {
        <span class="predefined-type">List</span>&lt;OfficeOptionViewModel&gt; amountsPerOffice = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;();

        OfficeOptionViewModel office1 =                                     <i class="conum" data-value="2"></i><b>(2)</b>
            factoryService.instantiate(OfficeOptionViewModel.class);
        office1.setOffice(<span class="string"><span class="delimiter">"</span><span class="content">Amsterdam</span><span class="delimiter">"</span></span>);                                     <i class="conum" data-value="3"></i><b>(3)</b>
        office1.setAmount(<span class="integer">200</span>);
        amountsPerOffice.add(office1);

        OfficeOptionViewModel office2 =                                     <i class="conum" data-value="2"></i><b>(2)</b>
            factoryService.instantiate(OfficeOptionViewModel.class);
        office2.setOffice(<span class="string"><span class="delimiter">"</span><span class="content">London</span><span class="delimiter">"</span></span>);                                        <i class="conum" data-value="3"></i><b>(3)</b>
        office2.setAmount(<span class="integer">100</span>);
        amountsPerOffice.add(office2);

        <span class="keyword">return</span> amountsPerOffice;
    }
}</code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>Parent view model</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="2"></i><b>2</b></td> 
              <td>Using <code>FactoryService</code>, incorrectly.</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="3"></i><b>3</b></td> 
              <td>Hard-coded just for demo purposes</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
          <div class="paragraph"> 
           <p>This collection, is, confusing, rendered as:</p> 
          </div> 
          <div class="imageblock"> 
           <div class="content"> 
            <a class="image" href="ugbtb/images/hints-and-tips/view-model-fail.png"><img src="ugbtb/images/hints-and-tips/view-model-fail.png" alt="view model fail" width="800px"></a> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>Even though the <code>amountsPerOffice</code> collection of view models is correctly populated, the framework/viewer maps these to their corresponding OIDs before they are rendered. Because the "Amsterdam" pojo and "London" pojo each mapped to the same OID, when fetching out the results the viewer obtains the London pojo both times.</p> 
          </div> 
          <div class="paragraph"> 
           <p>The following implementation, on the other hand, succeeds:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@XmlRootElement</span>(name = <span class="string"><span class="delimiter">"</span><span class="content">yearSummary</span><span class="delimiter">"</span></span>)
<span class="annotation">@XmlType</span>( propOrder = { ... } )
<span class="annotation">@XmlAccessorType</span>(XmlAccessType.FIELD)
<span class="directive">public</span> <span class="type">class</span> <span class="class">YearSummary</span> {
    ...
    <span class="annotation">@XmlTransient</span>
    <span class="annotation">@CollectionLayout</span>(defaultView = <span class="string"><span class="delimiter">"</span><span class="content">table</span><span class="delimiter">"</span></span>)
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;OfficeOptionViewModel&gt; getAmountsPerOffice() {
        <span class="predefined-type">List</span>&lt;OfficeOptionViewModel&gt; amountsPerOffice = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;();

                OfficeOptionViewModel office1 = <span class="keyword">new</span> OfficeOptionViewModel(<span class="string"><span class="delimiter">"</span><span class="content">Amsterdam</span><span class="delimiter">"</span></span>, <span class="integer">200</span>);    <i class="conum" data-value="1"></i><b>(1)</b>
                serviceRegistry.injectServicesInto(office1);
                amountsPerOffice.add(office1);

                OfficeOptionViewModel office2 = <span class="keyword">new</span> OfficeOptionViewModel(<span class="string"><span class="delimiter">"</span><span class="content">London</span><span class="delimiter">"</span></span>, <span class="integer">100</span>);       <i class="conum" data-value="1"></i><b>(1)</b>
                serviceRegistry.injectServicesInto(office2);
                amountsPerOffice.add(office2);

        <span class="keyword">return</span> amountsPerOffice;
    }
}</code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>Just instantiate with constructor. The framework "sees" the domain object when services are injected into it.</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
          <div class="paragraph"> 
           <p>As can be seen, this renders just fine:</p> 
          </div> 
          <div class="imageblock"> 
           <div class="content"> 
            <a class="image" href="ugbtb/images/hints-and-tips/view-model-success.png"><img src="ugbtb/images/hints-and-tips/view-model-success.png" alt="view model success" width="800px"></a> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>To complicate matters a little, note though that following "incorrect" implementation using <code>FactoryService</code> does also work correctly:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@XmlRootElement</span>(name = <span class="string"><span class="delimiter">"</span><span class="content">yearSummary</span><span class="delimiter">"</span></span>)
<span class="annotation">@XmlType</span>( propOrder = { ..., <span class="string"><span class="delimiter">"</span><span class="content">amountsPerOffice</span><span class="delimiter">"</span></span> } )                     <i class="conum" data-value="1"></i><b>(1)</b>
<span class="annotation">@XmlAccessorType</span>(XmlAccessType.FIELD)
<span class="directive">public</span> <span class="type">class</span> <span class="class">YearSummary</span> {
        ...

    void init() {
        amountsPerOffice = calculateAmountsPerOffice();
    }

    <span class="annotation">@XmlElementWrapper</span>
    <span class="annotation">@XmlElement</span>(name = <span class="string"><span class="delimiter">"</span><span class="content">officeOption</span><span class="delimiter">"</span></span>)
    <span class="annotation">@CollectionLayout</span>(defaultView = <span class="string"><span class="delimiter">"</span><span class="content">table</span><span class="delimiter">"</span></span>)
    <span class="annotation">@Getter</span> <span class="annotation">@Setter</span>
    <span class="directive">private</span> <span class="predefined-type">List</span>&lt;OfficeOptionViewModel&gt; amountsPerOffice = Lists.newArrayList();

        <span class="annotation">@XmlTransient</span>
    <span class="annotation">@CollectionLayout</span>(defaultView = <span class="string"><span class="delimiter">"</span><span class="content">table</span><span class="delimiter">"</span></span>)
    <span class="directive">public</span> <span class="predefined-type">List</span>&lt;OfficeOptionViewModel&gt; calculateAmountsPerOffice() {
        <span class="predefined-type">List</span>&lt;OfficeOptionViewModel&gt; amountsPerOffice = <span class="keyword">new</span> <span class="predefined-type">ArrayList</span>&lt;&gt;();

                OfficeOptionViewModel office1 = factoryService.instantiate(OfficeOptionViewModel.class);
                office1.setOffice(<span class="string"><span class="delimiter">"</span><span class="content">Amsterdam</span><span class="delimiter">"</span></span>);
                office1.setAmount(<span class="integer">200</span>);

                amountsPerOffice.add(office1);

                OfficeOptionViewModel office2 = factoryService.instantiate(OfficeOptionViewModel.class);
                office2.setOffice(<span class="string"><span class="delimiter">"</span><span class="content">London</span><span class="delimiter">"</span></span>);
                office2.setAmount(<span class="integer">100</span>);

                amountsPerOffice.add(office2);

        <span class="keyword">return</span> amountsPerOffice;
    }
}</code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>"amountsPerOffice" is part of the state of the parent view model</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
          <div class="paragraph"> 
           <p>In this case the <code>amountsPerOffice</code> collection is part of the state of the parent view model and so in this particular case everything works with either <code>FactoryService#instantiate</code> or using <code>ServiceRegistry</code>.</p> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_simulating-collections-of-values">6.7. Collections of values</h3> 
         <div class="paragraph"> 
          <p>Although in Apache Isis you can have properties of either values (string, number, date etc) or of (references to other) entities, with collections the framework (currently) only supports collections of (references to) entities. That is, collections of values (a bag of numbers, say) are not supported.</p> 
         </div> 
         <div class="paragraph"> 
          <p>However, it is possible to simulate a bag of numbers using view models.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="_view_model">6.7.1. View Model</h4> 
          <div class="admonitionblock note"> 
           <table> 
            <tbody>
             <tr> 
              <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
              <td class="content"> FIXME </td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_persistence_concerns">6.7.2. Persistence Concerns</h4> 
          <div class="admonitionblock note"> 
           <table> 
            <tbody>
             <tr> 
              <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
              <td class="content"> FIXME - easiest to simply store using DataNucleus' support for collections, marked as <a href="../rgant/rgant.html#_rgant-Programmatic"><code>@Programmatic</code></a> so that it is ignored by Apache Isis. Alternatively can store as json/xml in a varchar(4000) or clob and manually unpack. </td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_how-to-handle-void-and-null-results">6.8. How to handle void/null results</h3> 
         <div class="paragraph"> 
          <p>From this <a href="http://isis.markmail.org/thread/yf7qdeiu3vrvk2ei">thread</a> on the Apache Isis users mailing list:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p><em>When using a <code>void</code> action, let’s say a remove action, the user is redirected to a page "no results". When clicking the back button in the browser the user sees "Object not found" (since you’ve just deleted this object).</em></p> </li> 
           <li> <p><em>You can return a list for example to prevent the user from being redirect to a "No results" page, but I think it’s not the responsibility of the controllers in the domain model.</em></p> </li> 
           <li> <p><em>A solution could be that wicket viewer goes back one page when encountering a deleted object. And refresh the current page when receiving a null response or invoking a void action. But how to implement this?</em></p> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>One way to implement this idea is to provide a custom implementation of the <a href="../rgsvc/rgsvc.html#_rgsvc_presentation-layer-spi_RoutingService"><code>RoutingService</code></a> SPI domain service. The default implementation will either return the current object (if not null), else the home page (as defined by <a href="../rgant/rgant.html#_rgant-HomePage"><code>@HomePage</code></a>) if one exists.</p> 
         </div> 
         <div class="paragraph"> 
          <p>The following custom implementation refines this to use the breadcrumbs (available in the Wicket viewer) to return the first non-deleted domain object found in the list of breadcrumbs:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="annotation">@DomainService</span>(nature = NatureOfService.DOMAIN)
<span class="annotation">@DomainServiceLayout</span>(menuOrder = <span class="string"><span class="delimiter">"</span><span class="content">1</span><span class="delimiter">"</span></span>)                                           <i class="conum" data-value="1"></i><b>(1)</b>
<span class="directive">public</span> <span class="type">class</span> <span class="class">RoutingServiceUsingBreadcrumbs</span> <span class="directive">extends</span> RoutingServiceDefault {
    <span class="annotation">@Override</span>
    <span class="directive">public</span> <span class="predefined-type">Object</span> route(<span class="directive">final</span> <span class="predefined-type">Object</span> original) {
        <span class="keyword">if</span>(original != <span class="predefined-constant">null</span>) {                                                  <i class="conum" data-value="2"></i><b>(2)</b>
            <span class="keyword">return</span> original;
        }
        repositoryService.flush();                                              <i class="conum" data-value="3"></i><b>(3)</b>

        <span class="directive">final</span> BreadcrumbModelProvider wicketSession =                           <i class="conum" data-value="4"></i><b>(4)</b>
            (BreadcrumbModelProvider) AuthenticatedWebSession.get();
        <span class="directive">final</span> BreadcrumbModel breadcrumbModel =
            wicketSession.getBreadcrumbModel();
        <span class="directive">final</span> <span class="predefined-type">List</span>&lt;EntityModel&gt; breadcrumbs = breadcrumbModel.getList();

        <span class="directive">final</span> Optional&lt;<span class="predefined-type">Object</span>&gt; firstViewModelOrNonDeletedPojoIfAny =
                breadcrumbs.stream()                                            <i class="conum" data-value="5"></i><b>(5)</b>
                .filter(entityModel -&gt; entityModel != <span class="predefined-constant">null</span>)
                .map(EntityModel::getObject)                                    <i class="conum" data-value="6"></i><b>(6)</b>
                .filter(objectAdapter -&gt; objectAdapter != <span class="predefined-constant">null</span>)
                .map(ObjectAdapter::getObject)                                  <i class="conum" data-value="7"></i><b>(7)</b>
                .filter(pojo -&gt; !(pojo <span class="keyword">instanceof</span> Persistable) ||
                                !((Persistable)pojo).dnIsDeleted())             <i class="conum" data-value="8"></i><b>(8)</b>
                .findFirst();

        <span class="keyword">return</span> firstViewModelOrNonDeletedPojoIfAny.orElse(homePage());          <i class="conum" data-value="9"></i><b>(9)</b>
    }
    <span class="directive">private</span> <span class="predefined-type">Object</span> homePage() {
        <span class="keyword">return</span> homePageProviderService.homePage();
    }
    <span class="annotation">@Inject</span>
    HomePageProviderService homePageProviderService;
    <span class="annotation">@Inject</span>
    RepositoryService repositoryService;
}</code></pre> 
          </div> 
         </div> 
         <div class="colist arabic"> 
          <table> 
           <tbody>
            <tr> 
             <td><i class="conum" data-value="1"></i><b>1</b></td> 
             <td>override the default imlpementation</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="2"></i><b>2</b></td> 
             <td>if a non-null object was returned, then return this</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="3"></i><b>3</b></td> 
             <td>ensure that any persisted objects have been deleted.</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="4"></i><b>4</b></td> 
             <td>reach inside the Wicket viewer’s internals to obtain the list of breadcrumbs.</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="5"></i><b>5</b></td> 
             <td>loop over all breadcrumbs</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="6"></i><b>6</b></td> 
             <td>unwrap the Wicket viewer’s serializable representation of each domain object (<code>EntityModel</code>) to the Isis runtime’s representation (<code>ObjectAdapter</code>)</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="7"></i><b>7</b></td> 
             <td>unwrap the Isis runtime’s representation of each domain object (<code>ObjectAdapter</code>) to the domain object pojo itself</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="8"></i><b>8</b></td> 
             <td>if object is persistable (not a view model) then make sure it is not deleted</td> 
            </tr> 
            <tr> 
             <td><i class="conum" data-value="9"></i><b>9</b></td> 
             <td>return the first object if any, otherwise the home page object (if any).</td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>Note that the above implementation uses Java 8, so if you are using Java 7 then you’ll need to backport accordingly.</p> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_multi-tenancy">6.9. Multi-tenancy</h3> 
         <div class="paragraph"> 
          <p>Of the various modules provided by the (non-ASF) <a href="http://platform.incode.org" target="_blank" rel="noopener">Incode Platform</a>, the security module has the most features. One significant feature is the ability to associate users and objects with a "tenancy".</p> 
         </div> 
         <div class="paragraph"> 
          <p>For more details, see the <a href="http://platform.incode.org" target="_blank" rel="noopener">Incode Platform</a>'s security module README.</p> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_subclass-properties-in-tables">6.10. Subclass properties in tables</h3> 
         <div class="paragraph"> 
          <p>Suppose you have a hierarchy of classes where a property is derived and abstract in the superclass, concrete implementations in the subclasses. For example:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">abstract</span> <span class="type">class</span> <span class="class">LeaseTerm</span> {
    <span class="directive">public</span> <span class="directive">abstract</span> <span class="predefined-type">BigDecimal</span> getEffectiveValue();
    ...
}

<span class="directive">public</span> <span class="type">class</span> <span class="class">LeaseTermForIndexableTerm</span> <span class="directive">extends</span> LeaseTerm {
    <span class="directive">public</span> <span class="predefined-type">BigDecimal</span> getEffectveValue() { ... }
    ...
}</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>Currently the Wicket viewer will not render the property in tables (though the property is correctly rendered in views).</p> 
         </div> 
         <div class="admonitionblock note"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
             <td class="content"> 
              <div class="paragraph"> 
               <p>For more background on this workaround, see <a href="https://issues.apache.org/jira/browse/ISIS-582">ISIS-582</a>.</p> 
              </div> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>The work-around is simple enough; make the method concrete in the superclass and return a dummy implementation, eg:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="directive">abstract</span> <span class="type">class</span> <span class="class">LeaseTerm</span> {
    <span class="directive">public</span> <span class="predefined-type">BigDecimal</span> getEffectiveValue() {
        <span class="keyword">return</span> <span class="predefined-constant">null</span>;        <span class="comment">// workaround for ISIS-582</span>
    }
    ...
}</code></pre> 
          </div> 
         </div> 
         <div class="paragraph"> 
          <p>Alternatively the implementation could throw a <code>RuntimeException</code>, eg</p> 
         </div> 
         <div class="listingblock"> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="java"><span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">RuntimeException</span>(<span class="string"><span class="delimiter">"</span><span class="content">never called; workaround for ISIS-582</span><span class="delimiter">"</span></span>);</code></pre> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_pushing-changes">6.11. Pushing Changes (deprecated)</h3> 
         <div class="admonitionblock note"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
             <td class="content"> 
              <div class="paragraph"> 
               <p>This technique is much less powerful than using ../ugfun/ugfun.adoc#_ugfun_building-blocks_events_domain-events[the event bus] or an SPI service. We present it mostly for completeness.</p> 
              </div> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="sect3"> 
          <h4 id="_when_a_property_is_changed">6.11.1. When a property is changed</h4> 
          <div class="paragraph"> 
           <p>If you want to invoke functionality whenever a property is changed by the user, then you can create a supporting <code>modifyXxx()</code> method and include the functionality within that. The syntax is:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> modifyPropertyName(PropertyType param) { ... }</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>Why not just put this functionality in the setter? Well, the setter is used by the object store to recreate the state of an already persisted object. Putting additional behaviour in the setter would cause it to be triggered incorrectly.</p> 
          </div> 
          <div class="paragraph"> 
           <p>For example:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Order</span>() {
    <span class="directive">public</span> <span class="predefined-type">Integer</span> getAmount() { ... }
    <span class="directive">public</span> <span class="type">void</span> setAmount(<span class="predefined-type">Integer</span> amount) { ... }
    <span class="directive">public</span> <span class="type">void</span> modifyAmount(<span class="predefined-type">Integer</span> amount) { <i class="conum" data-value="1"></i><b>(1)</b>
        setAmount(amount);  <i class="conum" data-value="3"></i><b>(3)</b>
        addToTotal(amount); <i class="conum" data-value="2"></i><b>(2)</b>
    }
    ...
}</code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>The <code>modifyAmount()</code> method calls …​</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="2"></i><b>2</b></td> 
              <td>…​ the <code>addToTotal()</code> (not shown) to maintain some running total.</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
          <div class="paragraph"> 
           <p>We don’t want this <code>addToCall()</code> method to be called when pulling the object back from the object store, so we put it into the modify, not the setter.</p> 
          </div> 
          <div class="paragraph"> 
           <p>You may optionally also specify a <code>clearXxx()</code> which works the same way as modify <code>modify Xxx()</code> but is called when the property is cleared by the user (i.e. the current value replaced by nothing). The syntax is:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> clearPropertyName() { ... }</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>To extend the above example:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Order</span>() {
    <span class="directive">public</span> <span class="predefined-type">Integer</span> getAmount() { ... }
    <span class="directive">public</span> <span class="type">void</span> setAmount(<span class="predefined-type">Integer</span> amount) { ... }
    <span class="directive">public</span> <span class="type">void</span> modifyAmount(<span class="predefined-type">Integer</span> amount) { ... }
    <span class="directive">public</span> <span class="type">void</span> clearAmount() {
        removeFromTotal(<span class="local-variable">this</span>.amount);
        setAmount(<span class="predefined-constant">null</span>);
    }
    ...
}</code></pre> 
           </div> 
          </div> 
         </div> 
         <div class="sect3"> 
          <h4 id="_when_a_collection_is_modified">6.11.2. When a collection is modified</h4> 
          <div class="paragraph"> 
           <p>A collection may have a corresponding <code>addToXxx()</code> and/or <code>removeFromXxx()</code> method. If present, and direct manipulation of the contents of the connection has not been disabled (see ?), then they will be called (instead of adding/removing an object directly to the collection returned by the accessor).</p> 
          </div> 
          <div class="paragraph"> 
           <p>The reason for this behaviour is to allow other behaviour to be triggered when the contents of the collection is altered. That is, it is directly equivalent to the supporting <code>modifyXxx()</code> and <code>clearXxx()</code> methods for properties (see ?).</p> 
          </div> 
          <div class="paragraph"> 
           <p>The syntax is:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> addTo&lt;CollectionName&gt;(EntityType param) { ... }</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>and</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">void</span> removeFromCollectionName(EntityType param) { ... }</code></pre> 
           </div> 
          </div> 
          <div class="paragraph"> 
           <p>where <code>EntityType</code> is the same type as the generic collection type.</p> 
          </div> 
          <div class="paragraph"> 
           <p>For example:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="java"><span class="directive">public</span> <span class="type">class</span> <span class="class">Employee</span> { ... }

<span class="directive">public</span> <span class="type">class</span> <span class="class">Department</span> {

    <span class="directive">private</span> <span class="type">int</span> numMaleEmployees;                           <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="directive">private</span> <span class="type">int</span> numFemaleEmployees;                         <i class="conum" data-value="2"></i><b>(2)</b>

    <span class="directive">private</span> <span class="predefined-type">Set</span>&lt;Employee&gt; employees = <span class="keyword">new</span> <span class="predefined-type">TreeSet</span>&lt;Employee&gt;();
    <span class="directive">public</span> <span class="predefined-type">Set</span>&lt;Employee&gt; getEmployees() {
        <span class="keyword">return</span> employees;
    }
    <span class="directive">private</span> <span class="type">void</span> setEmployees(<span class="predefined-type">Set</span>&lt;Employee&gt; employees) {
        <span class="local-variable">this</span>.employees = employees;
    }
    <span class="directive">public</span> <span class="type">void</span> addToEmployees(Employee employee) {         <i class="conum" data-value="3"></i><b>(3)</b>
        numMaleEmployees += countOneMale(employee);
        numFemaleEmployees += countOneFemale(employee);
        employees.add(employee);
    }
    <span class="directive">public</span> <span class="type">void</span> removeFromEmployees(Employee employee) {    <i class="conum" data-value="4"></i><b>(4)</b>
        numMaleEmployees -= countOneMale(employee);
        numFemaleEmployees -= countOneFemale(employee);
        employees.remove(employee);
    }
    <span class="directive">private</span> <span class="type">int</span> countOneMale(Employee employee) { <span class="keyword">return</span> employee.isMale()?<span class="integer">1</span>:<span class="integer">0</span>; }
    <span class="directive">private</span> <span class="type">int</span> countOneFemale(Employee employee) { <span class="keyword">return</span> employee.isFemale()?<span class="integer">1</span>:<span class="integer">0</span>; }

    ...
}</code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>maintain a count of the number of male …​</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="2"></i><b>2</b></td> 
              <td>…​ and female employees (getters and setters omitted)</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="3"></i><b>3</b></td> 
              <td>the <a href="../rgcms/rgcms.html#_rgcms_methods_prefixes_addTo"><code>addTo…​()</code></a> method increments the derived properties</td> 
             </tr> 
             <tr> 
              <td><i class="conum" data-value="4"></i><b>4</b></td> 
              <td>the <a href="../rgcms/rgcms.html#_rgcms_methods_prefixes_removeFrom"><code>removeFrom…​()</code></a> method similarly decrements the derived properties</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_ugbtb_hints-and-tips_how-to-implement-a-spellchecker">6.12. How to implement a spellchecker?</h3> 
         <div class="paragraph"> 
          <p>From this <a href="http://isis.markmail.org/thread/dduarjscrbnodfsi">thread</a> on the Apache Isis users mailing list:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p><em>What is the easiest way to add a spell checker to the text written in a field in a domain object, for instance to check English syntax?</em></p> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>One way to implement is to use the <a href="../rgsvc/rgsvc.html#_rgsvc_core-domain-api_EventBusService">event bus</a>:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p>Set up a <a href="../rgcms/rgcms.html#_rgcms_classes_domainevent">domain event</a> <a href="../rgcms/rgcms.html#_rgcms_classes_super_AbstractSubscriber">subscriber</a> that can veto the changes.</p> </li> 
           <li> <p>if the change is made through an action, you can use <a href="../rgant/rgant.html#_rgant-Action_domainEvent"><code>@Action#domainEvent()</code></a>.</p> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>if if the change is made through an edit, you can use <a href="../rgant/rgant.html#_rgant-Property_domainEvent"><code>@Property#domainEvent()</code></a>.</p> 
         </div> 
         <div class="paragraph"> 
          <p>You’ll need some way to know which fields should be spell checked. Two ways spring to mind:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p>either look at the domain event’s identifier</p> </li> 
           <li> <p>or subclass the domain event (recommended anyway) and have those subclass events implement some sort of marker interface, eg a <code>SpellCheckEvent</code>.</p> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>And you’ll (obviously) also need some sort of spell checker implementation to call.</p> 
         </div> 
        </div> 
       </div> 
      </div> 
      <div class="sect1"> 
       <h2 id="_developers_guide">7. Developers' Guide</h2> 
       <div class="sectionbody"> 
        <div class="sect2"> 
         <h3 id="_dg_hints-and-tips_datanucleus-enhancer">7.1. Datanucleus Enhancer</h3> 
         <div class="paragraph"> 
          <p><a href="http://www.datanucleus.org/">DataNucleus</a> is the reference implementation of the JDO (Java data objects) spec, and Apache Isis integrates with DataNucleus as its persistence layer. Datanucleus is a very powerful library, allowing domain entities to be mapped not only to relational database tables, but also to NoSQL stores such as <a href="http://neo4j.com/">Neo4J</a>, <a href="http://www.mongodb.org/">MongoDB</a> and <a href="http://cassandra.apache.org/">Apache Cassandra</a>.</p> 
         </div> 
         <div class="paragraph"> 
          <p>With such power comes a little bit of complexity to the development environment: all domain entities must be enhanced through the DataNucleus enhancer.</p> 
         </div> 
         <div class="admonitionblock note"> 
          <table> 
           <tbody>
            <tr> 
             <td class="icon"> <i class="fa icon-note" title="Note"></i> </td> 
             <td class="content"> 
              <div class="paragraph"> 
               <p>Bytecode enhancement is actually a requirement of the JDO spec; the process is described in outline <a href="http://db.apache.org/jdo/enhancement.html">here</a>.</p> 
              </div> </td> 
            </tr> 
           </tbody>
          </table> 
         </div> 
         <div class="paragraph"> 
          <p>What this means is that the enhancer — available as both a Maven plugin and as an Eclipse plugin — must, one way or another, be integrated into your development environment.</p> 
         </div> 
         <div class="paragraph"> 
          <p>If working from the Maven command line, JDO enhancement is done using the <code>maven-datanucleus-plugin</code>.</p> 
         </div> 
         <div class="paragraph"> 
          <p>Both the <a href="../ugfun/ugfun.html#_ugfun_getting-started_helloworld-archetype">HelloWorld</a> and <a href="../ugfun/ugfun.html#_ugfun_getting-started_simpleapp-archetype">SimpleApp</a> Maven archetypes generate applications that have this plugin pre-configured.</p> 
         </div> 
         <div class="sect3"> 
          <h4 id="_meta_inf_persistence_xml">7.1.1. META-INF/persistence.xml</h4> 
          <div class="paragraph"> 
           <p>It’s also a good idea to ensure that every domain module(s) containing entities has a JDO <code>META-INF/persistence.xml</code> file:</p> 
          </div> 
          <div class="listingblock"> 
           <div class="content"> 
            <pre class="CodeRay highlight"><code data-lang="xml"><span class="preprocessor">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span>
<span class="tag">&lt;persistence</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://java.sun.com/xml/ns/persistence</span><span class="delimiter">"</span></span>
    <span class="attribute-name">xmlns:xsi</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://www.w3.org/2001/XMLSchema-instance</span><span class="delimiter">"</span></span>
    <span class="attribute-name">xsi:schemaLocation</span>=<span class="string"><span class="delimiter">"</span><span class="content">http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd</span><span class="delimiter">"</span></span> <span class="attribute-name">version</span>=<span class="string"><span class="delimiter">"</span><span class="content">1.0</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>

    <span class="tag">&lt;persistence-unit</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">"</span><span class="content">simple</span><span class="delimiter">"</span></span><span class="tag">&gt;</span> <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tag">&lt;/persistence-unit&gt;</span>
<span class="tag">&lt;/persistence&gt;</span></code></pre> 
           </div> 
          </div> 
          <div class="colist arabic"> 
           <table> 
            <tbody>
             <tr> 
              <td><i class="conum" data-value="1"></i><b>1</b></td> 
              <td>change as required; typically is the name of the domain module.</td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
          <div class="paragraph"> 
           <p>Again, the applications generated by both the <a href="../ugfun/ugfun.html#_ugfun_getting-started_helloworld-archetype">HelloWorld</a> and <a href="../ugfun/ugfun.html#_ugfun_getting-started_simpleapp-archetype">Simpleapp</a> Maven archetypes do this.</p> 
          </div> 
          <div class="admonitionblock warning"> 
           <table> 
            <tbody>
             <tr> 
              <td class="icon"> <i class="fa icon-warning" title="Warning"></i> </td> 
              <td class="content"> 
               <div class="paragraph"> 
                <p>If running on Windows, then there’s a good chance you’ll hit the <a href="http://msdn.microsoft.com/en-us/library/aa365247%28VS.85%29.aspx#maxpath">maximum path length limit</a>. In this case the <code>persistence.xml</code> file is mandatory rather than optional.</p> 
               </div> 
               <div class="paragraph"> 
                <p>This file is also required if you are using developing in Eclipse and relying on the DataNucleus plugin for Eclipse rather than the DataNucleus plugin for Maven. More information can be found <a href="../dg/dg.html#_dg_ide_eclipse">here</a>.</p> 
               </div> </td> 
             </tr> 
            </tbody>
           </table> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_dg_hints-and-tips_enabling-logging">7.2. Enabling Logging</h3> 
         <div class="paragraph"> 
          <p>Sometimes you just need to see what is going on. There are various ways in which logging can be enabled, here are the ones we tend to use.</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p>In Apache Isis<br></p> 
            <div class="paragraph"> 
             <p>Modify <code>WEB-INF/logging.properties</code> (a log4j config file)</p> 
            </div> </li> 
           <li> <p>In DataNucleus<br></p> 
            <div class="paragraph"> 
             <p>As per the <a href="http://www.datanucleus.org/products/accessplatform/logging.html">DN logging page</a></p> 
            </div> </li> 
           <li> <p>In the JDBC Driver<br></p> 
            <div class="paragraph"> 
             <p>Configure <code>log4jdbc</code> JDBC rather than the vanilla driver (see <code>WEB-INF/persistor_datanucleus.properties</code>) and configure log4j logging (see <code>WEB-INF/logging.properties</code>). There are examples of both in the <a href="../ugfun/ugfun.html#_ugfun_getting-started_simpleapp-archetype">SimpleApp archetype</a>.</p> 
            </div> </li> 
           <li> <p>In the database<br></p> 
            <div class="paragraph"> 
             <p>Details below.</p> 
            </div> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>Database logging can be configured:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p>for HSQLDB<br></p> 
            <div class="paragraph"> 
             <p>by adding`;sqllog=3` to the end of the JDBC URL.</p> 
            </div> </li> 
           <li> <p>for PostgreSQL:<br></p> 
            <div class="paragraph"> 
             <p>Can change <code>postgresql\9.2\data\postgresql.conf</code>; see <a href="http://www.postgresql.org/docs/9.2/static/runtime-config-logging.html">this article</a> for details.</p> 
            </div> </li> 
           <li> <p>for MS SQL Server Logging:<br></p> 
            <div class="paragraph"> 
             <p>We like to use the excellent SQL Profiler tool.</p> 
            </div> </li> 
          </ul> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_dg_hints-and-tips_enhance-only">7.3. Enhance only (IntelliJ)</h3> 
         <div class="paragraph"> 
          <p>From the Apache Isis mailing list is:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p><em>Is there a simple way to make a run configuration in IntelliJ for running the datanucleus enhancer before running integration test?</em></p> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>Yes, you can; here’s one way:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p>Duplicate your run configuration for running the webapp</p> 
            <div class="ulist"> 
             <ul> 
              <li> <p>the one where the main class is <code>org.apache.isis.WebServer</code></p> </li> 
              <li> <p>there’s a button for this on the run configurations dialog.</p> </li> 
             </ul> 
            </div> </li> 
           <li> <p>then, on your copy change the main class to <code>org.apache.isis.Dummy</code></p> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>Or, you could just write a small shell script and run from the command line:</p> 
         </div> 
         <div class="listingblock"> 
          <div class="title">
           enhance.sh
          </div> 
          <div class="content"> 
           <pre class="CodeRay highlight"><code data-lang="bash">mvn -pl dom datanucleus:enhance -o</code></pre> 
          </div> 
         </div> 
        </div> 
        <div class="sect2"> 
         <h3 id="_dg_hints-and-tips_how-run-fixtures-on-app-startup">7.4. How run fixtures on startup?</h3> 
         <div class="paragraph"> 
          <p>From this <a href="http://isis.markmail.org/thread/g6amfj2eyf2xfjbr">thread</a> on the Apache Isis users mailing list:</p> 
         </div> 
         <div class="ulist"> 
          <ul> 
           <li> <p><em>my fixtures have grown into a couple of files the application needs to read in when it starts the first time (and possibly later on when the files content change). What is the right way to do this? Hook up into the webapp start? Use events?</em></p> </li> 
          </ul> 
         </div> 
         <div class="paragraph"> 
          <p>The standard approach is to use <a href="../ugtst/ugtst.html#_ugtst_fixture-scripts">fixture scripts</a>. These can be run in on start-up typically by being specified in the <a href="../rgcms/rgcms.html#_rgcms_classes_AppManifest-bootstrapping"><code>AppManifest</code></a>, see for example the <a href="../ugfun/ugfun.html#_ugfun_getting-started_simpleapp-archetype">SimpleApp archetype</a>.</p> 
         </div> 
         <div class="paragraph"> 
          <p>Alternatively just set <code>isis.fixtures</code> and <code>isis.persistor.datanucleus.install-fixtures</code> properties.</p> 
         </div> 
         <div class="paragraph"> 
          <p>In terms of implementations, you might also want to check out the (non-ASF) <a href="http://platform.incode.org" target="_blank" rel="noopener">Incode Platform</a>'s excel module, by using <code>ExcelFixture</code> and overriding <code>ExcelFixtureRowHandler</code>.</p> 
         </div> 
         <div class="paragraph"> 
          <p>An example can be found in this (non ASF) <a href="https://github.com/incodehq/contactapp">contactapp</a>, see <a href="https://github.com/incodehq/contactapp/blob/master/backend/fixture/src/main/java/org/incode/eurocommercial/contactapp/fixture/scenarios/demo/ContactImport.java"><code>ContactRowHandler</code></a>.</p> 
         </div> 
        </div> 
       </div> 
      </div> 
     </div> 
    </div> 
    <div class="hidden-xs hidden-sm hidden-md col-lg-3"> 
     <nav id="toc" data-spy="affix" data-toggle="toc"></nav> 
    </div> 
   </div> 
  </div> 
  <footer class="footer"> 
   <div class="container"> 
    <div class="row"> 
     <p class="text-center small text-muted"> Copyright © 2010~2018 The Apache&nbsp;Software&nbsp;Foundation, licensed under the Apache&nbsp;License,&nbsp;v2.0. <br> Apache, the Apache feather logo, Apache&nbsp;Isis, and the Apache&nbsp;Isis project logo are all trademarks of The&nbsp;Apache&nbsp;Software&nbsp;Foundation. </p> 
    </div> 
   </div> 
  </footer> 
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script> 
  <script src="../../js/bootstrap/3.3.7/bootstrap.min.js"></script> 
  <script src="../../js/bootstrap-toc/0.4.1/bootstrap-toc.min.js"></script> 
  <script src="../../js/slick/1.5.0/slick.min.js"></script> 
  <script src="../../js/elasticlunr/elasticlunr.min.js"></script> 
  <script src="../../js/sticky-header/sticky-header.js"></script> 
  <script src="../../js/search-panel/search-panel.js"></script> 
  <script src="../../js/header-link/header-link.js"></script> 
  <script src="../../js/toc-scroll/toc-scroll.js"></script>  
 </body>
</html>
